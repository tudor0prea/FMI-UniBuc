(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred.odsp-common"],{1192:function(e,t,n){"use strict";n.d(t,"i",function(){return T});n.d(t,"n",function(){return N});n.d(t,"s",function(){return C});n.d(t,"o",function(){return L});n.d(t,"t",function(){return A});n.d(t,"r",function(){return O});n.d(t,"u",function(){return M});n.d(t,"e",function(){return _});var r,i,s,o,u,a,f,l,c,h,p=n(0),d=n(591),v=n(1792),m=n(346),g=n(18),y=n(220),b=n(376),w=n(328),E=n(23),S=void 0,x={ODB:1469,ODC:"ChromiumDateFix"};function T(e,t){void 0===t&&(t=!1);return b.n(e,_(m.e.language),t)}function N(e,t,n,r,i,s){void 0===t&&(t=!1);void 0===n&&(n=!1);void 0===r&&(r=!1);var o=Date.now()-e.getTime(),u=(function(){var e=new Date;e.setHours(0,0,0,0);return e})(),a=B(u,-1),f=B(u,-6),l=i||{},c=l.displayMinutesToOneHour,h=void 0===c||c,p=l.displayHoursToOneDay,g=void 0===p||p,y=l.displayHoursInDates,E=void 0===y||y,S=l.displayShortenedWeekday,x=void 0===S||S,T=_(s||m.e.language);if(h&&o<-5*w.n)return e.toLocaleDateString(T,F({month:"short",day:"numeric"},r));if(o<w.u)return n?v.n:v.t;if(h&&o<w.t)return j(o,v.i,w.n);if(w.c(u,e))return g?j(o,v.r,w.t):b.t("Today",n);if(e>=a)return t||!E?b.t("Yesterday",n):b.t("YesterdayAndTime",n).replace("{0}",e.toLocaleTimeString(T,F({hour:"numeric",minute:"2-digit"},r)));if(e>=f){var N=e.toLocaleDateString(T,F({weekday:"short"},r));return t?N:x||E?d.RelativeDateTime_DayAndTime.replace("{0}",N).replace("{1}",e.toLocaleTimeString(T,F({hour:"numeric",minute:"2-digit"},r))):e.toLocaleDateString(T,F({weekday:"long"},r))}return w.h(u,e)?T.match(/(^ja$)|(^ja-{1})/i)?e.toLocaleDateString(T,F({month:"long",day:"numeric"},r)):e.toLocaleDateString(T,F({month:"short",day:"numeric"},r)):e.toLocaleDateString(T,F({month:"short",day:"numeric",year:"numeric"},r))}function C(e){return b.r(e,_(m.e.language))}function k(){var e=r(),t=D();if(window.Intl&&window.Intl.DateTimeFormat){var n={},i={hour:"2-digit",minute:"2-digit"};s=new Intl.DateTimeFormat(e,n);o=new Intl.DateTimeFormat(e,i);if(t){n.timeZone="UTC";i.timeZone="UTC"}u=new Intl.DateTimeFormat(e,n);a=new Intl.DateTimeFormat(e,i);f=s.format;l=o.format;c=u.format;h=a.format}else{f=c=function(t){return t.toLocaleDateString(e)};l=h=function(t){return t.toLocaleTimeString(e)}}}function L(e,t){if(!e)return"";f||k();var n=w.c(new Date,e);return(t?n?h:c:n?l:f)(e)}function A(e,t){if(!e)return"";f||k();return(t?c:f)(e).replace(/[:\/\\]/g,"-")}function O(e,t){f||k();var n=t?c(e):f(e),r=t?h(e):l(e);return Object(g.format)(v.e,n,r)}function M(e,t){return w.d(e,_(m.e.language),t)}function _(e){if(void 0===S)try{S=y.e.isFeatureEnabled(x)}catch(e){S=!1}return S&&(function(e){void 0===H&&(function(){H={};var e=new Date(1900,0,1);try{for(var t={month:"long"},n=0,r=P;n<r.length;n++){var i=r[n];e.toLocaleDateString(i,t).match("M[0-9][0-9]")&&(H[i]=!0)}}catch(e){}})();if(e){e=e.toLowerCase();return H[e]}return})(e)?"en":e}r=function(){for(var e,t=0,n=!E.t.isActivated("6f22587b-a676-47a0-b10c-3e037c3f7b14","03/11/2022","Use currentCultureName to display numbers and dates.")?[window.$Config&&window.$Config.mkt,m.e.cultureLCID,m.e.language,navigator.language,"en"].filter(function(e){return!!e}):[window.$Config&&window.$Config.mkt,m.e.language,navigator.language,"en"].filter(function(e){return!!e});t<n.length;t++){var i=n[t];try{(new Date).toLocaleDateString(i);e=i;break}catch(e){}}e=_(e);r=function(){return e};return e};function D(){if(void 0===i)try{var e=r();(new Date).toLocaleDateString(e,{timeZone:"UTC"});i=!0}catch(e){i=!1}return i}var P=["eu-es","af-za","az-latn-az","bs-latn-ba","cy-gb","ga-ie","gl-es","ha-latn-ng","hy-am","ig-ng","is-is","ka-ge","kk-kz","km-kh","ky-kg","mk-mk","mn-mn","mt-mt","ne-np","nn-no","or-in","pa-in","si-lk","sq-al","ur-pk","uz-latn-uz","yo-ng","zu-za","pa-arab-pk","ku-arab-iq","be-by","rw-rw","ti-et","tg-cyrl-tj","eu","af","az","bs","cy","ga","gl","ha","hy","ig","is","ka","kk","km","ky","mk","mn","mt","ne","nn","or","pa","si","sq","ur","uz","yo","zu","pa","ku","be","rw","ti"],H=void 0;function B(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function j(e,t,n){var r=Math.round(e/n);return t.replace("{0}",String(r))}function F(e,t){return D()&&t&&e?Object(p.__assign)(Object(p.__assign)({},e),{timeZone:"UTC"}):e}},1691:function(e,t,n){"use strict";n.r(t);n.d(t,"getFirstConsistentlyInteractive",function(){return i});var r=n(1799);n.d(t,"restartLongTaskObserver",function(){return r.t});function i(e){void 0===e&&(e={});if("PerformanceLongTaskTiming"in window){return new r.e(e).getFirstConsistentlyInteractive()}return Promise.resolve(null)}},1799:function(e,t,n){"use strict";n.d(t,"t",function(){return l});n.d(t,"e",function(){return c});var r=n(0),i=0;var s=["img","script","iframe","link","audio","video","source"];function o(e,t){for(var n=0,r=e;n<r.length;n++){var i=r[n];if(t.includes(i.nodeName.toLowerCase())||o(i.children,t))return!0}return!1}function u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];a()&&console.log.apply(console,e)}function a(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableTTILogging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1}function f(e,t){if(e.length>2)return performance.now();for(var n=[],r=0,i=t;r<i.length;r++){var s=i[r];n.push({timestamp:s.start,type:"requestStart"});n.push({timestamp:s.end,type:"requestEnd"})}for(var o=0,u=e;o<u.length;o++){var a=u[o];n.push({timestamp:a,type:"requestStart"})}n.sort(function(e,t){return e.timestamp-t.timestamp});for(var f=e.length,l=n.length-1;l>=0;l--){var c=n[l];switch(c.type){case"requestStart":f--;break;case"requestEnd":if(++f>2)return c.timestamp;break;default:throw Error("Internal Error: This should never happen")}}return 0}function l(){window.__tti&&window.__tti.o.observe({entryTypes:["longtask"]})}var c=(function(){function e(e){void 0===e&&(e={});var t=this;this._useMutationObserver=!!e.useMutationObserver;this._trackNetworkRequests=!!e.trackNetworkRequests;this._minValue=e.minValue||null;this._requiredMainThreadQuietnessDurationInMilliseconds=e.requiredMainThreadQuietnessDurationInMilliseconds||5e3;this._requiredNetworkQuietnessDurationInMilliseconds=e.requiredNetworkQuietnessDurationInMilliseconds||5e3;var n=window.__tti&&window.__tti.e,r=window.__tti&&window.__tti.o;this._longTaskId=0;if(n){u("Consuming the long task entries already recorded.");this._longTasks=n.map(function(e){return t._createLongTask(e)});window.__tti.e=[]}else this._longTasks=[];r&&r.disconnect();this._networkRequests=[];this._incompleteJSInitiatedRequestStartTimes=new Map;this._timerId=void 0;this._timerActivationTime=-1/0;this._scheduleTimerTasks=!1;this._firstConsistentlyInteractiveResolver=null;this._performanceObserver=null;this._mutationObserver=null;this._registerListeners(this._trackNetworkRequests)}e.prototype.getFirstConsistentlyInteractive=function(){var e=this;return new Promise(function(t,n){e._firstConsistentlyInteractiveResolver=t;"complete"===document.readyState?e.startSchedulingTimerTasks():window.addEventListener("load",function(){e.startSchedulingTimerTasks()})})};e.prototype.startSchedulingTimerTasks=function(){u("Enabling FirstConsistentlyInteractiveDetector");this._scheduleTimerTasks=!0;var e=this._longTasks.length>0?this._longTasks[this._longTasks.length-1].end:0,t=f(this._incompleteRequestStarts(),this._networkRequests);this._rescheduleTimer(Math.max(this._trackNetworkRequests?t+this._requiredNetworkQuietnessDurationInMilliseconds:0,e))};e.prototype._rescheduleTimer=function(e){var t=this;if(this._scheduleTimerTasks){u("Attempting to reschedule FirstConsistentlyInteractive "+"check to ".concat(e));u("Previous timer activation time: ".concat(this._timerActivationTime));if(this._timerActivationTime>e)u("Current activation time is greater than attempted reschedule time. No need to postpone.");else{clearTimeout(this._timerId);this._timerId=setTimeout(function(){t._checkTTI()},Math.max(0,e-performance.now()));this._timerActivationTime=e;u("Rescheduled firstConsistentlyInteractive check at ".concat(e))}}else u("startSchedulingTimerTasks must be called before calling rescheduleTimer")};e.prototype._disable=function(){u("Disabling FirstConsistentlyInteractiveDetector");clearTimeout(this._timerId);this._scheduleTimerTasks=!1;this._unregisterListeners()};e.prototype._registerPerformanceObserver=function(e){var t=this;void 0===e&&(e=!0);this._performanceObserver=new PerformanceObserver(function(n){for(var r=0,i=n.getEntries();r<i.length;r++){var s=i[r];"resource"===s.entryType&&e&&t._networkRequestFinishedCallback(s);"longtask"===s.entryType&&t._longTaskFinishedCallback(s)}});this._performanceObserver.observe({entryTypes:e?["longtask","resource"]:["longtask"]})};e.prototype._registerListeners=function(e){void 0===e&&(e=!0);if(e){u=this._beforeJSInitiatedRequestCallback.bind(this),a=this._afterJSInitiatedRequestCallback.bind(this),f=XMLHttpRequest.prototype.send,l=i++,XMLHttpRequest.prototype.send=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];u(l.toString());this.addEventListener("readystatechange",function(){4===e.readyState&&a(l.toString())});return f.apply(this,t)};t=this._beforeJSInitiatedRequestCallback.bind(this),n=this._afterJSInitiatedRequestCallback.bind(this),r=window.fetch,window.fetch=function(){for(var e=[],s=0;s<arguments.length;s++)e[s]=arguments[s];return new Promise(function(s,o){var u=i++;t(u.toString());r.apply(void 0,e).then(function(e){n(u.toString());s(e)},function(e){n(e);o(e)})})}}var t,n,r,u,a,f,l;this._registerPerformanceObserver(e);this._useMutationObserver&&(this._mutationObserver=(function(e){var t=new MutationObserver(function(t){for(var n=0,r=t;n<r.length;n++){var i=r[n];("childList"===i.type&&o(i.addedNodes,s)||"attributes"===i.type&&s.includes(i.target.tagName.toLowerCase()))&&e(i)}});t.observe(document,{attributes:!0,childList:!0,subtree:!0,attributeFilter:["href","src"]});return t})(this._mutationObserverCallback.bind(this)))};e.prototype._unregisterListeners=function(){this._performanceObserver&&this._performanceObserver.disconnect();this._mutationObserver&&this._mutationObserver.disconnect()};e.prototype._beforeJSInitiatedRequestCallback=function(e){u("Starting JS initiated request. Request ID: ".concat(e));this._incompleteJSInitiatedRequestStartTimes.set(e,performance.now());u("Active XHRs: ".concat(this._incompleteJSInitiatedRequestStartTimes.size))};e.prototype._afterJSInitiatedRequestCallback=function(e){u("Completed JS initiated request with request ID: ".concat(e));this._incompleteJSInitiatedRequestStartTimes.delete(e);u("Active XHRs: ".concat(this._incompleteJSInitiatedRequestStartTimes.size))};e.prototype._networkRequestFinishedCallback=function(e){u("Network request finished",e);this._networkRequests.push({start:e.fetchStart,end:e.responseEnd});this._rescheduleTimer(f(this._incompleteRequestStarts(),this._networkRequests)+this._requiredNetworkQuietnessDurationInMilliseconds)};e.prototype._longTaskFinishedCallback=function(e){u("Long task finished",e);var t,n=this._createLongTask(e),r="longTaskEnd".concat(n.id);t=r,window.performance&&performance.mark&&performance.mark(t);n.endMarkName=r;this._longTasks.push(n);this._rescheduleTimer(n.end+this._requiredMainThreadQuietnessDurationInMilliseconds)};e.prototype._mutationObserverCallback=function(e){u("Potentially network resource fetching mutation detected",e);u("Pushing back FirstConsistentlyInteractive check by ".concat(this._requiredNetworkQuietnessDurationInMilliseconds," milliseconds."));this._rescheduleTimer(performance.now()+this._requiredNetworkQuietnessDurationInMilliseconds)};e.prototype._getMinValue=function(){return this._minValue?this._minValue:performance.timing.domContentLoadedEventEnd?performance.timing.domContentLoadedEventEnd-performance.timing.navigationStart:null};e.prototype._createLongTask=function(e){var t=e.startTime+e.duration;return{attribution:e.attribution,name:e.name,start:Math.round(e.startTime),end:Math.round(t),id:this._longTaskId++}};e.prototype._incompleteRequestStarts=function(){return Object(r.__spreadArray)([],Array.from(this._incompleteJSInitiatedRequestStartTimes.values()),!0)};e.prototype._checkTTI=function(){u("Checking if First Consistently Interactive was reached...");var e=performance.timing.navigationStart,t=f(this._incompleteRequestStarts(),this._networkRequests),n=(window.chrome&&window.chrome.loadTimes?1e3*window.chrome.loadTimes().firstPaintTime-e:0)||performance.timing.domContentLoadedEventEnd-e,r=this._getMinValue(),i=performance.now();if(null!==r){u("Parameter values:");u("NavigationStart",e);u("lastKnownNetwork2Busy",t);u("Search Start",n);u("Min Value",r);u("Last busy",t);u("Current time",i);u("Long tasks",this._longTasks);u("Incomplete JS Request Start Times",this._incompleteRequestStarts());u("Network requests",this._networkRequests);var s=(function(e,t,n,r,i,s,o,u){if(s&&r-n<u)return null;var a=0===i.length?e:i[i.length-1].end;if(r-a<o)return null;if(a&&i.length>0){var f=i[i.length-1].endMarkName;f&&performance.measure("TTI",void 0,f)}return Math.max(a,t)})(n,r,t,i,this._longTasks,this._trackNetworkRequests,this._requiredMainThreadQuietnessDurationInMilliseconds,this._requiredNetworkQuietnessDurationInMilliseconds);if(s&&this._firstConsistentlyInteractiveResolver){u("maybeFCI",s);this._firstConsistentlyInteractiveResolver({tti:s,longTasks:this._longTasks});this._disable()}else{u("Could not detect First Consistently Interactive. Retrying in 1 second.");this._rescheduleTimer(performance.now()+1e3)}}else{u("No usable minimum value yet. Postponing check.");this._rescheduleTimer(Math.max(this._trackNetworkRequests?t+this._requiredNetworkQuietnessDurationInMilliseconds:0,i+1e3))}};return e})()},1801:function(e,t,n){"use strict";n.r(t);n.d(t,"EngagementHelper",function(){return u});n.d(t,"mergeEngagementData",function(){return a});n.d(t,"EngagementPartType",function(){return i.r});n.d(t,"EngagementPart",function(){return i.n});n.d(t,"EngagementBuilder",function(){return i.t});n.d(t,"ENGAGEMENT_ROOT",function(){return i.e});n.d(t,"clickEngagementPart",function(){return f.e});n.d(t,"keyPressEngagementPart",function(){return f.n});n.d(t,"dropEngagementPart",function(){return f.t});n.d(t,"getMostSpecificMatchingContext",function(){return l});var r=n(0),i=n(586),s=n(127),o=n(198),u=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=n.handlers,o=void 0===i?[]:i,u=n.logData,a=void 0===u?function(e){return s.e.logData(e)}:u;r._handlers=o;r._logData=a;return r}t.prototype.logData=function(e){void 0===e&&(e={});if(this.contexts.length||e.name){for(var t=this.contexts.map(function(e,t){return{context:e,order:t}}).sort(function(e,t){return e.context.part.type-t.context.part.type||e.order-t.order}).map(function(e){return e.context}),n=e.name,i=void 0===n?t.map(function(e){return e.part.name}).join("."):n,s=e.isIntentional,o=void 0!==s&&s,u=e.extraData,f=void 0===u?{}:u,l=Object(r.__rest)(f,[]),c=Object(r.__rest)(e,["name","isIntentional","extraData"]),h=Object(r.__assign)({name:i,isIntentional:o,extraData:l},c),p=0,d=t;p<d.length;p++){var v=d[p],m=v.part,g=v.extraData,y=void 0===g?{}:g,b={};for(var w in y)b["".concat(m.name,"_").concat(w)]=y[w];a(h,{extraData:b});a(h,v.part.getEngagementData(v)||{})}for(var E=0,S=this._handlers;E<S.length;E++){var x=S[E],T=x.getEngagementData.apply(x,t);T&&a(h,T)}this._logData(h)}};t.prototype.clone=function(e){return new t({},{engagementSource:{contexts:e},handlers:this._handlers,logData:this._logData})};return t})(i.t);function a(e,t){var n=t.extraData,i=void 0===n?{}:n,s=t.experiment;(function e(t,n){for(var r in n){var i=n[r];if("object"==typeof i&&i){var s="object"==typeof t[r]&&t[r]||{};t[r]=s;e(s,i)}else void 0!==i&&(t[r]=i)}})(e,Object(r.__rest)(t,["extraData","experiment"]));Object(o.e)(e.extraData,i);void 0!==s&&(e.experiment=s)}var f=n(3668);function l(e,t){for(var n=t.length-1;n>=0;n--){var r=t[n];if(e.matches(r))return r}}},1869:function(e,t,n){"use strict";n.r(t);n.d(t,"getFirstCPUIdle",function(){return o});function r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i()&&console.log.apply(console,e)}function i(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableFCILogging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1}var s=(function(){function e(e){this._longTaskId=0;this._checkFCIRunId=0;this._isDisposed=!1;var t=e.requiredMainThreadCPUIdleDurationInMilliseconds,n=e.measurementStartTime;this._measurementStartTime=n;this._requiredMainThreadCPUIdleDurationInMilliseconds=t;this._resultResolver={resolve:void 0,reject:void 0};this._fciPromise=void 0;this._longTasks=[];this._processLongTaskPreQueue();this._registerLongTaskObserver()}e.prototype.measureFCI=function(){var e=this;if(this._isDisposed)throw"FCIMeasurer is disposed.";this._fciPromise||(this._fciPromise=new Promise(function(t,n){e._resultResolver.resolve=t;e._resultResolver.reject=n}));this._tryScheduleNextCheck();return this._fciPromise};e.prototype._tryScheduleNextCheck=function(){var e=this;this._checkFCIRunId&&clearTimeout(this._checkFCIRunId);var t=this._findEarlestPossibleCheckTime(),n=performance.now(),r=Math.max(0,t-n);this._checkFCIRunId=setTimeout(function(){e._checkFCI()},r)};e.prototype._findEarlestPossibleCheckTime=function(){var e=this._getLatestLongTask(),t=e&&e.end||-1/0;return Math.max(t+this._requiredMainThreadCPUIdleDurationInMilliseconds,this._measurementStartTime+this._requiredMainThreadCPUIdleDurationInMilliseconds,performance.now())};e.prototype._checkFCI=function(){var e,t=performance.now(),n=this._longTasks?this._longTasks.length:0;r("Running checkFCI:");r("Measurement start time",this._measurementStartTime);r("Current time",t);r("Long tasks",this._longTasks);r("latestLongTaskEndTime",null===(e=this._longTasks[n-1])||void 0===e?void 0:e.end);if(!this._measurementStartTime||this._measurementStartTime<0)this._onFoundFCI(NaN);else if(0!==n){for(var i=this._longTasks[0],s=1;s<n;s++){var o=this._longTasks[s],u=Math.max(i.end,this._measurementStartTime);if(o.start>=this._measurementStartTime&&o.start-u>=this._requiredMainThreadCPUIdleDurationInMilliseconds){this._onFoundFCI(u,i.endMarkName);return}i=o}if(t-i.end>=this._requiredMainThreadCPUIdleDurationInMilliseconds){var a=i.end>this._measurementStartTime?i.endMarkName:void 0;this._onFoundFCI(Math.max(i.end,this._measurementStartTime),a)}}else t-this._measurementStartTime>=this._requiredMainThreadCPUIdleDurationInMilliseconds&&this._onFoundFCI(this._measurementStartTime)};e.prototype._onFoundFCI=function(e,t){t&&performance.measure("FCI",void 0,t);r("possibleFCI:",e);this._resultResolver.resolve&&this._resultResolver.resolve({fci:e,longTasks:this._longTasks});this._dispose()};e.prototype._dispose=function(){clearTimeout(this._checkFCIRunId);this._longTaskObserver.disconnect();this._isDisposed=!0};e.prototype._getLatestLongTask=function(){for(var e=void 0,t=0,n=this._longTasks;t<n.length;t++){var r=n[t];(!e||r.end>e.end)&&(e=r)}return e};e.prototype._processLongTaskPreQueue=function(){if(window.__fci){var e=window.__fci.o,t=window.__fci.e;if(e){for(var n=0,r=t;n<r.length;n++){var i=r[n];if("longtask"===i.entryType){var s=this._createLongTask(i);this._longTasks.push(s)}}e.disconnect()}}};e.prototype._registerLongTaskObserver=function(){var e=this;this._longTaskObserver=new PerformanceObserver(function(t){for(var n=0,r=t.getEntries();n<r.length;n++){var i=r[n];"longtask"===i.entryType&&e._longTaskFinishedCallback(i)}});this._longTaskObserver.observe({entryTypes:["longtask"]})};e.prototype._createLongTask=function(e){var t=e.startTime+e.duration;return{attribution:e.attribution,name:e.name,start:Math.round(e.startTime),end:Math.round(t),id:this._longTaskId++}};e.prototype._longTaskFinishedCallback=function(e){r("Long task finished: ",e);var t,n=this._createLongTask(e),i="longTaskEnd".concat(n.id);t=i,window.performance&&performance.mark&&performance.mark(t);n.endMarkName=i;this._longTasks.push(n);this._tryScheduleNextCheck()};return e})();function o(e){if("PerformanceLongTaskTiming"in window){return new s(e).measureFCI()}return Promise.resolve(null)}},1959:function(e,t,n){"use strict";n.d(t,"e",function(){return p});var r=n(0),i=n(1065),s=n(18),o=n(2145),u=n("knockout-lib");var a={init:function(e,t,n,r,i){u.applyBindingsToNode(e,{attr:{"data-automationType":t()}},i);if(i){var s=i.$component;if(s){var o=u.utils.unwrapObservable(t());if(o){var a=s.__automationTypeBinding$elements;a||(a=s.__automationTypeBinding$elements={});var f=a[o];f||(f=a[o]=[]);f.push(e);u.utils.domNodeDisposal.addDisposeCallback(e,function(){var t=f.indexOf(e);if(-1!==t){delete f[t];f.splice(t,1)}})}}}}},f=n(1961),l=n(28),c=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=n.element.getAttribute("class");n.element.setAttribute("class",n._expandIconClassNames(r));return n}t.prototype._expandIconClassNames=function(e){var t={};if(e&&e.indexOf("ms-Icon--")>=0){for(var n=e.split(" "),r=[],i=0,s=n;i<s.length;i++){var o=s[i];this._lastClassesAdded&&this._lastClassesAdded[o]||r.push(o);if(0===o.indexOf("ms-Icon--")){var u=o.substring(9),a=Object(l.L)(u);if(a&&-1===n.indexOf(a)){t[a]=!0;r.push(a)}}}this._lastClassesAdded=t;return r.join(" ")}return e};t.after=["css","class"];return t})(f.e),h=n(198),p=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.bindingHandlers={};r.automationId=t&&t.automationId||void 0;r.addBindingHandlers({automation:o.e,automationType:a,icon:c});return r}t.prototype.getAutomationElement=function(e){return Object(o.t)(this,e)};t.prototype.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Object(s.format)(e,t)};t.prototype.addBindingHandlers=function(e){Object(h.e)(this.bindingHandlers,e)};return t})(i.default);t.t=p},1960:function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=n("knockout-lib"),i=n(1190);function s(e){var t=e.tagName,n=e.template,i=e.viewModel,s=e.synchronous,o=void 0!==s&&s;r.components.register(t,{viewModel:i,template:n,synchronous:o});return e}function o(e,t){var n=document.createElement("script");n.setAttribute("type","text/html");n.id=e;i.e.setText(n,t);document.head.appendChild(n)}},1961:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(1065),s=n("knockout-lib"),o=n(2180),u=n(8),a=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.element=t.element;r.valueAccessor=t.valueAccessor;r.allBindingsAccessor=t.allBindingsAccessor;r.bindingContext=t.bindingContext;r.controlsDescendantBindings=!1;return r}t.init=function(e,t,n,r,i){var a=new u.n(o.e(i)),f=new(this.supportsDependencies?a.resolved(this):a.injected(this))({element:e,allBindingsAccessor:n,valueAccessor:t,bindingContext:i});s.utils.domNodeDisposal.addDisposeCallback(e,function(){return f.dispose()});return{controlsDescendantBindings:f.controlsDescendantBindings}};t.dependencies=Object(r.__assign)({},i.default.dependencies);t.supportsVirtualElements=!1;t.supportsDependencies=!1;return t})(i.default);t.t=a},2091:function(e,t,n){"use strict";var r=n(319),i=(function(){function e(){}e.prototype.debounce=function(e){var t=this;this.clear();this._originalPromise=e;var n=new r.e(function(){return t._originalPromise.cancel()});this._originalPromise.done(function(e){t._clear(!1);n.complete(e)},function(e){t._clear(!1);n.error(e)});return n.getPromise()};e.prototype.clear=function(){this._clear(!0)};e.prototype.isExecuting=function(){return Boolean(this._originalPromise)};e.prototype._clear=function(e){if(this.isExecuting()){e&&this._originalPromise.cancel();this._originalPromise=null}};return e})();t.e=i},2094:function(e,t,n){"use strict";var r;(function(e){e[e.none=0]="none";e[e.htmlFileUpload=1]="htmlFileUpload";e[e.folderUpload=2]="folderUpload";e[e.downlevelUpload=3]="downlevelUpload";e[e.silverlightUpload=4]="silverlightUpload"})(r||(r={}));t.e=r},2119:function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return i});var r="Click";function i(e){return e.charAt(0).toUpperCase()+e.slice(1)}},2145:function(e,t,n){"use strict";n.d(t,"t",function(){return i});var r=n("knockout-lib");function i(e,t){var n=e.__automationBinding$elements;return n&&n[t]}t.e={init:function(e,t,n,i,s){r.applyBindingsToNode(e,{attr:{"data-automationId":t()}},s);if(s){var o=s.$component;if(o){var u=r.utils.unwrapObservable(t());if(u){var a=o.__automationBinding$elements;a||(a=o.__automationBinding$elements={});a[u]=e;r.utils.domNodeDisposal.addDisposeCallback(e,function(){a[u]&&delete a[u]})}}}}}},2180:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n("knockout-lib");"boolean"==typeof i.options.preferJQueryEvents?i.options.preferJQueryEvents=!1:"boolean"==typeof i.options.useOnlyNativeEvents&&(i.options.useOnlyNativeEvents=!0);var s=n(8),o=n(610),u=n(4040);function a(e){var t,n;if(e&&e.$data&&e.$data.resources)return e.$data.resources;for(;(!(n=e.$data)||"object"!=typeof n||!(t=n.resources))&&e.$parentContext;)e=e.$parentContext;return t}var f={loadViewModel:function(e,t,n){n(function(n,f){void 0===n&&(n={});var l,c=i.contextFor(f.element),h=i.utils.unwrapObservable(n.resources)||a(c),p={owner:e,useFactoriesOnKeys:!0},d=h?new s.n(h,p):new s.n(p);n=Object(r.__assign)(Object(r.__assign)({},n),{resources:d});l=(function(e){return"function"==typeof e.createViewModel})(t)?t.createViewModel(n,f):new(d.injected(t))(n);var v=new u.e({name:e,viewModel:l,element:f.element,bindingContext:c});return Object(o.e)(l,function(){v.dispose();d.dispose()})})}};i.components.loaders.unshift(f)},2239:function(e,t,n){"use strict";var r,i=n(220),s={ODB:563,ODC:null,Fallback:!1};(function(e){e.isShortcutItem=function(e){return!(!e||!e.extension)&&t("."!==e.extension[0]?e.extension:e.extension.slice(1))};function t(e){return"url"===e||"website"===e}e.isShortcutFileType=t;e.isShortcutEnabled=function(){return i.e.isFeatureEnabled(s)};(function(e){e[e.UnknownError=0]="UnknownError";e[e.NewFileCreationFileAlreadyExistsError=1]="NewFileCreationFileAlreadyExistsError";e[e.InvalidCharacterError=2]="InvalidCharacterError"})(e.ShortcutErrors||(e.ShortcutErrors={}))})(r||(r={}));t.e=r},2262:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(91),i=n(324),s="formFactorChange",o="hamburgerVisibilityChange",u="showCommandLabelsChange",a={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},f={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0},l=(function(){function e(e,t){this._scope=new i.e;this._events=new(this._scope.attached(r.t))(this);this._events.on(window,"resize, orientationchange",this._onContainerResize.bind(this));var n=t.breakpoints;this._breakpoints="function"==typeof n?n:function(){return n};this._windowWidth=0;this._windowHeight=0;this._onContainerResize()}e.reduceBreakpoints=function(e,t){return{Small:t,Medium:e.Small,Large:e.Medium,XLarge:e.Large,XXLarge:e.XLarge,XXXLarge:e.XXLarge,XXXXLarge:1/0}};e.determineWindowSize=function(e,t){void 0===t&&(t=f);if(0===e)return"Medium";for(var n in f)if(e<t[n])return n};e.determineCssClass=function(e){return a[e]};e.getScrollbarWidth=function(){var e=document.createElement("div"),t=document.createElement("div"),n=e.style;n.visibility="hidden";n.width="100px";n.msOverflowStyle="scrollbar";n.overflow="scroll";t.style.width="100%";document.body.appendChild(e);e.appendChild(t);var r=e.offsetWidth,i=t.offsetWidth;e.parentNode.removeChild(e);var s=r-i;this.getScrollbarWidth=function(){return s};return s};Object.defineProperty(e.prototype,"windowWidth",{get:function(){return this._windowWidth},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"windowHeight",{get:function(){return this._windowHeight},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"formFactorSize",{get:function(){return this._formFactorSize},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"isHamburgerVisible",{get:function(){return this._isHamburgerVisible},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"showLabels",{get:function(){return this._showLabels},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"cssClass",{get:function(){return this._cssClass},enumerable:!1,configurable:!0});e.prototype.dispose=function(){this._scope.dispose()};e.prototype.compareSize=function(e,t){var n=this._breakpoints();return n[e]-n[t]};e.prototype._afterContainerResize=function(){};e.prototype._onContainerResize=function(){var t=document.body,n=document.documentElement,r=this._windowHeight=n.clientWidth||t.clientWidth;this._windowWidth=n.clientHeight||t.clientHeight;var i=this._formFactorSize,a=this._formFactorSize=e.determineWindowSize(r,this._breakpoints());this._cssClass=e.determineCssClass(a);var l=this._isHamburgerVisible;this._isHamburgerVisible=r<f.Large;var c=this._showLabels;this._showLabels=this.compareSize(a,"Medium")>0;i&&a!==i&&this._events.raise(s);"boolean"==typeof l&&l!==this._isHamburgerVisible&&this._events.raise(o);"boolean"==typeof c&&c!==this._showLabels&&this._events.raise(u);this._afterContainerResize()};e.DEFAULT_BREAKPOINTS=f;e.MAC_SCROLL_BAR_WIDTH=8;return e})();t.t=l},2307:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=function(){try{return!!window.sessionStorage.getItem("_isRunningTABTest")}catch(e){console.log("No session storage accessible: "+e);return!1}}},2317:function(e,t,n){"use strict";n.d(t,"e",function(){return y});var r=n(0),i=n("react-lib"),s=n(1090),o=n(3969),u=(function(e){Object(r.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.onClick=function(e){t.props.inputProps&&t.props.inputProps.onClick&&t.props.inputProps.onClick(e);0!==e.button||e&&e.target&&e.target.value||t.onEmptyInputFocus()};t.onInputFocus=function(e){};return t}return t})(o.e),a=n(23),f=n(4374),l=n(1660),c=n(3645),h=n(2442),p=n(3225),d=n(760),v=a.t.isActivated("41868B4D-8044-4ACF-8E89-CFD71EF69C3D","10/31/2021","fix people picker suggestion dup"),m=u,g=o.t,y=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onResolveSuggestions=function(e){if(n._peoplePickerSearchPromise){n._peoplePickerSearchPromise.cancel();n._peoplePickerSearchPromise=void 0}if(!(e=e.trim())&&!n._canCallGraph)return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions([],e):[];var t=n._getPeoplePickerQueryParams(),r=null==t?void 0:t.conversationId;t&&t.conversationId&&delete t.conversationId;var i="peoplePickerSearch_".concat(e.trim(),"_").concat(JSON.stringify(t));t&&r&&(t.conversationId=r);var s=function(){var r=n._dataProvider.search(e.trim(),t);if(!r)return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions([],e):[];var i=r.cached?r.cached:[];n._peoplePickerSearchPromise=r.promise;return n._peoplePickerSearchPromise.then(function(e){n._peoplePickerSearchPromise=void 0;return e?i.concat(e):[]}).then(function(t){var r=v?t:n._dedupeSuggestions(t);return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions(r,e):r})};if(!n.props.peoplePickerImprovementsExperiment||!n.props.persistCachePeopleSearch)return s();try{return n.props.persistCachePeopleSearch({getData:s,key:i})}catch(e){return s()}};n._onGetMoreResults=function(e){n._onGetMoreResultsClicked&&n._onGetMoreResultsClicked();var t;if(n.props.peoplePickerQueryParams){(t=Object(r.__assign)({},n.props.peoplePickerQueryParams)).useGraph=!1;t.useSubstrate=!1}return n._dataProvider&&n._dataProvider.sharePointSearch&&t?n._dataProvider.sharePointSearch(e,t).then(function(t){if(n.props.onResolvedSuggestions){var r=n.props.onResolvedSuggestions(t,e);if(r instanceof Array)return r}return t}):[]};if(t.dataProvider)n._dataProvider=t.dataProvider;else{if(!t.context)throw new Error("No pageContext available for PeoplePickerProvider.");n._dataProvider=new f.e({pageContext:t.context,peoplePickerDataSource:t.dataSource})}n._canCallGraph=!!(n._dataProvider.canUseGraph&&n.props.peoplePickerQueryParams&&n._dataProvider.canUseGraph(n.props.peoplePickerQueryParams));n._handleGetMoreResultsInBaseClass=n._canCallGraph&&!n.props.onGetMoreResults;n.state={hasUnresolvedText:!1,searchForMoreText:n._getSearchForMoreText(n._handleGetMoreResultsInBaseClass)};return n}Object.defineProperty(t.prototype,"selectedPeople",{get:function(){return this._peoplePicker&&this._peoplePicker.items||[]},enumerable:!1,configurable:!0});t.prototype.render=function(){var e=this,t=this.props,n=t.className,s=t.onRenderItem,o=t.onRenderSuggestionsItem,u=t.defaultSelectedItems,a=t.onSelectedPersonasChange,f=t.suggestionsHeaderText,l=t.suggestionsClassName,d=t.noResultsFoundText,v=t.loadingText,y=t.inputProps,b=t.onSuggestionSelected,w=t.suggestionsAvailableAlertText,E=t.enableSelectedSuggestionAlert,S=t.selectedItems,x=t.itemLimit,T=t.onInputChange,N=t.onGetMoreResults,C=t.searchForMoreIcon,k=t.searchForMoreText,L=t.ariaLabel,A=void 0===L?"":L,O=t.pickerCalloutProps,M=t.pickerOverrideStyles,_=t.theme,D=t.disabled,P=t.onGetMoreResultsClicked,H=t.removeButtonAriaLabel,B=t.onEmptyResolveSuggestions,j=t.showDefaultSuggestion;this._onGetMoreResultsClicked=P;var F={className:n,onRenderSuggestionsItem:o||c.r,onResolveSuggestions:this._onResolveSuggestions,defaultSelectedItems:u,selectedItems:S,onChange:a,inputProps:y,enableSelectedSuggestionAlert:E,pickerSuggestionsProps:{suggestionsHeaderText:f,loadingText:v,noResultsFoundText:d,className:l,suggestionsAvailableAlertText:w,searchForMoreIcon:C,searchForMoreText:k||(this._handleGetMoreResultsInBaseClass?this.state.searchForMoreText:void 0),suggestionsContainerAriaLabel:p.t},onItemSelected:b,itemLimit:x,onInputChange:T,onGetMoreResults:N||(this._handleGetMoreResultsInBaseClass?this._onGetMoreResults:void 0),pickerCalloutProps:O,styles:M,theme:_,"aria-label":A,disabled:D,removeButtonAriaLabel:H,onEmptyResolveSuggestions:j&&this._canCallGraph?function(){return e._onResolveSuggestions("")}:B};switch(this.props.peoplePickerType){case h.e.listBelow:F.onRenderItem=s||c.e;return i.createElement(g,Object(r.__assign)({},F,{componentRef:this._resolveRef("_peoplePicker")}));default:F.onRenderItem=s||c.t;return i.createElement(m,Object(r.__assign)({},F,{componentRef:this._resolveRef("_peoplePicker")}))}};t.prototype.focusInput=function(){this._peoplePicker&&this._peoplePicker.focusInput()};t.prototype._getPeoplePickerQueryParams=function(){if(this.props.peoplePickerQueryParams){!this.props.peoplePickerQueryParams.onToggleGetMoreResults&&this._handleGetMoreResultsInBaseClass&&(this.props.peoplePickerQueryParams.onToggleGetMoreResults=this._onToggleGetMoreResults);return this.props.peoplePickerQueryParams}return{allowEmailAddresses:!1,groupID:0,maximumEntitySuggestions:30,principalSource:15,blockExternalUsers:!0,principalType:l.e.user|l.e.securityGroup|l.e.sharePointGroup}};t.prototype._dedupeSuggestions=function(e){var t=this,n=[],i=this._peoplePicker&&this._peoplePicker.items||[];i=Object(r.__spreadArray)([],i,!0);for(var s=function(e){var r=o._getItemKey(e);if(!i.some(function(e){var n=t._getItemKey(e);return r===n})){n.push(e);i.push(e)}},o=this,u=0,a=e;u<a.length;u++){s(a[u])}return n};t.prototype._getItemKey=function(e){return e.email||e.userId||Object(d.e)(JSON.stringify(e)).toString()};t.prototype._onToggleGetMoreResults=function(e){this.state&&(e&&!this.state.searchForMoreText||!e&&this.state.searchForMoreText)&&this.setState({searchForMoreText:this._getSearchForMoreText(e)})};t.prototype._getSearchForMoreText=function(e){return e?p.r:void 0};return t})(s.e)},2323:function(e,t,n){"use strict";var r=n(956);n.d(t,"e",function(){return r.e});n.d(t,"t",function(){return r.t});n.d(t,"n",function(){return r.r})},2349:function(e,t,n){"use strict";var r=(function(){function e(t){var n;this._raw=t;if(t){t=(t=t.replace(/\u200e|\u200f/g,"")).trim();for(var r,i,s=new RegExp(e.EmailRegexPattern,"gi"),o=e.EmailMatchTypes.None,u=e.EmailMatchTypes.None;null!==(i=s.exec(t));){var a=i[0],f=a.charAt(0),l=a.charAt(a.length-1);if((u="<"===f&&">"===l?e.EmailMatchTypes.Bracketed:'"'===f&&'"'===l?e.EmailMatchTypes.Quoted:e.EmailMatchTypes.Bare)>o){r=i;o=u;if(u===e.EmailMatchTypes.Bracketed)break}}var c=t;if(r){n=r[0];var h=r.index,p=h+n.length,d=h>0?t.substr(0,h).trim():"",v=p<t.length?t.substr(p):"";if("'"===(n=e.StripBracketsAndQuotesRegex.exec(n)[1]).charAt(0)&&v&&"'"===v.charAt(0)){n=n.slice(1);v=v.slice(1).trim()}c=""===d?v:d;this._email=n.trim()}(c=c.replace(/^\s*"\s*/,"").trim()).length>1&&"/"!==c.charAt(c.length-2)&&(c=c.replace(/\s*"$/,""));""!==(c=c.replace(/\//g,""))&&c!==n&&(this._name=c)}}e.isValidEmailSyntax=function(t,n){return!!t&&!!(n?e.ValidEmailRegex:e.EmailRegex).exec(t.trim())};e.parse=function(t){if(!t)return[];for(var n=e._splitAddresses(t),r=[],i=0,s=n.length;i<s;i++)r.push(new e(n[i]));return r};e.endsWithDelimiter=function(t){if(t){var n=t.split(e.DelimiterRegex);return!n[n.length-1].trim()}return!1};e._splitAddresses=function(t){for(var n=t.split(e.DelimiterRegex),r=n.length-1;r>=0;r--){n[r]=n[r].trim();0===n[r].length&&n.splice(r,1)}return n};e.prototype.getEmail=function(){return this._email};e.prototype.getName=function(){return this._name};e.prototype.getRaw=function(){return this._raw};e.EmailRegexPattern="(?:[<\"]\\s*)?[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?\\.)+[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?(?:\\s*[>\"])?";e.EmailRegex=new RegExp(e.EmailRegexPattern,"i");e.ValidEmailRegexPattern="[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@((?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)";e.ValidEmailRegex=new RegExp(e.ValidEmailRegexPattern,"i");e.StripBracketsAndQuotesRegex=/^[<"]?([^<>"]*)[>"]?$/;e.DelimiterRegex=/[,;](?=(?:[^"]*"[^"]*")*(?![^"]*"))/;e.EmailMatchTypes={None:0,Quoted:1,Bare:2,Bracketed:3};return e})();t.e=r},2405:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r;(function(e){e[e.none=0]="none";e[e.right=1]="right";e[e.flip=2]="flip";e[e.left=3]="left"})(r||(r={}));var i=r},2442:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.normal=0]="normal";e[e.listBelow=1]="listBelow"})(r||(r={}))},2474:function(e,t,n){"use strict";var r=n(59),i=n(319),s=(function(){function e(e){this.concurrency=e||1;this._running=0;this._queue=[];this._promiseComplete=this._promiseComplete.bind(this)}e.prototype.enqueue=function(e){var t;if(this._running<this.concurrency){this._running++;(t=e()).then(this._promiseComplete,this._promiseComplete)}else{var n={callback:e,signal:null,canceled:!1,result:null};n.signal=new i.e(function(){n.canceled=!0;r.n.is(n.result)&&n.result.cancel()});this._queue.push(n);t=n.signal.getPromise()}return r.n.resolve(t)};e.prototype._promiseComplete=function(){var e=this;this._running--;if(this._running<this.concurrency&&this._queue.length){for(var t=this._queue.shift();t&&t.canceled;)t=this._queue.length?this._queue.shift():null;if(t){this._running++;t.result=t.callback();t.result.then(function(n){t.signal.complete(n);e._promiseComplete()},function(n){t.signal.error(n);e._promiseComplete()})}}};return e})();t.e=s},2536:function(e,t,n){"use strict";var r=n("knockout-lib"),i=(function(){function e(){this._originalProvider=new r.bindingProvider;this._bindingHandlers={};this._bindingContexts=[]}e.getInstance=function(){return e._instance};e.prototype.nodeHasBindings=function(e){return this._originalProvider.nodeHasBindings(e)};e.prototype.getBindings=function(e,t){try{this._bindingContexts.push(t);var n=this._originalProvider.getBindings(e,t);return n&&this._remapKeys(n,t)}finally{this._bindingContexts.pop()}};e.prototype.getBindingAccessors=function(e,t){try{this._bindingContexts.push(t);var n=this._originalProvider.getBindingAccessors(e,t);return n&&this._remapKeys(n,t)}finally{this._bindingContexts.pop()}};e.prototype.getBindingHandler=function(e){var t=this._bindingContexts.slice(-1)[0];if(t){var n=this._getLocalBindingHandlers(t);if(n){var i=n[e];e=i&&this.getUniqueKeyForBindingHandler(i,e)||e}}return this._bindingHandlers[e]||r.bindingHandlers[e]};e.prototype.getUniqueKeyForBindingHandler=function(t,n){var i=e._BINDING_PROVIDER_UNIQUE_KEY,s=t[i]=t[i]||n+"-local-"+ ++e._lastUniqueKeyOrdinal;this._bindingHandlers[s]={init:t.init&&t.init.bind(t),update:t.update&&t.update.bind(t),options:t.options,preprocess:t.preprocess&&t.preprocess.bind(t)};this._bindingHandlers[s].after=t.after;t.supportsVirtualElements&&(r.virtualElements.allowedBindings[s]=!0);return s};e.prototype._remapKeys=function(e,t){var n=e,r=this._getLocalBindingHandlers(t);if(r){n={};for(var i in e){var s=r[i];n[s&&this.getUniqueKeyForBindingHandler(s,i)||i]=e[i]}}return n};e.prototype._getLocalBindingHandlers=function(e){for(var t;!(t="object"==typeof e.$data&&e.$data.bindingHandlers)&&e.$parentContext;)e=e.$parentContext;return t};e._instance=new e;e._BINDING_PROVIDER_UNIQUE_KEY="__localBindingProvider__uniqueKey";e._lastUniqueKeyOrdinal=0;return e})(),s=i.getInstance();r.getBindingHandler=s.getBindingHandler.bind(s);r.bindingProvider.instance=s},2681:function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"n",function(){return i});n.d(t,"t",function(){return s});var r,i,s,o;(function(e){e[e.None=0]="None";e[e.InSync=1]="InSync";e[e.ChangesSaved=2]="ChangesSaved";e[e.Syncing=3]="Syncing";e[e.Attention=4]="Attention";e[e.SyncConflict=5]="SyncConflict";e[e.SettingUp=6]="SettingUp";e[e.Unsupported=7]="Unsupported";e[e.Removed=8]="Removed";e[e.Error=9]="Error";e[e.ListStatusConnectionLost=10]="ListStatusConnectionLost";e[e.ListStatusConnected=11]="ListStatusConnected"})(r||(r={}));(function(e){e[e.UnknownError=0]="UnknownError"})(i||(i={}));(function(e){e[e.SetupRequired=0]="SetupRequired";e[e.SignInRequired=1]="SignInRequired"})(s||(s={}));(function(e){e.Create="Create";e.Update="Update";e.Delete="Delete"})(o||(o={}))},2689:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e.fromHexString=function(e,t){var n=t?{High:2147483647,Low:2147483647}:{High:0,Low:0},r=e&&e.match(/^(0x)?([0-9a-f]*)$/i);if(r){var i=void 0,s=void 0;if((e=(e=r[2]||"0").slice(-16)).length<=8){i=0;s=parseInt(e,16)}else{i=parseInt(e.slice(0,-8),16);s=parseInt(e.slice(-8),16)}if(!isNaN(i)&&!isNaN(s)){n.High=i;n.Low=s}}return n};e.or=function(e){return(e||[]).reduce(function(e,t){return{High:e.High|t.High,Low:e.Low|t.Low}},{High:0,Low:0})};e.and=function(e){return e&&e.length?e.reduce(function(e,t){return{High:e.High&t.High,Low:e.Low&t.Low}}):{High:0,Low:0}}})(r||(r={}));t.t=r},2902:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=(function(){function e(){}e.startExitingQuickEditEventName="startExitingQuickEdit";e.quickEditWriteChangesToListEventName="quickEditWriteChangesToList";e.deleteCompletedEventName="quickEditDeleteCompleted";e.switchGridLayout="switchGridLayout";e.undoChangeEventName="quickEditUndoChange";e.redoChangeEventName="quickEditRedoChange";e.undoRealCmdCountChangeEventName="quickEditUndoRealCmdCountChange";e.redoRealCmdCountChangeEventName="quickEditRedoRealCmdCountChange";e.gridGlobalsInitialized="gridGlobalsInitialized";return e})();t.t=r},2908:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.succeed=0]="succeed";e[e.unsupport=1]="unsupport";e[e.failed=2]="failed"})(r||(r={}))},3006:function(e,t,n){"use strict";n.d(t,"r",function(){return c});n.d(t,"n",function(){return h});n.d(t,"e",function(){return r});n.d(t,"t",function(){return p});var r,i=n(220),s=n(23),o=n(580),u=n(2504),a=n(28),f=n("react-lib"),l={ODB:60596};function c(){return!s.e.isActivated("E453BAFB-1A08-4222-89F4-568CF37CA2B8","11/02/2021","Placeholder sharing")&&i.e.isFeatureEnabled(l)}function h(e){var t,n;return c()&&!(!e.invitationId&&!(null===(n=null===(t=e.rawData||e.rawPersonData)||void 0===t?void 0:t.EntityData)||void 0===n?void 0:n.invitation))}(function(e){e[e.standalone=0]="standalone";e[e.pill=1]="pill"})(r||(r={}));function p(e,t){void 0===t&&(t={});var n=Object(a._)(),i=t.fontSize;return{coinProps:{styles:{initials:e===r.standalone?{border:"1px dashed ".concat(n.palette.themePrimary),boxSizing:"border-box",fontSize:null!=i?i:"16px",fontWeight:"normal",color:n.palette.themePrimary}:{border:"none",boxSizing:"border-box",fontSize:null!=i?i:"12px",color:n.palette.themePrimary,paddingLeft:"4px",paddingRight:"4px"}}},initialsColor:u.e.transparent,onRenderInitials:function(){return f.createElement(o.e,{iconName:"Contact",style:{fontWeight:"normal"}})}}}},3009:function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});var r=["htm","html","svg"],i=["eml","msg","md","mdown","markdown"];function s(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0}function o(e){return s(i,e)}function u(e){return s(r,e)}},3110:function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});var r=n(80),i=n(40),s=!1,o=!1;function u(){if(!o){o=!0;(function(){if(s||!o)return;s=!0;new r.e({name:"ItemAnalytics.PageFinishedLoading",startTimeOverride:window._itemAnalyticsStartTime}).end({resultType:i.e.Success});try{window.external.PageFinishedLoading()}catch(e){window.parent.postMessage(JSON.stringify({name:"item_analytics_ready"}),"*")}})()}}function a(e){try{window.external.PageError(e,e.message)}catch(n){var t={name:"item_analytics_error",error:e,errorMessage:e.message};window.parent.postMessage(JSON.stringify(t),"*")}}},3234:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.default=0]="default";e[e.firstRun=1]="firstRun";e[e.progressStarted=2]="progressStarted";e[e.progressFinished=3]="progressFinished"})(r||(r={}))},3558:function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e,t,n){var r=e&&e.toLowerCase(),i=t&&t.toLowerCase(),s=n&&n.toLowerCase();return!(r!==i&&r!==s)}},3588:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(752),i=n(161),s=n(220),o=n(11);function u(e,t,n){if(e.type===i.t.OneNote)return!1;if(e.list||e.subsite)return!1;return!(!s.e.isFeatureEnabled({ODB:831,ODC:"UseDownloadMicroservice"})||n||!e.urls[r.e.downloadAsZip]||!e.urls[r.e.itemUrl]||0===e.childCount||e.type!==i.t.Folder)||!e.isRootFolder&&(!!t&&((!t||!t.list||t.list.templateType!==o.n.webPageLibrary)&&(e.type===i.t.File||e.type===i.t.Media||e.type===i.t.Unknown)))}},3645:function(e,t,n){"use strict";n.d(t,"r",function(){return x});n.d(t,"t",function(){return T});n.d(t,"e",function(){return N});n.d(t,"n",function(){return C});var r=n(0),i=n("react-lib"),s=n(2504),o=n(3996),u=n(1766),a=n(119),f=n(1769),l=n(1746),c=n(580),h=n(37),p=n(18),d=n(3225),v=n(220),m=n(865),g=n(23),y=n(3006),b=v.e.isFeatureEnabled({ODC:"ToolTipEmailKillSwitch"})||g.e.isActivated("2f7a87f9150a4ef3b35a1ad82e402730","08/28/2021","ToolTipEmailKillSwitchActivated"),w={details:{paddingLeft:4,paddingRight:0}},E={icon:{fontSize:12,marginLeft:0,marginRight:0}};function S(e,t,n){var r="3rem";if(t)switch(t){case s.n.size24:r="1.5rem";break;case s.n.size32:r="2rem";break;case s.n.size40:r="2.5rem";break;case s.n.extraSmall:r="1.75rem";break;default:r="3rem"}var i={text:e.name?e.name:"",imageUrl:e.image?e.image:"",tertiaryText:e.email?e.email:"",secondaryText:e.job?e.job:"",imageInitials:"",imageAlt:e.imageAlt,coinProps:{styles:{coin:{width:r,height:r,maxWidth:"75px",maxHeight:"75px"},image:{width:r+"!important",height:r+"!important",maxWidth:"75px",maxHeight:"75px"},imageArea:{width:r,height:r,maxWidth:"75px",maxHeight:"75px"},initials:{width:r,height:r,fontSize:"0.625rem",lineHeight:r}}},styles:{root:{height:r},primaryText:{fontSize:"0.875rem"},secondaryText:{fontSize:"0.75rem"}}};return Object(y.n)(e)&&void 0!==n?Object(m.default)(i,Object(y.t)(n)):i}var x=function(e){var t=S(e,s.n.size40,y.e.standalone);return i.createElement("div",{className:"ms-PeoplePicker-personaContent"},i.createElement(o.e,Object(r.__assign)({},t,{presence:s.t.none,size:s.n.size40,className:"ms-PeoplePicker-pickerPersona"})),e.entityType===f.e.linkedinUser&&i.createElement(c.e,{className:"od-PeoplePicker-linkedInLogo",iconName:"LinkedInLogo"}))},T=function(e){var t,n=e.item,f=e.onRemoveItem,c=e.index,p=e.selected,d=e.removeButtonAriaLabel,v=S(n,s.n.extraSmall,y.e.pill);b||(v.onRenderPrimaryText=function(){return i.createElement(u.e,{content:n.email||v.text,directionalHint:a.e.topLeftEdge},v.text)});return i.createElement("div",{className:Object(h.e)("ms-PickerPersona-container",(t={"is-selected":!!p},t.placeholderUser_b8ea1d3d=Object(y.n)(n),t)),"data-is-focusable":!0,"data-selection-index":c,key:c,role:"listitem"},i.createElement("div",{className:Object(h.e)("ms-PickerItem-content","itemContent_b8ea1d3d")},i.createElement(o.e,Object(r.__assign)({},v,{presence:s.t.none,size:s.n.extraSmall}))),i.createElement(l.e,{onClick:f,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,ariaLabel:d,disabled:e.disabled}))},N=function(e){var t=e.item,n=e.onRemoveItem,u=e.index,a=e.selected,f=S(t,s.n.size40),c="PickerPersonaId"+Math.floor(1e4*Math.random()),v=p.format(d.n,t.name);return i.createElement("div",{className:Object(h.e)("ms-PickerPersona-container is-listbelow",{"is-selected":!!a}),"data-is-focusable":!0,"data-selection-index":u,key:u,"aria-labelledby":c,role:"listitem"},i.createElement("div",{className:"ms-PickerPersona-content"},i.createElement(o.e,Object(r.__assign)({id:c},f,{presence:s.t.none,size:s.n.size40}))),i.createElement("div",{className:"ms-PickerItem-content"},i.createElement(l.e,{onClick:n,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,ariaLabel:v})))},C=function(e){var t,n=e.item,u=e.onRemoveItem,a=e.index,f=n.email?"/_layouts/15/userphoto.aspx?accountname="+n.email:"",c={text:n.name||"",imageUrl:n.image||f,styles:{primaryText:{fontSize:"0.875rem"},secondaryText:{fontSize:"0.75rem"}}},h="PickerPersonaId"+Math.floor(1e4*Math.random()),v=p.format(d.n,n.name),g=["peoplePickerPill_b8ea1d3d"];if(Object(y.n)(n)){t=Object(m.default)(c,Object(y.t)(y.e.pill));g.push("placeholderUser_b8ea1d3d")}else t=c;return i.createElement("div",{className:g.join(" "),"data-is-focusable":!1,"data-selection-index":a,key:a,"aria-labelledby":h},i.createElement(o.e,Object(r.__assign)({id:h},t,{presence:s.t.none,size:s.n.size24,styles:w})),i.createElement(l.e,{onClick:u,iconProps:{iconName:"Cancel"},className:"peoplePickerClose_b8ea1d3d","data-is-focusable":!0,ariaLabel:v,styles:E}))}},3652:function(e,t,n){"use strict";n.d(t,"e",function(){return m});n.d(t,"t",function(){return y});var r=n("react-lib"),i=n(1950),s=n(2543),o=n(2908),u=n(580),a=n(28),f=n(2638),l=n(18),c=n(1766),h=n(119),p=n(4838),d=n(37),v=new Date("0001-01-01T00:00:00-08:00"),m=function(e){var t,n,d,m,b=e.itemAnalytics,w=e.onClick,E=e.isLink,S=e.status,x=e.isCompact,T=e.disableViewerCount,N=void 0===T||T,C=e.ODBOptOutViewerList,k=void 0!==C&&C,L=e.itemKey,A=y();if(S===o.e.failed){var O=Object(a._)();t=A.apiError&&(n="ErrorBadge",d=A.apiError,m={color:O.palette.redDark},r.createElement(r.Fragment,null,r.createElement(u.e,{iconName:n,className:"fileHoverCardErrorIcon_86ea3a8a",styles:{root:Object(a.F)([{paddingRight:"8px",position:"relative"},m])}}),d))}if(t)return null;if(!b||!b.viewCount||!b.viewerCount)return r.createElement(s.e,{className:"analyticsStats_86ea3a8a",isCompact:!0});var M=b.viewCount,_=b.viewerCount,D=b.activities,P=b.commentCount,H=b.likeCount,B=b.incompleteData&&b.incompleteData.missingDataBeforeDateTime&&new Date(b.incompleteData.missingDataBeforeDateTime).getTime()!==v.getTime(),j=b.incompleteData&&b.incompleteData.wasThrottled,F=B?f.fe:j?f.Ae:"",I=N?k?f.be:"":f.Ce,q=F||I,R=M>1?A.views:A.view,U=_>1?A.viewers:A.viewer,z=P&&P>1?A.comments:A.comment,W=H&&H>1?A.likes:A.like,X=P?"".concat(l.format(z,P)):"",V=H?"".concat(l.format(W,H)):"",$=V&&g(V,void 0),J=X&&g(X,void 0,void 0);return x?E?r.createElement("div",{className:"analyticsStatsContainer_86ea3a8a"},r.createElement(i.e,{className:"analyticsStatsLink_86ea3a8a",onClick:w},r.createElement(s.e,{activityPersonas:D&&0!==D.length?D.slice(0,3).map(function(e){return{imageUrl:e&&e.actor&&e.actor.user&&e.actor.user.image}}).reverse():void 0,activityDescription:r.createElement("div",{className:"analyticsStatsLabel_86ea3a8a"},M&&r.createElement("div",{className:"analyticsStatsCount_86ea3a8a"},"".concat(M," ").concat(R))),isCompact:!0})),V&&L?r.createElement(p.e,{likeLabel:V,itemKey:L}):$,J):r.createElement("div",{className:"analyticsStatsContainer_86ea3a8a"},g("".concat(M," ").concat(R),void 0),g("".concat(_," ").concat(U),void 0),q&&r.createElement(c.e,{content:q,directionalHint:h.e.bottomCenter},r.createElement(u.e,{className:"analyticsStatsTeachingMessage_86ea3a8a",iconName:"Info","aria-describedby":q})),$,J):r.createElement("div",{className:"analyticsStatsViews_86ea3a8a"},"".concat(_," ").concat(U),r.createElement("span",{className:"analyticsStatsViewsDivider_86ea3a8a"}),"".concat(M," ").concat(R),F&&r.createElement(c.e,{content:F,directionalHint:h.e.bottomCenter},r.createElement(u.e,{className:"analyticsStatsInfo_86ea3a8a",iconName:"Info","aria-describedby":F})))};m.defaultProps={isLink:!1};function g(e,t,n){var o=r.createElement(s.e,{activityDescription:r.createElement("div",{className:Object(d.e)("analyticsStatsLabel_86ea3a8a","analyticsStatsCount_86ea3a8a")},e),isCompact:!0});return t||n?r.createElement(i.e,{className:"analyticsStatsLink_86ea3a8a",href:"".concat(n,"#comments"),target:"_blank",onClick:t},o):r.createElement("div",{className:"analyticsStatsNoLink_86ea3a8a"},o)}function y(){return{details:f.Ne,viewer:f.Fe,viewers:f.Ie,view:f.Be,views:f.qe,comment:f.Ee,comments:f.Se,like:f.xe,likes:f.Te,apiError:f.te,suggestion:f.ke,unsupportMessage:f.He,accessActivity:f.Y,modifiedActivity:f.ye,activityTemplate:f.Z,inCompleteDataMessage:f.ae,throttledMessage:f.Le,trendingItem:f.Pe,loginUserYou:f.Re}}},3667:function(e,t,n){"use strict";n(1661);var r=n(610),i=n("knockout-lib"),s=(function(){function e(e,t){var n=this;this._source=e;this._getKey=t;this._groupsByKeyId={};this.groups=i.observableArray();this._initializeGroups();Object(r.e)(this.groups,function(){n._mapping.dispose()})}e.group=function(t,n){return new e(t,n).groups};e.prototype._initializeGroups=function(){var e=this;this._mapping=this._source.map({mappingWithDisposeCallback:function(t){var n=e._getKey(t),r=JSON.stringify(n),s=e._groupsByKeyId[r];if(s)s.values.push(t);else{s={key:n,values:i.observableArray([t])};e._groupsByKeyId[r]=s;e.groups.push(s)}return{mappedValue:r,dispose:function(){if(s.values.peek().length>1)s.values.remove(t);else{delete e._groupsByKeyId[r];e.groups.remove(s)}}}}})};return e})();t.e=s},3668:function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"n",function(){return s});n.d(t,"t",function(){return o});var r=n(586),i=new r.n("Click",4),s=new r.n("KeyPress",4),o=new r.n("Drop",4)},3680:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(0),i=n("react-lib"),s=n("react-dom-lib"),o=n(99),u=n(129),a=0,f=Object(o.e)(function(e){return"".concat(++a)});function l(){var e=i.useState(function(){return{}}),t=e[0],n=e[1],o=Object(u.e)(function(e,t){n(function(n){var i,o=f(t);return Object(r.__assign)(Object(r.__assign)({},n),((i={})[o]=s.createPortal(e,t),i))})}),a=Object(u.e)(function(e){n(function(t){var n=t,i=f(e);n[i];return Object(r.__rest)(n,["symbol"==typeof i?i:i+""])})}),l=i.useRef(),c=l.current||(l.current={render:o,unmount:a}),h=i.useMemo(function(){return i.createElement(i.Fragment,null,Object.keys(t).map(function(e){return i.createElement(i.Fragment,{key:e},t[e])}))},[t]);return i.useMemo(function(){return[c,h]},[c,h])}},3715:function(e,t,n){"use strict";var r=(function(){function e(){}e.prototype.getState=function(e){return this._getNormalizedWindowName()[e]};e.prototype.setState=function(e,t){var n=this._getNormalizedWindowName();n[e]=t;window.name=JSON.stringify(n)};e.prototype.removeState=function(e){var t=this._getNormalizedWindowName(),n=t[e];delete t[e];window.name=JSON.stringify(t);return n};e.prototype._getNormalizedWindowName=function(){var e,t;try{t=JSON.parse(window.name)||{}}catch(e){t={}}"object"!=typeof t&&(t=((e={}).value=t,e));return t};return e})();t.e=r},3760:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(0),i=n(127);function s(e,t,n){t?i.e.logData({name:e,isIntentional:!0,extraData:Object(r.__assign)({itemId:t.itemId,driveId:t.graph&&t.graph.driveId,fileExtension:t.extension,fileType:t.appMap},n)}):i.e.logData(Object(r.__assign)({name:e},n))}},4040:function(e,t,n){"use strict";var r=0,i=(function(){function e(e){var t=this._viewModel=e.viewModel,n=t.__ResourceComponentLoader$componentId="".concat(++r);t.__ResourceComponentLoader$componentBindingElement=e.element;t.__ResourceComponentLoader$childComponents={};t.__ResourceComponentLoader$componentName=e.name;for(var i=e.bindingContext;i&&(!i.$data||i.$data===t||!i.$data.__ResourceComponentLoader$childComponents);)i=i.$parentContext;if(i){var s=this._parentViewModel=i.$data;s.__ResourceComponentLoader$childComponents[n]=t;t.__ResourceComponentLoader$parentComponentViewModel=s}}e.prototype.dispose=function(){var e=this._viewModel,t=this._parentViewModel,n=e.__ResourceComponentLoader$componentId,r=t&&t.__ResourceComponentLoader$childComponents;n&&r&&delete r[n];if(e){delete e.__ResourceComponentLoader$parentComponentViewModel;delete e.__ResourceComponentLoader$childComponents;delete e.__ResourceComponentLoader$componentBindingElement;delete e.__ResourceComponentLoader$componentName}};return e})();t.e=i},4080:function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){return e>0&&e<=52428800}},4122:function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return i});var r,i;(function(e){e[e.WebhookSubscription=0]="WebhookSubscription";e[e.Meta=1]="Meta";e[e.EventHub=2]="EventHub"})(r||(r={}));(function(e){e[e.Zip=0]="Zip"})(i||(i={}))},4216:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e.TipsNTricks="TipsNTricks";e.TeamifyBanner="TeamifyBanner"})(r||(r={}))},4368:function(e,t,n){"use strict";n.d(t,"e",function(){return E});var r=n("react-lib"),i=n(2),s=n(4529),o=n(62),u=n(0),a=n(45),f=n(22),l=n(30),c=n(14),h=n(5),p=n(20),d=n(78),v=n(1517),m=n(4080),g=Object(d.e)(function(){return Object(u.__awaiter)(void 0,void 0,void 0,function(){return Object(u.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([649,"ondemand.resx-ondemand"],5205)];case 1:return[2,e.sent().ImmersiveReaderLauncher]}})})}),y=new Set;y.add(".docx");y.add(".txt");y.add(".html");var b=Object(a.e)(function(e,t){var n=t.itemKey,i=e.demandItemFacet(h.d,n),s=e.demandItemFacet(h.v,n),o=null==i?void 0:i.extension,a=e.demandItemFacet(v.e,n),f=v.e.evaluate(a)(e,{isAvailable:!1,itemKey:n}).isAvailable&&!!o&&y.has(o)&&!!s&&Object(m.e)(s),c=Object(p.o)(function(e){return r.createElement(g,Object(u.__assign)({},e,{itemKey:n,fileExtension:o}))});return Object(u.__assign)({isAvailable:f,onExecute:c},Object(l.t)(e,{itemKey:n,engagement:{name:"OpenInImmersiveReader",isIntentional:!0,extraData:{fileExtension:o}}}))})(f.e),w=Object(c.s)()(Object(c.r)()(b)),E={key:new i.e("ImmersiveReader").id,name:s.e,title:s.e,automationId:"openInImmersiveReaderCommand",iconProps:{iconName:"ReadOutLoud"},action:r.createElement(o.t,null,r.createElement(w,null))}},4450:function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});n.d(t,"n",function(){return o});var r=n("knockout-lib");function i(e,t){var n,r=function(e){t(t.peek()+e)},i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),s=e.subscribe(function(){r(e.peek()-n)});r(e.peek());return{dispose:function(){i.dispose();s.dispose();r(-e.peek())}}}function s(e,t){var n,r=function(e,n){var r=t.peek();void 0!==e&&r[e]--;void 0!==n&&(r[n]=(r[n]||0)+1);t.valueHasMutated()},i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),s=e.subscribe(function(){r(n,e.peek())});r(void 0,e.peek());return{dispose:function(){i.dispose();s.dispose();r(e.peek(),void 0)}}}function o(e,t){var n=e.peek(),i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),s=r.computed(function(){!t()&&e()&&t(e())}),o=e.subscribe(function(e){!e&&n&&t.peek()===n&&t(void 0)});return{dispose:function(){s.dispose();o.dispose();i.dispose()}}}},4473:function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){return{regular:{fontWeight:400},semibold:{fontWeight:600},bold:{fontWeight:700}}}},4474:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(193);function i(){Object(r.n)(".o365cs-base .o365cs-nav-contextMenu {    background-color: '[theme:white, default:#ffffff]';}\n.o365cs-base-visibility{  visibility: visible;}\n.o365cs-base .ms-fcl-tdr,.o365cs-base .ms-fcl-tdr-h:hover,.o365cs-base .ms-fcl-tdr-f:focus{    color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-base .ms-bgc-tdr,.o365cs-base .ms-bgc-tdr-h:hover,.o365cs-base .ms-bgc-tdr-f:focus{    background-color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-base .ms-bcl-tdr,.o365cs-base .ms-bcl-tdr-h:hover,.o365cs-base .ms-bcl-tdr-f:focus{    border-color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-base .ms-fcl-td,.o365cs-base .ms-fcl-td-h:hover,.o365cs-base .ms-fcl-td-f:focus{    color: '[theme:themeDark, default:#0d62aa]';}\n.o365cs-base .ms-bgc-td,.o365cs-base .ms-bgc-td-h:hover,.o365cs-base .ms-bgc-td-f:focus{    background-color: '[theme:themeDark, default:#0d62aa]';}\n.o365cs-base .ms-bcl-td,.o365cs-base .ms-bcl-td-h:hover,.o365cs-base .ms-bcl-td-f:focus{    border-color: '[theme:themeDark, default:#0d62aa]';}\n.o365cs-base .ms-fcl-tda,.o365cs-base .ms-fcl-tda-h:hover,.o365cs-base .ms-fcl-tda-f:focus{    color: '[theme:themeDarkAlt, default:#106ebe]';}\n.o365cs-base .ms-bgc-tda,.o365cs-base .ms-bgc-tda-h:hover,.o365cs-base .ms-bgc-tda-f:focus{    background-color: '[theme:themeDarkAlt, default:#106ebe]';}\n.o365cs-base .ms-bcl-tda,.o365cs-base .ms-bcl-tda-h:hover,.o365cs-base .ms-bcl-tda-f:focus{    border-color: '[theme:themeDarkAlt, default:#106ebe]';}\n.o365cs-base .ms-fcl-tp,.o365cs-base .ms-fcl-tp-h:hover,.o365cs-base .ms-fcl-tp-f:focus{    color: '[theme:themePrimary, default:#0078d7]';}\n.o365cs-base .ms-bgc-tp,.o365cs-base .ms-bgc-tp-h:hover,.o365cs-base .ms-bgc-tp-f:focus,.o365cs-base.ms-bgc-tp{    background-color: '[theme:themePrimary, default:#0078d7]';}\n.o365cs-base .ms-bcl-tp,.o365cs-base .ms-bcl-tp-h:hover,.o365cs-base .ms-bcl-tp-f:focus{    border-color: '[theme:themePrimary, default:#0078d7]';}\n.o365cs-base .ms-fcl-ts,.o365cs-base .ms-fcl-ts-h:hover,.o365cs-base .ms-fcl-ts-f:focus{    color: '[theme:themeSecondary, default:#2b88d8]';}\n.o365cs-base .ms-bgc-ts,.o365cs-base .ms-bgc-ts-h:hover,.o365cs-base .ms-bgc-ts-f:focus{    background-color: '[theme:themeSecondary, default:#2b88d8]';}\n.o365cs-base .ms-bcl-ts,.o365cs-base .ms-bcl-ts-h:hover,.o365cs-base .ms-bcl-ts-f:focus{    border-color: '[theme:themeSecondary, default:#2b88d8]';}\n.o365cs-base .ms-fcl-tt,.o365cs-base .ms-fcl-tt-h:hover,.o365cs-base .ms-fcl-tt-f:focus{    color: '[theme:themeTertiary, default:#71afe5]';}\n.o365cs-base .ms-bgc-tt,.o365cs-base .ms-bgc-tt-h:hover,.o365cs-base .ms-bgc-tt-f:focus{    background-color: '[theme:themeTertiary, default:#71afe5]';}\n.o365cs-base .ms-bcl-tt,.o365cs-base .ms-bcl-tt-h:hover,.o365cs-base .ms-bcl-tt-f:focus{    border-color: '[theme:themeTertiary, default:#71afe5]';}\n.o365cs-base .ms-fcl-tl,.o365cs-base .ms-fcl-tl-h:hover,.o365cs-base .ms-fcl-tl-f:focus{    color: '[theme:themeLight, default:#c7e0f4]';}\n.o365cs-base .ms-bgc-tl,.o365cs-base .ms-bgc-tl-h:hover,.o365cs-base .ms-bgc-tl-f:focus{    background-color: '[theme:themeLight, default:#c7e0f4]';}\n.o365cs-base .ms-bcl-tl,.o365cs-base .ms-bcl-tl-h:hover,.o365cs-base .ms-bcl-tl-f:focus{    border-color: '[theme:themeLight, default:#c7e0f4]';}\n.o365cs-base .ms-fcl-tlr,.o365cs-base .ms-fcl-tlr-h:hover,.o365cs-base .ms-fcl-tlr-f:focus{    color: '[theme:themeLighter, default:#deecf9]';}\n.o365cs-base .ms-bgc-tlr,.o365cs-base .ms-bgc-tlr-h:hover,.o365cs-base .ms-bgc-tlr-f:focus{    background-color: '[theme:themeLighter, default:#deecf9]';}\n.o365cs-base .ms-bcl-tlr,.o365cs-base .ms-bcl-tlr-h:hover,.o365cs-base .ms-bcl-tlr-f:focus{    border-color: '[theme:themeLighter, default:#deecf9]';}\n.o365cs-base .ms-fcl-tlra,.o365cs-base .ms-fcl-tlra-h:hover,.o365cs-base .ms-fcl-tlra-f:focus{    color: '[theme:themeLighterAlt, default:#eff6fc]';}\n.o365cs-base .ms-bgc-tlra,.o365cs-base .ms-bgc-tlra-h:hover,.o365cs-base .ms-bgc-tlra-f:focus{    background-color: '[theme:themeLighterAlt, default:#eff6fc]';}\n.o365cs-base .ms-bcl-tlra,.o365cs-base .ms-bcl-tlra-h:hover,.o365cs-base .ms-bcl-tlra-f:focus{    border-color: '[theme:themeLighterAlt, default:#eff6fc]';}\n.o365cs-base .ms-fcl-w,.o365cs-base .ms-fcl-w-h:hover,.o365cs-base .ms-fcl-w-f:focus{    color: '[theme:white, default:#ffffff]';}\n.o365cs-base .ms-bgc-w,.o365cs-base .ms-bgc-w-h:hover,.o365cs-base .ms-bgc-w-f:focus,.o365cs-base.ms-bgc-w{    background-color: '[theme:white, default:#ffffff]';}\n.o365cs-base .ms-bcl-w,.o365cs-base .ms-bcl-w-h:hover,.o365cs-base .ms-bcl-w-f:focus{    border-color: '[theme:white, default:#ffffff]';}\n.o365cs-base .ms-fcl-b,.o365cs-base .ms-fcl-b-h:hover,.o365cs-base .ms-fcl-b-f:focus{    color: '[theme:black, default:#000000]';}\n.o365cs-base .ms-fcl-b.o365cs-nav-closeButton{    color: #000000;}\n.o365cs-base .ms-bgc-b,.o365cs-base .ms-bgc-b-h:hover,.o365cs-base .ms-bgc-b-f:focus,.o365cs-base.ms-bgc-b{    background-color: '[theme:black, default:#000000]';}\n.o365cs-base .ms-bcl-b,.o365cs-base .ms-bcl-b-h:hover,.o365cs-base .ms-bcl-b-f:focus{    border-color: '[theme:black, default:#000000]';}\n.o365cs-base .ms-fcl-nd,.o365cs-base .ms-fcl-nd-h:hover,.o365cs-base .ms-fcl-nd-f:focus{    color: '[theme:neutralDark, default:#212121]';}\n.o365cs-base .ms-bgc-nd,.o365cs-base .ms-bgc-nd-h:hover,.o365cs-base .ms-bgc-nd-f:focus{    background-color: '[theme:neutralDark, default:#212121]';}\n.o365cs-base .ms-bcl-nd,.o365cs-base .ms-bcl-nd-h:hover,.o365cs-base .ms-bcl-nd-f:focus{    border-color: '[theme:neutralDark, default:#212121]';}\n.o365cs-base .ms-fcl-np,.o365cs-base .ms-fcl-np-h:hover,.o365cs-base .ms-fcl-np-f:focus{    color: '[theme:neutralPrimary, default:#333333]';}\n.o365cs-base .ms-bgc-np,.o365cs-base .ms-bgc-np-h:hover,.o365cs-base .ms-bgc-np-f:focus{    background-color: '[theme:neutralPrimary, default:#333333]';}\n.o365cs-base .ms-bcl-np,.o365cs-base .ms-bcl-np-h:hover,.o365cs-base .ms-bcl-np-f:focus{    border-color: '[theme:neutralPrimary, default:#333333]';}\n.o365cs-base .ms-fcl-ns,.o365cs-base .ms-fcl-ns-h:hover,.o365cs-base .ms-fcl-ns-f:focus{    color: '[theme:neutralSecondary, default:#666666]';}\n.o365cs-base .ms-fcl-ns.o365cs-nav-moduleLabel{    color: #666666;}\n.o365cs-base .ms-bgc-ns,.o365cs-base .ms-bgc-ns-h:hover,.o365cs-base .ms-bgc-ns-f:focus{    background-color: '[theme:neutralSecondary, default:#666666]';}\n.o365cs-base .ms-bcl-ns,.o365cs-base .ms-bcl-ns-h:hover,.o365cs-base .ms-bcl-ns-f:focus{    border-color: '[theme:neutralSecondary, default:#666666]';}\n.o365cs-base .ms-fcl-nsa,.o365cs-base .ms-fcl-nsa-h:hover,.o365cs-base .ms-fcl-nsa-f:focus{    color: '[theme:neutralSecondaryAlt, default:#767676]';}\n.o365cs-base .ms-bgc-nsa,.o365cs-base .ms-bgc-nsa-h:hover,.o365cs-base .ms-bgc-nsa-f:focus{    background-color: '[theme:neutralSecondaryAlt, default:#767676]';}\n.o365cs-base .ms-bcl-nsa,.o365cs-base .ms-bcl-nsa-h:hover,.o365cs-base .ms-bcl-nsa-f:focus{    border-color: '[theme:neutralSecondaryAlt, default:#767676]';}\n.o365cs-base .ms-fcl-nt,.o365cs-base .ms-fcl-nt-h:hover,.o365cs-base .ms-fcl-nt-f:focus{    color: '[theme:neutralTertiary, default:#a6a6a6]';}\n.o365cs-base .ms-bgc-nt,.o365cs-base .ms-bgc-nt-h:hover,.o365cs-base .ms-bgc-nt-f:focus{    background-color: '[theme:neutralTertiary, default:#a6a6a6]';}\n.o365cs-base .ms-bcl-nt,.o365cs-base .ms-bcl-nt-h:hover,.o365cs-base .ms-bcl-nt-f:focus{    border-color: '[theme:neutralTertiary, default:#a6a6a6]';}\n.o365cs-base .ms-fcl-nta,.o365cs-base .ms-fcl-nta-h:hover,.o365cs-base .ms-fcl-nta-f:focus{    color: '[theme:neutralTertiaryAlt, default:#c8c8c8]';}\n.o365cs-base .ms-bgc-nta,.o365cs-base .ms-bgc-nta-h:hover,.o365cs-base .ms-bgc-nta-f:focus{    background-color: '[theme:neutralTertiaryAlt, default:#c8c8c8]';}\n.o365cs-base .ms-bcl-nta,.o365cs-base .ms-bcl-nta-h:hover,.o365cs-base .ms-bcl-nta-f:focus{    border-color: '[theme:neutralTertiaryAlt, default:#c8c8c8]';}\n.o365cs-base .ms-fcl-nl,.o365cs-base .ms-fcl-nl-h:hover,.o365cs-base .ms-fcl-nl-f:focus{    color: '[theme:neutralLight, default:#eaeaea]';}\n.o365cs-base .ms-bgc-nl,.o365cs-base .ms-bgc-nl-h:hover,.o365cs-base .ms-bgc-nl-f:focus{    background-color: '[theme:neutralLight, default:#eaeaea]';}\n.o365cs-base .ms-bcl-nl,.o365cs-base .ms-bcl-nl-h:hover,.o365cs-base .ms-bcl-nl-f:focus{    border-color: '[theme:neutralLight, default:#eaeaea]';}\n.o365cs-base .ms-fcl-nlr,.o365cs-base .ms-fcl-nlr-h:hover,.o365cs-base .ms-fcl-nlr-f:focus{    color: '[theme:neutralLighter, default:#f4f4f4]';}\n.o365cs-base .ms-bgc-nlr,.o365cs-base .ms-bgc-nlr-h:hover,.o365cs-base .ms-bgc-nlr-f:focus,.o365cs-base.ms-bgc-nlr{    background-color: '[theme:neutralLighter, default:#f4f4f4]';}\n.o365cs-base .ms-bcl-nlr,.o365cs-base .ms-bcl-nlr-h:hover,.o365cs-base .ms-bcl-nlr-f:focus{    border-color: '[theme:neutralLighter, default:#f4f4f4]';}\n.o365cs-base .ms-fcl-nlra,.o365cs-base .ms-fcl-nlra-h:hover,.o365cs-base .ms-fcl-nlra-f:focus{    color: '[theme:neutralLighterAlt, default:#f8f8f8]';}\n.o365cs-base .ms-bgc-nlra,.o365cs-base .ms-bgc-nlra-h:hover,.o365cs-base .ms-bgc-nlra-f:focus,.o365cs-base.ms-bgc-nlra{    background-color: '[theme:neutralLighterAlt, default:#f8f8f8]';}\n.o365cs-base .ms-bcl-nlra,.o365cs-base .ms-bcl-nlra-h:hover,.o365cs-base .ms-bcl-nlra-f:focus{    border-color: '[theme:neutralLighterAlt, default:#f8f8f8]';}\n.o365cs-base .o365cs-topnavLinkBackground-2{    background-color: transparent;}\n.o365cs-base .o365cs-topnavText,.o365cs-base .o365cs-topnavText:hover{    color: '[theme:suiteBarText, default:#ffffff]';}\n.o365cs-base .o365cs-appLauncherBackground{    background-color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-nav-header16 .o365cs-navMenuButton{    color: '[theme:white, default:#ffffff]';}\n.o365cs-base .o365cs-navMenuButton{    color: '[theme:suiteBarText, default:#ffffff]';}\n.o365cs-base.o365cs-topnavBGImage{    background-position: center top;    background-repeat: repeat-x;    background-image: none;}\n.o365cs-base.o365cs-topnavBGColor-2{    background-color: '[theme:suiteBarBackground, default:#000000]';}\n")}},4496:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(91),i=n(59);function s(e,t,n){return(function(e){var t=new r.t(this);return new i.n(function(n,r){var i=new FileReader;t.on(i,"load",function(e){n(i.result);t.dispose()});t.on(i,"error",function(e){r(i.error);t.dispose()});i.readAsDataURL(e)})})(e).then(function(r){var i=document.createElement("img");i.src=r;var s=i.width,o=i.height;if(s>o){if(s>t){o*=t/s;s=t}}else if(o>n){s*=n/o;o=n}s=Math.floor(s);o=Math.floor(o);if(s===i.width&&o===i.height)return e;var u=document.createElement("canvas");u.width=s;u.height=o;u.getContext("2d").drawImage(i,0,0,s,o);return(function(e){for(var t=atob(e.split(",")[1]),n=new Uint8Array(t.length),r=e.split(",")[0].split(":")[1].split(";")[0],i=0,s=t.length;i<s;i++)n[i]=t.charCodeAt(i);return new Blob([n],{type:r})})("image/jpeg"===e.type?u.toDataURL(e.type,.92):u.toDataURL(e.type))})}},4531:function(e,t,n){"use strict";var r=n(0),i=n(153),s=n(220),o=n(80),u=n(40),a=n(4122),f=n(573),l=n(3740),c={ODB:819,ODC:"EnablePushChannelLogging"},h={ODB:459},p={ODB:!0},d=["Due to organizational policies, you can't access these resources from this network location","One of the provided arguments is not acceptable","Session has been revoked","The access token has expired","The caller does not have permission to perform the action","The caller is not authenticated","The request is malformed or incorrect","There has been an error authenticating the request"],v=(function(){function e(e,t){this._firedConnectQoSEvent=!1;this._getSubscriptionAttempts=0;this._socketIoReconnectAttempts=0;this._notificationHandlers={};this._connectionHandlers={};this._disableWebSockets=e.disableWebSockets;this._subscriptionService=t.subscriptionService;this._sessionTokenFetcher=t.sessionTokenFetcher;this._async=new i.e;this._socketIoReconnectAttempts=0}e.prototype.isConnected=function(){return!!this._socketIo&&this._socketIo.connected};e.prototype.getSocketIoSubscription=function(){return this._subscription};e.prototype.addConnectionHandler=function(e,t){this._connectionHandlers[e]=t};e.prototype.removeConnectionHandler=function(e){delete this._connectionHandlers[e]};e.prototype.setupNotificationHandler=function(e,t){var n=e.source,r=e.scenarios,i=e.id,s=void 0===i?"":i,o=a.t[n];if(o){if(r&&r.length)for(var u=0,f=r;u<f.length;u++){var l=f[u];this._notificationHandlers[o.toLowerCase()+a.e[l].toLowerCase()+s]=t}else this._notificationHandlers[o.toLowerCase()+s]=t;return!0}return!1};e.prototype.connect=function(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,i,f,c,h=this;return Object(r.__generator)(this,function(d){switch(d.label){case 0:this.disconnect();if(void 0!==e)return[3,2];n=this;return[4,this._getSubscription("PushChannelService.Connect")];case 1:n._subscription=d.sent();return[3,3];case 2:this._subscription=e;d.label=3;case 3:this._log("Connecting to subscription",this._subscription);if(void 0===this._subscription){this._log("Invalid subscription");return[2,!1]}if(!this._firedConnectQoSEvent||s.e.isFeatureEnabled(p)){this._firedConnectQoSEvent=!0;i=new o.e({name:"PushChannelService.Connect",extraData:Object(r.__assign)({notificationUrl:this._subscription.notificationUrl},t||{})})}f={reconnectionAttempts:20};-1!==this._subscription.notificationUrl.indexOf("pushn")?f.transports=["websocket"]:this._disableWebSockets&&(f.transports=["polling"]);c=this._socketIo=Object(l.connect)(this._subscription.notificationUrl,f);this._socketIo.on("connect",function(){if(c===h._socketIo){h._log("Connected");i&&i.end({resultType:u.e.Success,extraData:Object(r.__assign)({notificationUrl:h._subscription.notificationUrl},t||{})});h._executeConnectionHandlers(!0)}else c.disconnect()});this._socketIo.on("disconnect",function(){if(c===h._socketIo){h._log("Disconnected");h._executeConnectionHandlers(!1)}});this._socketIo.on("reconnect_failed",function(){h._log("Reconnect failed");i&&i.end({resultType:u.e.Failure,extraData:Object(r.__assign)({notificationUrl:h._subscription.notificationUrl},t||{})});h._subscription=void 0;h._socketIoReconnectAttempts++;h._socketIoReconnectAttempts>3?h._log("Exceeded max reconnect attempts"):h._async.setTimeout(function(){h.connect(void 0,{methodInvoker:"reconnect_failed"})},0)});this._socketIo.on("notification",function(e){h._log("Notification",e);var t;try{t=JSON.parse(e)}catch(e){return}var n=t.source,r=t.scenario?t.scenario.toLowerCase():"";n||(n=a.t[a.t.WebhookSubscription]);n=n.toLowerCase();var i=!1;i=h._handleMessage(t,n);var s=n+r;for(var o in h._notificationHandlers)-1!==o.indexOf(s)&&o!==n&&(i=h._handleMessage(t,o,s)||i);i||h._log("Notification - missing handler for message")});return[2,!0]}})})};e.prototype.disconnect=function(){if(this._socketIo){this._socketIo.disconnect();this._socketIo=void 0}if(this._async){this._async.dispose();this._async=new i.e}this._subscription=void 0};e.prototype.refreshSubscription=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,this._getSubscription("PushChannelService.refreshSubscription")];case 1:if(void 0===(e=t.sent()))return[2,void 0];if(this.isConnected()&&this._subscription&&this._subscription.notificationUrl!==e.notificationUrl){this._log("Notification url changed. Reconnecting...");this.connect(e,{methodInvoker:"PushChannelService.refreshSubscription"});return[2,!1]}this._subscription=e;return[2,!0]}})})};e.prototype._getSubscription=function(e){void 0===e&&(e="unknown");return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,i,a,l,c,p,v,m=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:n=void 0;s.e.isFeatureEnabled(h)&&(n=new o.e({name:"PushChannelService.getSubscription",extraData:{methodInvoker:e,getSubscriptionAttempts:this._getSubscriptionAttempts,socketIoReconnectAttempts:this._socketIoReconnectAttempts}}));r.label=1;case 1:r.trys.push([1,6,,7]);a=(i=this._subscriptionService).getSocketIoSubscription;v={};return this._sessionTokenFetcher?[4,this._sessionTokenFetcher()]:[3,3];case 2:l=r.sent();return[3,4];case 3:l=void 0;r.label=4;case 4:return[4,a.apply(i,[(v.sessionToken=l,v.existingSubscription=this._subscription,v)])];case 5:t=r.sent();n&&n.end({resultType:u.e.Success,extraData:{methodInvoker:e,getSubscriptionAttempts:this._getSubscriptionAttempts,socketIoReconnectAttempts:this._socketIoReconnectAttempts}});return[3,7];case 6:c=r.sent();this._log("Failed to get socketIo subscription",c);p=!1;Object(f.s)(c)&&(403===c.status?p=!0:c.error&&c.error.message&&(p=d.some(function(e){return 0===c.error.message.indexOf(e)})));n&&n.end({resultType:u.e.Success,extraData:{methodInvoker:e,getSubscriptionAttempts:this._getSubscriptionAttempts,socketIoReconnectAttempts:this._socketIoReconnectAttempts}});if(p)return[2,void 0];this._getSubscriptionAttempts++;return this._getSubscriptionAttempts>10?[2,void 0]:[2,new Promise(function(e){var t=500*Math.pow(2,m._getSubscriptionAttempts);m._log("Retrying in ".concat(t," milliseconds"));m._async.setTimeout(function(){return e(m._getSubscription("Retry_getSubscription"))},t)})];case 7:return[2,t]}})})};e.prototype._handleMessage=function(e,t,n){void 0===n&&(n=t);var r=this._notificationHandlers[t];if(r){r(e.payload?e.payload:e.value);return!0}return!1};e.prototype._executeConnectionHandlers=function(e){for(var t=0,n=Object.keys(this._connectionHandlers);t<n.length;t++){var r=n[t];this._connectionHandlers[r](e)}};e.prototype._log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];s.e.isFeatureEnabled(c)&&console.log.apply(console,Object(r.__spreadArray)(["PushChannelService"],e,!0))};return e})();t.e=v},4535:function(e,t,n){"use strict";var r=(function(){function e(e,t){this._dataRequestor=t.dataRequestor;this._listId=e.listId;this._webAbsoluteUrl=e.webAbsoluteUrl}e.prototype.getSocketIoSubscription=function(e){var t,n;if(this._listId&&this._webAbsoluteUrl){t="".concat(this._webAbsoluteUrl,"/_api/v2.0/sites/root/lists/").concat(this._listId);n=!1}else{if(!e.sessionToken)throw new Error("Invalid session token");t="/drive/root";n=!0}return this._dataRequestor.send({path:"".concat(t,"/subscriptions/socketIo"),apiName:"GetSocketIo",requestType:"GET",accessToken:e.sessionToken,useAuthorizationHeaders:n}).then(function(e){return e})};return e})();t.e=r},4601:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n("react-lib"),i=n(1958),s=n(1738),o=n(143),u=n(900),a=n(1281),f=n(1520);function l(e){var t=e.dragDropKey,n=e.dragType,l=e.acceptType,c=e.showDefaultDragPreview,h=e.hookCallback,p=e.handlers,d=!!p.canDragHandler,v=Object(u.r)({dragSourceKey:t,type:n,handlers:p,collectDragAvailability:!1}),m=Object(i.e)(v),g=m[0],y=m[1],b=m[2];Object(r.useEffect)(function(){d&&b&&!c&&b(Object(f.e)(),{captureDraggingState:!0})},[d,b,c]);var w=Object(a.r)({acceptType:l,dropTargetKey:t,handlers:p}),E=Object(s.e)(w),S=E[0],x=E[1];Object(r.useEffect)(function(){h({collectedDragProps:g,collectedDropProps:S,connectDragSource:y,connectDropTarget:x})},[g,S,y,b,x]);return Object(o.t)(e.children,{collectedDragProps:g,collectedDropProps:S,connectDragSource:y,connectDropTarget:x})}},4610:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(165),i=n(23),s="STS",o=[{registration:{id:s,swPrefetchManifestName:"stsserviceworkerprefetch"}},{registration:{id:"SPHome"}},{featureIds:[1966],registration:{id:"SitePages"}},{registration:{id:"Embed"}},{odc:!0,featureIds:["EnableODCServiceWorker"],registration:{id:"ODC"}},{featureIds:[60579],registration:{id:"CreateGroup"}},{featureIds:[60155],registration:{id:"SingleWebPart"}},{featureIds:[60840],registration:{id:"VivaHome"}},{featureIds:[60877],registration:{id:"Vinci"}}];function u(e){var t=r.n.isFeatureEnabled({ODC:!0}),n=o.filter(function(e){if(t===!e.odc)return!1;var n=!0;e.featureIds&&e.featureIds.forEach(function(e){n=n&&r.n.isFeatureEnabled(t?{ODC:e}:{ODB:e})});switch(e.registration.id){case s:return n&&!navigator.userAgent.match(/Version\/[\d\.]+.*Safari/)}return n}).map(function(e){return e.registration}),u=JSON.stringify(n),a=!t&&r.n.isFeatureEnabled({ODB:1966})&&-1!==document.cookie.indexOf("SPClientSideFrameworkDevCookie-9076A2B0-2161-43C6-8BEA-9FECB7EA459B=");return"".concat(t?"/odc":"/_layouts/15/odsp","serviceworkerproxy.aspx")+"?swManifestName=".concat(t?"odc":"sp","serviceworker")+"&debug=".concat(a?"true":"false")+"&bypass=".concat(e?"true":"false")+"&applications=".concat(encodeURIComponent(u))+"".concat(r.n.isFeatureEnabled({ODB:60448})?"&list=v2":"")+"".concat(!i.t.isActivated("9FF1CAC6-51F5-44D3-819D-8D7D6ED6D2C9","1/28/2022","Remove brotli from path")&&r.n.isFeatureEnabled({ODB:60734})?"&defaultBrotli=true":"")}},4611:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(447);function i(){return Object(r.e)({data:{url:location.href,type:1}})}},4612:function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r;function i(){r||"function"!=typeof BroadcastChannel||(r=new BroadcastChannel("sw_broadcast"));return r}var s={OfflineNotification:"OfflineNotification",CheckOffline:"CheckOffline"}},4805:function(e,t,n){"use strict";n.d(t,"e",function(){return w});var r=n(0),i=n("react-lib"),s=n(1927),o=n(1776),u=n(441),a=n(2543),f=n(2504),l=n(18),c=n(3652),h=n(2638),p=n(3558),d=function(e){var t=e.activity,n=e.loginUserEmail,r=e.userEmail,s=Object(c.t)(),o="";"Access"===t.activityType?o=s.accessActivity:"Modified"===t.activityType&&(o=s.modifiedActivity);var u=t&&t.actor&&t.actor.user,d=Object(p.e)(u&&u.email,n,r)?s.loginUserYou:u&&u.displayName||u&&u.email||h.oe,v=i.createElement("div",{className:"analyticsActivityUserName_f87f3312"},d),m=i.createElement("div",{className:"analyticsActivityUserAction_f87f3312"},o),g=s.activityTemplate&&l.formatToArray(s.activityTemplate,v,m),y=f.n.size24;return i.createElement(a.e,{activityPersonas:[{imageUrl:u.image,imageAlt:d,imageInitials:e.imageInitials,initialsColor:e.initialsColor,size:y}],activityDescription:i.createElement("div",{dir:"auto",className:"analyticsActivity_f87f3312"},g),timeStamp:t.activityDateTime,styles:{root:{alignItems:"center"},activityContent:{padding:"0 12px"},personaContainer:{width:"24px",height:"24px"}}})},v=n(3110),m=n(1807),g=n(79),y=n(23),b=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.componentDidMount=function(){this.props.onLoaded&&this.props.onLoaded()};t.prototype.render=function(){return i.createElement(o.e,{size:u.e.large})};return t})(i.Component),w=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onRenderCell=function(e,t){return e&&e.activity&&i.createElement("div",{className:"analyticsActivityListActivity_ae2a35ce"},i.createElement(d,{activity:e.activity,loginUserEmail:n.props.loginUserEmail,userEmail:n.props.userEmail,imageInitials:e.imageInitials,initialsColor:e.initialsColor}),n.props.moreActivities&&t===n.state.items.length-1?i.createElement(b,{onLoaded:n.props.onLoadMoreActivities}):void 0)};n.state={items:t.itemAnalytics&&t.itemAnalytics.activities.map(function(e){return{activity:e}}),itemAnalyticsData:t.itemAnalytics};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){if(e.itemAnalytics){this._updateActivities(e.itemAnalytics);this.props.pageContext&&this._updateAcronyms(e.itemAnalytics)}};t.prototype.render=function(){var e,t=this,n=this.props.showAnalyticsStats,r=void 0===n||n,o=this.state.itemAnalyticsData,u=Object(c.t)();o&&o.incompleteData&&o.incompleteData.wasThrottled&&(e=u.throttledMessage);if(o){var a=!y.t.isActivated("a0516140-7477-4e38-803b-62eabaf047d8","02/28/2022","Move Viewers title into component");v.t();return i.createElement("div",null,r&&i.createElement(c.e,{itemAnalytics:o,inComplete:!!e}),this.state.items&&i.createElement(i.Fragment,null,a&&this.props.title&&this.state.items.length>0&&i.createElement("div",{className:"analyticsActivityListViewersTitle_ae2a35ce"},this.props.title),i.createElement(s.e,{items:this.state.items,onRenderCell:this._onRenderCell,onShouldVirtualize:function(){return t.state.items.length>30}})))}return i.createElement(b,null)};t.prototype._updateActivities=function(e){this.setState(function(){return{itemAnalyticsData:e,items:e.activities.map(function(e){return{activity:e}})}})};t.prototype._updateAcronyms=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,i,s;return Object(r.__generator)(this,function(r){switch(r.label){case 0:r.trys.push([0,3,,4]);if(!this.props.pageContext)return[3,2];t=e.activities.map(function(e){return e.actor.user.displayName});return[4,new m.e(this.props.pageContext).getAcronyms(t,{qosName:"ItemAnalyticsListAcronyms"})];case 1:n=r.sent();i=n.reduce(function(e,t){t.text&&(e[t.text]=t);return e},{});this.setState(function(e){return{items:e.items.map(function(e){var t=i[e.activity.actor.user.displayName];return{activity:e.activity,imageInitials:t&&t.acronym,initialsColor:t&&t.color}})}});r.label=2;case 2:return[3,4];case 3:s=r.sent();g.e.logError(s);v.e(s);return[3,4];case 4:return[2]}})})};return t})(i.Component)},4837:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n("react-lib"),s=n(1658),o=n(3652),u=n(1816),a=n(343),f=n(2908),l=n(1453),c=function(e){var t=e.items,n=e.farItems,c=e.analyticsStats,h=e.isLink,p=e.showActionBar,d=void 0===p||p,v=!(!c||!c.itemAnalytics&&!c.isNotSupported&&c.status!==f.e.unsupport&&c.status!==f.e.failed),m=e.itemKey?i.createElement(l.e,{className:"analyticsActionBar_43e4af34",commands:t,farCommands:n}):i.createElement(s.e,{className:"analyticsActionBar_43e4af34",items:t,farItems:n});return i.createElement("div",null,i.createElement("div",{className:"analyticsActionBarStats_43e4af34"},i.createElement(u.e,{width:"35%",isDataLoaded:v,shimmerElements:[{type:a.e.line,height:8}]},i.createElement(o.e,Object(r.__assign)({isLink:h,isCompact:!0},c)))),d&&(n.length>0||t.length>0)&&m)}},4920:function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(18);function i(e){return new Date(e)}function s(e,t){void 0===t&&(t=!1);var n=new Date(e),i=n.getTimezoneOffset()<0,s=n.getFullYear()+"",o=Object(r.leftPad)(n.getMonth()+1+"",2),u=Object(r.leftPad)(n.getDate()+"",2),a=Object(r.leftPad)(n.getHours()+"",2),f=Object(r.leftPad)(n.getMinutes()+"",2),l=Object(r.leftPad)(n.getSeconds()+"",2),c=(i?"+":"-")+Object(r.leftPad)(i?(Math.ceil(n.getTimezoneOffset()/60)+"").replace("-",""):Math.floor(n.getTimezoneOffset()/60)+"",2)+Object(r.leftPad)((n.getTimezoneOffset()%60).toString().replace("-",""),2);return t?s+"-"+o+"-"+u+"T"+a+":"+f+":"+l+c:s+o+u+"T"+a+f+l+c}},5127:function(e,t,n){"use strict";n.r(t);n.d(t,"FileHoverCard",function(){return Be});n.d(t,"CurrentFileHoverCard",function(){return je});var r=n(0),i=n("react-lib"),s=n(4318),o=n(119),u=n(176),a=n(14),f=n(5),l=n(1232),c=n(28),h=n(523),p=n(1828),d=n(20),v=n(1089),m=n(383),g=n(32),y=n(155),b=n(37),w=n(4805),E=n(380),S=n(2909),x=n(580),T=n(1766),N=n(1927),C=n(1746),k=n(1554),L=n(2638),A=n(18),O=n(127),M=(function(){function e(e){this._engagementData={};this._engagement=e||O.e}Object.defineProperty(e.prototype,"engagementData",{set:function(e){this._engagementData=e},enumerable:!1,configurable:!0});e.prototype.logData=function(e,t){this._engagement.logData(Object(r.__assign)(Object(r.__assign)({name:e},this._engagementData),{extraData:Object(r.__assign)(Object(r.__assign)({},this._engagementData.extraData),t)}))};return e})(),_=i.createContext(new M),D=n(220),P=n(643),H={ODB:1588,OneDrive:!0},B={ODB:1883,OneDrive:!0},j={ODB:1020,OneDrive:!0},F={ODB:1015,OneDrive:!0},I=[P.u,P.n,P.s,".docx",".xlsx",".pptx",".doc",".xls",".ppt",".pdf"];function q(){return D.e.isFeatureEnabled(B)}function R(){return D.e.isFeatureEnabled(F)}var U=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onClick=function(e){n.context.logData("FileHoverCard.KeyPoints.Click");n.props.onKeyPointsClick&&n.props.onKeyPointsClick(e)};n._onClickMoreIcon=function(e){n._moreIconElement=e.currentTarget;n.setState({showCallout:!0});n.context.logData("FileHoverCard.KeyPoints.ClickMoreIcon")};n.state={showCallout:!1};return n}t.prototype.render=function(){var e=this,t=L.ce,n=this.props.keyPointsData;return i.createElement("div",{className:"fileHoverCardInsideLook_2b6030ba",style:q()?{borderTop:0,paddingTop:0}:{}},!q()&&i.createElement("div",{className:"fileHoverCardInsideLookTitle_2b6030ba"},i.createElement("div",null,!q()&&L.le,i.createElement(T.e,{content:t,directionalHint:o.e.bottomCenter},i.createElement(x.e,{iconName:"Info",ariaLabel:t,role:"tooltip",tabIndex:0}))),this._ellipses()),this.state.showCallout&&i.createElement(k.e,{gapSpace:0,isBeakVisible:!0,shouldFocusOnMount:!0,target:this._moreIconElement,onDismiss:function(){return e.setState({showCallout:!1})},directionalHint:Object(E.e)()?o.e.bottomLeftEdge:o.e.bottomRightEdge,items:[{key:"sendFeedback",name:L.q,onClick:this.props.onSendFeedbackClick},{key:"editKeyPoints",name:L.h,onClick:this.props.onKeyPointsClick}]}),!(!n||!n.readTime||void 0===n.readTime.minutes)&&i.createElement("div",{className:"fileHoverCardReadTimeContainer_2b6030ba",style:q()?{justifyContent:"space-between"}:{}},i.createElement("div",{className:"fileHoverCardReadTime_2b6030ba"},i.createElement(x.e,{className:"fileHoverCardReadTimeIcon_2b6030ba",iconName:"Clock","aria-describedby":t}),this._timeToReadMessage(n.readTime.minutes)),q()&&this._ellipses()),n&&n.keyPoints&&n.keyPoints.length>0&&(this.props.onKeyPointsClick?i.createElement(S.e,{className:"fileHoverCardKeyPointsButton_2b6030ba",onClick:this._onClick,styles:{flexContainer:{flexWrap:"wrap"}}},this._keyPointsContent(n)):i.createElement("div",{className:"fileHoverCardKeyPointsNonButton_2b6030ba"},this._keyPointsContent(n))))};t.prototype._keyPointsContent=function(e){return i.createElement(i.Fragment,null,i.createElement("div",{className:"fileHoverCardKeyPointsAction_2b6030ba"},L.de),i.createElement(N.e,{renderCount:3,items:e.keyPoints,onRenderCell:this._onRenderCell,className:"fileHoverCardKeyPointsContent_2b6030ba"}))};t.prototype._onRenderCell=function(e){return e&&i.createElement("div",{className:"fileHoverCardKeyPointsCell_2b6030ba"},i.createElement("div",{className:"fileHoverCardKeyPointsBullet_2b6030ba"}),i.createElement("div",{dir:"auto",className:"fileHoverCardKeyPointsText_2b6030ba"},e.text))};t.prototype._ellipses=function(){return this.props.onSendFeedbackClick&&i.createElement(C.e,{iconProps:{iconName:"More"},onClick:this._onClickMoreIcon,ariaLabel:L.N,style:{marginTop:"2px"}})};t.prototype._timeToReadMessage=function(e){if(0===e)return L.De;if(e>60){var t=A.getLocalizedCountValue(L.Oe,L.Me,Math.floor(e/60));return t&&A.format(t,Math.floor(e/60))}return A.format(L._e,e)};return t})(i.Component);U.contextType=_;var z=n(1950),W=n(3558),X=n(770),V=n(1192),$=n(1088),J=n(23);function K(e){var t,n,r,i,s,o=e.lifeCycleSignalData,u=e.loginUserEmail,a=e.userEmail,f=e.createdBy,l=e.createdDateTime,c=e.onRenderLifeCycleSignal,h=o.signal,p=o.title;switch(o.key){case X.o:p=L.me;t="https://go.microsoft.com/fwlink/?linkid=862871";i=L.ve;break;case X.c:p=L.ze;n=e.onCheckIn;r=e.onDiscardCheckOut;i=e.onCheckIn?L.ie:void 0;s=e.onDiscardCheckOut?L.se:void 0;break;case X.f:p=o.title;break;case X.e:p=L.a;n=e.onViewPolicyTip;i=L.je;break;case X.u:p=L.ge;n=e.onAddMetadataNow;i=L.ee;break;case X.t:p=L.f;n=e.onViewPolicyTip;i=L.je;break;case X.l:p=o.title;break;case X.a:var d=l&&Object(V.n)(new Date(l));p=f&&f.email&&Object(W.e)(f.email,u,a)?A.format(L.Ue,d):A.format(L.we,d,f&&f.displayName);break;default:if(!J.t.isActivated("3ec8c778-3357-49fa-a673-48e8db866d6b","1/25/2022","Teams meeting recording expiration signal"))break;h=null}return(c?Object($.e)(c,Q):Q)({signal:h,content:p,action:n,actionName:i,secondaryAction:r,secondaryActionName:s,link:t})}function Q(e){return e&&e.signal?i.createElement("div",{className:"fileHoverCardLifeCycle_7b573ea9"},e.signal,i.createElement("div",{className:"fileHoverCardLifeCycleMessage_7b573ea9"},e.content&&i.createElement("div",{className:"fileHoverCardLifeCycleTitle_7b573ea9"},e.content),(e.action||e.link)&&i.createElement(z.e,{className:"fileHoverCardLifeCycleAction_7b573ea9",href:e.link,target:e.link&&"_blank",onClick:e.action},e.actionName),e.secondaryAction&&" ".concat(L._," "),e.secondaryAction&&i.createElement(z.e,{className:"fileHoverCardLifeCycleAction_7b573ea9",onClick:e.secondaryAction},e.secondaryActionName))):null}var G=n(2543),Y=n(4920),Z=n(50),ee=n(3760),te=(function(e){Object(r.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._handleClickShare=function(e){var n=t.props.shareWith&&t.props.shareWith.slice(0,2).map(function(e){return e.email});t.props.onShareWith(e,n);Object(ee.e)("FileHoverCard.RecommendedActions.ShareWith",t.props.item)};return t}t.prototype.render=function(){var e=this,t=this.props,n=t.editActivities,r=t.shareWith,s=this.props.shareWith&&this.props.shareWith.slice(0,2).map(function(e){return e.email});return r&&r.length>=2&&i.createElement(i.Fragment,null,i.createElement("div",{className:"fileHoverCardShareWith_598162d9"},A.formatToArray(L.U,this._userNameJSX(r[0].displayName),this._userNameJSX(r[1].displayName))),this.props.onRenderShareWithPeople?i.createElement("div",{className:"fileHoverCardShareWithLink_598162d9"},this.props.onRenderShareWithPeople(s)):i.createElement(z.e,{className:"fileHoverCardShareWithLink_598162d9",onClick:this._handleClickShare},L.z),n&&n.map(function(t,n){return n<2&&i.createElement(G.e,{key:n,activityIcon:i.createElement(x.e,{iconName:"Edit",className:"fileHoverCardRecommendedIcon_598162d9"}),onRenderActivityDescription:function(){return e._onRenderActivityDescription(t)},timeStamp:t.activityDateTime})}))};t.prototype._onRenderActivityDescription=function(e){var t=e&&e.actor&&e.actor.user,n=Object(W.e)(t&&t.email,this.props.loginUserEmail,this.props.userEmail)?L.Re:e.actor.user.displayName;return i.createElement("div",{className:"fileHoverCardActivity_598162d9"},A.formatToArray(L.S,this._userNameJSX(n)))};t.prototype._userNameJSX=function(e){return i.createElement("div",{key:e,className:"fileHoverCardUserName_598162d9"},e)};return t})(i.Component),ne=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._recommendedAction=function(e,t){var r=Object(V.n)(Object(Y.t)(e.activityTimestamp)),s="",u="",a="";switch(e.recommendationEventType){case"Mentioned":s="Accounts";a=A.formatToArray(L.T,n._userNameJSX(e.actorDisplayName));u=L.H;break;case"Edited":s="Edit";a=L.p;u=L.M;var f=e.importantActorsAndActivities[0],l=f&&f.activityTimestamp;r=l&&Object(V.n)(Object(Y.t)(l));var c=e.importantActorsAndActivities.map(function(e){return e.actorDisplayName});a=1===c.length?A.formatToArray(L.O,n._userNameJSX(c[0])):2===c.length?A.formatToArray(L.K,n._userNameJSX(c[0]),n._userNameJSX(c[1])):A.formatToArray(L.p,n._userNameJSX(c[0]),n._userNameJSX(c[1]),e.recentEditorCount-2);break;case"Commented":s="Chat";a=A.formatToArray(L.s,n._userNameJSX(e.actorDisplayName));u=L.Q}return i.createElement("div",{key:t},i.createElement("div",{className:"fileHoverCardRecommendedAction_598162d9"},i.createElement(G.e,{activityIcon:i.createElement(x.e,{iconName:s,className:"fileHoverCardRecommendedIcon_598162d9"}),activityDescription:i.createElement("div",{className:"fileHoverCardRecommendedMessage_598162d9"},a),timeStamp:r}),i.createElement(T.e,{content:L.c,directionalHint:o.e.topCenter},i.createElement(C.e,{className:"fileHoverCardCancelIcon_598162d9",iconProps:{iconName:"Cancel"},onClick:function(){return n._handleClickDismiss(t)}}))),i.createElement(z.e,{className:"fileHoverCardRecommendedLink_598162d9",href:n._getNavLink(e.navigationId),target:"_blank",onClick:function(){n.context.logData("FileHoverCard.RecommendedActions.".concat(e.recommendationEventType),{})}},u))};n._getNavLink=function(e){if(n.props.pageUrl&&e){var t=new Z.t(n.props.pageUrl);t.setQueryParameter("nav",e);t.setQueryParameter("commentId",e);return t.toString()}return n.props.pageUrl};n._recommendedActionRef=function(e){var t=n.state.recommendedActions;n.context.logData("FileHoverCard.RecommendedActions.Render",{activityType:t&&t.length>0?"HighActivities":"LowActivities"})};n.state={recommendedActions:n.props.actions.recommendedActions};return n}t.prototype.render=function(){var e=this.state.recommendedActions;return e&&e.length>0&&i.createElement("div",{ref:this._recommendedActionRef,className:"fileHoverCardRecommendedSection_598162d9",style:q()?{borderTop:0}:{}},!q()&&i.createElement("div",{className:"fileHoverCardRecommendedTitle_598162d9"},L.D),e&&e.length>0?e.slice(0,3).map(this._recommendedAction):i.createElement(te,{item:this.props.item,shareWith:this.props.actions.shareWith,editActivities:this.props.actions.editActivities,loginUserEmail:this.props.loginUserEmail,userEmail:this.props.userEmail,onShareWith:this.props.onShareWith,onRenderShareWithPeople:this.props.onRenderShareWithPeople}))};t.prototype._userNameJSX=function(e){return i.createElement("span",{className:"fileHoverCardUserName_598162d9"},e)};t.prototype._handleClickDismiss=function(e){this.context.logData("FileHoverCard.RecommendedActions.Dismiss",{recommendedActionId:this.state.recommendedActions[e].recommendationId});this.props.onDismiss(this.state.recommendedActions[e].recommendationId,e);this.state.recommendedActions.splice(e,1);this.setState({recommendedActions:this.state.recommendedActions})};return t})(i.Component);ne.contextType=_;var re=n(923),ie=n(1510),se=n(4111),oe=n(442),ue=(function(e){Object(r.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._conversation=function(e,n){var r=t._context(e),s=e.deepLink,o=t._getIconName(e.conversationType),u=t._participants(e),a=e.referencePreview,f=Object(V.n)(new Date(e.activityTimestamp));return i.createElement("div",{key:n},i.createElement("div",{className:"fileHoverCardConversation_11349dc8",onClick:function(){var e=window.open(s,"_blank");e&&e.focus();t.context.logData("FileHoverCard.Conversations.ClickDeepLink",{})}},i.createElement(G.e,{activityIcon:i.createElement(x.e,{iconName:o,className:"fileHoverCardConversationIcon_11349dc8"}),activityDescription:u,comments:i.createElement(i.Fragment,null,r,i.createElement("div",{className:"fileHoverCardConversationReferencePreview_11349dc8"},a)),timeStamp:f})))};return t}t.prototype.render=function(){var e=this.props.conversations;return i.createElement("div",{className:"fileHoverCardConversationsSection_11349dc8",style:q()?{borderTop:0}:{}},!q()&&i.createElement("div",{className:"fileHoverCardConversationsTitle_11349dc8"},L.o),e.slice(0,3).map(this._conversation))};t.prototype._context=function(e){var t=e.context,n=i.createElement(i.Fragment,null),r="fileHoverCardConversationContext_11349dc8";if(e.conversationType===se.e.CalendarEvent){t=A.format(L.x,e.context);n=i.createElement(x.e,{iconName:"Event",className:"fileHoverCardConversationsMeetingIcon_11349dc8"});r="fileHoverCardMeetingConversationContext_11349dc8"}var s=0===t.length?i.createElement(i.Fragment,null):i.createElement("div",{className:r},t);return i.createElement(i.Fragment,null,n,s)};t.prototype._participants=function(e){var t,n=this;t=e.participants.filter(function(t){return t.identity.displayName&&!n._isSharedByUser(t.identity.email,e.sharedByUserEmail,t.identity.displayName,e.sharedByUserDisplayName)}).map(function(e){return Object(W.e)(e.identity.email,n.props.loginUserEmail,n.props.userEmail)?L.Re:e.identity.displayName}).join(", ");var r=e.isSharedByMe?L.Re:e.sharedByUserDisplayName;return i.createElement("div",{className:"fileHoverCardConversationParticipants_11349dc8"},i.createElement("span",{className:"fileHoverCardConversationSharedByUser_11349dc8"},0===t.length?r:r+", "),t)};t.prototype._isSharedByUser=function(e,t,n,r){return e.toLowerCase()===t.toLowerCase()||n.toLowerCase()===r.toLowerCase()};t.prototype._getIconName=function(e){var t=e===se.e.CalendarEvent||e===se.e.Mail?Object(oe.n)({extension:"",brand:"outlook"}):Object(oe.n)({extension:"",brand:"teams"});if(t)return t.iconName};return t})(i.PureComponent);ue.contextType=_;var ae=n(148),fe=n(212),le=n(1230),ce=n(145),he=n(30),pe=n(9),de=n(1773),ve=n(225),me=n(546);function ge(e){return i.createElement("div",{className:"fileHoverCardRelatedFilesSection_048e12ce",style:q()?{borderTop:0}:{}},!q()&&i.createElement("div",{className:"fileHoverCardRelatedFilesTitle_048e12ce"},L.P),e.relatedFilesKeys.slice(0,3).map(function(e,t){return(function(e,t){return i.createElement(u.e,{key:t},function(n){var r=n.itemCache,s=r.demandItemFacet(f.h,e),o=(function(e){if(!e)return;var t=Object(de.n)({extension:e,size:16});return t?t.iconName:void 0})(null==s?void 0:s.split(".")[1]),u=Object(ve.r)(r,i.createElement(me.e,{itemKey:e,engagement:{name:"FileHoverCard.RelatedFiles.ClickDeepLink"}}));return i.createElement(d.n,{action:u},function(e){var n=e.execute;return i.createElement("div",{key:"relatedFile_".concat(t)},i.createElement("div",{className:"fileHoverCardRelatedFile_048e12ce",onClick:function(){n()}},i.createElement(G.e,{activityIcon:i.createElement(x.e,{iconName:o,className:"fileHoverCardRelatedFileIcon_048e12ce"}),activityDescription:i.createElement(i.Fragment,null,i.createElement("div",{className:"fileHoverCardRelatedFilesName_048e12ce"},s)),isCompact:!0})))})})})(e,t)}))}function ye(e){var t=e.itemKey,n=i.useContext(_),s=i.useRef(null),o=Object(i.useState)(!1),a=o[0],c=o[1],h=Object(i.useState)(!0),m=h[0],E=h[1],S=Object(i.useState)(!1),N=S[0],C=S[1],k=Object(i.useState)(!0),A=k[0],M=k[1],P=Object(i.useState)(!1),H=P[0],B=P[1],F=Object(i.useState)(!0),I=F[0],U=F[1],z=Object(i.useState)(!1),W=z[0],V=z[1],$=Object(i.useState)(!0),J=$[0],Q=$[1],G=Object(i.useState)(!1),Y=G[0],Z=G[1],ee=Object(i.useState)(!0),te=ee[0],ne=ee[1];i.useEffect(function(){s.current&&e.onCardExpand(s.current.clientHeight)});function se(e,t,r,i,s,o){i(!r);if(s){n.logData(e,t);o(!1)}}return i.createElement(u.e,null,function(n){var o=n.itemCache,u=(function(e,t){var n,r=e.demandItemFacet(f.n,t),i=r&&r.itemKey,s=e.demandItemFacet(l.h,i),o=e.demandItemFacet(l.p,i),u=e.demandItemFacet(l.o,i),a=e.demandItemFacet(l.e,i),c=e.demandItemFacet(l.s,i),h=e.demandItemFacet(l.u,i),p=e.demandItemFacet(g.N,y.e),d=e.demandItemFacet(f.d,t),v=a&&a.filter(function(e){return void 0!==e.access}),m=e.demandItemFacet(l.l,i),b=e.demandItemFacet(l.n,i);if(R()){var w=e.demandItemFacet(f.H,t),E=e.demandItemFacet(pe.e,w&&w.itemKey);n=E&&E.itemKeys}return{analyticsKey:r,itemAnalyticsKey:i,viewCount:s,viewerCount:o,isTrending:u,activities:a,incompleteData:c,keyPointsData:h,loginUser:p,itemName:d,viewActivities:v,actions:m,conversations:b,relatedItemKeys:n}})(o,t),h=u.itemAnalyticsKey,S=u.viewCount,k=u.viewerCount,_=u.isTrending,P=u.incompleteData,F=u.keyPointsData,z=u.loginUser,$=u.itemName,G=u.viewActivities,ee=u.actions,oe=u.conversations,de=u.relatedItemKeys,ve=Object(X.r)(o,t,2,!0),me=o.isItemFacetResolved(l.u,h)&&o.isItemFacetResolved(l.l,h)&&o.isItemFacetResolved(l.n,h)&&(!R()||o.isItemFacetResolved(f.H,t)),ye=o.isItemFacetResolved(ae.e,h),Ce=be(F),ke=$&&t&&we($.extension,ee),Le=Ee(oe),Ae=Se(G),Oe=xe(de),Me={keyPoints:Ce,recommendedActions:!!ke,conversations:Le,viewers:!!Ae,relatedFiles:Oe};if(me||ye)return i.createElement("div",{ref:s,className:Object(b.e)("fileHoverCardExpandedCard_2526b7ce",{isFluent:!0})},!!(z&&t&&h)&&ve.map(function(e){return(function(e,t,n,s,o){var u,a=Object(r.__assign)({},v.e.pack(function(){return{itemKeys:[n]}})),c=o.demandItemFacet(re.e,n),h=re.e.evaluate(c)(o,{itemKey:n}),m=h.checkInAction,g=h.undoCheckOutAction,y=h.policyTipAction,b=h.addMetadataAction,w={checkIn:m,undoCheckOut:g,viewPolicyTip:y,addMetadata:b},E=o.demandItemFacet(l.r,s),S=o.demandItemFacet(l.i,s);if(E){var x=o.demandItem({displayName:f.h,email:fe.e,image:fe.r,id:fe.i},E.itemKey);u={email:x.email||"",displayName:x.displayName||"",image:x.image||"",id:x.id||""}}var T=o.demandItemFacet(ie.e,n),N=ie.e.evaluate(T)(o,{itemKey:n,signalData:e}).onRenderLifeCycleSignal,C=Object(ce.n)(o).telemetry,k=Object(he.n)(o,{itemKey:n,engagement:{isIntentional:!0}});return i.createElement(p.e,{controlHandlers:a},i.createElement(d.r,{actions:w},function(n){var s=n.actions,o=s.checkIn,a=s.undoCheckOut,f=s.viewPolicyTip,l=s.addMetadata;return i.createElement(K,{lifeCycleSignalData:e,createdBy:u,createdDateTime:S,loginUserEmail:t.userLoginName,userEmail:t.userEmail,onViewPolicyTip:function(){C(O.e).logData(Object(r.__assign)({name:"FileHoverCard.LifeCycle.ViewPolicyTip"},k));f&&f.execute()},onAddMetadataNow:function(){C(O.e).logData(Object(r.__assign)({name:"FileHoverCard.LifeCycle.AddMetadata"},k));l&&l.execute()},onCheckIn:o&&o.isAvailable?function(){C(O.e).logData(Object(r.__assign)({name:"FileHoverCard.LifeCycle.FileCheckIn"},k));o&&o.execute()}:void 0,onDiscardCheckOut:a&&a.isAvailable?function(){C(O.e).logData(Object(r.__assign)({name:"FileHoverCard.LifeCycle.DiscardCheckOut"},k));a&&a.execute()}:void 0,onRenderLifeCycleSignal:N})}))})(e,z,t,h,o)}),i.createElement("div",{className:"fileHoverCardExpandedCardScrollableSection_2526b7ce"},q()&&i.createElement("div",{className:"collapsedFileCardTooltip_2526b7ce"},i.createElement(T.e,{content:L.i},i.createElement(x.e,{iconName:"info"}))),!!(Ce&&F&&t)&&(q()?i.createElement("div",{className:"fileCardExpandSectionContainer_2526b7ce",style:{border:0}},i.createElement(le.e,{className:"fileCardExpandSectionButton_2526b7ce",text:L.le,menuIconProps:{iconName:a?"ChevronUp":"ChevronDown"},onClick:function(){return se("FileHoverCard.KeyPointsExpanded",Me,a,c,m,E)}}),a&&Te(o,{keyPointsData:F,itemKey:t})):Te(o,{keyPointsData:F,itemKey:t})),ke&&h&&(q()?i.createElement("div",{className:"fileCardExpandSectionContainer_2526b7ce",style:Ce?{}:{border:0}},i.createElement(le.e,{className:"fileCardExpandSectionButton_2526b7ce",text:L.D,menuIconProps:{iconName:N?"ChevronUp":"ChevronDown"},onClick:function(){return se("FileHoverCard.RecommendedActionsExpanded",Me,N,C,A,M)}}),N&&Ne(o,{target:e.target,itemKey:t,itemAnalyticsKey:h})):Ne(o,{target:e.target,itemKey:t,itemAnalyticsKey:h})),D.e.isFeatureEnabled(j)&&de&&Oe&&(q()?i.createElement("div",{className:"fileCardExpandSectionContainer_2526b7ce",style:Ce||Oe?{}:{border:0}},i.createElement(le.e,{className:"fileCardExpandSectionButton_2526b7ce",text:L.P,menuIconProps:{iconName:Y?"ChevronUp":"ChevronDown"},onClick:function(){return se("FileHoverCard.RelatedFilesExpanded",Me,Y,Z,te,ne)}}),Y&&i.createElement(ge,{relatedFilesKeys:de,itemKey:t})):i.createElement(ge,{relatedFilesKeys:de,itemKey:t})),oe&&z&&Le&&(q()?i.createElement("div",{className:"fileCardExpandSectionContainer_2526b7ce",style:Ce||ke?{}:{border:0}},i.createElement(le.e,{className:"fileCardExpandSectionButton_2526b7ce",text:L.o,menuIconProps:{iconName:H?"ChevronUp":"ChevronDown"},onClick:function(){return se("FileHoverCard.ConversationsExpanded",Me,H,B,I,U)}}),H&&i.createElement(ue,{conversations:oe,loginUserEmail:z.userLoginName,userEmail:z.userEmail})):i.createElement(ue,{conversations:oe,loginUserEmail:z.userLoginName,userEmail:z.userEmail})),!(!Ae||!z)&&(q()?i.createElement("div",{className:"fileCardExpandSectionContainer_2526b7ce",style:Ce||ke||Le?{}:{border:0}},i.createElement(le.e,{className:"fileCardExpandSectionButton_2526b7ce",text:L.Ie,menuIconProps:{iconName:W?"ChevronUp":"ChevronDown"},onClick:function(){return se("FileHoverCard.ViewersExpanded",Me,W,V,J,Q)}}),W&&i.createElement("div",{className:"fileHoverCardActivitiesSection_2526b7ce",style:{borderTop:0}},i.createElement(w.e,{itemAnalytics:{activities:G||[],viewCount:S,viewerCount:k,isTrending:_,incompleteData:P},loginUserEmail:z.userLoginName,userEmail:z.userEmail}))):i.createElement("div",{className:"fileHoverCardActivitiesSection_2526b7ce"},i.createElement(w.e,{itemAnalytics:{activities:G||[],viewCount:S,viewerCount:k,isTrending:_,incompleteData:P},loginUserEmail:z.userLoginName,userEmail:z.userEmail})))))})}function be(e){var t=e&&e.readTime&&e.readTime.minutes;return!!(e&&e.keyPoints&&e.keyPoints.length>0)||!!t}function we(e,t){return Boolean(t&&t.length>0)&&(function(e,t){var n=e||t;return!!n&&I.indexOf(n)>-1})(void 0,e)}function Ee(e){return Boolean(e&&e.length>0)}function Se(e){return Boolean(e&&e.length>=1)}function xe(e){return Boolean(e&&e.length>0)}function Te(e,t){var n=t.keyPointsData,r=t.itemKey,s=e.demandItemFacet(re.e,r),o=re.e.evaluate(s)(e,{itemKey:r}),u={showKeyPoints:o.showKeyPointsPane,showFeedback:o.showFeedbackPane};return i.createElement(d.r,{actions:u},function(e){var t=e.actions,r=t.showKeyPoints,s=t.showFeedback,o=r&&r.isAvailable?r.execute:void 0,u=s&&s.isAvailable?s.execute:void 0;return i.createElement(U,{keyPointsData:n,onKeyPointsClick:o,onSendFeedbackClick:u})})}function Ne(e,t){var n=t.target,r=t.itemKey,s=t.itemAnalyticsKey,o=e.demandItemFacet(l.l,s),u=[],a=e.demandItemFacet(f.O,r),c=e.demandItemFacet(l.e,s),v=e.demandItemFacet(g.N,y.e),b=c&&c.filter(function(e){return void 0!==e.edit}),w=e.demandItemFacet(re.e,r),E=re.e.evaluate(w)(e,{itemKey:r}).onDismiss;return i.createElement(p.e,{controlHandlers:m.e.pack(function(){return{defaultRecipients:u?u.map(function(e){return e.email}):[]}})},i.createElement(d.n,{action:i.createElement(h.ItemShareAction,{itemKeys:[r]})},function(e){var t=e.execute;return o&&E&&i.createElement(ne,{actions:{recommendedActions:o,shareWith:u,editActivities:b},loginUserEmail:v&&v.userLoginName,userEmail:v&&v.userEmail,pageUrl:a,onDismiss:E,onShareWith:function(e,r){e.target=n;e.persist();t({event:e})}})}))}var Ce=n(1320),ke=n(1165),Le=n(4837);function Ae(e){var t=e.itemKey,n=i.useRef(null);i.useEffect(function(){n.current&&e.updateCardHeight(n.current.clientHeight)});return i.createElement(u.e,null,function(s){var o,u=s.itemCache,a=u.demandItemFacet(f.d,t),c=a&&a.name,m=a&&a.extension,g=u.demandItemFacet(f.n,t),y=g&&g.itemKey,w=i.createElement("div",{className:Object(b.e)("fileHoverCardCompactCardTitle_2526b7ce",(o={},o.titleNotExpanded_2526b7ce=!n.current,o)),id:"ms-FileHoverCard-title","aria-label":A.format(L.ue,c)},c),E=i.createElement("div",{className:"fileHoverCardCompactCardTitleRegion_2526b7ce"},i.createElement(ke.e,{className:"fileHoverCardCompactCardFileIcon_2526b7ce",extension:m,size:32}),w);return i.createElement("div",{ref:n,className:Object(b.e)("fileHoverCardCompactCard_2526b7ce",{isFluent:!0})},E,!(!t||!y)&&(function(e,t,n,s){var o=e.demandItemFacet(l.h,n),u=e.demandItemFacet(l.p,n),a=e.demandItemFacet(l.f,n),c=e.demandItemFacet(l.t,n),m=e.demandItemFacet(f.O,t),g=e.demandItemFacet(l.e,n),y=g&&g.filter(function(e){return void 0!==e.access}),b=Object(ce.n)(e).telemetry,w=Object(he.n)(e,{itemKey:t,engagement:{isIntentional:!0}}),E=e.isItemFacetResolved(l.h,n)||e.isItemFacetResolved(ae.e,n)?{activities:y||[],viewCount:o,viewerCount:u,likeCount:a,commentCount:c}:void 0,S=e.demandItemFacet(re.e,t),x=re.e.evaluate(S)(e,{itemKey:t}),T=x.showDetailsPane,N=x.showFileAnalytics,C={showDetails:T,showItemAnalytics:N,shareAction:i.createElement(h.ItemShareAction,{itemKeys:[t]})},k=Object(r.__assign)({},v.e.pack(function(){return{itemKeys:[t]}}));return i.createElement(p.e,{controlHandlers:k},i.createElement(d.r,{actions:C},function(e){var n=e.actions,o=n.showDetails,u=n.showItemAnalytics,a=n.shareAction,f=o&&o.execute?function(){b(O.e).logData(Object(r.__assign)({name:"FileHoverCard.SeeDetailsClick"},w));o.execute().catch(function(){})}:void 0,l=u&&u.execute?function(){b(O.e).logData(Object(r.__assign)({name:"FileHoverCard.ViewCountClick"},w));u.execute().catch(function(){})}:void 0,c=a&&a.isAvailable?function(e){if(e&&s){e.target=s;e.persist();a.execute({event:e});b(O.e).logData(Object(r.__assign)({name:"FileHoverCard.CommandBar.ShareClick"},w))}}:void 0,h=Object(r.__spreadArray)([],o&&o.isAvailable?[{key:"details",title:L.Ne,name:L.Ne,ariaLabel:L.Ne,onClick:f}]:[],!0),p={key:"share",iconProps:{iconName:"share"},title:L.R,onClick:c},d={itemAnalytics:E,isCompact:!0,isLink:u&&u.isAvailable,pageUrl:m,onClick:l,itemKey:t},v=[];c&&v.push(p);D.e.isFeatureEnabled(H)&&Ce.e.action&&Ce.e.onClick&&v.unshift(Object(r.__assign)(Object(r.__assign)({},Ce.e),{iconOnly:!0,name:void 0}));return i.createElement(Le.e,{itemKey:t,analyticsStats:d,items:v,withFacePile:!0,farItems:h})}))})(u,t,y,e.target))})}var Oe=n(40),Me=n(80),_e=n(795),De=n(501),Pe=n(45),He=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._dynamicCompactCardHeight=function(e){n.state.compactCardHeight!==e&&n.setState({compactCardHeight:e})};n._dynamicExpandedCardHeight=function(e){var t=n.state.expandedCardHeight;e&&t!==e&&n.setState({expandedCardHeight:e})};n.state={visible:!1,expandedCardHeight:1,compactCardHeight:131};n._isFirstTimeOpenCard=!0;return n}t.prototype.componentDidCatch=function(e,t){this._hoverCardRenderQos&&this._hoverCardRenderQos.end({error:"".concat(e.name,"_").concat(e.message),extraData:{stack:e.stack,errorInfo:JSON.stringify(t)},resultCode:e.name,resultType:Oe.e.Failure})};t.prototype.render=function(){var e=this,t=this.props,n=t.itemKey,a=t.cardDismissDelay,f=void 0===a?300:a,h=t.directionalHint,p=void 0===h?o.e.rightTopEdge:h,d=t.gapSpace,v=void 0===d?8:d,m=t.target;if(!n||!m)return null;var g,y,b,w,E,S={expandedCardScroll:"fileHoverCardExpandedCardHostScroll_2526b7ce"},x=Object(r.__assign)({root:{boxShadow:Object(c._)().effects.elevation16,borderRadius:"2px",width:"320px",selectors:{".ms-Callout-main":{borderRadius:"2px"}}},expandedCard:[{selectors:{":before":{display:"none"}}}]},S),T=new M(this.props.telemetry(O.e));return i.createElement(u.e,null,function(t){var r=t.itemCache;if(e.state.visible){var o=e._demandFacets(r),u=o.itemAnalyticsKey,a=o.keyPointsData,c=o.itemName,h=o.recommendedActions,d=o.conversations,S=o.viewActivities,N=o.relatedItemKeys,C=r.isItemFacetResolved(l.h,u),k=r.isItemFacetResolved(ae.e,u),L=k?r.demandItemFacet(ae.e,u):void 0;e._errorMessage=L&&L.message;e._isViewCountDataError=k&&!C;g=be(a);y=!!c&&we(c.extension,h);b=Ee(d);w=Se(S);E=xe(N);if(r.demandItemFacet(ae.e,n,{suppressGetItems:!0}))return null}var A=Object(he.n)(r,{itemKey:n,engagement:{isIntentional:!0}});T.engagementData=A;var O={onRenderCompactCard:function(){return i.createElement(Ae,{itemKey:n,target:m,updateCardHeight:e._dynamicCompactCardHeight})},onRenderExpandedCard:function(){return i.createElement(ye,{itemKey:n,target:m,onCardExpand:function(t){return e._onCardExpand(t,A)}})},compactCardHeight:e.state.compactCardHeight,expandedCardHeight:e.state.expandedCardHeight,directionalHint:p,directionalHintFixed:!1,gapSpace:v,styles:x};return i.createElement(ce.e,{withContext:{component:"FileHoverCard"}},i.createElement(_.Provider,{value:T},i.createElement(s.e,{expandingCardProps:O,cardDismissDelay:f,expandedCardOpenDelay:500,target:e.props.target,onCardVisible:function(){return e._onCardOpen(A)},onCardHide:function(){return e._onCardHide(A,g,y,b,w,E)},trapFocus:!0})))})};t.prototype._demandFacets=function(e){var t,n=e.demandItemFacet(f.n,this.props.itemKey),r=n&&n.itemKey,i=e.demandItemFacet(l.u,r),s=e.demandItemFacet(f.d,this.props.itemKey),o=e.demandItemFacet(l.l,r),u=e.demandItemFacet(l.n,r),a=e.demandItemFacet(l.e,r),c=a&&a.filter(function(e){return void 0!==e.access});if(R()){var h=e.demandItemFacet(f.H,this.props.itemKey),p=e.demandItemFacet(pe.e,h&&h.itemKey);t=p&&p.itemKeys}return{analyticsKey:n,itemAnalyticsKey:r,keyPointsData:i,itemName:s,recommendedActions:o,conversations:u,activities:a,viewActivities:c,relatedItemKeys:t}};t.prototype._onCardOpen=function(e){var t=this,n=this.props.itemCacheDispatch;n(Object(_e.e)(function(e){return t._demandFacets(e)},{flushOperationQueue:!0}));n(Object(De.e)());this.props.telemetry(O.e).logData(Object(r.__assign)({name:"FileHoverCard.CompactCardOpen"},e));this._cardOpenTimeStamp=Date.now();this.setState({visible:!0});this._isFirstTimeOpenCard&&(this._hoverCardRenderQos=new(this.props.telemetry(Me.e))({name:"ItemScope_FileHoverCardRender"}))};t.prototype._onCardHide=function(e,t,n,i,s,o){var u=Date.now()-this._cardOpenTimeStamp,a=this.state.expandedCardHeight>1,f=a&&u>2500?"FileHoverCard.DwellTimeLong":"FileHoverCard.DwellTime";this.props.telemetry(O.e).logData(Object(r.__assign)(Object(r.__assign)({name:f},e),{extraData:Object(r.__assign)(Object(r.__assign)({},e.extraData),{time:u,compactCardOpen:1===this.state.expandedCardHeight,expandedCardOpen:a,keyPoints:t,recommendedActions:n,conversations:i,viewers:s,relatedFiles:o})}));if(this._isFirstTimeOpenCard){this._hoverCardRenderQos.end({resultType:Oe.e.Success});this._isFirstTimeOpenCard=!1}this.setState({visible:!1})};t.prototype._onCardExpand=function(e,t){this._dynamicExpandedCardHeight(e);if(!this._isCardExpanded&&e>1){this.props.telemetry(O.e).logData(Object(r.__assign)({name:"FileHoverCard.ExpandedCardOpen"},t));this._isCardExpanded=!0}if(this._isFirstTimeOpenCard){this._isViewCountDataError?this._hoverCardRenderQos.end({resultType:Oe.e.Failure,resultCode:"NoViewCount",error:this._errorMessage}):this._hoverCardRenderQos.end({resultType:Oe.e.Success});this._isFirstTimeOpenCard=!1}};t.defaultProps={itemKey:""};return t})(i.Component),Be=Object(Pe.e)()(Object(ce.r)()(He)),je=Object(a.e)()(Be)},5309:function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(0),i=n("react-lib"),s=n(3996),o=n(2504),u=n(37),a=n(1090),f=n(580),l=n(1746),c=n(1554),h=n(119),p=n(1925),d=n(18),v=n(3225),m=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onClick=function(){n.setState({isContextualMenuVisible:!n.state.isContextualMenuVisible})};n._onDismiss=function(e){n.setState({isContextualMenuVisible:!1});e.stopPropagation();e.preventDefault()};n.state={isContextualMenuVisible:!1};return n}t.prototype.render=function(){var e=this.props,t=e.item,n=e.onRemoveItem,a=e.index,m=e.selected,g=this._convertIPersonToIPersonaProps(t),y="PickerPersonaId"+Math.floor(1e4*Math.random()),b=d.format(v.n,t.name);return i.createElement("div",{className:Object(u.e)("ms-PickerPersonaMenu-container",{"is-selected":!!m}),"data-selection-index":a,key:a,"data-is-focusable":!0,"aria-labelledby":y},i.createElement(p.e,{className:"ms-PickerPersona-item"},i.createElement("div",{className:"ms-PickerPersona-content"},i.createElement(s.e,Object(r.__assign)({id:y},g,{presence:o.t.none,size:o.n.small,secondaryText:this.props.menuTitle&&!this.props.menuItems?this.props.menuTitle:void 0,"aria-label":v.e}),this.props.menuTitle&&this.props.menuItems&&i.createElement("div",{className:"ms-sitePerm-ContextMenu"},i.createElement("div",{className:"ms-sitePerm-buttonArea",ref:this._resolveRef("_buttonTarget")},i.createElement("span",{className:"ms-sitePerm-linkText",onClick:this._onClick,"data-is-focusable":!0,role:"button","aria-haspopup":!0},this.props.menuTitle,i.createElement(f.e,{iconName:"ChevronDown",className:"ms-sitePermMenu-chevron"}))),this.state.isContextualMenuVisible&&i.createElement(c.e,{items:this.props.menuItems,isBeakVisible:!1,target:this._buttonTarget,directionalHint:h.e.bottomLeftEdge,onDismiss:this._onDismiss,gapSpace:0})))),i.createElement("div",{className:"ms-PickerItem-sideContent"},i.createElement(l.e,{onClick:n,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content",ariaLabel:b}))))};t.prototype._convertIPersonToIPersonaProps=function(e){return{text:e.name?e.name:"",imageUrl:e.image?e.image:"",tertiaryText:e.email?e.email:"",secondaryText:e.job?e.job:"",imageInitials:""}};return t})(a.e)}}]);