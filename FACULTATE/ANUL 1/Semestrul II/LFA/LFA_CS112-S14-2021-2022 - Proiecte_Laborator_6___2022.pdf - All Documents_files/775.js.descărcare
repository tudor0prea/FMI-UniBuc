(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[775],{2031:function(e,t,n){"use strict";var r,i=n(0),s=(function(){function e(){}e.tokenCacheSessionStorageId="tokenCache";e.aboutToExpireIntervalSeconds=600;e.apiUrl="/_api/SP.OAuth.Token/Acquire";e.retries=3;e.retriableErrorCodes=[10006,10008];e.unexpectedErrorCodeFormat="Expected error code format is <numericCode>, <exception class name>";e.unexpectedTokenMessageFormat="Your token request succeedeed but the token could not be parsed from the response.This is most probably caused by a change in the server response format";e.npmPackageVersion="0.1.5";return e})();(function(e){e[e.unknownError=0]="unknownError";e[e.malformedResponseBody=1]="malformedResponseBody";e[e.serverError=2]="serverError"})(r||(r={}));var o=(function(e){Object(i.__extends)(t,e);function t(n,r){var i=e.call(this,r.message)||this;i.__proto__=t.prototype;i._type=n;i._httpResponseStatus=r.httpResponseStatus;i._cultureName=r.cultureName;i._message=r.message;i._serverErrorCode=r.serverErrorCode;i._correlationId=r.correlationId;i._redirectUrl=r.redirectUrl;return i}Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0});Object.defineProperty(t.prototype,"serverErrorCode",{get:function(){if(this.type!==r.serverError)throw new Error("ServerErrorCode can only be obtained for errors of type serverError");return this._serverErrorCode},enumerable:!1,configurable:!0});Object.defineProperty(t.prototype,"httpResponseStatus",{get:function(){return this._httpResponseStatus},enumerable:!1,configurable:!0});Object.defineProperty(t.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0});Object.defineProperty(t.prototype,"cultureName",{get:function(){return this._cultureName},enumerable:!1,configurable:!0});Object.defineProperty(t.prototype,"correlationId",{get:function(){return this._correlationId},enumerable:!1,configurable:!0});Object.defineProperty(t.prototype,"redirectUrl",{get:function(){return this._redirectUrl},enumerable:!1,configurable:!0});return t})(Error),u=(function(){function e(e){var t=this;this._context=e;this._dispose=this._dispose.bind(this);window.addEventListener("unload",this._dispose);window._spPageOnMediaTokenReceived=function(){t._receiveMediaServiceFlushedToken()};window._spMSBTLoaded=function(){t._receiveMediaServiceFlushedToken()}}e._getCorrelationId=function(e){return e.headers.get("sprequestguid")};e._extractRealError=function(e){return e.hasOwnProperty("error")?e.error:e};e.prototype.getOAuthToken=function(e,t){return this.getInstrumentedOAuthToken(e,t).then(function(e){if(e)return e.tokenInfo})};e.prototype.getInstrumentedOAuthToken=function(e,t){var n=this;this._receiveMediaServiceFlushedToken();var r=this._getCachedTokenData(e);if(r&&!this._isExpiring(r)){var i={token:r.accessToken,isGuest:!1,expirationTimeMs:r.expiresOn};return Promise.resolve({tokenInfo:i,spRequestId:r.correlationId,spRequestTimestamp:r.requestTimestamp})}return this._retriableFetchWithDigest(e,s.retries,t).then(function(t){n._storeTokenData(e,t);return{tokenInfo:{token:t.accessToken,isGuest:!1,expirationTimeMs:t.expiresOn},spRequestId:t.correlationId,spRequestTimestamp:t.requestTimestamp}})};e.prototype.clearCachedToken=function(e){var t=this._getCacheKey(e);window.sessionStorage.removeItem(t);var n=this._resourceKeys.indexOf(t);!isNaN(n)&&n>-1&&this._resourceKeys.splice(n)};Object.defineProperty(e.prototype,"_resourceKeys",{get:function(){this._keysToDispose||(this._keysToDispose=new Array);return this._keysToDispose},enumerable:!1,configurable:!0});e.prototype._retriableFetchWithDigest=function(t,n,i){var s=this,u=this._context.qosMonitor(),a=Date.now();return this._context.fetchWithDigest(this._buildTokenRequest(t,i)).then(function(f){if(200!==f.status){s._context.logger.logError("fetchWithDigest failed. Server responded with "+f.statusText);var l=new o(r.unknownError,{httpResponseStatus:f.status,message:f.statusText,correlationId:e._getCorrelationId(f)});if(400!==f.status){u.writeUnexpectedFailure("UnknownError",l);return Promise.reject(l)}return f.json().then(function(r){var o=e._extractRealError(r),a=s._getErrorCodeFromResponseCode(o);if(!s._isRetriableError(a)||0===n){var f=s._buildErrorFromResponse(o);u.writeUnexpectedFailure("SharepointServerError",f);return Promise.reject(f)}s._context.logger.logError("fetchWithDigest failed. Retrying. Retries left: "+n);return s._retriableFetchWithDigest(t,n-1,i)})}return s._instrumentedParseResponseData(f,u,a)})};e.prototype._getCachedTokenData=function(e){return JSON.parse(window.sessionStorage.getItem(this._getCacheKey(e)))};e.prototype._storeTokenData=function(e,t){window.sessionStorage.setItem(this._getCacheKey(e),JSON.stringify(t))};e.prototype._getCacheKey=function(e){var t=["sp-client-shared",s.npmPackageVersion,"OAuthUtility",e].join(";");-1===this._resourceKeys.indexOf(t)&&this._resourceKeys.push(t);return t};e.prototype._isExpiring=function(e){return e.expiresOn-Date.now()/1e3<s.aboutToExpireIntervalSeconds};e.prototype._isRetriableError=function(e){return-1!==s.retriableErrorCodes.indexOf(e)};e.prototype._buildTokenRequest=function(e,t){var n=new Headers;n.append("Content-Type","application/json; charset=utf-8");n.append("Odata-Version","4.0");n.append("Accept","application/json;odata.metadata=minimal");var r={method:"POST",headers:n,body:JSON.stringify(this._buildRequestBody(e))},i=t;i&&i.lastIndexOf("/")===i.length-1&&(i=i.substr(0,i.length-1));return new Request(i+s.apiUrl,r)};e.prototype._buildRequestBody=function(e){return{resource:e}};e.prototype._buildErrorFromResponse=function(e){var t,n,i=this._getErrorCodeFromResponseCode(e);if(void 0===i)return new o(r.malformedResponseBody,{httpResponseStatus:400,message:s.unexpectedErrorCodeFormat,correlationId:e.correlationId});if(e.message)if("string"==typeof e.message)t=e.message;else{t=e.message.value;n=e.message.lang}return new o(r.serverError,{httpResponseStatus:400,message:t,cultureName:n,serverErrorCode:i,correlationId:e.correlationId,redirectUrl:e["error.redirectUrl"]||e["@".concat("error.redirectUrl")]})};e.prototype._getErrorCodeFromResponseCode=function(e){var t=e.code,n=Number(t);if(isNaN(n)&&"string"==typeof e.message){var r=t.indexOf(",");-1!==r&&(n=Number(t.substr(0,r)))}return n};e.prototype._instrumentedParseResponseData=function(t,n,i){try{return t.json().then(function(r){n.writeSuccess();return{accessToken:r.access_token,expiresOn:Number(r.expires_on),notBefore:Number(r.not_before),resource:r.resource,tokenType:r.token_type,correlationId:e._getCorrelationId(t),requestTimestamp:i}})}catch(i){n.writeUnexpectedFailure("ResponseParseError",i);return Promise.reject(new o(r.malformedResponseBody,{httpResponseStatus:200,message:s.unexpectedTokenMessageFormat,correlationId:e._getCorrelationId(t)}))}};e.prototype._dispose=function(e){window.removeEventListener("unload",this._dispose);for(var t=0,n=this._resourceKeys;t<n.length;t++){var r=n[t];window.sessionStorage.removeItem(r)}};e.prototype._receiveMediaServiceFlushedToken=function(){if(window._spMSBT){var e={tokenType:window._spMSBT.TokenType,expiresOn:window._spMSBT.ExpiresOn,notBefore:void 0,resource:window._spMSBT.Resource,accessToken:window._spMSBT.AccessToken};this._storeTokenData(e.resource,e);window._spMSBT=void 0}};return e})(),a=n(641),f=n(59),l=n(94),c=n(80),h=n(40),p=(function(){function e(){this._qos=new c.e({name:"OAuthTokenDataSource"})}e.prototype.writeSuccess=function(){this._qos.end({resultType:h.e.Success})};e.prototype.writeUnexpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:h.e.Failure,error:JSON.stringify(t)})};e.prototype.writeExpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:h.e.ExpectedFailure,error:JSON.stringify(t)})};return e})(),d=(function(){function e(){}e.prototype.logWarning=function(e){};e.prototype.logError=function(e){};return e})(),v=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,{},{pageContext:t})||this;r.logger=new d;if(n){n.logger&&(r.logger=n.logger);n.useAbsoluteUrlForOAuth&&(r._useAbsoluteUrlForOAuth=n.useAbsoluteUrlForOAuth)}r._oAuthUtility=new u(r);return r}t.prototype.qosMonitor=function(){return new p};Object.defineProperty(t.prototype,"webUrl",{get:function(){return this._useAbsoluteUrlForOAuth?this._pageContext.webAbsoluteUrl:Object(l.n)(this._pageContext)},enumerable:!1,configurable:!0});t.prototype.fetchWithDigest=function(e){var t=this;return e.text().then(function(n){var r=e.headers.get("Content-Type");e.headers.delete("Content-Type");return t._odspPromiseToEs6Promise(t.getData(function(){return e.url},function(e,t){return new Response(e,{status:t.getStatus(),headers:t.getResponseHeadersDictionary()})},"DelegationTokenDataSource",function(){return n},"POST",t._getRequestHeadersDictionary(e),r,void 0,!0).then(function(e){return e},function(e){return new Response(JSON.stringify(e),{status:e.status})}))})};t.prototype.getToken=function(e,t){t&&this._oAuthUtility.clearCachedToken(e);return this._es6PromiseToOdspPromise(this._oAuthUtility.getOAuthToken(e,this.webUrl).then(function(e){return e.token}))};t.prototype.getInstrumentedToken=function(e,t){t&&this._oAuthUtility.clearCachedToken(e);return this._es6PromiseToOdspPromise(this._oAuthUtility.getInstrumentedOAuthToken(e,this.webUrl))};t.prototype._getRequestHeadersDictionary=function(e){var t=e.headers,n={};t.forEach(function(e,t){n[t]=e});return n};t.prototype._odspPromiseToEs6Promise=function(e){return new Promise(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})};t.prototype._es6PromiseToOdspPromise=function(e){return new f.n(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})};return t})(a.t);t.e=v},2504:function(e,t,n){"use strict";n.d(t,"n",function(){return r});n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r,i,s;(function(e){e[e.tiny=0]="tiny";e[e.extraExtraSmall=1]="extraExtraSmall";e[e.extraSmall=2]="extraSmall";e[e.small=3]="small";e[e.regular=4]="regular";e[e.large=5]="large";e[e.extraLarge=6]="extraLarge";e[e.size8=17]="size8";e[e.size10=9]="size10";e[e.size16=8]="size16";e[e.size24=10]="size24";e[e.size28=7]="size28";e[e.size32=11]="size32";e[e.size40=12]="size40";e[e.size48=13]="size48";e[e.size56=16]="size56";e[e.size72=14]="size72";e[e.size100=15]="size100";e[e.size120=18]="size120"})(r||(r={}));(function(e){e[e.none=0]="none";e[e.offline=1]="offline";e[e.online=2]="online";e[e.away=3]="away";e[e.dnd=4]="dnd";e[e.blocked=5]="blocked";e[e.busy=6]="busy"})(i||(i={}));(function(e){e[e.lightBlue=0]="lightBlue";e[e.blue=1]="blue";e[e.darkBlue=2]="darkBlue";e[e.teal=3]="teal";e[e.lightGreen=4]="lightGreen";e[e.green=5]="green";e[e.darkGreen=6]="darkGreen";e[e.lightPink=7]="lightPink";e[e.pink=8]="pink";e[e.magenta=9]="magenta";e[e.purple=10]="purple";e[e.black=11]="black";e[e.orange=12]="orange";e[e.red=13]="red";e[e.darkRed=14]="darkRed";e[e.transparent=15]="transparent";e[e.violet=16]="violet";e[e.lightRed=17]="lightRed";e[e.gold=18]="gold";e[e.burgundy=19]="burgundy";e[e.warmGray=20]="warmGray";e[e.coolGray=21]="coolGray";e[e.gray=22]="gray";e[e.cyan=23]="cyan";e[e.rust=24]="rust"})(s||(s={}))},2505:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(2504),i=[r.e.lightBlue,r.e.blue,r.e.darkBlue,r.e.teal,r.e.green,r.e.darkGreen,r.e.lightPink,r.e.pink,r.e.magenta,r.e.purple,r.e.orange,r.e.lightRed,r.e.darkRed,r.e.violet,r.e.gold,r.e.burgundy,r.e.warmGray,r.e.cyan,r.e.rust,r.e.coolGray],s=i.length;function o(e){var t=e.primaryText,n=e.text,o=e.initialsColor;return"string"==typeof o?o:(function(e){switch(e){case r.e.lightBlue:return"#4F6BED";case r.e.blue:return"#0078D4";case r.e.darkBlue:return"#004E8C";case r.e.teal:return"#038387";case r.e.lightGreen:case r.e.green:return"#498205";case r.e.darkGreen:return"#0B6A0B";case r.e.lightPink:return"#C239B3";case r.e.pink:return"#E3008C";case r.e.magenta:return"#881798";case r.e.purple:return"#5C2E91";case r.e.orange:return"#CA5010";case r.e.red:return"#EE1111";case r.e.lightRed:return"#D13438";case r.e.darkRed:return"#A4262C";case r.e.transparent:return"transparent";case r.e.violet:return"#8764B8";case r.e.gold:return"#986F0B";case r.e.burgundy:return"#750B1C";case r.e.warmGray:return"#7A7574";case r.e.cyan:return"#005B70";case r.e.rust:return"#8E562E";case r.e.coolGray:return"#69797E";case r.e.black:return"#1D1D1D";case r.e.gray:return"#393939"}})(o=void 0!==o?o:(function(e){var t=r.e.blue;if(!e)return t;for(var n=0,o=e.length-1;o>=0;o--){var u=e.charCodeAt(o),a=o%8;n^=(u<<a)+(u>>8-a)}return t=i[n%s]})(n||t))}},3204:function(e,t,n){"use strict";var r,i=n(59),s=n(80),o=n(40);(function(e){e[e.InteractionRequired=10013]="InteractionRequired"})(r||(r={}));var u=(function(){function e(e,t){void 0===e&&(e={});this._dataSource=t.oAuthTokenDataSource}e.prototype.getToken=function(e,t){var n=new s.e({name:"getToken"});return this._dataSource.getToken(e,t).then(function(e){n.end({resultType:o.e.Success});return e},function(e){n.end({resultType:o.e.Failure});return i.n.reject(e)})};e.prototype.getInstrumentedToken=function(e,t){var n=new s.e({name:"getToken"});return this._dataSource.getInstrumentedToken(e,t).then(function(e){n.end({resultType:o.e.Success});return e},function(e){n.end({resultType:o.e.Failure});return i.n.reject(e)})};return e})();t.e=u},3231:function(e,t,n){window,e.exports=(function(e){function t(t){for(var n,i,s=t[0],o=t[1],u=0,f=[];u<s.length;u++)i=s[u],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&f.push(r[i][0]),r[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(a&&a(t);f.length;)f.shift()()}var n={},r={1:0};function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var s=new Promise(function(t,i){n=r[e]=[t,i]});t.push(n[2]=s);var o,u=document.createElement("script");u.charset="utf-8",u.timeout=120,i.nc&&u.setAttribute("nonce",i.nc),u.src=(function(e){return i.p+""+({0:"feed-bootstrapper",2:"topic-card-bootstrapper",3:"vendors~aria-webjs-sdk"}[e]||e)+"_"+{0:"4fd00bd2c530dea78b23",2:"8a6b7f2870b8978a311c",3:"98116dba6251f48431a2"}[e]+".js"})(e),0!==u.src.indexOf(window.location.origin+"/")&&(u.crossOrigin="anonymous");var a=new Error;o=function(t){u.onerror=u.onload=null,clearTimeout(f);var n=r[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src;a.message="Loading chunk "+e+" failed.\n("+i+": "+s+")",a.name="ChunkLoadError",a.type=i,a.request=s,n[1](a)}r[e]=void 0}};var f=setTimeout(function(){o({type:"timeout",target:u})},12e4);u.onerror=u.onload=o,document.head.appendChild(u)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="https://lpcres.delve.office.com/lpc/versionless/",i.oe=function(e){throw console.error(e),e};var s=window.webpackJsonpMidgardBootstrapper=window.webpackJsonpMidgardBootstrapper||[],o=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var a=o;return i(i.s=11)})([function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e,t,n,r,i){this.name=e,this.message=t,this.rootCorrelationId=n,this.statusCode=r,this.numberOfRetries=i}},function(e,t,n){"use strict";var r;n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i}),(function(e){e.getAuthToken="GetAuthTokenDuration",e.getAuthTokenFromStart="GetAuthTokenFromStartDuration",e.getLokiConfig="GetLokiConfigDuration",e.getLokiConfigFromStart="GetLokiConfigFromStartDuration",e.getLpcBundles="GetLpcBundlesDuration",e.getLpcBundlesFromStart="GetLpcBundlesFromStartDuration",e.startLpc="StartLpcDuration",e.startLpcFromStart="StartLpcFromStartDuration",e.getOfficeFeedBundles="GetOfficeFeedBundlesFromStartDuration"})(r||(r={}));var i=(function(){function e(e){this.targetWindow=e,this.start=this.getCurrentTime(),this.timings={}}return e.prototype.measureFromStart=function(e){this.timings[e]=Math.round(this.getCurrentTime()-this.start)},e.prototype.startCustomTiming=function(e){try{this.targetWindow.performance.mark(e+"-start")}catch(e){}},e.prototype.endCustomTiming=function(e){try{this.targetWindow.performance.mark(e+"-end"),this.targetWindow.performance.measure(e,e+"-start",e+"-end");var t=this.targetWindow.performance.getEntriesByName(e)[0];this.timings[e]=Math.round(t.duration)}catch(e){}},e.prototype.getAllTimings=function(){var e=this;try{var t=this.targetWindow.performance.getEntriesByType("resource");t&&t.forEach(function(t){if(t&&t.name){var n=t.name.toLowerCase(),r=!1;-1!==n.indexOf("authtoken/loki")||-1!==n.indexOf("service.svc?action=getclientaccesstoken&ep=1&app=mail")?(n="AuthRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacard_")?(n="LpcBundleRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacardstrings")?(n="LpcStringsRequestDuration",r=!0):-1!==n.indexOf("/api/v1/configuration/")&&(n="InitConfigRequestDuration",r=!0),r&&(e.timings[n]=Math.round(t.duration))}})}catch(e){}return this.timings},e.prototype.getCurrentTime=function(){return this.targetWindow.performance&&"function"==typeof this.targetWindow.performance.now?performance.now():Date.now()},e})()},function(e,t,n){"use strict";var r=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,u)}a((r=r.apply(e,t||[])).next())})},i=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return(function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}})([s,u])}}},s=(function(){function e(e){this.bootstrapperConfig=e,this.loggers=new Map}return e.prototype.logEventAsync=function(e,t){return r(this,void 0,void 0,function(){return i(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,this.getLoggerAsync(t)];case 1:return n.sent().logEvent(e),[4,this.getLogManagerAsync()];case 2:return n.sent().flush(this.noOp),[3,4];case 3:return n.sent(),console.log("Live Persona Card ERROR: Failed to log an event to Aria"),[3,4];case 4:return[2]}})})},e.prototype.updateContextWithLokiDataAsync=function(e,t){return r(this,void 0,void 0,function(){var n;return i(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.getLoggerAsync(t)];case 1:return(n=r.sent()).setContext("LokiUrl",e.LokiUrl),n.setContext("tenantAadObjectId",e.TenantAadObjectId),n.setContext("userAadObjectId",e.UserAadObjectId),n.setContext("userPuid",e.UserPuid),[3,3];case 2:throw r.sent(),new Error("Live Persona Card ERROR: Failed to update Aria's context");case 3:return[2]}})})},e.prototype.getLoggerAsync=function(e){return r(this,void 0,void 0,function(){var t,n,r;return i(this,function(i){switch(i.label){case 0:return(t=this.loggers.get(e))?[3,3]:[4,this.getLogManagerAsync()];case 1:return n=i.sent(),[4,this.getCollectorUrlAsync()];case 2:r=i.sent(),(t=n.initialize(e,{collectorUri:r}))||(t=n.getLogger(e)),this.loggers.set(e,t),t.setContext("culture",this.bootstrapperConfig.culture),t.setContext("region",this.bootstrapperConfig.region),t.setContext("clientType",this.bootstrapperConfig.clientType),t.setContext("clientContextType",this.bootstrapperConfig.clientContextType),t.setContext("clientCorrelationId",this.bootstrapperConfig.clientCorrelationId),t.setContext("bootstrapperVersion","1.20200108.3.0"),t.setContext("complianceEnvironment",this.bootstrapperConfig.complianceEnvironment),i.label=3;case 3:return[2,t]}})})},e.prototype.getLogManagerAsync=function(){return r(this,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return[4,n.e(3).then(n.t.bind(null,43,7))];case 1:return[2,e.sent().AWTLogManager]}})})},e.prototype.getCollectorUrlAsync=function(){return r(this,void 0,void 0,function(){var e;return i(this,function(t){switch(t.label){case 0:return[4,n.e(3).then(n.t.bind(null,43,7))];case 1:switch(e=t.sent(),this.bootstrapperConfig.complianceEnvironment){case"Blackforest":return[2,e.AWT_COLLECTOR_URL_GERMANY];case"GccHigh":return[2,e.AWT_COLLECTOR_URL_USGOV_DOJ];case"DoD":return[2,e.AWT_COLLECTOR_URL_USGOV_DOD];case"Gallatin":throw new Error("Gallatin not supported by Aria");case"GccModerate":case"Prod":default:return[2,void 0]}return[2]}})})},e.prototype.noOp=function(){},e})();n.d(t,"b",function(){return a}),n.d(t,"a",function(){return f});var o=[];function u(e){return o.filter(function(t){return t.targetWindow===e})[0]}function a(e){var t=e.targetWindow||window,n=u(t);return n||(n={targetWindow:t,bootstrapperConfig:e,ariaLogger:new s(e),initializationPromise:void 0,forceRefreshInitializationPromise:!1}),(function(e){var t=u(e.targetWindow);if(t){var n=o.indexOf(t);o[n]=e}else o.push(e)})(n),n}function f(e){var t=u(e);if(t){var n=t.bootstrapperConfig.targetWindow;n&&(delete n.LPC,delete n.LivePersonaCardHoverTarget,delete n.LivePersonaCardHoverTargetV2,delete n.LivePersonaCardStrings,delete n.LivePersonaCardStringsLpcMini,delete n.OfficeFeed,delete n.OfficeFeedFull,delete n.OfficeFeedStrings,delete n.MeetingInsightsV2,delete n.MidgardBootstrapper,delete n.PersonaInsightRing),delete t.bootstrapperConfig.targetWindow,delete t.ariaLogger,delete t.initializationPromise,delete t.bootstrapperConfig}!(function(e){var t=u(e);if(t){var n=o.indexOf(t);o.splice(n,1)}})(e)}},function(e,t,n){"use strict";var r=n(0);function i(e,t,n){try{n.sessionStorage&&n.sessionStorage.setItem&&n.sessionStorage.setItem(e,t)}catch(e){}}n.d(t,"a",function(){return o});var s="LokiAuthToken";function o(e,t,n){return new Promise(function(o,u){e?(i(s,e,n),o(e)):t(function(e,t){e?(i(s,e,n),o(e)):u(new r.a("GetAuthTokenError","Auth token is undefined",t))},function(e,t){var n=(function(e){return/^AADSTS\d+?:/.test(e)})(e)?e:"";u(new r.a("GetAuthTokenError",n,t))})})}},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(0);function i(e,t){var n=this,r=0,i=function(e,t){return(function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,u)}a((r=r.apply(e,t||[])).next())})})(n,void 0,void 0,function(){var n;return(function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return(function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}})([s,u])}}})(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,6]),[4,s(e,t)];case 1:return o.sent(),[3,6];case 2:return n=o.sent(),r<2?(r++,[4,i(e,t)]):[3,4];case 3:return o.sent(),[3,5];case 4:throw n.numberOfRetries=r,n;case 5:return[3,6];case 6:return[2]}})})};return i(e,t)}function s(e,t){return new Promise(function(n,i){var s=t.document.createElement("script");s.type="text/javascript",s.charset="utf-8",s.crossOrigin="anonymous",s.src=e,s.addEventListener("load",function(){n()}),s.addEventListener("error",function(){i(new r.a("LoadScriptError","Unexpected error while loading script on page."))}),t.document.body.appendChild(s)})}},function(e,t,n){"use strict";function r(e){var t={};return Object.keys(e).forEach(function(n){t["Perf_"+n]=e[n].toString()}),t}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=3e5},function(e,t,n){"use strict";n.d(t,"a",function(){return r});function r(e){switch(e.complianceEnvironment){case"Blackforest":return"e5ad760145754ffc9704e67c800087f2-fe4f92a6-9453-4f06-a3f9-52484ba9c6a1-7193";case"GccHigh":return"e5ad760145754ffc9704e67c800087f2-5eda57b1-3b30-42c8-a461-bf3c6ee769d8-7057";case"DoD":return"e5ad760145754ffc9704e67c800087f2-e57f210b-942a-4f32-aaa3-2fd7b8d44a62-7359";case"Gallatin":return"";case"GccModerate":case"Prod":default:return"e5ad760145754ffc9704e67c800087f2-dc72ff20-3e8a-401a-b9a8-ec72e4dd3e22-7257"}}},function(e,t,n){"use strict";function r(e){return{ErrorType:e.name,ErrorMessage:e.message||"",RootCorrelationId:e.rootCorrelationId||"",IsClientOnline:navigator&&void 0!==typeof navigator.onLine?navigator.onLine:""}}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";function r(e){return"ppe"===e.region||"df"===e.region||"msit"===e.region?"https://{0}.loki.delve.office.com".replace("{0}",e.region):(function(e){switch(e){case"Blackforest":return"https://loki.delve.office.de";case"GccModerate":return"https://gcc.loki.delve.office.com";case"GccHigh":return"https://gcchigh.loki.office365.us";case"DoD":return"https://dod.loki.office365.us";case"Gallatin":return"https://loki.office365.cn";case"Prod":return"https://loki.delve.office.com";default:return e}})(e.complianceEnvironment)}var i=n(0);function s(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t.location.search);return null===n?"":t.decodeURIComponent&&t.decodeURIComponent(n[1].replace(/\+/g," "))||""}n.d(t,"a",function(){return c}),n.d(t,"b",function(){return h});var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},u="LivePersonaCardVersionOverride",a="LivePersonaCardCultureOverride",f="MidgardVersion",l="MidgardBranch";function c(e,t,n){return p((function(e,t){var n=t||e.culture,i=r(e);return"{0}/api/v1/configuration/{1}/{2}".replace("{0}",i).replace("{1}",e.clientType).replace("{2}",n)})(t,s(a,n)),e,o(o({},t),{clientFeature:"LivePersonaCard"}),n)}function h(e,t,n){return p((function(e,t){var n=t||e.culture,i=r(e);return"{0}/api/v1/officefeed/configuration?cultureName={1}&returnResources=true".replace("{0}",i).replace("{1}",n)})(t,s(a,n)),e,o(o({},t),{clientFeature:"OfficeFeed"}),n)}function p(e,t,n,r){return new Promise(function(o,a){var c=new XMLHttpRequest;c.open("GET",e,!0),c.setRequestHeader("authToken",t),c.setRequestHeader("Accept","application/json");var h="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t;if(window.crypto){var n=new Uint8Array(1);window.crypto.getRandomValues(n),t=n[0]}else t=Math.floor(16*Math.random());return("x"===e?t%16:t%4+8).toString(16)});c.setRequestHeader("X-RootCorrelationId",h),c.setRequestHeader("X-CorrelationId",h),c.setRequestHeader("X-ClientCorrelationId",n.clientCorrelationId),c.setRequestHeader("X-ClientType",n.clientType),c.setRequestHeader("X-ClientFeature",n.clientFeature),n.hostAppRing&&c.setRequestHeader("X-HostAppRing",n.hostAppRing),n.hostAppVersion&&c.setRequestHeader("X-HostAppVersion",n.hostAppVersion);var p=s(f,r)||s(u,r);p&&(c.setRequestHeader(u,p),c.setRequestHeader(f,p));var d=s(l,r);d&&c.setRequestHeader(l,d),c.addEventListener("load",function(){if(200===c.status)try{var e=JSON.parse(c.response);e.RootCorrelationId=h,e.LokiVersion=c.getResponseHeader("x-serverversion")||"",o(e)}catch(e){a(new i.a("GetLokiConfigError","Failed to parse initialization config.",h))}else a(new i.a("GetLokiConfigError","Couldn't retrieve initialization config. Status code is "+c.status,h,c.status))}),c.addEventListener("error",function(){a(new i.a("GetLokiConfigError","Couldn't retrieve initialization config, request failed to complete.",h))}),c.addEventListener("timeout",function(){a(new i.a("GetLokiConfigError","Loki config request timed out after 60000 ms.",h))}),c.timeout=6e4,c.send()})}},function(e,t,n){"use strict";var r=n(0);function i(e){return void 0===e||"string"!=typeof e||""===e||null===e}function s(e){return void 0===e||"function"!=typeof e}n.d(t,"a",function(){return a});var o=["msit","df","ppe"],u=["Prod","Blackforest","GccModerate","GccHigh","DoD","Gallatin"];function a(e){var t="";if(e){var n=[];i(e.culture)&&n.push("culture"),i(e.clientType)&&n.push("clientType"),i(e.clientContextType)&&n.push("clientContextType"),i(e.clientCorrelationId)&&n.push("clientCorrelationId"),s(e.logMessage)&&n.push("logMessage"),s(e.getAuthToken)&&n.push("getAuthToken"),n.length>0&&(t="Invalid required parameter(s): "+n.join(", ")+". Check the values and types you're passing. "),e.region&&-1===o.indexOf(e.region.toLowerCase().trim())&&(t+="Invalid region value. Allowed values are: empty string for production environments, and "+o.join(", ")+" for pre-production environments. "),-1===u.indexOf(e.complianceEnvironment)&&(t+="Environment is missing or wrong. Allowed values are: "+u.join(", ")+". We currently don't support other Sovereign Clouds.")}else t="Config must be defined.";if(t)throw new r.a("ValidateBootstrapperConfigError",t)}},function(e,t,n){"use strict";n.r(t);var r=n(6),i=n(3),s=n(9),o=0;function u(e,t,n){return(function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,u)}a((r=r.apply(e,t||[])).next())})})(this,void 0,void 0,function(){var r,a;return(function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return(function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}})([s,u])}}})(this,function(f){switch(f.label){case 0:return f.trys.push([0,2,,8]),[4,Object(s.a)(e,t,n)];case 1:return r=f.sent(),[3,8];case 2:return(a=f.sent()).statusCode&&401===a.statusCode?[4,Object(i.a)(void 0,t.getAuthToken,n)]:[3,4];case 3:e=f.sent(),f.label=4;case 4:return o<2?(o++,[4,u(e,t,n)]):[3,6];case 5:return r=f.sent(),[3,7];case 6:throw a.numberOfRetries=o,a;case 7:return[3,8];case 8:return[2,r]}})})}var a=n(4),f=n(0),l=n(2);function c(e,t){var n=Object(l.b)(t).targetWindow;return new Promise(function(r,i){setTimeout(function(){try{n.LPC||i(new f.a("StartLivePersonaCardError","targetWindow.LPC is undefined.")),n.LivePersonaCardStrings&&n.LivePersonaCardStrings.strings||n.LivePersonaCardStringsLpcMini&&n.LivePersonaCardStringsLpcMini.strings||i(new f.a("StartLivePersonaCardError","targetWindow.LivePersonaCardStrings is undefined."));var s=(function(e,t){var n=Object(l.b)(t).targetWindow;return{refreshAuthToken:h(t),logToExternalApplication:t.logMessage,contextType:t.clientContextType,strings:n.LivePersonaCardStringsLpcMini&&n.LivePersonaCardStringsLpcMini.strings||n.LivePersonaCardStrings&&n.LivePersonaCardStrings.strings,source:t.clientType,consumerCorrelationId:t.clientCorrelationId,activeFlights:e.Flights,isDebug:!1,culture:t.culture,dataCallbacks:t.dataCallbacks,actionCallbacks:t.actionCallbacks,dataUpdateBroadcaster:t.dataUpdateBroadcaster,privateDataCallbacks:t.privateDataCallbacks,options:t.options?t.options:{hideDocumentFilter:!1},theme:t.theme,lokiUrl:e.LokiUrl,lokiVersion:e.LokiVersion,tenantAadObjectId:e.TenantAadObjectId,userAadObjectId:e.UserAadObjectId,userPuid:e.UserPuid,ecsConfigIds:e.EcsConfigIds,ecsETag:e.EcsEtag,loggedInUserUpn:e.Upn,complianceEnvironment:t.complianceEnvironment,userDisplayName:e.UserDisplayName}})(e,t);n.LPC.start(s),r()}catch(e){i(new f.a("StartLivePersonaCardError",e.name))}},0)})}function h(e){return function(t){e.getAuthToken(function(e,n){t(e,"",n)},function(e,n){t("",e,n)})}}var p=n(7),d=n(8),v=n(5),m=n(1),g=n(10);n.d(t,"initializeLivePersonaCardAsync",function(){return x}),n.d(t,"freeBootstrapperMemory",function(){return T}),n.d(t,"fetchLokiConfigAsync",function(){return N}),n.d(t,"lazyInitializeTopicCardAsync",function(){return C}),n.d(t,"lazyInitializeOfficeFeedAsync",function(){return k});var y=function(){return(y=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},b=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,u)}a((r=r.apply(e,t||[])).next())})},w=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return(function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}})([s,u])}}};try{var E=window.document.createElement("link"),S=Boolean("onmscontentzoom"in window.document);E.rel=S?"dns-prefetch":"preconnect",E.href="https://lpcres.delve.office.com/",window.document.head.appendChild(E)}catch(e){console.log("Live Persona Card ERROR: Bootstrapper failed to warm up the connection to Midgard CDN.",e)}function x(e){return b(this,void 0,void 0,function(){var t,n,s=this;return w(this,function(o){return!(t=Object(l.b)(e)).forceRefreshInitializationPromise&&t.initializationPromise||(n=new m.a(t.targetWindow),t.forceRefreshInitializationPromise=!1,t.initializationPromise=new Promise(function(r,o){return b(s,void 0,void 0,function(){var s,f,l,h,b,E;return w(this,function(w){switch(w.label){case 0:s=Object(p.a)(e),w.label=1;case 1:return w.trys.push([1,7,,8]),Object(g.a)(e),n.startCustomTiming(m.b.getAuthToken),[4,Object(i.a)(e.authToken,e.getAuthToken,t.targetWindow)];case 2:return f=w.sent(),n.endCustomTiming(m.b.getAuthToken),n.measureFromStart(m.b.getAuthTokenFromStart),n.startCustomTiming(m.b.getLokiConfig),[4,u(f,e,t.targetWindow)];case 3:return l=w.sent(),n.endCustomTiming(m.b.getLokiConfig),n.measureFromStart(m.b.getLokiConfigFromStart),n.startCustomTiming(m.b.getLpcBundles),[4,(S=l,x=t.targetWindow,N="MiniOwaMail"===S.Workload?S.Resources.livepersonacardstringslpcmini:S.Resources.livepersonacardstrings,T="MiniOwaMail"===S.Workload?S.Resources["livepersonacard_lpc-mini"]:"OwaPeopleHub"===S.Workload?S.Resources.livepersonacard_global:S.Resources.livepersonacard_full,Promise.all([Object(a.a)(N,x),Object(a.a)(T,x)]))];case 4:return w.sent(),n.endCustomTiming(m.b.getLpcBundles),n.measureFromStart(m.b.getLpcBundlesFromStart),n.startCustomTiming(m.b.startLpc),[4,c(l,e)];case 5:return w.sent(),n.endCustomTiming(m.b.startLpc),n.measureFromStart(m.b.startLpcFromStart),[4,t.ariaLogger.updateContextWithLokiDataAsync(l,s).catch(function(){console.log("Live Persona Card ERROR: Bootstrapper failed to initialize Aria, continuing without.")})];case 6:return w.sent(),(h=Object(v.a)(n.getAllTimings())).RootCorrelationId=l.RootCorrelationId,h.isConsumer=e.isConsumer,t.ariaLogger.logEventAsync({name:"initializeLivePersonaCard_success",properties:h},s),r(),[3,8];case 7:return b=w.sent(),E=Object(v.a)(n.getAllTimings()),t.ariaLogger.logEventAsync({name:"initializeLivePersonaCard_failure",properties:y(y(y({},Object(d.a)(b)),E),{isConsumer:e.isConsumer})},s),o("Failed to initialize Live Persona Card: "+b.name+" "+b.message),[3,8];case 8:return[2]}var S,x,T,N})})}),t.initializationPromise.catch(function(){setTimeout(function(){t.forceRefreshInitializationPromise=!0},r.a)})),[2,t.initializationPromise]})})}function T(e){Object(l.a)(e)}function N(e){return b(this,void 0,void 0,function(){var t;return w(this,function(n){switch(n.label){case 0:return t=Object(l.b)(e),[4,Object(i.a)(e.authToken,e.getAuthToken,t.targetWindow)];case 1:return[2,u(n.sent(),e,t.targetWindow)]}})})}function C(e){return b(this,void 0,void 0,function(){return w(this,function(t){return[2,n.e(2).then(n.bind(null,45)).then(function(t){return(0,t.initializeTopicCardAsync)(e)})]})})}function k(e){return b(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,n.e(0).then(n.bind(null,44))];case 1:return[2,(0,t.sent().initializeOfficeFeedAsync)(e)]}})})}}])},3232:function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return s});function r(e){var t=e.webAbsoluteUrl,n=e.farmLabel,r=e.env2,s=e.farmSettings;if("o365test"===r||"onebox"===r||"edog"===r)return r;if("string"==typeof t&&t.toLowerCase().indexOf("microsoft.sharepoint-df.com")>-1)return"spdf";if(null==s?void 0:s.ExternalService_searchcloudenvironment){var o=s.ExternalService_searchcloudenvironment;return"spdf"===o?"prodbubble":o}return(function(e){return Boolean(e)&&i.some(function(t){return 0===e.toLowerCase().indexOf(t)})})(n)?"gcc":r}var i=["us_2_","us_86_","us_96_","us_105_","us_265_","us_266_","us_267_","us_268_","us_269_","us_270_"];function s(e){return e&&("ag08"===(t=e.ExternalService_searchcloudenvironment)||"ag09"===t)&&e.ExternalService_searchcloudurl?JSON.parse(e.ExternalService_searchcloudurl):void 0;var t}},4342:function(e,t,n){"use strict";n.d(t,"e",function(){return w});var r=n(0),i=n("react-lib"),s=n(193);Object(s.n)([{rawString:".livePersonaCardAdapterRoot_a8b6bb4d{display:inline-block}\n"}]);var o=n(3231),u=n(80),a=n(40),f=n(3232),l=n(3204),c=n(641),h=n(2031),p=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{dataSourceName:"LokiDataSource"},{pageContext:t})||this;n._oAuthTokenProvider=new l.e(null,{oAuthTokenDataSource:new h.e(t)});return n}t.prototype.getRegion=function(){var e=new u.e({name:"LivePersonaCard.GetLokiRegion"});try{var n=this._pageContext.farmLabel;if(!n){e.end({resultType:a.e.Failure,resultCode:"LokiNoFarmLabel",error:"Farm label property not found in _spPageContextinfo object. Aborting connection!"});return""}var r=n.split("_")[0].toLowerCase();return t.FARMLABEL_TO_REGION_MAPPING[r]}catch(t){e.end({resultType:a.e.Failure,resultCode:"LokiGetRegionError",error:t});return""}};t.prototype.getAuthTokenGetter=function(e){void 0===e&&(e="");return this.getAadAuthTokenGetter()};t.prototype.getAadAuthTokenGetter=function(){var e,t,n=this,r=this._pageContext.CorrelationId,i=(e=this._pageContext.farmSettings,(t=Object(f.e)(e))&&t.Loki||"https://loki.delve.office.com");return function(e,t){n._oAuthTokenProvider.getInstrumentedToken(i).then(function(t){return e(t.tokenInfo.token,t.spRequestId)}).catch(function(e){var n={httpStatusCode:e.httpResponseStatus,serverErrorCode:e.serverErrorCode,requestCorrelationId:e.correlationId,type:e.type};t(JSON.stringify(n),r)})}};t.prototype.getBootstrapperConfig=function(){return{culture:this._pageContext.currentUICultureName,region:this.getRegion(),clientType:"ODSP",clientCorrelationId:this._pageContext.CorrelationId,complianceEnvironment:(e=this._pageContext,d(e)?"Blackforest":v(e)?"GccModerate":"Prod"),getAuthToken:this.getAuthTokenGetter()};var e};t.FARMLABEL_TO_REGION_MAPPING={edog:"ppe",msit:"msit",spdf:"df"};return t})(c.t);function d(e){return e.env&&"blackforest"===e.env.toLowerCase()||e.farmLabel&&0===e.farmLabel.toLowerCase().indexOf("deu_1")}function v(e){var t=e.farmLabel&&e.farmLabel.toLowerCase()||"";return 0===t.indexOf("us_2_")||0===t.indexOf("us_86_")||0===t.indexOf("us_96_")||0===t.indexOf("us_105_")||0===t.indexOf("us_265_")||0===t.indexOf("us_266_")||0===t.indexOf("us_267_")||0===t.indexOf("us_268_")||0===t.indexOf("us_269_")||0===t.indexOf("us_270_")}var m=n(2505),g=n(1090),y=n(127),b=n(23),w=(function(e){Object(r.__extends)(t,e);function t(n,r){var i=e.call(this,n,r)||this;i.makeAdapterConfig=function(){var e=i.props.lpcCallbacks||{};i.props.addGroupMembersCallback&&(e.addGroupMembers=i.props.addGroupMembersCallback);return{pageContext:i.props.pageContext,actionCallBacks:e,dataCallBacks:i.props.lpcCallbacks,clientType:i.props.lpcClientType}};i.state={isReady:!1};i.hasCalledOnReady=!1;t.ensureInitializeLPC(i.makeAdapterConfig()).then(function(){i.setState({isReady:!0})});return i}t.ensureInitializeLPC=function(e){if(!e.pageContext.isSPO)return Promise.reject("LPC is not supported on-prem.");if((e.pageContext.isExternalGuestUser||e.pageContext.isAnonymousGuestUser)&&(t.disableLPCForNativeIdentity||!e.pageContext.isNativeFederatedUser))return Promise.reject("LPC is not enabled for guest users.");if(window.LPC&&window.LPC.getRenderer){t.LivePersonaCardHoverTarget=window.LivePersonaCardHoverTarget;t.LivePersonaCardHoverTargetV2=window.LivePersonaCardHoverTargetV2;e.callback&&e.callback();return Promise.resolve()}var n=new p(e.pageContext),r=n.getAadAuthTokenGetter(),i=(function(e){switch(Object(f.t)(e)||"prod"){case"o365test":case"onebox":case"edog":case"spdf":return"Df";case"prodbubble":return"Msit";case"prod":return"Prod";case"blackforest":return"Blackforest";case"gallatin":return"Gallatin";case"pathfinder":return"DoD";case"trailblazer":return"GccHigh";case"gcc":return"GccModerate";case"ag08":return"AG08";case"ag09":return"AG09";default:return"Prod"}})(e.pageContext),s={culture:e.pageContext.currentUICultureName,region:n.getRegion(),clientType:e.clientType||"ODSP",clientContextType:"Generic",clientCorrelationId:e.pageContext.CorrelationId,logMessage:t._logResult,getAuthToken:r,actionCallbacks:e.actionCallBacks,dataCallbacks:e.dataCallBacks,complianceEnvironment:"Msit"===i||"Df"===i?"Prod":i};return Object(o.initializeLivePersonaCardAsync)(s).then(function(){t.LivePersonaCardHoverTarget=window.LivePersonaCardHoverTarget;t.LivePersonaCardHoverTargetV2=window.LivePersonaCardHoverTargetV2;e.callback&&e.callback();e.onSuccess&&e.onSuccess()}).catch(function(t){0;e.onFailure&&e.onFailure(t)})};t._buildHostAppPersonaId=function(e,n){if(!t.disableLPCForNativeIdentity&&e&&n){e=e.replace(/[{}]/g,"");n=n.replace(/[{}]/g,"");return"".concat(e,"@").concat(n)}};t.prototype.render=function(){var e=this,n=!!this.props.displayName;if(t.LivePersonaCardHoverTargetV2&&!this.props.lpcHoverTargetProps){var s=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},this.props.tabIndex&&{tabIndex:this.props.tabIndex}),{cardParameters:Object(r.__assign)({personaInfo:{identifiers:{HostAppPersonaId:t._buildHostAppPersonaId(this.props.organizationId,this.props.tenantId),Smtp:this.props.email,Upn:this.props.upn||("User"===this.props.personaType?this.props.email:void 0),PersonaType:this.props.personaType,TopicId:this.props.topicId,LocationId:this.props.locationId},displayName:n?this.props.displayName:void 0,personaCoinColor:n?Object(m.e)({text:this.props.displayName}):void 0},behavior:Object(r.__assign)(Object(r.__assign)({},this.props.lpcCardBehavior),{onCardOpen:function(){e.props.loggingData&&y.e.logData(e.props.loggingData);e.props.lpcCardBehavior&&e.props.lpcCardBehavior.onCardOpen&&e.props.lpcCardBehavior.onCardOpen()},onCardClose:function(){e.props.loggingData&&y.e.logData(e.props.loggingData);e.props.lpcCardBehavior&&e.props.lpcCardBehavior.onCardClose&&e.props.lpcCardBehavior.onCardClose()}}),externalAppSessionCorrelationId:this.props.pageContext.CorrelationId},this.props.ariaLabel&&{ariaLabel:this.props.ariaLabel})}),this.props.lpcHoverTargetV2Props);return i.createElement(t.LivePersonaCardHoverTargetV2,Object(r.__assign)({},s),this.props.children)}if(t.LivePersonaCardHoverTarget){s=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({upn:this.props.email,hostAppPersonaInfo:{PersonaType:this.props.personaType,LocationId:this.props.locationId},externalAppSessionCorrelationId:this.props.pageContext.CorrelationId},this.props.tabIndex&&{tabIndex:this.props.tabIndex}),this.props.ariaLabel&&{ariaLabel:this.props.ariaLabel}),this.props.lpcHoverTargetProps),{onCardOpen:function(){e.props.loggingData&&y.e.logData(e.props.loggingData);e.props.lpcHoverTargetProps&&e.props.lpcHoverTargetProps.onCardOpen&&e.props.lpcHoverTargetProps.onCardOpen()}});return i.createElement(t.LivePersonaCardHoverTarget,Object(r.__assign)({},s),this.props.children)}return i.createElement("div",{className:"livePersonaCardAdapterRoot"},this.props.children)};t.prototype.componentDidUpdate=function(){if(this.state.isReady&&!this.hasCalledOnReady&&this.props.onPersonaCardReady){this.hasCalledOnReady=!0;this.props.onPersonaCardReady()}};t.LivePersonaCardHoverTarget=void 0;t.LivePersonaCardHoverTargetV2=void 0;t.disableLPCForNativeIdentity=b.t.isActivated("4447C532-D4A2-4162-9C89-56324A4F7E52","08/03/2021","enable LPC for native identity users");t._logResult=function(e,t,n){0};return t})(g.e)},4909:function(e,t,n){"use strict";n.r(t);n.d(t,"SpLivePersonaCard",function(){return a});var r=n(0),i=n("react-lib"),s=n(1090),o=n(1195),u=n(4342),a=(function(e){Object(r.__extends)(t,e);function t(n,r){var i=e.call(this,n,r)||this;i.state={lpcCallbacks:t.makeSpLpcCallbacks(void 0,i.props.pageContext,i.props.lpcCallbacks)};return i}t.makeSpLpcCallbacks=function(e,t,n){return Object(r.__assign)(Object(r.__assign)({},n||{}),{getAndPrefetchPersonaImageUri:function(e,t){"User"===e.PersonaType&&e.Smtp&&t?t(Object(o.e)(e.Smtp,3)):t()},addGroupMembers:e})};t.prototype.render=function(){return i.createElement(u.e,{personaType:this.props.personaType,email:this.props.identifier,locationId:this.props.locationId,pageContext:this.props.pageContext,dataAutomationId:this.props.dataAutomationId,lpcCallbacks:this.state.lpcCallbacks,lpcHoverTargetProps:this.props.lpcHoverTargetProps,loggingData:this.props.loggingData,lpcCardBehavior:this.props.lpcCardBehavior,lpcHoverTargetV2Props:this.props.lpcHoverTargetV2Props,ariaLabel:this.props.ariaLabel,tabIndex:this.props.tabIndex,lpcClientType:this.props.lpcClientType,topicId:this.props.topicId,organizationId:this.props.organizationId,tenantId:this.props.tenantId,onPersonaCardReady:this.props.onPersonaCardReady},this.props.children)};return t})(s.e)}}]);