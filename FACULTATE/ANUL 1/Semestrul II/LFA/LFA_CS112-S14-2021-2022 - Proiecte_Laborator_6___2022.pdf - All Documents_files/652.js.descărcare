(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[652,80],{1749:function(e,t,n){"use strict";n.r(t);n.d(t,"ConfirmationDialog",function(){return d});var r=n("react-lib"),i=n(3467),s=n(2621),o=n(2867),u=n(1761),a=n(1230),f=n(2124),l=n(1755),c=n(1751),h=n(2156),p=n(165).n.isFeatureEnabled({ODC:"DialogNextEnabled",ODB:60768})?h.e:{},d=function(e){var t=e.onConfirm,n=e.onCancel,h=e.defaultToYes,d=void 0!==h&&h,v=e.defaultFocusToYes,m=void 0!==v&&v,g=e.yesText,y=void 0===g?l.t:g,b=e.noText,w=void 0===b?l.e:b,E=function(e){e&&e.focus()},S=d?u.e:a.e,x=d?a.e:u.e,T=m?void 0:E,N=m?E:void 0;return r.createElement(f.e,null,r.createElement(c.e,{scopedSettings:p},r.createElement(i.e,{dialogContentProps:{type:s.e.close,subText:e.prompt?e.prompt:""},onDismiss:n,hidden:!1,title:e.title,maxWidth:e.maxWidth},e.children,r.createElement(o.e,null,r.createElement(S,{"data-automationid":"confirmbutton",onClick:t,componentRef:N},y),r.createElement(x,{"data-automationid":"cancelbutton",onClick:n,componentRef:T},w)))))}},2124:function(e,t,n){"use strict";n.d(t,"e",function(){return a});n.d(t,"t",function(){return f});var r=n("react-lib"),i=n(1211),s=n(143),o=n(107),u=0;function a(e){var t=e.isDefault,n=void 0!==t&&t,o=r.useState("".concat(++u))[0],a=r.useContext(i.e),f=r.useRef(),c=f.current||n&&a.keyboardManager||(f.current=new i.t({isDefault:!1,id:o,parent:a.keyboardManager})),h=l(c),p=h.isActive,d=h.isChildActive;r.useEffect(function(){return function(){if(!n){c.setIsActive(!1);c.dispose()}}},[]);var v=r.useMemo(function(){return{keyboardManager:c}},[c]);return r.createElement("div",{"data-keyboard-zone-id":o},r.createElement(i.e.Provider,{value:v},Object(s.t)(e.children,{isActive:p,isChildActive:d})))}function f(){return l(r.useContext(i.e).keyboardManager)}function l(e){var t=r.useState(function(){return e.getIsActive()}),n=t[0],i=t[1],s=r.useState(function(){return e.hasActiveChildren()}),u=s[0],a=s[1];r.useEffect(function(){var t=new o.e(null);t.on(e,"change",function(){i(e.getIsActive());a(e.hasActiveChildren())});return function(){t.dispose()}},[]);return{isActive:n,isChildActive:u}}},2156:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r,i=n(0),s={height:"100%",display:"flex",flexDirection:"column"},o={width:"440px",minWidth:"none",maxWidth:"none"},u={Modal:{styles:{main:Object(i.__assign)({selectors:(r={},r["@media (min-width: 480px)"]=Object(i.__assign)({},o),r),minHeight:"240px"},o)}},DialogContent:{styles:{content:s,inner:s,innerContent:s}},DialogFooter:{styles:{actions:{minHeight:"none"}}}}},2172:function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return i});var r,i;(function(e){e.AddToOneDrive="AddToOneDrive";e.BrowseFiles="BrowseFiles";e.CloseVault="CloseVault";e.CreateFolder="CreateFolder";e.CreateFile="CreateFile";e.DeleteFile="DeleteFile";e.DeleteFolder="DeleteFolder";e.DownloadFile="DownloadFile";e.DownloadBatch="DownloadBatch";e.RenameFile="RenameFile";e.RenameFolder="RenameFolder";e.OpenVault="OpenVault";e.PopulateRecentFiles="PopulateRecentFiles";e.PopulateSharedWithMe="PopulateSharedWithMe";e.Search="Search";e.UploadFile="UploadFile";e.SaveFile="SaveFile";e.UploadBatch="UploadBatch"})(r||(r={}));(function(e){e.ActiveUserOperation="AUO";e.BackgroundOperation="BGO";e.PassiveOperation="PO"})(i||(i={}))},2428:function(e,t,n){"use strict";n.d(t,"e",function(){return v});var r=n(0),i=n(13),s=n(281),o=n(130),u=n(5),a=n(9),f=n(2),l=n(219),c=n(151),h=n(364),p=n(509),d={displayName:u.h,defaultChildItemSet:a.t,icon:o.t};function v(e,t){function n(n){var i=this,s=n.itemKey,o=e.deserialize(s);return function(e){return Object(r.__awaiter)(i,void 0,void 0,function(){var i,c,h,p;return Object(r.__generator)(this,function(v){i=new l.e({publisher:t});c=e(t(o));i.resolveItems({items:Object(r.__assign)((h={},h[s]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},u.M.pack(void 0)),u.m.pack({})),Object(f.n)(d,c)),h),c.defaultChildItemSet?(p={},p[c.defaultChildItemSet.itemKey]=Object(r.__assign)({},a.s.pack({itemKey:n.itemKey})),p):{})});e(i.execute());return[2]})})}}return Object(i.t)(function(){return function(t){t(Object(c.t)({keyFacet:p.e,facets:[a.t,u.h,u.m,o.t,u.M]}));t(Object(s.r)(e,h.e)(Object(i.i)()(n)))}})}},2499:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("bundle")},2589:function(e,t,n){"use strict";n.d(t,"r",function(){return r});n.d(t,"n",function(){return i});n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r="root",i="me",s="/drive/root:",o=30},2738:function(e,t,n){"use strict";function r(e){return void 0!==e.action}function i(e){return void 0!==e.activityDateTime}function s(e){var t=y(e).comment;return void 0!==t&&!t.isReply}function o(e){var t=y(e).comment;return void 0!==t&&t.isReply}function u(e){return void 0!==y(e).mention}function a(e){return void 0!==y(e).version}function f(e){return void 0!==y(e).pointInTimeRestore}function l(e){return void 0!==y(e).restoreVersion}function c(e){return void 0!==y(e).move}function h(e){return void 0!==y(e).rename}function p(e){return void 0!==y(e).delete}function d(e){return void 0!==y(e).share}function v(e){var t=y(e).addToOneDrive;return void 0!==t&&!t.removedDateTime}function m(e){var t=y(e).addToOneDrive;return void 0!==t&&!!t.removedDateTime}function g(e){return function(t){return u(t)?e.Mention(t):s(t)?e.Comment(t):o(t)?e.CommentResponse(t):(function(e){return void 0!==y(e).create})(t)?e.Create(t):p(t)?e.Delete(t):(function(e){return void 0!==y(e).edit})(t)?e.Edit(t):c(t)?e.Move(t):h(t)?e.Rename(t):(function(e){return void 0!==y(e).restore})(t)?e.Restore(t):l(t)?e.RestoreVersion(t):d(t)?e.Share(t):a(t)?e.Version(t):(function(e){return void 0!==y(e).copy})(t)?e.Copy(t):f(t)?e.PointInTimeRestore(t):v(t)?e.AddShortcutToOneDrive(t):m(t)?e.RemoveShortcutFromOneDrive(t):void 0}}function y(e){return r(e)?e.action:e}function b(e){return e.driveItem||e.listItem}var w=n(50),E=!n(23).t.isActivated("DC1B3A2B-2469-49B2-9230-7F6CD01BD84C","12/30/2020","Enable deeplinking for comment activities"),S=(function(){function e(){}e.prototype.processResponse=function(e){var t=this,n=e.item,r=e.response;return{isPlaceholder:!1,activities:r.value.map(function(e){if(i(e))if(s(e)||o(e)){var r=y(e).comment;(r.contentId||r.navigationId)&&(e.docDetails={contentId:r.contentId,navigationId:r.navigationId})}else if(u(e)){var a=y(e).mention;(a.contentId||a.navigationId)&&(e.docDetails={contentId:a.contentId,navigationId:a.navigationId})}return t._processActivityResponse(n,e)}),nextRequestToken:this._getNextRequestToken(r),success:!0}};e.prototype.processActivitiesByIntervalResponse=function(e){var t=this;return{activitiesByInterval:e.value.map(function(e){return t._processActivitySummaryResponse(e)}),success:!0}};e.prototype._processActivitySummaryResponse=function(e){return{totalCount:(void 0!==e.create?e.create.actionCount:0)+(void 0!==e.delete?e.delete.actionCount:0)+(void 0!==e.edit?e.edit.actionCount:0)+(void 0!==e.move?e.move.actionCount:0)+(void 0!==e.rename?e.rename.actionCount:0)+(void 0!==e.restore?e.restore.actionCount:0)+(void 0!==e.copy?e.copy.actionCount:0),startDateTime:new Date(e.startDateTime),endDateTime:new Date(e.endDateTime)}};e.prototype._getNextRequestToken=function(e){if(e.value&&!(e.value.length<1)){var t=e["@odata.nextLink"],n=t&&t.match(/skiptoken=([^&]+)/i);return n?n[1]:void 0}};e.prototype._processActivityResponse=function(e,t){var n=this._getItem(e,t),r=this._getParentItem(t),s=this._getAction(e,n,r,t);if(i(t)){var o=t.actor&&t.actor.user,u=o&&{displayName:o.displayName,id:o.id,email:o.email,self:o.self};return{id:t.id,type:this._getActivityType(t),actors:u?[u]:[],item:n,parentItem:r,time:new Date(t.activityDateTime),action:s}}var a=t.actor&&t.actor.user,f=a&&{displayName:a.displayName,email:a.email,self:a.self,userPrincipalName:a.userPrincipalName};return{id:t.id,type:this._getActivityType(t),actors:[f],item:n,parentItem:r,time:t.times.recordedTime?new Date(t.times.recordedTime):new Date(t.times.recordedDateTime),friendlyDisplayTime:t["@sharePoint.localizedRelativeTime"],action:s}};e.prototype._getActivityType=function(e){return g({Comment:function(){return 2},CommentResponse:function(){return 3},Create:function(){return 11},Delete:function(){return 10},Edit:function(){return 0},Mention:function(){return 4},Move:function(){return 1},Rename:function(){return 9},Restore:function(){return 6},RestoreVersion:function(){return 7},PointInTimeRestore:function(){return 8},Share:function(){return 12},Version:function(){return 5},Copy:function(){return 13},AddShortcutToOneDrive:function(){return 14},RemoveShortcutFromOneDrive:function(){return 15}})(e)};e.prototype._getItem=function(e,t){var n=b(t);if(c(t)){if(r(t)){var s=y(t).move;if(s&&s.to)return{name:this._getFileNameFromPath(s.to),isRoot:this._isRootItem(s.to),graphItemUrl:void 0,relativePath:void 0,absolutePath:s.to}}}else if(p(t)&&r(t)){var o=y(t).delete;if(o&&o.name){var u=(f=(a=n&&n.parentReference)&&this._getRelativePathFromVroomPath(a.path))&&n&&f+"/"+n.name+"/"+o.name;return{name:o.name,isRoot:this._isRootItem(o.name),graphItemUrl:void 0,relativePath:u,absolutePath:void 0,isFolder:"Folder"===o.objectType}}}if(n){t.docDetails&&(n.webUrl=this._getNavLink(n,t.docDetails));var a,f;u=(f=(a=n&&(n.parentReference||n.remoteItem&&n.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(a.path))&&f+"/"+n.name;return p(t)?{name:n.name,isRoot:this._isRootItem(n.name),graphItemUrl:void 0,relativePath:u,absolutePath:void 0}:{name:n.name,isRoot:this._isRootItem(n.name),graphItemUrl:a&&"/drives/".concat(a.driveId,"/items/").concat(n.id),relativePath:u,absolutePath:void 0,driveItem:n,navigationId:this._getNavigationId(t)}}if(!i(t))return e};e.prototype._getParentItem=function(e){var t=b(e);if(c(e)){var n=y(e).move;if(n&&n.to){var i=this._getDirNameFromPath(n.to),s=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference);return{name:this._getFileNameFromPath(i),isRoot:this._isRootItem(i),graphItemUrl:s&&"/drives/".concat(s.driveId,"/items/").concat(s.id),relativePath:void 0,absolutePath:this._getDirNameFromPath(i),isFolder:!0,driveItem:s&&{id:s.id}}}}else if(p(e)&&t){if(r(e)){var o=(a=(s=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(s.path))&&a+"/"+name;return{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:s&&"/drives/".concat(s.driveId,"/items/").concat(t.id),relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:t}}if(s=t&&t.parentReference){o=this._getRelativePathFromVroomPath(s.path);var u=s.name?s.name:o&&this._getFileNameFromPath(o);if(void 0===o||void 0===u||void 0===s.id)return;return{name:u,isRoot:this._isRootItem(u),graphItemUrl:"/drives/".concat(s.driveId,"/items/").concat(s.id),relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:{id:s.id}}}}else{if(l(e)&&t){o=(a=(s=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(s.path))&&a+"/"+name;return{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:s&&"/drives/".concat(s.driveId,"/items/").concat(t.id),relativePath:o,absolutePath:void 0,isFolder:!1,driveItem:t}}if(f(e)&&t){var a;o=(a=(s=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(s.path))&&a+"/"+name;return{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:s&&"/drives/".concat(s.driveId,"/items/").concat(t.id),relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:t}}if(t){if(s=t.parentReference&&t.parentReference){o=this._getRelativePathFromVroomPath(s.path);var h=s.name?s.name:o&&this._getFileNameFromPath(o);return{name:h,isRoot:this._isRootItem(h),graphItemUrl:"/drives/".concat(s.driveId,"/items/").concat(s.id),relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:{id:s.id}}}}}};e.prototype._getNavLink=function(e,t){var n=e.webUrl,r=n&&new w.t(n),i=t.navigationId;r&&i&&r.setQueryParameter("nav",i);return r.toString()||n};e.prototype._getNavId=function(e){return e&&e.navigationId};e.prototype._getNavigationId=function(e){var t,n,r;if(null==e?void 0:e.docDetails)return this._getNavId(e.docDetails);if(E&&s(e)){var i=y(e);return(null===(t=null==i?void 0:i.comment)||void 0===t?void 0:t.navigationId)?null===(n=null==i?void 0:i.comment)||void 0===n?void 0:n.navigationId:null===(r=null==i?void 0:i.comment)||void 0===r?void 0:r.commentId}};e.prototype._getAction=function(e,t,n,r){var f={};a(r)&&(f.version={newVersion:y(r).version.newVersion});if(c(r)){var l=y(r).move;if(i(r)){var p=void 0,g=void 0;l.from&&(p=this._getDirNameFromPath(l.from));l.to&&(g=this._getDirNameFromPath(l.to));f.move={from:{name:this._getFileNameFromPath(p),isRoot:this._isRootItem(p),graphItemUrl:void 0,absolutePath:p},to:{name:this._getFileNameFromPath(g),isRoot:this._isRootItem(g),graphItemUrl:void 0,absolutePath:g}}}else if(l.From){var b=this._getDirNameFromPath(l.From);f.move={from:{name:this._getFileNameFromPath(b),isRoot:this._isRootItem(b),graphItemUrl:void 0,absolutePath:b},to:void 0}}else if(l.to){var w=this._getDirNameFromPath(l.to);f.move={from:void 0,to:{name:this._getFileNameFromPath(w),isRoot:this._isRootItem(w),graphItemUrl:void 0,absolutePath:w}}}}if(h(r)){var E=y(r).rename;f.rename={newItem:{name:E.newName,isRoot:this._isRootItem(E.newName),graphItemUrl:t?t.graphItemUrl:void 0,relativePath:t?t.relativePath:void 0,absolutePath:t?t.absolutePath:void 0,driveItem:t?t.driveItem:void 0},oldItem:{name:E.oldName,isRoot:this._isRootItem(E.oldName),graphItemUrl:t?t.graphItemUrl:void 0,relativePath:t?t.relativePath:void 0,absolutePath:t?t.absolutePath:void 0,driveItem:t?t.driveItem:void 0}}}if(o(r)){(S=y(r).comment).isReply&&(f.commentResponse={commentAuthor:S.parentAuthor&&S.parentAuthor.user})}if(s(r)){var S;(S=y(r).comment).isReply||(f.comment={commentId:S.commentId})}if(u(r)){var x=y(r).mention;f.mention={mentionees:x.mentionees&&x.mentionees.map(function(e){return e.user})||[],commentId:i(r)?x.navigationId:void 0}}if(d(r)){var T=y(r).share;f.share={recipients:T.recipients&&T.recipients.map(function(e){return e.user})||[]}}v(r)&&(f.addShortcutToOneDrive={});if(m(r)){var N=y(r).addToOneDrive;f.removeShortcutFromOneDrive={mountPointName:N.mountPointName}}return f};e.prototype._getRelativePathFromVroomPath=function(e){if(e){return e.split(":",2)[1]}};e.prototype._getDirNameFromPath=function(e){return e&&e.substring(0,e.lastIndexOf("/"))};e.prototype._getFileNameFromPath=function(e){return e&&e.substring(e.lastIndexOf("/")+1)};e.prototype._isRootItem=function(e){return e&&"/LiveFolders"===e};return e})();t.e=S},2757:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("driveItemResponse")},2762:function(e,t,n){"use strict";n.d(t,"e",function(){return P});n.d(t,"t",function(){return B});var r=n(0),i=n(130),s=n(5),o=n(9),u=n(102),a=n(1214),f=n(3244),l=n(2757),c=n(2499),h=n(662),p=n(1243),d=n(2427),v=n(158),m=n(57),g=n(898),y=n(3245),b=n(888),w=n(3011),E=n(4108),S=n(2814),x=n(3246),T=n(3549),N=n(3548),C=n(261),k=n(4110),L=n(4109),A=n(1403),O=n(3734),M=n(3735),_=n(3736),D=n(219);function P(e){var t=e.itemKey,n=e.driveItemKey,j=e.driveItem,F=e.endpoint,I=e.parentFolderItemKey,q=e.shouldReturnShareFacets,R=void 0===q||q,U=j.coverImage,z=j.file,W=j.fileSystemInfo,X=j.name,V=j.remoteItem,$=j.root,J=j.size,K=j.thumbnails,Q=j.image,G=j.video,Y=j.eTag,Z=j.tags,ee=j.photo,te=j.specialFolder,ne=j.photoStreamItemSource;return function(e){var q,re,ie,se=j.lastModifiedDateTime,oe=void 0===se?W&&W.lastModifiedDateTime||V&&V.lastModifiedDateTime:se,ue=j.createdDateTime||W&&W.createdDateTime||V&&V.createdDateTime,ae=Object(S.e)(j),fe=null==ae?void 0:ae.driveId,le=null==ae?void 0:ae.driveType,ce="personal"===le,he=W&&W.lastAccessedDateTime||V&&V.fileSystemInfo&&V.fileSystemInfo.lastAccessedDateTime,pe=(null==ee?void 0:ee.takenDateTime)||(null==ee?void 0:ee.alternateTakenDateTime),de=j.package||V&&V.package,ve=K||(null==V?void 0:V.thumbnails),me=Q||V&&V.image,ge=G||V&&V.video,ye=j.shared||V&&V.shared,be={itemId:j.id,driveId:fe,endpoint:F},we=W&&W.systemPath,Ee=n||V&&V.parentReference&&{itemId:V.id,driveId:V.parentReference.driveId,endpoint:F}||be,Se=u.e.serialize(Ee),xe=j.webDavUrl||V&&V.webDavUrl;ie="business"!==le&&"documentLibrary"!==le&&"personal"!==le||!$?X||V&&V.name||"":d.t;var Te=j.bundle||(null==V?void 0:V.bundle),Ne=j.folder||(null==V?void 0:V.folder)||Te,Ce=null!=J?J:null==V?void 0:V.size,ke=null==Ne?void 0:Ne.childCount,Le=B(ie,!!Ne),Ae=Le.extension||j.package&&j.package.type,Oe=Ae&&Object(E.e)(Ae),Me=j.sharepointIds||V&&V.sharepointIds,_e=j.localItem,De=j.webUrl||V&&V.webUrl,Pe=new D.e({publisher:P});Pe.resolveItems({items:(q={},q[t]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},u.e.pack(Ee)),s.h.pack(ie)),void 0!==Ce?s.v.pack(Ce):{}),s.m.pack(Ne?{}:void 0)),De?s.O.pack(De):{}),b.n.pack(we)),xe?s.i.pack(decodeURIComponent(xe)):{}),s.f.pack(oe?new Date(oe).getTime():void 0)),s.u.pack(ue?new Date(ue).getTime():void 0)),v.u.pack(pe?new Date(pe).getTime():void 0)),he?Object(r.__assign)({},s.o.pack(new Date(he).getTime())):{}),i.i.pack(de&&"oneNote"===de.type?{}:void 0)),ve?Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f.e.pack(ve)),N.e.pack(!0)),L.e.pack(Object(A.t)(Le.extension))):{}),Object(C.e)().forFacet(v.v).thenInvalidate(Se,f.e).pack()),l.e.pack(j)),Y?s.p.pack(Y):{}),me&&me.width&&me.height?v.a.pack({width:me.width,height:me.height}):{}),me&&!ge?v.p.pack({}):{}),ge?v.g.pack({}):{}),o.t.pack({itemKey:a.e.serialize({driveItemKey:Ee,sortBy:"",isAscending:!0})})),s.n.pack({itemKey:h.e.serialize({driveItemKey:Ee})})),s.M.pack(I?{itemKey:I}:void 0)),!ce&&xe?Object(r.__assign)({},s._.pack(H(xe))):{}),g.e.pack(le)),ce?Object(r.__assign)({},y.e.pack(j.vault)):{}),ce&&j.restricted?Object(r.__assign)({},O.e.pack(j.restricted)):{}),s.d.pack(Le)),R?Object(r.__assign)(Object(r.__assign)({},s.x.pack(!!ye)),p.e.pack(ye)):{}),_e?b.e.pack(_e):{}),"number"==typeof ke?m.e.pack(ke):{}),k.e.pack(U)),M.e.pack(Z)),_.e.pack(!!ne)),b.t.pack(z&&z.mimeType)),Oe?w.e.pack(Oe):{}),Me?x.e.pack(Me):{}),te?T.e.pack(te.name):{}),q)});Pe.resolveItems({items:(re={},re[t]=Object(r.__assign)({},Te?c.e.pack(Te):{}),re)});return{itemResolver:Pe}}}function H(e){var t=e.split("/");return t.length>2?decodeURIComponent(t[t.length-2]):void 0}function B(e,t){var n=e.lastIndexOf(".");return t||n<0?{name:e,extension:""}:{name:e.substring(0,n),extension:e.substring(n)}}},2814:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(23);function i(e){var t;return r.t.isActivated("70112978-C401-4C01-AC5E-CFB577601CD6","","")?e.parentReference:(null===(t=e.remoteItem)||void 0===t?void 0:t.parentReference)||e.parentReference}},2874:function(e,t,n){"use strict";n.d(t,"e",function(){return E});var r=n(0),i=n(199),s=n("react-lib"),o=n(1321),u=n(5),a=n(20),f=n(644),l=n(168),c=n(225),h=n(23).e.isActivated("AB1B9B00-C482-451A-A5DA-500AC7533605","1/31/2022","Require Name to be clickable for parent path to be clickable");var p=n(167),d=n(71),v=n(914),m=n(915),g=n(907),y=n(908),b=n(670),w=n(159),E=Object(v.e)({key:p.u,name:i.f,fieldName:"",isCollapsible:!1,minWidth:445,maxWidth:445,sortProps:d.r,data:{facets:Object(r.__assign)({},w.e.pack("nameAndPath"))}},[m.e,b.t,function(e,t){var n=t.itemKey,r=t.renderer,i=e.demandItemFacet(u.M,n),p=i&&e.demandItemFacet(u.O,i.itemKey)||"",d=p?(function(e){for(var t=[],n=new l.e(e),r=0,i=n.segments.slice(1);r<i.length;r++){var s=i[r];try{t.push(decodeURIComponent(s))}catch(e){t.push(s)}}return t})(p):[],v=i&&p?Object(c.r)(e,s.createElement(f.e,{itemKey:i.itemKey})):null;return{renderer:function(e,t,n){var i=r?r(e,t,n):null;return s.createElement(s.Fragment,null,i?s.createElement(s.Fragment,{key:"content"},i):null,v?s.createElement(a.n,{key:"path",action:v},function(t){var n=t.execute,r=t.isAvailable&&(h||e.isInvokable)?function(e){n({event:e}).catch(function(){});e.preventDefault();e.stopPropagation()}:void 0;return s.createElement(o.e,{displayPathSegments:d,parentLink:r?p:void 0,onClick:r})}):null)}}},g.e,y.e])},2899:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(6),i=new r.e("itemsViewSearch",{getSearchItemKey:r.t,isAvailable:r.t})},3011:function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});var r=n(2),i=new r.e("officeApp"),s=new r.e("officeLens")},3012:function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n(434),i=n(433),s=n(2427),o=n(83),u=n(171),a=n(2428),f=Object(a.e)(i.e,function(e){return function(t){var n=t(Object(u.e)({groupBy:o.L})).groupBy;return{defaultChildItemSet:{itemKey:r.e.serialize({driveItemKey:e,sortBy:"",isAscending:!0,groupBy:n||""})},displayName:s.n,icon:"History"}}})},3013:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(509),i=n(329),s=n(2427),o=n(2428),u=Object(o.e)(r.e,function(e){return function(){return{defaultChildItemSet:{itemKey:i.e.serialize({driveItemKey:e,sortBy:"",isAscending:!0})},displayName:s.s,icon:"People"}}})},3099:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(7),i=new r.e("userByEmail",{email:Object(r.s)(),endpoint:Object(r.s)()})},3100:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("passwordProtectedErrorFacet")},3221:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("thumbnailAccessToken")},3243:function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){return"."===e[0]}},3244:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("graphThumbnailSet")},3246:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("sharepointIds")},3548:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("hasThumbnailAuthTokenFacet")},3549:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("specialFolder")},3733:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=n(165).n.isFeatureEnabled({ODC:"EnableDefaultSortOrderFromBackend"})},3734:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("restricted")},3735:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("tags")},3736:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("isPhotoStreamItem")},4108:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(643),i=function(e){var t=e.replace(".",""),n=Object.keys(r.e);for(var i in n)if(r.e.hasOwnProperty(n[i])){var s=n[i];if(r.e[s].indexOf(t)>-1)return s}}},4109:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("hasPdfFacet")},4110:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("coverImage")},4346:function(e,t,n){"use strict";n.d(t,"e",function(){return h});n.d(t,"t",function(){return p});var r,i=n(0),s=n(59);(function(e){e[e.MalwareDetected=0]="MalwareDetected";e[e.ThisFileIsCheckedOut=1]="ThisFileIsCheckedOut";e[e.DLPBlocked=2]="DLPBlocked";e[e.MissingMetaData=3]="MissingMetaData";e[e.DLPWarning=4]="DLPWarning";e[e.AwaitingApproval=5]="AwaitingApproval";e[e.Trending=6]="Trending";e[e.New=7]="New";e[e.NeedsRepublishing=8]="NeedsRepublishing"})(r||(r={}));var o=n(1195),u=n(40),a=n(573),f=n(1192),l=n(4920);var c="/_layouts/15/userphoto.aspx?size=S&accountname=",h=(function(){function e(e,t){this._eTagMap={};this._dataRequestor=t.vroomDataRequestor;var n=t.getProfileImageUrl,r=void 0===n?function(e){return Object(o.e)(e)}:n,i=t.caller,s=void 0===i?"hovercard":i,u=t.useSharePointApi,a=void 0!==u&&u;this._getProfileImageUrl=r;this._caller=s;this._useSharePointApi=a}e.prototype.getItemAnalytics=function(e,t){void 0===t&&(t={});var n=t.apiVersion,r=void 0===n?"v2.1":n,i=t.skipToken,o=void 0===i?"":i,u=t.headers,a=void 0===u?{Caller:this._caller}:u,f=o?";$skiptoken=".concat(o):"",l=e.queryType?"_".concat(e.queryType):"",c="GetItemAnalytics".concat(r).concat(l,"_WithGuestUser"),h=this._getBaseUrl(e);if(!h)return s.n.resolve();var p="".concat(h,"/analytics/allTime?$expand=activities"),d="".concat(p).concat("($filter=access%20ne%20null)").concat(f);return this._getAnalytics(c,d,!1,e,a)};e.prototype.getAnalyticsSections=function(e,t){void 0===t&&(t={});if(this._useSharePointApi)return s.n.reject(void 0);var n=t.headers,r=void 0===n?{Caller:this._caller}:n,i=this._getBaseUrl(e);if(!i)return s.n.resolve();",id,reactions";"$expand=insights($expand=keyPoints)";",malware,metadataMissing,awaitingApproval,trending,retentionPolicy,publication,dataLossPrevention";var o="$select=*".concat(",id,reactions").concat(",malware,metadataMissing,awaitingApproval,trending,retentionPolicy,publication,dataLossPrevention"),u="".concat(o,"&").concat("$expand=insights($expand=keyPoints)"),a=this._useSharePointApi?"".concat(i,"/driveItem?").concat(u):"".concat(i,"?").concat(u);return this._getAnalytics("GetAnalyticsSections_WithReaction_WithKeyPoints_WithLifeCycle",a,!0,e,r)};e.prototype.getItemAnalyticsSections=function(e,t){void 0===t&&(t={});var n="$expand=analytics($expand=allTime($expand=activities($filter=access%20ne%20null)))",r=this._getBaseUrl(e);if(!r)return s.n.resolve();var i=t.apiVersion,o=void 0===i?"v2.1":i,u=t.headers,a=void 0===u?{Caller:this._caller}:u,f=e.queryType?"_".concat(e.queryType):"";if(this._useSharePointApi){var l="GetItemAnalyticsSharePoint".concat(o).concat(f),c="".concat(r,"/driveItem?").concat(n);return this._getAnalytics(l,c,!0,e,a)}var h="GetItemAnalyticsSections".concat(o).concat(f,"_WithGuestUser_WithReaction_WithKeyPoints_WithLifeCycle"),p="$select=*".concat(",id,reactions").concat(",malware,metadataMissing,awaitingApproval,trending,retentionPolicy,publication,dataLossPrevention"),d="".concat(p,"&").concat(n).concat(",insights($expand=keyPoints)"),v="".concat(r,"?").concat(d);return this._getAnalytics(h,v,!0,e,a)};e.prototype.getLastSevenDaysItemAnalytics=function(e){var t=this._getBaseUrl(e),n={Caller:this._caller};if(!t)return s.n.resolve();var r="".concat(t,"/analytics/lastSevenDays?$expand=activities($filter=ActivityType%20eq%20%27Access%27)");return this._getAnalytics("GetLastSevenDaysItemAnalytics",r,!1,e,n)};e.prototype.getItemAnalyticsByInterval=function(e,t,n,r){var i=t.toISOString(),s=n.toISOString(),o=this._getBaseUrl(e)||"",u=this._getAnalyticsByIntervalPath(o,"v2.1",i,s,r);return this._getAnalyticsByInterval("GetDailyItemAnalytics",u,e.getAccessToken&&e.getAccessToken(),"v2.1")};e.prototype._getAnalytics=function(e,t,n,r,s,o){var u=this;return this._dataRequestor.send({apiName:e,path:t,accessToken:r.getAccessToken&&r.getAccessToken(),headers:s,timeout:6e3,qosExtraData:{Caller:this._caller}}).then(function(e){"string"==typeof e.isTrending&&"True"===e.isTrending||"boolean"==typeof e.isTrending&&!0===e.isTrending?e.isTrending=!0:e.isTrending=!1;e.eTag&&(u._eTagMap[r.itemId]=e.eTag);return n?p(e,u._getProfileImageUrl):(function(e,t){var n=e.activities,r=e.access,s=e.endDateTime,o=Object(i.__rest)(e,["activities","access","endDateTime"]);return{activities:v(n,t),incompleteData:o.incompleteData,startDateTime:o.startDateTime,skipToken:o.skipToken,isTrending:o.isTrending,viewCount:r&&r.actionCount,viewerCount:r&&r.actorCount,lastActivityDateTime:s}})(e,u._getProfileImageUrl)})};e.prototype.updateItemKeyPoints=function(e,t){var n=this,r="".concat(this._getBaseUrl(e),"/insights/keyPoints");return this._dataRequestor.send({path:r,apiName:"UpdateKeyPoints",requestType:"POST",headers:{Caller:this._caller,"if-Match":this._eTagMap[e.itemId]},postData:JSON.stringify({value:t}),accessToken:e.getAccessToken&&e.getAccessToken(),timeout:6e3,qosExtraData:{Caller:this._caller},parseResponse:function(t){n._eTagMap[e.itemId]=t.getResponseHeader("eTag")||"";return JSON.parse(t.responseText)}}).then(function(e){return e.value})};e.prototype._getAnalyticsByInterval=function(e,t,n,r){return this._dataRequestor.send({apiName:e,path:t,accessToken:n,useAuthorizationHeaders:this._useSharePointApi,timeout:6e3,qosExtraData:{Caller:this._caller}}).then(function(e){var t;"v2.1"===r?(e=e)&&e.value&&(t=e.value.map(m)):t=(e=e).Items;return t})};e.prototype._getBaseUrl=function(e){return e&&e.graphItemUrl?"".concat(e.graphItemUrl):null};e.prototype._getAnalyticsByIntervalPath=function(e,t,n,r,i){var s;i=i||"day";var o="v2.1"===t?"oneDrive.getActivitiesByInterval":"getanalyticsbyinterval";s=this._useSharePointApi?"interval='".concat(i,"',startDateTime='").concat(n,"',endDateTime='").concat(r,"'"):"v2.1"===t?"startDateTime=".concat(n,"&endDateTime=").concat(r,"&interval=").concat(i):"startDateTime='".concat(n,"'&endDateTime='").concat(r,"'&interval='").concat(i,"'");return this._useSharePointApi?"".concat(e,"/oneDrive.getActivitiesByInterval(").concat(s,")"):"".concat(e,"/").concat(o,"?").concat(s)};e.prototype.getFilesAnalytics=function(e,t,n){var r=this;return e&&t?this._dataRequestor.send({apiName:"getFilesAnalytics.byItems",useAuthorizationHeaders:!0,accessToken:n,apiVersion:"v2.1",path:"".concat(t,"/items?$expand=analytics($expand=lastSevenDays)&$filter=sharepointIds/listItemUniqueId eq '").concat(e.join("' or sharepointIds/listItemUniqueId eq '"),"'"),postProcessQos:this._overrideFilesAnalyticsExpectedFailure}).then(function(e){return r._parseFilesAnalyticsResponse(e)}):s.n.resolve()};e.prototype.getRecommendedActions=function(e){var t="".concat(this._getBaseUrl(e)).concat("?$expand=recommendedActionSet($expand=nonAggregatedRecommendedActions,aggregatedEditRecommendedAction($expand=importantActorsAndActivities))");return this._dataRequestor.send({apiName:"RecommendedActions",path:t,accessToken:e.getAccessToken&&e.getAccessToken(),timeout:6e3,parseResponse:function(e){return JSON.parse(e.responseText).recommendedActionSet},headers:{Caller:this._caller},qosExtraData:{Caller:this._caller}})};e.prototype.getShareWith=function(e){var t="".concat(this._getBaseUrl(e)).concat("/recommendations/shareWith/users?$top=2&$filter=userType eq 'Internal'");return this._dataRequestor.send({apiName:"ShareWith",path:t,accessToken:e.getAccessToken&&e.getAccessToken(),timeout:6e3,parseResponse:function(e){return JSON.parse(e.responseText).value},headers:{Caller:this._caller},qosExtraData:{Caller:this._caller}})};e.prototype._overrideFilesAnalyticsExpectedFailure=function(e,t){var n=t?Object(a.t)(t,function(e){switch(e){case"notSupported":return{resultType:u.e.ExpectedFailure}}}):{};return Object(i.__assign)(Object(i.__assign)({},e),n)};e.prototype._parseFilesAnalyticsResponse=function(e){var t=this,n=(e.value,Object(i.__rest)(e,["value"])),r=e.value.map(function(e){var n=e.analytics,r=Object(i.__rest)(e,["analytics"]);return Object(i.__assign)(Object(i.__assign)({},r),{analytics:{lastSevenDays:d(n.lastSevenDays,t._getProfileImageUrl)}})});return Object(i.__assign)(Object(i.__assign)({},n),{value:r})};return e})();function p(e,t){var n=e&&e.analytics&&e.analytics.allTime,i=n&&n.access,s=n&&n.endDateTime,o=v(n&&n.activities,t),u=(function(e){var t=[];e.malware&&t.push({status:r.MalwareDetected});e.publication&&e.publication.level.indexOf("checkout")>-1&&t.push({status:r.ThisFileIsCheckedOut,userCheckedOutThis:e.publication.checkedOutBy&&e.publication.checkedOutBy.user});e.dataLossPrevention&&(e.dataLossPrevention.block?t.push({status:r.DLPBlocked}):e.dataLossPrevention.notify&&t.push({status:r.DLPWarning}));e.metadataMissing&&t.push({status:r.MissingMetaData});e.awaitingApproval&&t.push({status:r.AwaitingApproval});e.trending&&t.push({status:r.Trending});if(e.createdDateTime){var n=new Date(e.createdDateTime);(i=n,s=(new Date).getTime(),o=i&&i.valueOf(),!isNaN(o)&&s-o<1728e5)&&t.push({status:r.New,createdRelativeTime:Object(f.n)(Object(l.t)(e.createdDateTime)),creator:e.createdBy&&e.createdBy.user})}var i,s,o;return t})(e),a=(function(e){var t=e&&e.insights,n=t&&t.keyPoints;return t&&{readTime:t.readTime,keyPoints:n}})(e),c=e&&e.reactions;return{activities:o||[],incompleteData:n&&n.incompleteData,startDateTime:n&&n.startDateTime,skipToken:n&&n.skipToken,isTrending:n&&n.isTrending,viewCount:i&&i.actionCount,viewerCount:i&&i.actorCount,commentCount:c&&c.commentCount,likeCount:c&&c.likeCount,lifeCycleStatus:u,keyPointsData:a,lastActivityDateTime:s,createdBy:e.createdBy&&e.createdBy.user,createdDateTime:e.createdDateTime}}function d(e,t){e.activities;var n=Object(i.__rest)(e,["activities"]),r=e.activities&&e.activities.map(function(e){var n=Object(i.__rest)(e,[]),r=n.actor&&n.actor.user&&n.actor.user.email;n.activityDateTime=Object(f.n)(Object(l.t)(n.activityDateTime));n.actor.user.image=t&&t(n.actor.user.email)||"".concat(c).concat(r);return n});return Object(i.__assign)(Object(i.__assign)({},n),{activities:r})}function v(e,t){return e&&e.map(function(e){var n=Object(i.__rest)(e,[]),r=n.actor&&n.actor.user&&n.actor.user.email,s=Object(i.__assign)(Object(i.__assign)({},n.actor.user),{image:t?t(r):"".concat(c).concat(r),userType:n.actor.user.userType});return Object(i.__assign)(Object(i.__assign)({},n),{activityDateTime:Object(f.n)(Object(l.t)(n.activityDateTime)),actor:Object(i.__assign)(Object(i.__assign)({},n.actor),{location:n.location,user:s}),activityType:n.access?"Access":"Edit"})})}function m(e){return e&&{activity:{},incompleteData:{missingDataBeforeDateTime:e.endDateTime,wasThrottled:e.incompleteData&&e.incompleteData.wasThrottled},isTrending:e.isTrending,startDateTime:e.startDateTime,viewCount:e.access&&e.access.actionCount,viewerCount:e.access&&e.access.actorCount}}},5110:function(e,t,n){"use strict";n.r(t);n.d(t,"graphAddon",function(){return Xf});var r=n(0),i=n(13),s=n(1488),o=n(1552),u=n(281),a=n(3013),f=n(329),l=n(335),c=n(747),h=n(171),p=n(261),d=n(9),v=n(7),m=new v.e("driveItemPage",{endpoint:Object(v.s)(),setItemKey:Object(v.s)(),token:Object(v.s)()}),g=n(219),y=n(268),b=n(377),w=n(83),E=n(353),S=n(40),x=n(168),T=n(2762),N=n(102),C=n(5),k=n(768),L=n(1232),A=new v.e("userById",{id:Object(v.s)(),endpoint:Object(v.s)()}),O=n(212),M=n(2),_=new M.e("sharedBy"),D=n(3099);function P(e){var t=e.itemKey,n=e.driveItemKey,i=e.parentFolderItemKey,s=e.setItemKey,o=e.driveItemResponse,u=e.endpoint,a=e.getDriveItemFacets,f=void 0===a?T.e:a,l=e.shouldInvalidateItemSetOnChildItemRename,c=void 0===l?void 0:l;return function(e){var a,l=new g.e({publisher:P}),h=k.e.serialize({driveItemKey:n}),v=void 0;if(s){var m=Object(p.e)().forFacet(C.l).thenInvalidate(s,d.e).forFacet(C.M).thenInvalidate(s,d.e);c&&!c(u)||(m=m.forFacet(C.h).thenInvalidate(s,d.e));v=m.pack()}l.merge(e(f({itemKey:t,driveItemKey:n,driveItem:o,endpoint:u,parentFolderItemKey:i})).itemResolver);l.resolveItems({items:(a={},a[t]=Object(r.__assign)(Object(r.__assign)({},C.e.pack({itemKey:h})),v),a)});if(o.lastModifiedBy){if(E=o.lastModifiedBy.user){var y=E.id&&A.serialize({id:E.id,endpoint:u});if(y=E.email&&D.e.serialize({email:E.email,endpoint:u})){var b=H({itemKey:t,personFacet:C.A,userKey:y,user:E}).itemResolver;l.merge(b)}}}if(o.createdBy){var w=void 0;if((E=o.createdBy.user)&&E.email&&(w=D.e.serialize({email:E.email,endpoint:u}))){b=H({itemKey:t,personFacet:L.r,userKey:w,user:E}).itemResolver;l.merge(b)}}if(o.remoteItem&&o.remoteItem.shared&&o.remoteItem.shared.sharedBy&&o.remoteItem.shared.sharedBy.user){var E,S=void 0;if((E=o.remoteItem.shared.sharedBy.user).email&&(S=D.e.serialize({email:E.email,endpoint:u}))){b=H({itemKey:t,personFacet:_,userKey:S,user:E}).itemResolver;l.merge(b)}}return{itemResolver:l}}}function H(e){var t,n,i=e.itemKey,s=e.personFacet,o=e.userKey,u=e.user,a=new g.e({publisher:H});a.resolveItems({items:Object(r.__assign)((t={},t[o]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},C.h.pack(u.displayName)),O.e.pack(u.email)),O.i.pack(u.id)),t),s&&(n={},n[i]=Object(r.__assign)({},s.pack({itemKey:o,displayValue:u.displayName})),n))});return{itemResolver:a}}var B=n(2589),j=new v.e("driveItem",{endpoint:Object(v.s)(),driveId:Object(v.s)({shouldNormalizeToEmpty:!0}),canonicalUrl:Object(v.s)()});function F(e){var t=e.driveItemResponse,n=e.endpoint,i=e.getDriveItemFacets,s=void 0===i?T.e:i;return function(i){var o,u,a,f=t.remoteItem,l=f&&f.parentReference,c=t.parentReference,h=c||l,p=h&&h.driveId,d=h&&h.id,v="personal"===(h&&h.driveType),m=!!t.root;if(f){a=f.id;l&&(p=l.driveId)}else a=v&&t.root?B.r:t.id;var g={endpoint:n,driveId:p,itemId:a},y=N.e.serialize(g),b=t&&(t.webDavUrl||t.webUrl),w=v&&h&&h.path===B.e?B.r:d||void 0,E=h&&w?N.e.serialize({endpoint:n,driveId:h.driveId||p,itemId:w}):void 0,S=[],T="";if(!v&&b){var k=new x.e(b);S.push.apply(S,k.path.split("/").slice(1,-1).map(function(e){return decodeURIComponent(e)}));S.unshift(k.authority);T=S.join("/")}h&&!m&&!w&&T&&(E=j.serialize({endpoint:n,driveId:h.driveId,canonicalUrl:T}));var L=i(P(Object(r.__assign)(Object(r.__assign)({},e),{itemKey:y,driveItemKey:g,parentFolderItemKey:E}))).itemResolver;L.resolveItems({items:Object(r.__assign)({},E&&(o={},o[E]=Object(r.__assign)({},T?C.O.pack(T):{}),o))});if(f&&l){var A=N.e.serialize({endpoint:n,driveId:c&&c.driveId,itemId:t.id}),O=N.e.serialize({endpoint:n,driveId:l.driveId,itemId:f.id});L.mapKeys({mappings:(u={},u[A]=O,u)});L.merge(i(s({itemKey:O,driveItem:t,endpoint:n})).itemResolver)}return{itemResolver:L,actualDriveItemKey:g,actualItemKey:y}}}var I=n(122),q=n(57),R=new M.e("itemSetEngagementExtraData"),U=n(130),z=n(1214),W=n(3244),X=n(2757),V=new M.e("mountPoint"),$=n(307),J=n(662),K=n(1243),Q=n(2427),G=n(158),Y=n(898),Z=n(3245),ee=n(888),te=n(3011),ne=n(4108),re=n(3246),ie=n(3549),se=n(3548),oe=n(2499),ue=n(4110),ae=n(4109),fe=n(1403),le=n(3735),ce=n(3736),he=n(354),pe=n(3734),de=n(23),ve=!de.t.isActivated("D828DE11-7FE0-424F-8417-A1CA75D2A2BB","02/08/2022","Fixes issues with shortcut icons in ODC List views");function me(e){var t=e.itemKey,n=e.driveItemKey,i=e.driveItem,s=e.endpoint,o=e.parentFolderItemKey,u=e.shouldReturnShareFacets,a=void 0===u||u,f=i.coverImage,l=i.file,c=i.fileSystemInfo,h=i.name,v=i.parentReference,m=i.lenses,y=i.remoteItem,b=i.root,w=i.size,E=i.thumbnails,S=i.image,x=i.video,T=i.eTag,k=i.photo,L=i.restricted,A=i.tags,O=i.specialFolder,M=i.photoStreamItemSource;return function(e){var u,_,D,P,H,B,j,F,I,R,de,ge=i.lastModifiedDateTime,ye=void 0===ge?c&&c.lastModifiedDateTime:ge,be=i.createdDateTime||c&&c.createdDateTime,we=(new Date).getTime(),Ee=be?new Date(be).getTime():void 0,Se=Ee?we-Ee<1728e5:void 0,xe=v&&v.driveId,Te=v&&v.driveType,Ne="personal"===Te,Ce=c&&c.lastAccessedDateTime,ke=(null==k?void 0:k.takenDateTime)||(null==k?void 0:k.alternateTakenDateTime),Le=i.package,Ae=E,Oe=S,Me=x,_e=i.shared||(null===(H=i.remoteItem)||void 0===H?void 0:H.shared),De={itemId:i.id,driveId:xe,endpoint:s},Pe=c&&c.systemPath,He=void 0;if(y){He={itemId:y.id,driveId:y.parentReference&&y.parentReference.driveId||"",endpoint:s};de=N.e.serialize({itemId:y.id,driveId:null!==(j=null===(B=y.parentReference)||void 0===B?void 0:B.driveId)&&void 0!==j?j:xe,endpoint:s})}var Be,je=n||De,Fe=N.e.serialize(je),Ie=i.webDavUrl;Be="business"!==Te&&"documentLibrary"!==Te&&"personal"!==Te||!b?h||"":Q.t;var qe,Re=i.bundle||(null==y?void 0:y.bundle),Ue=i.folder||(null==y?void 0:y.folder)||Re;Ue&&(qe=ve?y?12:_e?5:2:_e?y?12:5:2);var ze=(null===(F=null==Ue?void 0:Ue.folderView)||void 0===F?void 0:F.sortBy)||"",We="descending"===(null===(I=null==Ue?void 0:Ue.folderView)||void 0===I?void 0:I.sortOrder),Xe=ze&&{columnKey:Object(he.l)(ze),isAscending:!We},Ve=null!=w?w:null==y?void 0:y.size,$e=null==Ue?void 0:Ue.childCount,Je=(function(e,t){var n=e.lastIndexOf(".");if(t||n<0)return{name:e,extension:""};return{name:e.substring(0,n),extension:e.substring(n)}})(Be,!!Ue),Ke=Je.extension||i.package&&i.package.type,Qe=Ke&&Object(ne.e)(Ke),Ge=i.sharepointIds,Ye=i.localItem,Ze=i.webUrl,et=new g.e({publisher:me});et.resolveItems({items:(u={},u[t]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},N.e.pack(je)),C.h.pack(Be)),ee.n.pack(Pe)),C.f.pack(ye?new Date(ye).getTime():void 0)),C.u.pack(Ee)),G.u.pack(ke?new Date(ke).getTime():void 0)),C.S.pack(Se)),U.i.pack(Le&&"oneNote"===Le.type?{}:void 0)),Object(p.e)().forFacet(G.v).thenInvalidate(Fe,W.e).pack()),X.e.pack(i)),d.t.pack({itemKey:z.e.serialize({driveItemKey:je,sortBy:ze,isAscending:!We})})),C.n.pack({itemKey:J.e.serialize({driveItemKey:je})})),C.M.pack(o?{itemKey:o}:void 0)),Y.e.pack(Te)),C.d.pack(Je)),oe.e.pack(Re)),ue.e.pack(f)),ee.t.pack(l&&l.mimeType)),V.pack(He)),te.t.pack(m&&m.length>0?m:void 0)),le.e.pack(A)),ce.e.pack(!!M)),C.m.pack(Ue?{}:void 0)),Ce?Object(r.__assign)({},C.o.pack(new Date(Ce).getTime())):{}),Ae?Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.e.pack(Ae)),se.e.pack(!0)),ae.e.pack(Object(fe.t)(Je.extension))):{}),T?C.p.pack(T):{}),Oe&&Oe.width&&Oe.height?G.a.pack({width:Oe.width,height:Oe.height}):{}),Oe&&!Me?G.p.pack({}):{}),Me?G.g.pack({}):{}),Ne?Object(r.__assign)({},Z.e.pack(i.vault)):{}),a?Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},C.x.pack(!!_e)),K.e.pack(_e)),qe?U.e.pack(qe):{}):{}),u)});(null===(R=i.vault)||void 0===R?void 0:R.root)&&et.mapKeys({mappings:(_={},_[N.e.serialize({endpoint:s,driveId:xe,itemId:"vault"})]=t,_)});et.resolveItems({items:(D={},D[t]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},void 0!==Ve?C.v.pack(Ve):{}),Ze?C.O.pack(Ze):{}),Xe?d.u.pack(Xe):{}),Ie?C.i.pack(decodeURIComponent(Ie)):{}),Ye?ee.e.pack(Ye):{}),"number"==typeof $e?q.e.pack($e):{}),Qe?te.e.pack(Qe):{}),L?pe.e.pack(L):{}),Ge?re.e.pack(Ge):{}),O?ie.e.pack(O.name):{}),D)});et.resolveItems({items:(P={},P[t]=Object(r.__assign)({},ve?$.e.pack(de?{itemKey:de}:void 0):de?$.e.pack({itemKey:de}):{}),P)});return{itemResolver:et}}}function ge(e){var t=e.driveItemResponse,n=e.endpoint;return function(i){var s=t.parentReference,o=s&&s.driveId,u=s&&s.id,a=t.id;t.root&&(a=B.r);var f={endpoint:n,driveId:o,itemId:a},l=N.e.serialize(f),c=s&&s.path===B.e?B.r:u||void 0,h=s&&c?N.e.serialize({endpoint:n,driveId:s.driveId,itemId:c}):void 0;return{itemResolver:i(P(Object(r.__assign)(Object(r.__assign)({},e),{itemKey:l,driveItemKey:f,getDriveItemFacets:me,parentFolderItemKey:h}))).itemResolver,actualDriveItemKey:f,actualItemKey:l}}}function ye(e){return function(t){var n,i,s,o,u,a=e.itemKey,f=e.parentItemKey,l=e.itemSetKeyFacet,c=e.filterChildItems,v=e.onProcessResponse,T=e.groupChildItems,N=e.response,C=e.skip,k=void 0===C?0:C,L=e.enableRandomAccess,A=void 0!==L&&L,O=e.disableRemoteItem,M=e.totalChildCount,_=e.getDriveItemFacets,D=l.deserialize(a),P=D.driveItemKey.endpoint,H=new g.e({publisher:ye}),B=t(Object(E.e)({name:"remoteItemsMissingParentRef"})),j="number"==typeof N["@odata.count"]?N["@odata.count"]:M||N.value.length,U=N["@odata.nextLink"],z=!!U,W=t(Object(I.e)(function(e){return{childItemsFacetResolved:e.isItemFacetResolved(d.e,a),prevChildKeys:e.demandItemFacet(d.e,a)}})),X=W.childItemsFacetResolved,V=W.prevChildKeys,$=V&&V.itemKeys,J=0,K=0;A&&(X&&$?u=$.slice(0):"number"==typeof j&&(u=new Array(j+(z&&j<=N.value.length?1:0))));u||(u=new Array(N.value.length+(z?1:0)));for(var Q=k,G=0,Y=0,Z=N.value;Y<Z.length;Y++){var ee=Z[Y],te=c&&c(ee),ne=ee.remoteItem,re=!(ee.remoteItem&&ee.remoteItem.parentReference&&ee.remoteItem.parentReference.driveId),ie=ne&&re;ie&&G++;if(te||ie){u.splice(Q,1);j--}else{var se=t(Object(h.e)({graphEndpoint:w.m,graphRecentEndpoint:w.b,processDriveItemSet:w.C,allowDisableRemoteItemInPlace:w.i})),oe=se.graphEndpoint,ue=se.graphRecentEndpoint,ae=se.processDriveItemSet,fe=se.allowDisableRemoteItemInPlace&&O,le=fe?ge:F,ce=ee.webDavUrl||!fe&&ee.remoteItem&&ee.remoteItem.webDavUrl||ee.webUrl,he=P.indexOf("/_api/v2.0")>-1||P.indexOf("/_api/v2.1")>-1,pe=oe||ue;if(ce&&he){var de=ce&&decodeURIComponent(ce);P=pe?"".concat(new x.e(de).authority,"/_api/v2.0"):"".concat(new x.e(de).authority).concat(new x.e(P).path)}var ve=t(le({shouldInvalidateItemSetOnChildItemRename:ae&&ae.shouldInvalidateItemSetOnChildItemRename,setItemKey:a,driveItemResponse:ee,endpoint:P,getDriveItemFacets:_})),me=ve.itemResolver,be=ve.actualItemKey,we=ve.actualDriveItemKey,Ee=ee.thumbnails,Se=ee.remoteItem;J++;(Ee||!fe&&Se&&Se.thumbnails)&&K++;u[Q]=be;H.merge(me);if(v){var xe=v({itemKey:a,driveItemKey:we,item:ee});xe&&H.merge(xe.itemResolver)}var Te=t(Object(h.e)({processDriveItemFromSharePoint:w.N})).processDriveItemFromSharePoint;if(Te&&(he||pe)){var Ne=t(Te.process({itemKey:be,driveItem:ee})).itemResolver;H.merge(Ne)}Q++}}t(B(Object(r.__assign)({resultType:G<1?S.e.Success:S.e.Failure},G>0?{extraData:{count:G}}:{})));if(z){var Ce=m.serialize({setItemKey:a,endpoint:P,token:U});H.merge(Object(y.t)({itemKey:Ce}).itemResolver);u[Q]=Ce}if(T){var ke=T(D);ke&&H.merge(ke.itemResolver)}else H.resolveItems({items:(n={},n[a]=Object(r.__assign)({},d.e.pack({itemKeys:u})),n)});H.resolveItems({items:(i={},i[a]=Object(r.__assign)({},R.pack({childCount:J,childCount_withThumbnail:K})),i)});j!==M&&H.resolveItems({items:(s={},s[f]=Object(r.__assign)({},q.e.pack(j)),s)});H.resolveItems({items:(o={},o[a]=Object(r.__assign)(Object(r.__assign)({},d.s.pack({itemKey:f})),Object(p.e)().forFacet(d.e).thenInvalidate(b.e).pack()),o)});return{itemResolver:H}}}var be=n(411),we=n(242);function Ee(e){var t=e.itemKey,n=e.itemSetKeyFacet,i=e.parentItemKeyFacet,s=e.childItemsResponse,o=e.disableRemoteItem,u=e.parentItemResponse,a=e.mapItemSetKey,f=n.deserialize(t),l=i.serialize(f.driveItemKey),c=f.driveItemKey.endpoint;return function(n){var i,f;we.t(be.e.processData.start);var v=n(ye(Object(r.__assign)(Object(r.__assign)({},e),{response:s,disableRemoteItem:o,parentItemKey:l}))).itemResolver;if(a){var m=a().itemResolver;v.merge(m)}var g=n(Object(h.e)({allowDisableRemoteItemInPlace:w.i})).allowDisableRemoteItemInPlace;if(u){var y=n((g&&o?ge:F)({setItemKey:t,driveItemResponse:u,endpoint:c})),b=y.itemResolver,E=y.actualItemKey;v.mapKeys({mappings:(i={},i[E]=l,i)});v.merge(b)}v.resolveItems({items:(f={},f[l]=Object(r.__assign)({},Object(p.e)().forFacet(d.t).thenInvalidate(e.itemKey,d.e).pack()),f)});we.t(be.e.processData.end);return{itemResolver:v}}}var Se=n(403),xe=de.t.isActivated("cade488d-480a-444f-a1ea-d3d121529bb7","11/01/2021","Set one minute timeout for API requests");function Te(e){var t=this,n=e.itemKey,i=e.itemSetKeyFacet,s=e.getUrl,o=e.sortChildItems,u=e.qosName,a=e.preprocessResponse,f=e.expectedErrors,h=e.disableRemoteItem,p=void 0!==h&&h,d=e.scenarioInfo,v=i.deserialize(n),m=v.driveItemKey.endpoint;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,h,g,y,b;return Object(r.__generator)(this,function(w){switch(w.label){case 0:t=Object(l.n)(v.driveItemKey);w.label=1;case 1:w.trys.push([1,4,,5]);return[4,n(Object(c.n)({url:s(v),driveUrl:t,qosName:"getChildren".concat(u?".".concat(u):""),endpoint:m,headers:e.additionalHeaders,expectedErrors:f,timeout:xe?void 0:6e4,scenarioInfo:d}))];case 2:i=w.sent();h=Object(r.__spreadArray)([],i.value,!0);g=a&&a(h)||i.value;y=o&&o(g)||g;return[4,n(Ee(Object(r.__assign)(Object(r.__assign)({},e),{disableRemoteItem:p,childItemsResponse:Object(r.__assign)(Object(r.__assign)({},i),{value:y})})))];case 3:return[2,{itemResolver:w.sent().itemResolver}];case 4:b=w.sent();throw new Se.e(Object(r.__assign)({code:"UnknownError"},b instanceof Error?{innerError:b}:{message:JSON.stringify(b)}));case 5:return[2]}})})}}var Ne=n(509),Ce=n(112),ke=n(574),Le=n(867),Ae=n(272);function Oe(e,t){var n=new Date(e.valueOf());n.setDate(n.getDate()-t);return n}var Me=n(2181),_e="fileName",De="sharedByName",Pe="dateModified";var He=new Map([["code",Ce.e.text],["csv",Ce.e.excel],["docx",Ce.e.word],["dotx",Ce.e.word],["one",Ce.e.onenote],["onepkg",Ce.e.onenote],["onetoc",Ce.e.onenote],["pdf",Ce.e.pdf],["photo",Ce.e.media],["potx",Ce.e.powerpoint],["ppsx",Ce.e.powerpoint],["pptx",Ce.e.powerpoint],["rtf",Ce.e.text],["txt",Ce.e.text],["video",Ce.e.media],["xlsx",Ce.e.excel],["xltx",Ce.e.excel],["zip",Ce.e.zip]]);function Be(e,t){var n,r,i=(n=e,r=Object(ke.t)(n,!0),Object(Le.n)(r)),s=He.get(i);return!!s&&Object(Ce.t)(t.filters,s)}function je(e,t){void 0===t&&(t=[]);return t.every(function(t){var n,r=!(t.type===De)||(function(e,t){var n=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedBy&&e.remoteItem.shared.sharedBy.user&&e.remoteItem.shared.sharedBy.user.displayName;return!!n&&t.indexOf(n)>-1})(e,t.values),i=!(t.type===_e)||(function(e,t){return!!e.name&&Be(e.name,t)})(e,Object(Ae.t)(t.values)),s=!(t.type===Pe)||(function(e,t){var n=e.lastModifiedDateTime||"";return(n&&new Date(n))>=t})(e,(function(e){var t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate());switch(e){case Me.e.today:return n;case Me.e.yesterday:return Oe(n,1);case Me.e.last7Days:return Oe(n,7);case Me.e.last30Days:return Oe(n,30);case Me.e.last3Months:return Oe(n,90);default:return new Date(0)}})((n=t.values).length<1||-1===Object.keys(Me.e).indexOf(n[0])?Me.e.none:Me.e[n[0]]));return r&&i&&s})}var Fe=n(167);function Ie(e,t,n){var r=e.lastModifiedDateTime,i=t.lastModifiedDateTime,s=r&&i&&new Date(r).getTime()-new Date(i).getTime()||0,o=r&&i&&new Date(i).getTime()-new Date(r).getTime()||0;return n?s:o}function qe(e,t,n){var r=e&&e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedDateTime,i=t&&t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedDateTime,s=r&&i&&new Date(r).getTime()-new Date(i).getTime()||0,o=r&&i&&new Date(i).getTime()-new Date(r).getTime()||0;return n?s:o}function Re(e,t,n){var r=e.name,i=t.name,s=r&&i&&r.localeCompare(i)||0,o=r&&i&&i.localeCompare(r)||0;return n?s:o}function Ue(e,t,n){var r=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedBy&&e.remoteItem.shared.sharedBy.user&&e.remoteItem.shared.sharedBy.user.displayName,i=t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedBy&&t.remoteItem.shared.sharedBy.user&&t.remoteItem.shared.sharedBy.user.displayName,s=r&&i&&r.localeCompare(i)||0,o=r&&i&&i.localeCompare(r)||0;return n?s:o}function ze(e,t,n,i){return(function(e,t){return Object(r.__spreadArray)([],e,!0).sort(t)})(e,function(e,r){var s=e.folder,o=r.folder;return n&&s&&!o?-1:n&&!s&&o?1:i(e,r,t)})}var We=new v.e("SharedByPersonKeyFacet",{displayName:Object(v.s)(),email:Object(v.s)(),id:Object(v.s)()}),Xe=new v.e("dateSharedGroupKeyFacet",{relativeTime:Object(v.s)(),sharedDateTime:Object(v.s)()}),Ve=new v.e("relativeTimeGroupKeyFacet",{relativeTime:Object(v.s)()}),$e=n(4524),Je=n(591),Ke=n(18),Qe=n(60),Ge=n(4522),Ye=(Ge.P,Ge.l,Ge.B,Ge.j,Ge.H,Ge.i,Ge.p,Ge.O,Ge.N,Ge._,Ge.D,Ge.M,Ge.b,Ge.L,Ge.w,Ge.y,Ge.x,Ge.v,Ge.T,Ge.S,Ge.E,Ge.m,Ge.A,Ge.k,Ge.C,Ge.g,[Ge.s,Ge.r,Ge.a,Ge.e,Ge.f,Ge.u,Ge.o,Ge.t,Ge.d,Ge.h,Ge.c,Ge.n]),Ze=de.t.isActivated("1E74BB9A-47A2-40F6-89FA-C628928BEC2F","04/12/2022","Enable grouping of items that are missing the email or display name of the person who shared an item");function et(e){if(f.e.matches(e)){var t=f.e.deserialize(e).groupBy;if(t===he.r[he.a])return(function(e){var t={},n=function(i){for(var s,o,u=new g.e({publisher:n}),a=(function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];if(!We.matches(i))return e;var s=We.deserialize(i);t.push(s)}return t.sort(function(e,t){return e&&t&&e.displayName.localeCompare(t.displayName)}).map(function(e){return We.serialize(e)})})(Object.keys(t)),f=[],l=0,c=a;l<c.length;l++){var h=c[l];if(We.matches(h)){var p=We.deserialize(h);u.resolveItems({items:(s={},s[h]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},C.h.pack(p.displayName)),q.s.pack(!0)),d.e.pack({itemKeys:t[h]})),s)});f.push(h)}}u.resolveItems({items:(o={},o[e]=Object(r.__assign)(Object(r.__assign)({},d.e.pack({itemKeys:f})),Qe.e.pack(!0)),o)});return{itemResolver:u}};return{onProcessResponse:function(e){var n,i,s,o,u,a=e.driveItemKey,f=e.item;if(f&&a){var l=f.remoteItem,c=l&&l.shared&&(null!==(n=l.shared.sharedBy)&&void 0!==n?n:l.shared.owner),h=(null===(i=null==c?void 0:c.user)||void 0===i?void 0:i.displayName)||(Ze?"":(null===(s=null==c?void 0:c.user)||void 0===s?void 0:s.email)||$e.u),p=Object(r.__assign)(Object(r.__assign)({},null!==(o=null==c?void 0:c.user)&&void 0!==o?o:{}),{displayName:h}),d=N.e.serialize(a);if(!Ze||p.email||p.id){var v=We.serialize({displayName:p.displayName,email:p.email||"",id:p.id||""});if(u=v,t.hasOwnProperty(u))t[v].push(d);else{t[v]=[];t[v].push(d)}}}},groupChildItems:n}})(e);if(t===he.r[he.e])return(function(e){var t={},n=function(i){for(var s,o,u=new g.e({publisher:n}),a=(function(e){for(var t={},n=(function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];if(!Xe.matches(i))return e;var s=Xe.deserialize(i);t.push(s)}return t.sort(function(e,t){return e&&t&&new Date(t.sharedDateTime).getTime()-new Date(e.sharedDateTime).getTime()}).map(function(e){return Xe.serialize(e)})})(Object.keys(e)),r=function(e){return t.hasOwnProperty(e)},i=0,s=n;i<s.length;i++){var o=s[i];if(Xe.matches(o)){var u=Xe.deserialize(o).relativeTime,a=Ve.serialize({relativeTime:u});if(r(a))for(var f=e[o],l=0,c=f;l<c.length;l++){var h=c[l];t[a].push(h)}else{t[a]=[];f=e[o];for(var p=0,d=f;p<d.length;p++){h=d[p];t[a].push(h)}}}}return t})(t),f=[],l=0,c=Object.keys(a);l<c.length;l++){var h=c[l];if(Ve.matches(h)){var p=Ve.deserialize(h).relativeTime;u.resolveItems({items:(s={},s[h]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},C.h.pack(p)),q.s.pack(!0)),d.e.pack({itemKeys:a[h]})),s)});f.push(h)}}u.resolveItems({items:(o={},o[e]=Object(r.__assign)(Object(r.__assign)({},d.e.pack({itemKeys:f})),Qe.e.pack(!0)),o)});return{itemResolver:u}};return{onProcessResponse:function(e){var n,r=e.driveItemKey,i=e.item;if(i&&r){var s=i.remoteItem,o=s&&s.shared&&s.shared.sharedDateTime,u=N.e.serialize(r);if(o){var a=(function(e,t){if(!e)return $e.n;var n=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(e>=n)return Je.today;n.setDate(n.getDate()-1);if(e>=n)return Je.yesterday;n.setDate(t.getDate()-t.getDay());if(e>=n)return $e.i;n.setDate(n.getDate()-7);if(e>n)return $e.t;var r=new Date(t.getFullYear(),t.getMonth(),1),i=new Date(t.getFullYear(),t.getMonth()-1,1);if(e>=i&&e<r)return $e.e;n.setDate(n.getDate()-7);if(e>n)return $e.o;n.setDate(n.getDate()-7);if(e>n)return $e.s;if(e>=r)return $e.r;var s=t.getFullYear()===e.getFullYear(),o=Ye[e.getMonth()];if(s)return o;return Ke.format(Je.MonthAndYear,o,e.getFullYear())})(new Date(o),new Date),f=Xe.serialize({relativeTime:a,sharedDateTime:o});if(n=f,t.hasOwnProperty(n))t[f].push(u);else{t[f]=[];t[f].push(u)}}}},groupChildItems:n}})(e)}return{onProcessResponse:void 0,groupChildItems:void 0}}function tt(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e.endpoint;i=n(Object(h.e)({getUserOneDriveEndpoint:w.v,graphEndpoint:w.m})),s=i.getUserOneDriveEndpoint;return(o=i.graphEndpoint)&&t!==o&&s?[4,n(s({endpoint:t}))]:[3,2];case 1:u=r.sent();t=u;r.label=2;case 2:return[2,t]}})})}}var nt=n(2172),rt=Object(i.i)()(function e(t){var n=this,i=f.e.deserialize(t.itemKey),s=i.filters,o=i.sortBy,u=i.isAscending;return function(i){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,a,l,p,d,v,m,y,b,E;return Object(r.__generator)(this,function(S){switch(S.label){case 0:n=et(t.itemKey),a=n.onProcessResponse,l=n.groupChildItems;p=f.e.deserialize(t.itemKey);d=p.driveItemKey.endpoint;v=i(Object(h.e)({graphSharedWithMeEndpoint:w.w})).graphSharedWithMeEndpoint;d=v||d;if(de.e.isActivated("C8633E26-C16D-4D6D-ABE5-BE1A2C3C256A","02/23/2022","Use OneDrive endpoint for Shared with me"))return[3,3];if(!v||v===p.driveItemKey.endpoint)return[3,1];p=Object(r.__assign)(Object(r.__assign)({},p),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},p.driveItemKey),{endpoint:v})});return[3,3];case 1:return[4,i(tt({endpoint:d}))];case 2:(m=S.sent())!==p.driveItemKey.endpoint&&(p=Object(r.__assign)(Object(r.__assign)({},p),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},p.driveItemKey),{endpoint:m})}));S.label=3;case 3:if((y=i(Object(c.i)(p.driveItemKey.endpoint)))&&!o){o=he.i;u=!0}b=f.e.serialize(p);return[4,i(Te(Object(r.__assign)(Object(r.__assign)({},t),{qosName:"sharedWithMe",itemKey:b,itemSetKeyFacet:f.e,parentItemKeyFacet:Ne.e,getUrl:function(e){var t=e.driveItemKey.endpoint;return"".concat(t,y?"/drive/oneDrive.sharedWithMe?select=*,webDavUrl":"/me/drive/sharedWithMe?expand=formats&allowExternal=true&$top=500")},filterChildItems:function(e){return!je(e,s)},sortChildItems:function(e){return(function(e,t,n,r){void 0===r&&(r=!1);var i=he.r[he.e],s=he.r[he.a],o=he.r[Fe.r],u=he.r[Fe.n],a=he.r[he.o],f=he.r[Fe.u];switch(t){case i:return ze(e,n,r,qe);case s:return ze(e,n,r,Ue);case o:case u:case f:return ze(e,n,r,Re);case a:return ze(e,n,r,Ie);default:return e}})(e,o,u,!0)},onProcessResponse:a,groupChildItems:l,mapItemSetKey:function(){var n,r=new g.e({publisher:e});r.mapKeys({mappings:(n={},n[b]=t.itemKey,n)});return{itemResolver:r}},scenarioInfo:{scenario:nt.e.PopulateSharedWithMe,scenarioType:nt.t.ActiveUserOperation}})))];case 4:E=S.sent().itemResolver;i(E.execute());return[2]}})})}});var it=n(151),st=n(364),ot=n(10),ut=n(420),at=n(374),ft=n(41);function lt(e,t){var n=t.itemsScopeItemKey,i=Object(ft.e)(e,n),s=e.demandItemFacet(R,i);return Object(r.__assign)({},s)}var ct=Object(ot.t)()(pt),ht=Object(ot.t)()(pt);function pt(){return function(e){return function(e,t){var n=t.itemsScopeItemKey,i=t.engagement,s=i&&i.name;return{engagement:{objectType:"SharedWithMe",datasource:"Graph",extraData:Object(r.__assign)({},"ItemsView.Load"===s?lt(e,{itemsScopeItemKey:n}):{})}}}}}var dt=Object(i.t)(function(){return function(e){e(Object(ut.e)(Ne.e,at.e)(ct));e(Object(ut.e)(f.e,at.e)(ht))}}),vt=n(767),mt=Object(ot.t)()(function(){return function(e){return function(e,t){return{engagement:{currentPage:"SharedWithMe"}}}}});var gt=Object(i.t)(function(){return function(e){e(Object(it.t)({keyFacet:Ne.e,facets:[Ne.e,C.h,C.v,C.m,C.O,C.i,C.f,d.t,C.M,ee.n]}));e(Object(it.t)({keyFacet:f.e,facets:[f.e,d.e]}));e(a.e);e(Object(u.r)(f.e,st.e)(rt));e(Object(ut.e)(Ne.e,vt.e)(mt));e(dt)}}),yt=new v.e("sharedByMeRootItem",{endpoint:Object(v.s)()}),bt=new v.e("sharedByMeItemSet",{driveItemKey:Object(v.o)(N.e)}),wt=n(2428),Et=Object(wt.e)(yt,function(e){return function(){return{defaultChildItemSet:{itemKey:bt.serialize({driveItemKey:e})},displayName:Q.i,icon:void 0}}}),St=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s;return Object(r.__generator)(this,function(o){switch(o.label){case 0:t=e.itemKey;i=bt.deserialize(t).driveItemKey.endpoint;return[4,n(Te(Object(r.__assign)(Object(r.__assign)({},e),{qosName:"sharedByMe",itemSetKeyFacet:bt,parentItemKeyFacet:yt,getUrl:function(e){var t="".concat(i,"/drive/shared");return"".concat(t,"?").concat("$expand=thumbnails","&").concat("$select=*,fileSystemInfo,folder,reactions,bundle,webDavUrl")}})))];case 1:s=o.sent().itemResolver;n(s.execute());return[2]}})})}});var xt=Object(ot.t)()(Nt),Tt=Object(ot.t)()(Nt);function Nt(){return function(e){return function(e,t){var n=t.itemsScopeItemKey,i=t.engagement,s=i&&i.name;return{engagement:{objectType:"SharedByMe",datasource:"Graph",extraData:Object(r.__assign)({},"ItemsView.Load"===s?lt(e,{itemsScopeItemKey:n}):{})}}}}}var Ct=Object(i.t)(function(){return function(e){e(Object(ut.e)(yt,at.e)(xt));e(Object(ut.e)(bt,at.e)(Tt))}}),kt=Object(i.t)(function(){return function(e){e(Object(it.t)({keyFacet:yt,facets:[yt,C.h,C.v,C.m,C.O,C.i,C.f,d.t,C.M,ee.n]}));e(Object(it.t)({keyFacet:bt,facets:[bt,d.e]}));e(Et);e(Object(u.r)(bt,st.e)(St));e(Ct)}}),Lt=n(668),At=n(436),Ot=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=At.e.deserialize(i);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,o;return Object(r.__generator)(this,function(u){(n=new g.e({publisher:e})).resolveItems({items:(o={},o[i]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},d.t.pack({itemKey:Lt.e.serialize({driveItemKey:s,sortBy:"",isAscending:!0})})),U.t.pack("SingleBookmark")),C.h.pack(Q.r)),C.m.pack({})),C.M.pack(void 0)),o)});t(n.execute());return[2]})})}});var Mt=n(526);function _t(e){var t,n,r=e.name&&(t=e.name,n=".aspx",t.substr(t.length-n.length)===n),i=e.package||e.remoteItem&&e.remoteItem.package,s=i&&"oneNote"===i.type;return r||s||!1}var Dt=Object(i.i)()(function e(t){var n=this;return function(i){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,o,u,a,f;return Object(r.__generator)(this,function(l){switch(l.label){case 0:n=i(Object(h.e)({saveForLaterGraphEndpoint:w.A})).saveForLaterGraphEndpoint;s=Lt.e.deserialize(t.itemKey);if(!n||n===s.driveItemKey.endpoint)return[3,1];s=Object(r.__assign)(Object(r.__assign)({},s),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},s.driveItemKey),{endpoint:n})});return[3,3];case 1:return[4,i(tt({endpoint:s.driveItemKey.endpoint}))];case 2:(o=l.sent())!==s.driveItemKey.endpoint&&(s=Object(r.__assign)(Object(r.__assign)({},s),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},s.driveItemKey),{endpoint:o})}));l.label=3;case 3:u=Lt.e.serialize(s);a=[{code:"provisioningNotAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Unable to retrieve user's mysite URL."},{code:"InvalidAuthenticationToken",message:"Access token has expired."},{code:"resourceBeingProvisioned",message:"The requested resource is being automatically provisioned. Please try again in a few minutes."}];return[4,i(Te(Object(r.__assign)(Object(r.__assign)({},t),{itemKey:u,qosName:"savedForLater",itemSetKeyFacet:Lt.e,parentItemKeyFacet:At.e,getUrl:function(e){if(e.driveItemKey.endpoint===n){return"".concat(e.driveItemKey.endpoint,"/me/drive/following?top=5000&select=").concat(["followed","name","parentReference","webDavUrl","webUrl","id","size","lastModifiedBy","lastModifiedDateTime","sharepointIds"].join(","))}return"".concat(e.driveItemKey.endpoint,"/drives/me/followed?top=5000&select=*,webDavUrl")},onProcessResponse:function(t){var n,i,s=t.itemKey,o=t.driveItemKey,u=t.item,a=new g.e({publisher:e});if(o&&u){var f=N.e.serialize(o),l=Mt.e.serialize({driveItemKey:o}),c=u&&(u.webDavUrl||u.webUrl);a.resolveItems({items:(n={},n[f]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},C.g.pack({itemKey:l})),C.i.pack(c)),C.v.pack(u.size)),n[l]=Object(r.__assign)(Object(r.__assign)({},C.E.pack(!0)),Object(p.e)().forFacet(C.E).thenInvalidate(s,d.e).pack()),n)});a.invalidateItems({items:(i={},i[s]=[d.e],i)})}return{itemResolver:a}},filterChildItems:_t,getDriveItemFacets:Pt,mapItemSetKey:function(){var n,r=new g.e({publisher:e});r.mapKeys({mappings:(n={},n[u]=t.itemKey,n)});return{itemResolver:r}},expectedErrors:a})))];case 4:f=l.sent().itemResolver;i(f.execute());return[2]}})})}});function Pt(e){var t=e.driveItem;return function(n){var i,s=t.root,o=t.remoteItem,u=t.name,a=s?Q.t:u||o&&o.name||"",f=!t.webDavUrl,l=t.followed&&t.followed.followedDateTime,c=new g.e({publisher:Pt});c.merge(n(Object(T.e)(Object(r.__assign)(Object(r.__assign)({},e),{shouldReturnShareFacets:!1}))).itemResolver);c.resolveItems({items:(i={},i[e.itemKey]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},C.d.pack(Object(T.t)(a,f))),l?C.a.pack(new Date(l).getTime()):{}),C.m.pack(f?{}:void 0)),i)});return{itemResolver:c}}}var Ht=Object(i.t)(function(){return function(e){e(Object(it.t)({keyFacet:At.e,facets:[At.e,C.h,C.v,C.m,C.O,C.f,d.t,C.M]}));e(Object(u.r)(At.e,st.e)(Ot));e(Object(u.r)(Lt.e,st.e)(Dt))}}),Bt=n(1236),jt=n(434),Ft=n(1259),It=n(235),qt=Object(ot.t)()(function(){return function(e){return Rt}});function Rt(e,t){var n=t.handlers,i=t.itemKey,s=e.demandItemFacet(jt.e,i);if(n&&s){for(var o=[],u=0,a=n;u<a.length;u++){var f=a[u];if(f.key===It.a.key)o.push("photo");else if(f.key===It.f.key)o.push("video");else if(f.key===It.n.key)o.push("folder");else if(f.key===It.t.key)o.push("file");else if(f.key===It.u.key)o.push("onenote");else if(f.key===It.s.key)o.push("!photo");else if(f.key===It.o.key)o.push("!video");else if(f.key===It.r.key)o.push("!folder");else if(f.key===It.i.key)o.push("!onenote");else{var l=Object(Ft.e)(f);l&&o.push(l)}}return{itemKey:jt.e.serialize(Object(r.__assign)(Object(r.__assign)({},s),{filters:o}))}}return{}}var Ut,zt=n(3012),Wt=n(433),Xt=n(160),Vt=new v.e("recentGroup",{recentItemSet:Object(v.o)(jt.e),relativeTime:Object(v.r)({today:"today",yesterday:"yesterday",thisWeek:"thisWeek",lastWeek:"lastWeek",twoWeeksAgo:"twoWeeksAgo",threeWeeksAgo:"threeWeeksAgo",thisMonth:"thisMonth",lastMonth:"thisMonth",twoMonthsAgo:"twoMonthsAgo",older:"older"})});(function(e){e.today="today";e.yesterday="testerday";e.thisWeek="thisWeek";e.lastWeek="lastWeek";e.twoWeeksAgo="twoWeeksAgo";e.threeWeeksAgo="threeWeeksAgo";e.thisMonth="thisMonth";e.lastMonth="lastMonth";e.twoMonthsAgo="twoMonthsAgo";e.older="older"})(Ut||(Ut={}));function $t(e){var t=new Date;return(function(e,t){return Jt(t,e)})(e,t)?Ut.today:(function(e,t){return Jt(new Date(t.getTime()-864e5),e)})(e,t)?Ut.yesterday:(function(e,t){var n=t.setHours(0,0,0,0)-864e5*t.getDay();return e.getTime()>n})(e,t)?Ut.thisWeek:(function(e,t){var n=t.setHours(0,0,0,0)-864e5*(t.getDay()+7);return e.getTime()>n})(e,t)?Ut.lastWeek:(function(e,t){var n=t.setHours(0,0,0,0)-12096e5;return e.getTime()>n})(e,t)?Ut.twoWeeksAgo:(function(e,t){var n=t.setHours(0,0,0,0)-18144e5;return e.getTime()>n})(e,t)?Ut.threeWeeksAgo:(function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()})(e,t)?Ut.thisMonth:(function(e,t){var n=t.getMonth(),r=e.getMonth();return n-r==11||t.getFullYear()===e.getFullYear()&&t.getMonth()-e.getMonth()==1})(e,t)?Ut.lastMonth:(function(e,t){var n=t.getFullYear(),r=e.getFullYear(),i=t.getMonth(),s=e.getMonth(),o=n-r==1&&i-s==-10;return n===r&&i-s==2||o})(e,t)?Ut.twoMonthsAgo:Ut.older}function Jt(e,t){return e.toDateString()===t.toDateString()}var Kt=new M.e("convergenceConfigurationFacet"),Qt=n(1111),Gt=n(3243),Yt=!de.t.isActivated("670094E2-09D8-4B36-90FB-B7EF6BA067C9","04/06/2022","Add support for `photo` and `video` filters for the picker");function Zt(e){return e.reduce(function(e,t){return e&&t?"(".concat(e," or ").concat(t,")"):t||e})}function en(e){return e.reduce(function(e,t){return e&&t?"(".concat(e," and ").concat(t,")"):t||e})}function tn(e){return function(t){for(var n=void 0,r=void 0,i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if(Object(Qt.e)(s)){u=Object(Qt.t)(s);o=!0}if("."===u[0])if(t.name){var a=new RegExp("".concat(u.toLocaleLowerCase(),"$")),f=t.name.toLocaleLowerCase().split(a),l=2===f.length&&""===f[1]||!1;o?n=void 0!==n?n&&!l:l:r=r||l}else{n=!1;r=!1}else if("folder"===u){var c=void 0!==t.folder||void 0!==t.remoteItem&&void 0!==t.remoteItem.folder||!1;o?n=void 0!==n?n&&!c:c:r=r||c}else if("onenote"===u){var h=t.package&&"oneNote"===t.package.type||t.remoteItem&&t.remoteItem.package&&"oneNote"===t.remoteItem.package.type||!1;o?n=void 0!==n?n&&!h:h:r=r||h}else if("photo"===u&&Yt){var p=void 0!==t.photo||void 0!==t.image;o?n=void 0!==n?n&&!p:p:r=r||p}else if("video"===u&&Yt){var d=!!t.video;o?n=void 0!==n?n&&!d:d:r=r||d}}return void 0===r?void 0!==n&&n:(void 0===n||n)&&!r}}var nn=n(4523),rn=!de.t.isActivated("2477F975-39B5-47B9-AA5F-C02028225BCB","10/27/2021","Updates ODC itemsscope Recent to use prefer APIVersion 2.0 header (instead of 2.1) in the case the user has been migrated."),sn=!de.e.isActivated("667B27A0-823E-489C-B1CF-3AA1F1E5C454","04/09/2022","Enable the Older grouping for list items in Recent pivot"),on=!de.e.isActivated("213A4632-291F-4C56-A70F-D16FF269A867","04/07/2022","Enforce maxmimum filter complexity for Graph Recent API");var un=function(e,t){var n=new RegExp("^"+t+"\\/","i");return e.filter(function(e){var t=e&&e.remoteItem||e;return!(!t||!t.file)&&n.test(t.file.mimeType)})},an=Object(i.i)()(function(e){var t=this,n=jt.e.deserialize(e.itemKey),i=n.filters,s=void 0===i?[]:i,o=n.groupBy,u=void 0===o?"":o,a=n,f=Object(Ae.e)({extFilters:Object(Ae.t)(s),allowedMediaTypes:[Ce.e.photo,Ce.e.video],fileTypeIconMap:Xt.e}),p=Object(Ae.e)({extFilters:Object(Ae.t)(s),allowedMediaTypes:[Ce.e.photo],fileTypeIconMap:Xt.e}),v=Object(Ae.e)({extFilters:Object(Ae.t)(s),allowedMediaTypes:[Ce.e.video],fileTypeIconMap:Xt.e});return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,o,m,y,b,E,S,x,T,k,L,A,O,M,_,D,P,H,B,j,F,I,R,U,z,W,X,V,$,J,K,Q,G,Y;return Object(r.__generator)(this,function(Z){switch(Z.label){case 0:t=n(Object(h.e)({graphRecentEndpoint:w.b,enableOverflowRecentGroup:w.c,convergenceConfiguration:Kt})),i=t.graphRecentEndpoint,o=t.enableOverflowRecentGroup,m=void 0===o?sn:o,y=t.convergenceConfiguration;if(!i)return[3,1];a=Object(r.__assign)(Object(r.__assign)({},a),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},a.driveItemKey),{endpoint:i})});return[3,3];case 1:return[4,n(tt({endpoint:a.driveItemKey.endpoint}))];case 2:(b=Z.sent())!==a.driveItemKey.endpoint&&(a=Object(r.__assign)(Object(r.__assign)({},a),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},a.driveItemKey),{endpoint:b})}));Z.label=3;case 3:E=jt.e.serialize(a);S=Vt.serialize({recentItemSet:a,relativeTime:"today"});x=Vt.serialize({recentItemSet:a,relativeTime:"yesterday"});T=Vt.serialize({recentItemSet:a,relativeTime:"thisWeek"});k=Vt.serialize({recentItemSet:a,relativeTime:"lastWeek"});L=Vt.serialize({recentItemSet:a,relativeTime:"twoWeeksAgo"});A=Vt.serialize({recentItemSet:a,relativeTime:"threeWeeksAgo"});O=Vt.serialize({recentItemSet:a,relativeTime:"lastMonth"});M=Vt.serialize({recentItemSet:a,relativeTime:"twoMonthsAgo"});_=Vt.serialize({recentItemSet:a,relativeTime:"older"});D=[];P=[];H=[];B=[];j=[];F=[];I=[];R=[];U=[];z="";W="date"===u;X=function(e){var t,n=e.driveItemKey,i=e.item,s=new g.e({publisher:X});if(i&&n){var o=i.remoteItem,u=o&&o.fileSystemInfo,a=u&&u.lastAccessedDateTime,f=N.e.serialize(n);if(W&&a){var l=new Date(a);switch($t(l)){case Ut.today:D.push(f);break;case Ut.yesterday:P.push(f);break;case Ut.thisWeek:H.push(f);break;case Ut.lastWeek:B.push(f);break;case Ut.twoWeeksAgo:j.push(f);break;case Ut.threeWeeksAgo:F.push(f);break;case Ut.lastMonth:I.push(f);break;case Ut.twoMonthsAgo:R.push(f);z=Ye[l.getMonth()];break;case Ut.older:default:U.push(f)}}s.resolveItems({items:(t={},t[f]=Object(r.__assign)({},C.m.pack(void 0)),t)});return{itemResolver:s}}};V=!f&&W?function(t){var n,i,s=new g.e({publisher:V});s.resolveItems({items:(n={},n[S]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},C.h.pack(nn.s)),q.s.pack(!0)),d.e.pack({itemKeys:D})),n[x]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},C.h.pack(nn.u)),q.s.pack(!0)),d.e.pack({itemKeys:P})),n[T]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},C.h.pack(nn.r)),q.s.pack(!0)),d.e.pack({itemKeys:H})),n[k]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},C.h.pack(nn.t)),q.s.pack(!0)),d.e.pack({itemKeys:B})),n[L]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},C.h.pack(nn.o)),q.s.pack(!0)),d.e.pack({itemKeys:j})),n[A]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},C.h.pack(nn.i)),q.s.pack(!0)),d.e.pack({itemKeys:F})),n[O]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},C.h.pack(nn.e)),q.s.pack(!0)),d.e.pack({itemKeys:I})),n[M]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},C.h.pack(z)),q.s.pack(!0)),d.e.pack({itemKeys:R})),n[_]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},C.h.pack(nn.n)),q.s.pack(!0)),d.e.pack({itemKeys:U})),n)});var o=[];D.length>0&&o.push(S);P.length>0&&o.push(x);H.length>0&&o.push(T);B.length>0&&o.push(k);j.length>0&&o.push(L);F.length>0&&o.push(A);I.length>0&&o.push(O);R.length>0&&o.push(M);U.length>0&&m&&o.push(_);s.resolveItems({items:(i={},i[e.itemKey]=Object(r.__assign)({},d.e.pack({itemKeys:o})),i)});return{itemResolver:s}}:void 0;$=n(Object(c.i)(a.driveItemKey.endpoint));J=[{code:"notAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"notAllowed",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"notAllowed",message:"Operation not allowed"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}];K=rn&&(null==y?void 0:y.isUserMigrated)?"ApiVersion=2.0":"ApiVersion=2.1";return[4,n(Te(Object(r.__assign)(Object(r.__assign)({},e),{qosName:f?"recentMedia":$?"ODC-recent":"recent",itemKey:E,itemSetKeyFacet:jt.e,parentItemKeyFacet:Wt.e,getUrl:function(e){var t="".concat(Object(l.n)({endpoint:e.driveItemKey.endpoint,driveId:"me"}),"/recent?"),n=de.e.isActivated("022299AD-ACC7-4C1F-B2E8-010FBC126277","1/7/2022","Narrow filters for media queries");if($)t="".concat(e.driveItemKey.endpoint,"/drive/view.recent?");else{if(p&&!n){var i="$filter=(remoteItem/image ne null)",o="$expand=thumbnails";return t="".concat(t).concat(i,"&").concat(o)}if(v&&!n){i="$filter=(remoteItem/image eq null or remoteItem/video ne null)",o="$expand=thumbnails";return t="".concat(t).concat(i,"&").concat(o)}if(f){i="$filter=(remoteItem/image ne null or remoteItem/video ne null)",o="$expand=thumbnails";return t="".concat(t).concat(i,"&").concat(o)}}return"".concat(t).concat((function(e){if(!e||0===e.length||on&&e.length>8)return"";for(var t=[],n=[],i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if(Object(Qt.e)(s)){u=Object(Qt.t)(s);o=!0}"folder"===u?!o&&t.push("folder ne null"):"onenote"===u?o?n.push("(remoteItem/package/type ne 'oneNote' and package/type ne 'oneNote')"):t.push("(remoteItem/package/type eq 'oneNote' or package/type eq 'oneNote')"):"."!==u[0]||!o&&t.push("(endsWith(name, '".concat(u.toLowerCase(),"') or endsWith(remoteItem/name, '").concat(u.toLowerCase(),"'))"))}return t.length>0||n.length>0?"&$filter=".concat(0===n.length?Zt(t):0===t.length?en(n):en(Object(r.__spreadArray)([Zt(t)],n,!0))):""})(s))},getDriveItemFacets:fn,expectedErrors:J,preprocessResponse:function(e){p?e=un(e,"image"):v&&(e=un(e,"video|^application"));return(function(e){if(!e)return e;return e.filter(function(e,t,n){return n.map(function(e){return e.id}).indexOf(e.id)===t})})(e.sort(function(e,t){var n=e.remoteItem&&e.remoteItem.fileSystemInfo&&e.remoteItem.fileSystemInfo.lastAccessedDateTime,r=t.remoteItem&&t.remoteItem.fileSystemInfo&&t.remoteItem.fileSystemInfo.lastAccessedDateTime;return n||r?n?r?n>r?-1:1:-1:1:0}))},additionalHeaders:f?{Prefer:"".concat(K,",RecentOnlyMediaApp,NoPreAuthThumbnailUrls")}:{Prefer:"".concat(K,";ODC,returnparentresource,returnowner")},onProcessResponse:X,groupChildItems:V,scenarioInfo:{scenario:nt.e.PopulateRecentFiles,scenarioType:nt.t.ActiveUserOperation}})))];case 4:Q=Z.sent().itemResolver;f&&Q.resolveItems({items:(G={},G[e.itemKey]=Object(r.__assign)({},q.u.pack({})),G)});Q.mapKeys({mappings:(Y={},Y[E]=e.itemKey,Y)});n(Q.execute());return[2]}})})}});function fn(e){return function(t){var n,i=new g.e({publisher:fn});i.merge(t(Object(T.e)(e)).itemResolver);var s=e.driveItem,o=s.thumbnails,u=s.remoteItem,a=o||u&&u.thumbnails;i.resolveItems({items:(n={},n[e.itemKey]=Object(r.__assign)({},a?Object(r.__assign)({},se.e.pack(!1)):{}),n)});return{itemResolver:i}}}var ln=Object(ot.t)()(hn),cn=Object(ot.t)()(hn);function hn(){return function(e){return function(e,t){var n=t.itemsScopeItemKey,i=t.engagement,s=i&&i.name;return{engagement:{objectType:"Recent",datasource:"Graph",extraData:Object(r.__assign)({},"ItemsView.Load"===s?lt(e,{itemsScopeItemKey:n}):{})}}}}}var pn=Object(i.t)(function(){return function(e){e(Object(ut.e)(Wt.e,at.e)(ln));e(Object(ut.e)(jt.e,at.e)(cn))}}),dn=Object(ot.t)()(function(){return function(e){return function(e,t){return{engagement:{currentPage:"Recent"}}}}});var vn=Object(i.t)(function(){return function(e){e(Object(it.t)({keyFacet:Wt.e,facets:[Wt.e,C.h,C.v,C.m,C.O,C.f,d.t,C.M,ee.n]}));e(Object(it.t)({keyFacet:jt.e,facets:[jt.e,d.e]}));e(zt.e);e(Object(u.r)(jt.e,st.e)(an));e(Object(ut.e)(jt.e,Bt.e)(qt));e(Object(ut.e)(Wt.e,vt.e)(dn));e(pn)}}),mn=n(148),gn=!de.t.isActivated("5F12686F-52A2-4E49-A1D8-A2AE7969622E","10/29/2021","True to use multiPart getItem api(ODC vroom) to avoid CORS."),yn=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=N.e.deserialize(n);return function(s){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,p,d,v,m,g,y,b,E,S;return Object(r.__generator)(this,function(x){switch(x.label){case 0:t=i;return i.driveId&&"me"!==i.driveId?[3,2]:[4,s(tt({endpoint:i.endpoint}))];case 1:(o=x.sent())!==i.endpoint&&(t=Object(r.__assign)(Object(r.__assign)({},i),{endpoint:o}));x.label=2;case 2:u=Object(l.n)(t);a=s(Object(h.e)({disableRemoteItemInPlace:w.i})).disableRemoteItemInPlace;f=a?ge:F;return[4,s(Object(c.i)(t.endpoint))];case 3:p=x.sent();d=gn&&p;return[4,s(Object(c.n)({url:"".concat(Object(l.t)(t),"?$expand=thumbnails"),driveUrl:u,qosName:"getItem",useMultiPartIfSupported:d,endpoint:t.endpoint}))];case 4:v=x.sent();m=s(f({driveItemResponse:v,endpoint:t.endpoint})),g=m.itemResolver,y=m.actualItemKey;g.resolveItems({items:(b={},b[e.itemKey]=Object(r.__assign)({},mn.r.pack(N.e)),b)});g.mapKeys({mappings:(E={},E[y]=n,E)});i.driveId&&"me"!==i.driveId||g.mapKeys({mappings:(S={},S[N.e.serialize(Object(r.__assign)(Object(r.__assign)({},i),{driveId:"me"}))]=N.e.serialize(Object(r.__assign)(Object(r.__assign)({},i),{driveId:""})),S[n]=N.e.serialize(t),S)});s(g.execute());return[2]}})})}});var bn=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=m.deserialize(i),o=s.setItemKey,u=s.endpoint,a=s.token,f=v.e.get(o).deserialize(o),b=f.extFilters,E=f.driveItemKey,S=Object(l.n)(E),x=z.e.matches(o);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,f,l,v,E,k,L,A,O,M,_,D,P,H,j,F,I,q,R,U,z,W;return Object(r.__generator)(this,function(X){switch(X.label){case 0:return[4,t(Object(c.i)(u))];case 1:n=X.sent();s=gn&&n;return[4,t(Object(c.t)({endpoint:u,url:a,driveUrl:S,useMultiPartIfSupported:s,qosName:"getChildrenPage"}))];case 2:f=X.sent();l=b&&b.length>0?tn(b):void 0;v=new g.e({publisher:e});E=[];for(k=0,L=f.value;k<L.length;k++){A=L[k];if(!(!!l&&l(A))){O=A&&(A.parentReference||A.remoteItem&&A.remoteItem.parentReference);M=O&&O.driveId;_=N.e.serialize({itemId:A.id,driveId:M,endpoint:u});D=null==O?void 0:O.id;P=(null==O?void 0:O.path)===B.e?B.r:D||void 0;H=O?N.e.serialize({itemId:P,driveId:M,endpoint:u}):void 0;j=t(Object(h.e)({allowDisableRemoteItemInPlace:w.i,processDriveItemFromSharePoint:w.N})),F=j.allowDisableRemoteItemInPlace,I=j.processDriveItemFromSharePoint;q=x&&F?me:T.e;E.push(_);v.merge(t(q({itemKey:_,driveItem:A,endpoint:u,parentFolderItemKey:H})).itemResolver);v.resolveItems({items:(W={},W[_]=Object(r.__assign)({},Object(p.e)().forFacet(C.h).thenInvalidate(i,d.e).forFacet(C.l).thenInvalidate(i,d.e).pack()),W)});if(I){R=t(I.process({itemKey:_,driveItem:A})).itemResolver;v.merge(R)}}}if(U=f["@odata.nextLink"]){z=m.serialize({setItemKey:o,endpoint:u,token:U});v.merge(Object(y.t)({itemKey:z}).itemResolver);E.push(z)}v.merge(Object(y.e)({itemKey:i,itemSetKey:o,childItemKeys:E}).itemResolver);t(v.execute());return[2]}})})}});var wn=n(157),En=n(3100),Sn=n(573),xn=!de.e.isActivated("E0D4E3B7-F0E1-41FE-BDB6-DCFF1C62CA43","04/01/2022","Process parent item error, and add handling for `sharingPasswordRequired` error");function Tn(e,t){var n=Object(M.n)({},{});e instanceof Sn.e&&(n=Object(Sn.t)(e,function(n){var i,s;switch(n){case 404:return wn.p.pack({});case"sharingPasswordRequired":if(xn)return Object(r.__assign)(Object(r.__assign)({},En.e.pack({fixItUrl:null===(s=null===(i=null==e?void 0:e.response)||void 0===i?void 0:i.error)||void 0===s?void 0:s.fixItUrl})),wn.e.pack({}));case 401:return wn.e.pack({});case 0:return wn.y.pack({domain:new x.e(t).domain})}})||Object(M.n)({},{}));return n}var Nn,Cn=n(3733),kn=new M.e("enableListViewDataPrefetchConfiguration"),Ln=new M.e("prefetchCacheConfiguration");var An=((Nn={})[he.s]="name",Nn[he.u]="lastModifiedDateTime",Nn[he.f]="size",Nn[he.n]="photo/takenDateTime",Nn);function On(e){var t=e.driveItem,n=e.skip,i=e.totalChildCount,s=e.isConsumerEndpoint,o=e.enableDefaultSortOrderFromBackend,u=e.sortBy,a=e.isAscending,f=e.extFilters,c=e.top,h=Object(l.t)(t),p=n?"&skiptoken=".concat(n+1,"/").concat(i,"&skip=").concat(n):"",d=s&&o?"&orderby=folder,savedSortFieldValue":"",v=u&&void 0!==a?(function(e,t){return"&orderby=folder,".concat(An[e]," ").concat(t?"asc":"desc")})(u,a):d,m=(function(e){if(!e||0===e.length)return"";if(Yt){e.unshift("folder");e=Array.from(new Set(null!=e?e:[]))}for(var t=[],n=[],i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if(Object(Qt.e)(s)){u=Object(Qt.t)(s);o=!0}if(o)return"";if(Object(Gt.e)(u))return"";if(!Yt)return"";if("media"===u){t.push("photo ne null");t.push("video ne null")}else if("photo"===u)t.push("photo ne null");else if("video"===u)t.push("video ne null");else{if("folder"!==u)return"";t.push("folder ne null")}}return t.length>0||n.length>0?"&$filter=".concat(0===n.length?Zt(t):0===t.length?en(n):en(Object(r.__spreadArray)([Zt(t)],n,!0))):""})(f),g="thumbnails".concat(s?",lenses,tags":"");return"".concat(h,"/children?$top=").concat(c).concat(p).concat(v,"&$expand=").concat(g,"&select=*,ocr,webDavUrl,isRestricted").concat(m)}var Mn=!de.e.isActivated("0EE393E4-FFA7-42F0-A80F-087B337FC123","04/01/2022","Restrict `loadAndProcessPagedDriveItemSet` to throw 1 error. Throw child error with preference if both child and parent response throw."),_n=!de.e.isActivated("E0D4E3B7-F0E1-41FE-BDB6-DCFF1C62CA43","04/01/2022","Process parent item error, and add handling for `sharingPasswordRequired` error");function Dn(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f,p,d,v,m,y,b,w,E,S,x,T,C,k,L,A,O,_,D,P,H,B,j,F,R,U,W,X,V,$,J,K,Q,G,Z,ee,te,ne,re,ie,se,oe;return Object(r.__generator)(this,function(ue){switch(ue.label){case 0:t=e.itemKey,i=e.top,s=e.skip,o=e.disableRemoteItemInPlace;u=z.e.deserialize(t);a=u.driveItemKey,f=u.extFilters;p=u.sortBy,d=u.isAscending;v=u;m=a;return a.driveId&&"me"!==a.driveId?[3,2]:[4,n(tt({endpoint:a.endpoint}))];case 1:if((y=ue.sent())!==a.endpoint){m=Object(r.__assign)(Object(r.__assign)({},a),{endpoint:y});v=Object(r.__assign)(Object(r.__assign)({},u),{driveItemKey:m})}ue.label=2;case 2:b=N.e.serialize(m);w=Object(l.n)(m);return[4,n(Object(I.e)(function(e){return{isParentItemResolved:e.isItemFacetResolved(N.e,b),totalChildCount:e.isItemFacetResolved(q.e,b)?e.demandItemFacet(q.e,b):void 0,driveType:e.isItemFacetResolved(Y.e,b)?e.demandItemFacet(Y.e,b):void 0}}))];case 3:E=ue.sent(),S=E.isParentItemResolved,x=E.totalChildCount,T=E.driveType;C=n(Object(c.i)(m.endpoint));k=gn&&C;L=n(Object(h.e)({convergenceConfiguration:Kt,enableListViewDataPrefetchConfiguration:kn,prefetchCache:Ln})),A=L.convergenceConfiguration,O=L.enableListViewDataPrefetchConfiguration,_=L.prefetchCache;D=[{code:"notAllowed",message:"You do not have access to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"ItemNotFound"},{code:"503"},{code:"userContentMigrated"}];P=A&&A.canHandleUserMigration;H=Promise.resolve(void 0);if(!S){B=(function(e){var t=e.driveItem,n=Object(l.t)(t),r=n;!de.e.isActivated("B3F7A11A-91E8-4B9E-A526-6FD1CBD81747","03/24/2022","add sharepointIds to api")&&n&&(r=n+"?$select=*,sharepointIds");return r})({driveItem:m});"getItem";j=function(){return n(Object(c.n)({url:B,driveUrl:w,useMultiPartIfSupported:k,qosName:"getItem",endpoint:m.endpoint,headers:C&&P?{Prefer:"Migration=EnableRedirect;FailOnMigratedFiles"}:void 0,expectedErrors:C?D:void 0,scenarioInfo:{scenario:nt.e.BrowseFiles,scenarioType:nt.t.ActiveUserOperation}}))};if(O&&_){W=_.getData({url:B,qosName:"getItem"});H=W?W.catch(j):j()}else H=j()}F=On({driveItem:a,skip:s,totalChildCount:x,isConsumerEndpoint:C,enableDefaultSortOrderFromBackend:Cn.e,sortBy:p,isAscending:d,extFilters:f,top:i});"getChildren.folder";R=function(){return n(Object(c.n)({url:F,driveUrl:w,qosName:"getChildren.folder",useMultiPartIfSupported:k,endpoint:m.endpoint,headers:C&&P?{Prefer:"Migration=EnableRedirect;FailOnMigratedFiles"}:void 0,expectedErrors:D,scenarioInfo:{scenario:nt.e.BrowseFiles,scenarioType:nt.t.ActiveUserOperation}}))};if(O&&_){W=_.getData({url:F,qosName:"getChildren.folder"});U=W?W.catch(R):R()}else U=R();X=!1;if(!we.e(be.e.dataFetch.start)){we.t(be.e.dataFetch.start);X=!0}return Mn?[4,H.catch(function(t){J=_n?n((function(e,t){var n=e.error;return function(i){var s,o=Tn(n,t),u=Object(M.r)({accessDeniedError:wn.e,passwordProtectedError:En.e},o),a=u.accessDeniedError,f=u.passwordProtectedError,l=new Se.e({facets:o,innerError:new Se.e(n)});if(a&&f){var c=new g.e;c.updateItems({items:(s={},s[e.itemKey]=Object(r.__assign)({},mn.e.pack(l)),s)});i(c.execute())}return l}})(Object(r.__assign)(Object(r.__assign)({},e),{error:t}),m.endpoint)):t})]:[3,6];case 4:V=ue.sent();return[4,U.catch(function(t){K=n(Pn(Object(r.__assign)(Object(r.__assign)({},e),{error:t,parentItemError:J}),m.endpoint))})];case 5:$=ue.sent();if(K)throw K;$=$;if(J)throw J;return[3,8];case 6:Q=[U.catch(function(t){throw n(Pn(Object(r.__assign)(Object(r.__assign)({},e),{error:t}),m.endpoint))}),H];return[4,Promise.all(Q)];case 7:ne=ue.sent(),$=ne[0],V=ne[1];ue.label=8;case 8:X&&we.t(be.e.dataFetch.end);if(V){V.folder&&(x=V.folder.childCount);V.parentReference&&V.parentReference.driveType&&(T=V.parentReference.driveType)}G=n(Object(c.s)(m.endpoint,T));(Z=new g.e({publisher:Dn})).mapKeys({mappings:(re={},re[z.e.serialize(v)]=e.itemKey,re[b]=N.e.serialize(u.driveItemKey),re)});if(!u.driveItemKey.driveId||"me"===u.driveItemKey.driveId){(null===(oe=null==V?void 0:V.parentReference)||void 0===oe?void 0:oe.driveId)&&Z.mapKeys({mappings:(ie={},ie[z.e.serialize(Object(r.__assign)(Object(r.__assign)({},v),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},v.driveItemKey),{driveId:V.parentReference.driveId})}))]=e.itemKey,ie)});Z.mapKeys({mappings:(se={},se[N.e.serialize(Object(r.__assign)(Object(r.__assign)({},u.driveItemKey),{driveId:"me"}))]=N.e.serialize(Object(r.__assign)(Object(r.__assign)({},u.driveItemKey),{driveId:""})),se)})}te=(ee=Z).merge;return[4,n(Ee({itemKey:t,itemSetKeyFacet:z.e,parentItemKeyFacet:N.e,parentItemResponse:V,childItemsResponse:$,disableRemoteItem:o,filterChildItems:f&&f.length>0?tn(f):void 0,skip:s,enableRandomAccess:G,totalChildCount:x,onProcessResponse:function(e){var t,n=e.driveItemKey,i=new g.e({publisher:Dn});n&&i.resolveItems({items:(t={},t[N.e.serialize(n)]=Object(r.__assign)({},mn.r.pack(N.e)),t)});return{itemResolver:i}}}))];case 9:te.apply(ee,[ue.sent().itemResolver]);return[2,Z]}})})}}function Pn(e,t){var n=e.error,i=e.parentItemError;return function(s){var o,u=Tn(n,t),a=Object(M.r)({itemNotFoundError:wn.p,accessDeniedError:wn.e,networkBlockedError:wn.y},u),f=a.itemNotFoundError,l=a.accessDeniedError,c=a.networkBlockedError,h=Object(M.r)({passwordProtectedError:En.e},i instanceof Se.e?i.facets:Object(M.n)({},{})).passwordProtectedError,p=new Se.e({facets:Object(r.__assign)(Object(r.__assign)({},u),h?En.e.pack(h):{}),innerError:new Se.e(n)});if(f||l||c){var v=new g.e;v.updateItems({items:(o={},o[e.itemKey]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},d.e.pack(void 0)),d.o.pack(void 0)),mn.e.pack(p)),o)});s(v.execute())}return p}}var Hn=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(s){switch(s.label){case 0:t=n(Object(h.e)({pageSize:w.s})).pageSize;return[4,n(Dn(Object(r.__assign)(Object(r.__assign)({},e),{disableRemoteItemInPlace:!0,skip:0,top:t||B.t})))];case 1:i=s.sent();we.t(be.e.resolveData.start);n(i.execute());we.t(be.e.resolveData.end);return[2]}})})}});var Bn=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Object(it.t)({keyFacet:z.e,facets:[z.e,d.e]}));e(Object(u.r)(z.e,st.e)(Hn));return[2]})})}}),jn=n(117),Fn=n(365),In=n(803);function qn(e,t){var n=t.folderItemKey,i=t.itemSet;if(n&&i){var s=e.demandItemFacet(X.e,n),o=(function(e,t){return!("photo"===(null==e?void 0:e.folderType))&&t===he.t})(null==s?void 0:s.folder,i.sortBy)?"":i.sortBy;return Object(r.__assign)(Object(r.__assign)({},i),{sortBy:o})}return i}var Rn=Object(ot.t)()(function(){return function(e){return function(e,t){var n,i,s=Object(ft.e)(e),o={},u=e.demandItemFacet(z.e,t.itemKey),a=e.demandItemFacet(N.e,t.itemKey),f=e.demandItemFacet($.e,t.itemKey,{suppressGetItems:!0}),l=e.demandItemFacet(V,t.itemKey,{suppressGetItems:!0});if(de.e.isActivated("09AA0112-641E-4D73-805E-DBCD89D22C3D","9/30/2021","Use new shortcutItemFacet for shortcut checks")){if(l&&t.itemKey){i={driveItemKey:l,sortBy:"",isAscending:!0};h=z.e.serialize(i);return Object(r.__assign)(Object(r.__assign)({},Un(e,{itemSetKey:h,parentItemKey:N.e.serialize(i.driveItemKey),stageItem:t.stageItem})),{itemKey:Fn.e.serialize({localItemKey:t.itemKey,remoteItemKey:h})})}}else if(f&&t.itemKey){var c=e.demandItemFacet(N.e,f.itemKey);if(c){i={driveItemKey:c,sortBy:"",isAscending:!0};var h=z.e.serialize(i);return Object(r.__assign)(Object(r.__assign)({},Un(e,{itemSetKey:h,parentItemKey:N.e.serialize(i.driveItemKey),stageItem:t.stageItem})),{itemKey:Fn.e.serialize({localItemKey:t.itemKey,remoteItemKey:h})})}}if(u){var p=a||u.driveItemKey;i=qn(e,{folderItemKey:N.e.serialize(p),itemSet:u});n=Un(e,{itemSetKey:z.e.serialize(i||u),parentItemKey:N.e.serialize(u.driveItemKey),stageItem:t.stageItem});o={itemKey:t.itemKey}}else{i=(function(e,t){var n=t.folderItemKey,i=t.currentItemSetKey;if(i&&n){var s=e.demandItemFacet(z.e,i),o=e.demandItemFacet(N.e,n);if(s&&o){if(!de.e.isActivated("D8B0FDDF-555D-49A4-B069-D03ED692694A","11/4/2021","Do not emit item set key for non-folder items")&&o.itemId&&"root"!==o.itemId&&!e.demandItemFacet(C.m,n))return;var u=o.endpoint,a=o.driveId,f=o.itemId;return Object(r.__assign)(Object(r.__assign)({},s),{driveItemKey:{endpoint:u,driveId:a,itemId:f}})}}return})(e,{folderItemKey:t.itemKey,currentItemSetKey:s});o=(h=(i=qn(e,{folderItemKey:t.itemKey,itemSet:i}))?z.e.serialize(i):void 0)?{itemKey:h}:{};n=i&&h&&Un(e,{itemSetKey:h,parentItemKey:N.e.serialize(i.driveItemKey),stageItem:t.stageItem})}var d=Object(In.e)(e),v=d?e.demandItemFacet(N.e,d.localItemKey):void 0;if(d&&(i||o||a)){var m=v&&v.driveId,g=u&&u.driveItemKey&&u.driveItemKey.driveId||a&&a.driveId,y=i?z.e.serialize(i):u?z.e.serialize(u):a?N.e.serialize(a):void 0;if(m!==g&&y)return Object(r.__assign)({itemKey:Fn.e.serialize({localItemKey:d.localItemKey,remoteItemKey:y})},n?{stageItem:n}:{})}return Object(r.__assign)(Object(r.__assign)({},o),n?{stageItem:n}:{})}}});function Un(e,t){var n=this,i=t.parentItemKey,s=t.itemSetKey,o=t.stageItem;if(i)return o?Object(jn.t)(function(e){var t=e.itemsScopeItemKey,u=e.currentItemKey;return function(e){return Object(r.__awaiter)(n,void 0,void 0,function(){var n;return Object(r.__generator)(this,function(a){switch(a.label){case 0:e(Object(it.e)({items:(n={},n[s]=Object(r.__assign)({},d.s.pack({itemKey:i})),n)}));return[4,e(o({currentItemKey:u,itemsScopeItemKey:t}))];case 1:a.sent();return[2]}})})}}):void 0}var zn=n(402),Wn=new v.e("driveItemVirtualizedPage",{endpoint:Object(v.s)(),setItemKey:Object(v.s)(),skip:Object(v.i)(),top:Object(v.i)()}),Xn=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Wn.deserialize(n),s=i.setItemKey,o=i.top,u=i.skip;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(a){switch(a.label){case 0:return[4,n(Dn(Object(r.__assign)(Object(r.__assign)({},e),{itemKey:s,disableRemoteItemInPlace:!1,skip:u,top:o})))];case 1:(t=a.sent()).resolveItems({items:(i={},i[s]=Object(r.__assign)({},Object(p.e)().forFacet(d.e).thenInvalidate(e.itemKey,d.e).pack()),i)});n(t.execute());return[2]}})})}});var Vn=n(1313),$n=new v.e("SearchDateFilterKeyFacet",{dateType:Object(v.s)(),beginDate:Object(v.s)(),endDate:Object(v.s)()}),Jn=new v.e("searchItemSet",{driveItemKey:Object(v.o)(N.e),searchTerm:Object(v.s)(),extFilters:Object(v.t)(Object(v.s)()),dateFilter:Object(v.o)($n)}),Kn=Object(ot.t)()(function(){return function(e){return Qn}});function Qn(e,t){var n=t.handlers,i=t.itemKey,s=e.demandItemFacet(z.e,i),o=e.demandItemFacet(Jn,i);if(n&&(s||o)){for(var u=[],a=0,f=n;a<f.length;a++){var l=f[a];if(l.key===It.a.key)u.push("photo");else if(l.key===It.f.key)u.push("video");else if(l.key===It.n.key)u.push("folder");else if(l.key===It.t.key)u.push("file");else if(l.key===It.u.key)u.push("onenote");else if(l.key===It.s.key)u.push("!photo");else if(l.key===It.o.key)u.push("!video");else if(l.key===It.r.key)u.push("!folder");else if(l.key===It.i.key)u.push("!onenote");else{var c=Object(Ft.e)(l);c&&u.push(c)}}if(s)return{itemKey:z.e.serialize(Object(r.__assign)(Object(r.__assign)({},s),{extFilters:u}))}}return{}}var Gn=n(1311),Yn=n(1339),Zn=n(1112),er=Object(ot.t)()(function(){return function(){return function(e,t){return{validator:Zn.e}}}});function tr(e,t){return Jn.serialize(Object(r.__assign)({driveItemKey:e.driveItemKey},t?{searchTerm:t}:{searchTerm:""}))}var nr=Object(ot.t)()(ir),rr=Object(ot.t)()(ir);function ir(){return function(e){return function(e,t){var n,r=t.itemKey,i=e.demandItemFacet(z.e,r);if(i)n=function(e){return i?tr(i,e):void 0};else{var s=e.demandItemFacet(Jn,r);n=function(e){return s?tr(s,e):void 0}}return{isAvailable:!0,getSearchItemKey:n}}}}var sr=n(1309),or=n(766),ur=n(922),ar=n(1093),fr=n(796),lr=n(704),cr=n(605),hr=n(407),pr=n(542),dr=n(797),vr=new M.e("addToOneDrive"),mr=new M.e("createFolder"),gr=new M.e("createLink"),yr=new M.e("delete"),br=new M.e("download"),wr=new M.e("invite"),Er=new M.e("move"),Sr=new M.e("officeLens"),xr=new M.e("rename"),Tr=new M.e("upload"),Nr=new v.e("commands",{endpoint:Object(v.s)(),driveId:Object(v.s)({shouldNormalizeToEmpty:!0})}),Cr=n(135);function kr(e,t){var n,r=null!==(n=t.driveItemKey)&&void 0!==n?n:{};return r.driveId===(function(e,t){var n=t.endpoint;if(!n)return;var r=N.e.serialize({endpoint:n,driveId:B.n,itemId:B.r}),i=e.demandItemFacet(N.e,r);return null==i?void 0:i.driveId})(e,{endpoint:r.endpoint})}var Lr=!de.e.isActivated("DAF1BE9A-8497-4F4F-8797-73EF984441D3","04/05/2022","Fix logic in hasRequiredRole"),Ar=!de.e.isActivated("A7214F2C-B4A0-4A90-AB59-4F8E4927261F","04/05/2022","Revises hasPermission `isOwner` logic to be self-contained and available to addon-graph consumers (not just odsp-next)"),Or=(new Cr.e("addToOneDrive",function(e,t){return Hr(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:vr}))}),new Cr.e("canCreateFolder",function(e,t){return Hr(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:mr}))})),Mr=(new Cr.e("canCreateLink",function(e,t){return Hr(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:gr}))}),new Cr.e("canDelete",function(e,t){return Hr(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:yr}))})),_r=new Cr.e("canDownload",function(e,t){return!e.demandItemFacet(U.i,t.itemKey)&&Hr(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:br}))}),Dr=(new Cr.e("canInvite",function(e,t){return Hr(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:wr}))}),new Cr.e("canMove",function(e,t){return Hr(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:Er}))}),new Cr.e("canUseOfficeLens",function(e,t){return Hr(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:Sr}))}),new Cr.e("canRename",function(e,t){return Hr(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:xr}))})),Pr=new Cr.e("canUpload",function(e,t){return Hr(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:Tr}))});function Hr(e,t){var n=t.itemKey,r=t.commandFacet,i=e.demandItemFacet(N.e,n);if(!i)return!1;var s=i.endpoint,o=i.driveId,u=e.demandItemFacet(r,Nr.serialize({endpoint:s,driveId:o}));return!!u&&!!u.roles&&Br(e,{itemKey:n,oneOfRequiredRoles:u.roles})}function Br(e,t){var n=t.itemKey;return(function(e,t){var n=t.oneOfRequiredRoles,r=t.effectiveRoles;if(Lr)for(var i=0,s=r;i<s.length;i++){var o=s[i];if(n.indexOf(o)>=0)return!0}else for(var o in r)if(o in n)return!0;return!1})(0,{oneOfRequiredRoles:t.oneOfRequiredRoles,effectiveRoles:(function(e,t){if((function(e,t,n){var r,i,s=e.demandItemFacet(K.e,t);if(Ar){var o=e.demandItemFacet(N.e,t);if(kr(e,{driveItemKey:o}))return!0}else{var u=null===(i=null===(r=null==s?void 0:s.owner)||void 0===r?void 0:r.user)||void 0===i?void 0:i.id;if(n&&u)return n.toUpperCase()===u.toUpperCase()}return!s||!s.effectiveRoles||!s.owner})(e,t))return["read","write","owner"];var n=e.demandItemFacet(K.e,t);if(n&&n.effectiveRoles)return n.effectiveRoles;return[]})(e,n)})}var jr=Object(ot.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return!!e.demandItemFacet(oe.e,n)?{isAvailable:!1}:{isAvailable:e.demandItemFacet(Or,n)}}}});var Fr=n(139),Ir=Object(ot.t)()(function(){return function(){return function(e,t){var n=t.itemKey,r=Object(Fr.e)(e);if(e.demandItemFacet(yt,r)){if(!!!e.demandItemFacet(oe.e,n))return{isAvailable:!1}}return{isAvailable:e.demandItemFacet(Dr,n),validator:Zn.e}}}});var qr=n("react-lib"),Rr=n(45),Ur=n(4521),zr=n(193);Object(zr.n)([{rawString:".informationContainer_0d44ca9a{background-color:#f3f2f1;border-radius:8px;-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-box;display:-ms-flexbox;display:flex;gap:8px;padding:8px 12px;width:100%}.informationContainer_0d44ca9a .infoIcon_0d44ca9a{color:#616161;font-family:FabricMDL2Icons;font-size:16px}.informationContainer_0d44ca9a .informationText_0d44ca9a{color:#242424;font-size:12px;line-height:16px;margin:0}\n"}]);var Wr=Object(ot.t)()(function(){return function(){return function(e,t){var n=t.itemKey,r=e.demandItemFacet(Mr,n),i=e.demandItemFacet(V,n);return{isAvailable:r&&!i,deleteWizard:Xr}}}});var Xr=Object(Rr.t)(function(e,t){var n=t.itemKeys,i=t.defaultRender,s=Object(r.__rest)(t,["itemKeys","defaultRender"]),o=void 0;1===n.length?o=Object(r.__assign)(Object(r.__assign)({},s),{deleteWizardStrings:Object(r.__assign)(Object(r.__assign)({},s.deleteWizardStrings),{confirmText:Ur.e})}):n.length>0&&(o=Object(r.__assign)(Object(r.__assign)({},s),{deleteWizardStrings:Object(r.__assign)(Object(r.__assign)({},s.deleteWizardStrings),{confirmText:Ur.t})}));var u=!1;!de.e.isActivated("940C7189-6004-4F43-BF51-0CC7401767E7","02/25/2022","Enable Photo story delete prompt when deleting an item used in photo story")&&(u=n.some(function(t){return e.demandItemFacet(ce.e,t)}));var a=o||s;return i?qr.createElement(i,Object(r.__assign)({itemKeys:n},a),u&&qr.createElement("div",{className:"informationContainer_0d44ca9a"},qr.createElement("div",{className:"infoIcon_0d44ca9a"},""),qr.createElement("p",{className:"informationText_0d44ca9a"},Ur.n))):null}),Vr=Object(ot.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return!!e.demandItemFacet(oe.e,n)?{isAvailable:!1}:{isAvailable:e.demandItemFacet(Pr,n)}}}});var $r=Object(ot.t)()(function(){return function(e){return Jr}});function Jr(e,t){if(1!==t.itemKeys.length)return{};var n=t.itemKeys[0];if(e.demandItemFacet(C.m,n))return{};var i=e.demandItemFacet(N.e,n),s=i?Object(l.t)(i):void 0,o=i?Object(l.n)(i):void 0,u=i&&i.endpoint||"";return{isAvailable:e.demandItemFacet(_r,n),getDownloadData:s&&o?function(){return(function(e){var t=this,n=e.itemUrl,i=e.driveUrl,s=e.endpoint;return function(o){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u,a,f;return Object(r.__generator)(this,function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,o(Object(c.t)({url:e.itemUrl,driveUrl:i,method:"GET",qosName:"getItemDownloadUrl",endpoint:s}))];case 1:t=r.sent();if(!(u=(function(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)})(n)?t["@microsoft.graph.downloadUrl"]:t["@content.downloadUrl"]))throw new Error("Unable to obtain download URL.");return[2,{method:"GET",url:u}];case 2:if((a=r.sent())instanceof Sn.e){f=Object(Sn.t)(a,function(e,t){switch(e){case"unauthenticated":case 401:return wn.r.pack({});case"itemNotFound":case 404:return wn.a.pack({});case"accessDenied":case 403:return wn.e.pack({});default:return wn.b.pack({})}});throw new Se.e({innerError:a,facets:f})}throw a;case 3:return[2]}})})}})({itemUrl:s,driveUrl:o,endpoint:u})}:void 0}}var Kr=Object(ot.t)()(function(){return function(e){return Qr}});function Qr(e,t){var n=t.itemKey,i=e.demandItemFacet(N.e,n);return{isAvailable:!0,getShareLink:function(){return(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!(t=e.driveItem))return[3,2];i=Object(l.t)(t)+"/invite";s=Object(l.n)(t);return[4,n(Object(c.n)({url:i,driveUrl:s,method:"POST",qosName:"getDefaultShareLink",endpoint:t.endpoint,headers:{prefer:"getDefaultLink","Content-type":"application/json"}}))];case 1:if(!(o=r.sent()))throw new Error("Unable to obtain default share URL");return[2,{url:o.value[0].link.webUrl,scope:o.value[0].link.scope}];case 2:throw new Error("Unable to obtain default share URL")}})})}})({driveItem:i})}}}var Gr=Object(ot.t)()(function(){return function(){return function(){return{}}}});var Yr=Object(ot.t)()(function(){return function(e){return Zr}});function Zr(e,t){var n=t.itemKey,i=t.link,s=t.recipients,o=e.demandItemFacet(N.e,n);return{isAvailable:!0,permissionInvite:function(){return(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f,l,h,p,d,v;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e.driveItem,i=e.link,s=e.recipients;if(!t||!i)throw new Error("Unable to obtain default share URL");o=t.endpoint;a=btoa(i);u="u!"+a.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-");f=s.map(function(e){return{email:e}});l={recipients:f,roles:["read"]};h=o.replace("v1.0","beta");p=h+"/shares/"+u+"/permission/grant";return[4,n(Object(c.n)({url:p,method:"POST",qosName:"permissionGrant",endpoint:t.endpoint,headers:{"Content-type":"application/json",Accept:"application/json"},body:l}))];case 1:d=r.sent();v=d.value[0].grantedToIdentities.map(function(e){return{email:e.user.email}});return[2,{recipients:v}]}})})}})({driveItem:o,link:i,recipients:s})}}}var ei=n(1153),ti=n(1495),ni=new v.e("thumbnailToken",{endpoint:Object(v.s)(),driveId:Object(v.s)({shouldNormalizeToEmpty:!0})}),ri=n(3221),ii=n(379),si=!de.e.isActivated("AB808229-F141-4F5A-B7E9-C1DEF8EC6F64","10/21/2021","Enable crop mode for folder cover thumbnail"),oi=!de.e.isActivated("75843FC5-8F0A-4925-BB0B-AA5FCE46444C","02/07/2022","Enable various thumbnail fixes in ItemResultProcessor and addon-graph ItemThumbnailControl"),ui=Object(ot.t)()(function(){return function(e){return ai}});function ai(e,t){var n=t.itemKey,i=t.desiredSize,s=t.fitMode,o=t.requestOptions,u=e.demandItemFacet(N.e,n);if(!u)return{};var a=e.demandItemFacet(se.e,n)?(function(e,t){var n=t.itemKey,r=t.desiredSize,i=t.fitMode,s=(function(e){return e&&(t=e,t&&"number"==typeof t.length)?e[0]:e;var t})(e.demandItemFacet(W.e,n));if(s&&s.large)return{url:hi(s.large.url,r,i),width:0,height:0}})(e,{itemKey:n,driveItem:u,desiredSize:i,fitMode:s}):(function(e,t){var n,i=t.itemKey,s=t.driveItem,o=t.desiredSize;if(oi){var u=!!e.demandItemFacet(C.m,i),a=!!e.demandItemFacet(U.i,i);if(u||a)return}var f,h,p=e.demandItemFacet(C.p,i,{suppressGetItems:!0})||"",d=new x.e(s.endpoint).authority;if(oi){h=s.endpoint.indexOf("/v2.")>-1;var v=Object(c.r)(e,s.endpoint);f="".concat(d,h&&!v?"/_api/v2.1":"/v1.0")}else{h=s.endpoint.indexOf("/_api/v2.")>-1;f="".concat(d,h?"/_api/v2.1":"/v1.0")}var m=ni.serialize({endpoint:f,driveId:s.driveId}),g=e.demandItemFacet(ri.e,m);if(g){var y=Object(l.t)({endpoint:f,driveId:s.driveId,itemId:s.itemId}),b=Math.ceil(o.width),w=Math.ceil(o.height),E="".concat(y,"/thumbnails/0/c").concat(b,"x").concat(w,"/content"),S={prefer:"noredirect,closestavailablesize",cb:p};if(h||oi){var T=Object(r.__assign)(Object(r.__assign)({},S),{access_token:{uriValue:g}});return{url:"".concat(E,"?").concat(Object(ii.e)(T)),width:b,height:w}}if(null===(n=t.requestOptions)||void 0===n?void 0:n.allowsHeaders){var N={Authorization:"bearer ".concat(g)};return{url:"".concat(E,"?").concat(Object(ii.e)(S)),width:b,height:w,headers:N}}}return})(e,{itemKey:n,driveItem:u,desiredSize:i,requestOptions:o});return a?{thumbnail:a}:{}}var fi=/width=[0-9]*/,li=/height=[0-9]*/,ci=/cropmode=[a-z]*/;function hi(e,t,n){if(si){var r="cover"===n?"center":"none";ci.test(e)?e=e.replace(ci,"cropmode=".concat(r)):e+="".concat(e.indexOf("?")>-1?"&":"?","cropmode=").concat(r)}var i="number"==typeof t.width?Math.ceil(t.width):t.width,s="number"==typeof t.height?Math.ceil(t.height):t.height,o="".concat(i||"");fi.test(e)?e=e.replace(fi,"width=".concat(o)):e+="".concat(e.indexOf("?")>-1?"&":"?","width=").concat(o);var u="".concat(s||"");li.test(e)?e=e.replace(li,"height=".concat(u)):e+="".concat(e.indexOf("?")>-1?"&":"?","height=").concat(u);return e}var pi=n(763),di=n(2899),vi=Object(ot.t)()(gi),mi=Object(ot.t)()(gi);function gi(){return function(e){return function(e,t){var n,i=t.itemsScopeItemKey,s=t.engagement,o=t.itemKey,u=s&&s.name,a=e.demandItemFacet(z.e,o),f=(null==a?void 0:a.driveItemKey)||e.demandItemFacet(N.e,o)||{},l=f.driveId,c=void 0===l?"me":l,h=f.itemId,p=void 0===h?"root":h;"me"===c&&"root"===p?n="MyFiles":(a||"root"===p)&&(n="Folder");return{engagement:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},(null==s?void 0:s.datasource)?{}:{datasource:"Graph"}),n?{objectType:n}:{}),{extraData:Object(r.__assign)({itemGraphId:p,itemGraphDriveId:c},"ItemsView.Load"===u?lt(e,{itemsScopeItemKey:i}):{})})}}}}var yi=Object(i.t)(function(){return function(e){e(Object(ut.e)(N.e,at.e)(vi));e(Object(ut.e)(z.e,at.e)(mi))}}),bi=Object(i.t)(function(){return function(e){var t=e(Object(h.e)({useBatchedDeleteConfiguration:w._})).useBatchedDeleteConfiguration;e(Object(it.t)({keyFacet:N.e,facets:[N.e,C.h,C.v,C.m,$.e,V,C.O,C.f,d.t,C.M,C.i,C.p,ee.n]}));e(Object(it.t)({keyFacet:m,facets:[m,d.e,d.r]}));e(Bn);e(Object(u.r)(N.e,st.e)(yn));e(Object(u.r)(Wn,st.e)(Xn));e(Object(u.r)(m,st.e)(bn));e(Object(ut.e)(N.e,zn.e)(Rn));e(Object(ut.e)(z.e,zn.e)(Rn));e(yi);e(Object(ut.e)(z.e,di.e)(nr));e(Object(ut.e)(z.e,Bt.e)(Kn));e(Object(u.r)(N.e,sr.t)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([13],5028)];case 1:return[2,e.sent().driveItemCreateFolderOperationHandler]}})})})));e(t?Object(u.r)(N.e,or.e)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([597],5029)];case 1:return[2,e.sent().driveItemDeleteItemsBatchedOperationHandler]}})})})):Object(u.r)(N.e,or.e)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([14],4134)];case 1:return[2,e.sent().driveItemDeleteItemsOperationHandler]}})})})));e(Object(u.r)(N.e,ur.t)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([16],5030)];case 1:return[2,e.sent().driveItemRenameItemOperationHandler]}})})})));e(Object(u.r)(N.e,ar.t)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([17],5233)];case 1:return[2,e.sent().driveItemUploadItemsOperationHandler]}})})})));e(Object(u.r)(N.e,Gn.t)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([15],5031)];case 1:return[2,e.sent().driveItemMoveCopyItemsOperationHandler]}})})})));e(Object(u.r)(N.e,Vn.e)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([12],5032)];case 1:return[2,e.sent().addToOneDriveOperationHandler]}})})})));e(Object(ut.e)(N.e,fr.e)(jr));e(Object(ut.e)(N.e,Yn.e)(er));e(Object(ut.e)(N.e,lr.e)(Ir));e(Object(ut.e)(N.e,cr.t)(Wr));e(Object(ut.e)(N.e,hr.e)(Vr));e(Object(ut.e)(N.e,ei.e)(Kr));e(Object(ut.e)(N.e,ti.e)(Yr));e(Object(ut.e)(N.e,pr.t)($r));e(Object(ut.e)(N.e,dr.e)(Gr));e(Object(ut.e)(N.e,pi.e)(ui))}}),wi=de.e.isActivated("1097DC43-A3D7-4151-A119-48637C6D4534","04/05/2022","Fixes itemsscope + ko shim logic related to items with view-only permissions"),Ei=Object(i.i)()(function e(t){var n=this;return function(i){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,o,u,a,f,c;return Object(r.__generator)(this,function(h){switch(h.label){case 0:n=t.itemKey;s=Nr.deserialize(n);o=s.endpoint;u=Object(l.n)(s);return[4,i(Si({url:Object(l.e)(s),driveUrl:u,qosName:"commands",endpoint:o}))];case 1:a=h.sent();(f=new g.e({publisher:e})).resolveItems({items:(c={},c[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},vr.pack(a.addToOneDrive)),mr.pack(a.createFolder)),gr.pack(a.createLink)),yr.pack(a.delete)),br.pack(a.download)),wr.pack(a.invite)),Er.pack(a.move)),Sr.pack(a.officeLens)),xr.pack(a.rename)),Tr.pack(a.upload)),c)});i(f.execute());return[2]}})})}});function Si(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(r){t=e.endpoint;i=n(Object(c.i)(t));return[2,{addToOneDrive:{roles:wi||i?["write"]:["owner","write","read"]},createFolder:{roles:["owner","write"]},createLink:{defaultScope:"anonymous",linkTypes:["view","edit"],scopes:["anonymous","application"]},delete:{roles:["owner","write"]},download:{roles:["owner","write","read"]},invite:{roles:["owner","write"]},move:{roles:["owner","write"]},officeLens:{extensions:["jpeg","jpg","jpe"],lensNames:["officeLens"],roles:["owner"]},rename:{roles:["owner","write"]},upload:{roles:["owner","write"]}}]})})}}var xi=Object(i.t)(function(){return function(e){e(Object(it.t)({keyFacet:Nr,facets:[vr,mr,gr,yr,br,wr,Er,Sr,xr,Tr]}));e(Object(u.r)(Nr,st.e)(Ei))}});function Ti(e){var t=e.itemKey,n=e.itemSetKeyFacet,i=e.parentItemKeyFacet,s=e.childItemsResponse,o=e.disableRemoteItem,u=e.parentItemResponse,a=e.mapItemSetKey,f=n.deserialize(t),l=i.serialize(f),c=f.driveItemKey.endpoint;return function(n){var i,f;we.t(be.e.processData.start);var v=n(ye(Object(r.__assign)(Object(r.__assign)({},e),{response:s,disableRemoteItem:o,parentItemKey:l}))).itemResolver;if(a){var m=a().itemResolver;v.merge(m)}var g=n(Object(h.e)({allowDisableRemoteItemInPlace:w.i})).allowDisableRemoteItemInPlace;if(u){var y=n((g&&o?ge:F)({setItemKey:t,driveItemResponse:u,endpoint:c})),b=y.itemResolver,E=y.actualItemKey;v.mapKeys({mappings:(i={},i[E]=l,i)});v.merge(b)}v.resolveItems({items:(f={},f[l]=Object(r.__assign)({},Object(p.e)().forFacet(d.t).thenInvalidate(e.itemKey,d.e).pack()),f)});we.t(be.e.processData.end);return{itemResolver:v}}}var Ni=de.t.isActivated("cade488d-480a-444f-a1ea-d3d121529bb7","11/01/2021","Set one minute timeout for API requests");function Ci(e){var t=this,n=e.itemKey,i=e.itemSetKeyFacet,s=e.getUrl,o=e.sortChildItems,u=e.qosName,a=e.preprocessResponse,f=e.expectedErrors,h=e.disableRemoteItem,p=void 0!==h&&h,d=i.deserialize(n),v=d.driveItemKey.endpoint;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,h,m,g,y;return Object(r.__generator)(this,function(b){switch(b.label){case 0:t=Object(l.n)(d.driveItemKey);b.label=1;case 1:b.trys.push([1,4,,5]);return[4,n(Object(c.n)({url:s(d),driveUrl:t,qosName:"getChildren".concat(u?".".concat(u):""),endpoint:v,headers:e.additionalHeaders,expectedErrors:f,timeout:Ni?void 0:6e4,scenarioInfo:{scenario:nt.e.Search,scenarioType:nt.t.ActiveUserOperation}}))];case 2:i=b.sent();h=Object(r.__spreadArray)([],i.value,!0);m=a&&a(h)||i.value;g=o&&o(m)||m;return[4,n(Ti(Object(r.__assign)(Object(r.__assign)({},e),{disableRemoteItem:p,childItemsResponse:Object(r.__assign)(Object(r.__assign)({},i),{value:g})})))];case 3:return[2,{itemResolver:b.sent().itemResolver}];case 4:y=b.sent();throw new Se.e(Object(r.__assign)({code:"UnknownError"},y instanceof Error?{innerError:y}:{message:JSON.stringify(y)}));case 5:return[2]}})})}}var ki=new v.e("searchRootItem",{driveItemKey:Object(v.o)(N.e),searchTerm:Object(v.s)()}),Li=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a;return Object(r.__generator)(this,function(f){switch(f.label){case 0:t=[{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}];i=Jn.deserialize(e.itemKey),s=i.searchTerm,o=i.extFilters,u=i.dateFilter;return[4,n(Ci(Object(r.__assign)(Object(r.__assign)({},e),{qosName:"search",itemSetKeyFacet:Jn,parentItemKeyFacet:ki,getUrl:function(e){var t,i=e.driveItemKey;s&&(t=encodeURIComponent(s).replace(/'/g,"''"));var a=(function(e){if(!e||0===e.length)return"";for(var t=[],n=[],i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if(Object(Qt.e)(s)){u=Object(Qt.t)(s);o=!0}"folder"===u?!o&&t.push("folder ne null"):"onenote"===u?o?n.push("(remoteItem/package/type ne 'oneNote' and package/type ne 'oneNote')"):t.push("(remoteItem/package/type eq 'oneNote' or package/type eq 'oneNote')"):"."!==u[0]?"audio"===u?!o&&t.push("audio ne null"):"document"===u?!o&&t.push("file ne null and video eq null and image eq null and audio eq null and folder eq null"):"media"===u&&!o&&t.push("image ne null or video ne null"):!o&&t.push("(endsWith(name, '".concat(u.toLowerCase(),"') or endsWith(remoteItem/name, '").concat(u.toLowerCase(),"'))"))}return t.length>0||n.length>0?"&$filter= ( ".concat(0===n.length?Zt(t):0===t.length?en(n):en(Object(r.__spreadArray)([Zt(t)],n,!0))," )"):""})(o),f=(null==u?void 0:u.beginDate)?"( createdDateTime ge ".concat(u.beginDate," )"):"",h="";h=""!==a?"".concat(a," ").concat(f?" and ".concat(f):""," "):f?"&$filter=".concat(f):"";return n(Object(c.i)(i.endpoint))?"".concat(Object(l.t)(i),"/oneDrive.search(q='").concat(t,"')?").concat(h,"&$expand=thumbnails&select=*,webDavUrl"):"".concat(Object(l.t)(i),"/search(q='").concat(t,"')?$expand=thumbnails&select=*,webDavUrl")},expectedErrors:t})))];case 1:a=f.sent().itemResolver;n(a.execute());return[2]}})})}});var Ai=Object(i.t)(function(){return function(e){e(Object(u.r)(Jn,st.e)(Li));e(Object(ut.e)(Jn,di.e)(rr));e(Object(it.t)({keyFacet:Jn,facets:[d.e]}))}}),Oi=n(4346),Mi=n(4111),_i=n(692),Di=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=J.e.deserialize(n).driveItemKey,s=i.endpoint;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,p,d,v=this;return Object(r.__generator)(this,function(m){t={Caller:"HoverCard"};o=e(Object(h.e)({enableCookiesForAnalyticsRequests:w.a})).enableCookiesForAnalyticsRequests,u=void 0!==o&&o;"GetItemAnalytics_addon-graph";a=Object(r.__awaiter)(v,void 0,void 0,function(){var o,a,f,h,p,d;return Object(r.__generator)(this,function(v){switch(v.label){case 0:return[4,e(Object(c.n)({url:(m=Object(l.t)(i),g=Pi(m),y="$expand=analytics($expand=allTime($expand=activities))",b="$select=*".concat(",id,reactions").concat(",trending"),w="".concat(b,"&").concat(y).concat(",insights($expand=keyPoints)"),E="".concat(g,"?").concat(w),E),qosName:"".concat("GetItemAnalytics_addon-graph","_GetAnalyticsSections"),endpoint:s,timeout:6e3,headers:t,driveUrl:Pi(Object(l.n)(i)),allowCookies:u}))];case 1:o=v.sent();a=Object(Oi.t)(o);if(f=a.createdBy){h=D.e.serialize({email:f.email,endpoint:s});e(Object(it.e)({items:(p={},p[h]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},C.h.pack(f.displayName)),O.e.pack(f.email)),O.r.pack(f.image)),O.i.pack(f.id)),p[n]=Object(r.__assign)({},L.r.pack({itemKey:h,displayValue:f.displayName})),p)}))}e(Object(it.e)({items:(d={},d[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},L.h.pack(a.viewCount)),L.p.pack(a.viewerCount)),L.o.pack(a.isTrending)),L.e.pack(a.activities)),L.f.pack(a.likeCount)),L.t.pack(a.commentCount)),L.a.pack(a.lifeCycleStatus)),L.u.pack(a.keyPointsData)),L.s.pack(a.incompleteData)),L.i.pack(a.createdDateTime)),d)}));return[2]}var m,g,y,b,w,E})});f=[a];p=Object(r.__awaiter)(v,void 0,void 0,function(){var o,a,f,h;return Object(r.__generator)(this,function(p){switch(p.label){case 0:return[4,e(Object(c.n)({url:(d=Object(l.t)(i),v=Pi(d),"".concat(v).concat("?$expand=recommendedActionSet($expand=nonAggregatedRecommendedActions,aggregatedEditRecommendedAction($expand=importantActorsAndActivities)),conversationSet($expand=emailConversations($expand=participants),meetingConversations($expand=participants),teamsConversations($expand=participants))")),qosName:"".concat("GetItemAnalytics_addon-graph","_GetRecommendedActionsAndConversations"),endpoint:s,timeout:6e3,headers:t,driveUrl:Pi(Object(l.n)(i)),allowCookies:u}))];case 1:o=p.sent();a=(function(e){var t=e.recommendedActionSet,n=t.nonAggregatedRecommendedActions;t.aggregatedEditRecommendedAction&&t.aggregatedEditRecommendedAction.recentEditorCount&&(n=n.concat(t.aggregatedEditRecommendedAction));return n})(o);f=(function(e){var t=e.conversationSet,n=t.emailConversations.concat(t.meetingConversations,t.teamsConversations),r={},i=[];n.forEach(function(e){var t=e.teamsMessageThreadId||e.conversationInstance.conversationId;if(!r.hasOwnProperty(t)){r[t]=!0;i.push({activityTimestamp:e.conversationInstance.sharedByTime,context:e.conversationInstance.subject,conversationType:Mi.e[e.conversationInstance.referenceType],deepLink:e.conversationInstance.deepLink,referencePreview:e.conversationInstance.referencePreview,isSharedByMe:e.conversationInstance.isSharedByMe,sharedByUserDisplayName:e.sharedByUser.displayName,sharedByUserEmail:e.sharedByUser.email,participants:e.participants})}});return i.sort(function(e,t){return Date.parse(t.activityTimestamp)-Date.parse(e.activityTimestamp)})})(o);e(Object(it.e)({items:(h={},h[n]=Object(r.__assign)(Object(r.__assign)({},L.l.pack(a)),L.n.pack(f)),h)}));return[2]}var d,v})});f.push(p);e(Object(it.e)({items:(d={},d[n]=Object(r.__assign)({},L.c.pack([])),d)}));return[2,Object(_i.e)(f)]})})}});function Pi(e){return e.replace("2.0","2.1")}var Hi=Object(i.t)(function(){return function(e){e(Object(it.t)({keyFacet:J.e,facets:[L.h]}));e(Object(u.r)(J.e,st.e)(Di))}}),Bi=n(2738),ji=n(955),Fi=n(305),Ii=Object(i.n)({maxParallelOperationCount:1,maxItemCountPerBatch:20,areSameBatch:function(e,t){var n=k.e.deserialize(e.itemKey).driveItemKey,r=n.endpoint,i=n.driveId,s=k.e.deserialize(t.itemKey).driveItemKey,o=s.endpoint,u=s.driveId;return!!i&&!!u&&i===u&&r===o}})(function e(t){var n=this,i=t.items;return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,o,u,a,f,h,d,v,m,y,b,w,E,S,x,T,L,A,O,M,_,D,P,H,B,j,F,I,q,R;return Object(r.__generator)(this,function(U){switch(U.label){case 0:n=Object.keys(i);s=n[0];o=k.e.deserialize(s);u=o.driveItemKey,a=u.endpoint,f=u.driveId;if(!a)throw new Error("No endpoint to determine activity items.");h=n.map(function(e){return k.e.deserialize(e).driveItemKey.itemId});d=Object(l.n)({endpoint:(z=a,z.replace("2.1","2.0")),driveId:f});v="".concat(d,"/ExtendedActivitiesForItems");m={driveItems:h,badgeOnly:!0};return[4,t(Object(c.t)({url:v,method:"POST",body:m,qosName:"ItemActivityFieldDataSource.extendedActivitiesForItems",endpoint:a}))];case 1:if((y=U.sent()).value){b=(function(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n],s=i.driveItemId;if(s){(t[s]||(t[s]=[])).push(i)}}return t})(y.value);w=0;E=0;S=0;x=0;T=new g.e({publisher:e});for(L=0,A=n;L<A.length;L++){O=A[L];w++;M=k.e.deserialize(O);_=M.driveItemKey.itemId;D=_&&b[_];P=N.e.serialize(M.driveItemKey);H=void 0;if(D){B=new Bi.e;j=B.processResponse({item:{name:_||"",relativePath:"",absolutePath:"",isFolder:!1,graphItemUrl:v},response:{value:D,"@odata.nextLink":""}}).activities;F=qi(j);if(I=Ri(j)){S++;E++;if(!F){x++;q=Ui(I,O).itemResolver;T.merge(q);H=I}}}T.resolveItems({items:(R={},R[O]=Object(r.__assign)({},ji.e.pack(H)),R[P]=Object(r.__assign)({},Object(p.e)().forFacet(C.e).thenInvalidate(O,ji.e).pack()),R)})}t(T.execute());t(Object(Fi.e)({name:"ItemActivityField.View",extraData:{activityFieldProcessedItemCount:w,activityFieldEligibleItemCount:E,activityFieldActiveItemCount:S,activityFieldBadgedItemCount:x,activityFieldBadgedPercent:w?Math.round(x/w*100):0},isIntentional:!1}))}return[2]}var z})})}});function qi(e){var t=e[0];return!!t&&1===t.actors.length&&t.actors[0].self&&!t.type||!1}function Ri(e){var t=e[0],n={};if(t)for(var i=0,s=t.actors;i<s.length;i++){(l=s[i]).id&&(n[l.id]=!0)}for(var o=Object(r.__assign)(Object(r.__assign)({},t),{actors:Object(r.__spreadArray)([],t.actors||[],!0)}),u=1;u<e.length;u++)for(var a=0,f=e[u].actors;a<f.length;a++){var l;if("string"==typeof(l=f[a]).id&&!n[l.id]){o.actors.push(l);n[l.id]=!0}}return o||t}function Ui(e,t){var n=new g.e({publisher:Ui}),i=k.e.deserialize(t).driveItemKey,s=(function(e){var t=e.actors,n=e.action.mention&&e.action.mention.mentionees||[],i=e.action.share&&e.action.share.recipients||[],s=e.action.commentResponse&&e.action.commentResponse.commentAuthor,o=Object(r.__spreadArray)(Object(r.__spreadArray)(Object(r.__spreadArray)([],t,!0),n,!0),i,!0);s&&o.push(s);return o})(e);if(s.length>0){var o=zi(s,i).itemResolver;n.merge(o)}return{itemResolver:n}}function zi(e,t){for(var n=new g.e({publisher:zi}),r=0,i=e;r<i.length;r++){var s=Wi(i[r],t).itemResolver;n.merge(s)}return{itemResolver:n}}function Wi(e,t){var n=new g.e({publisher:Wi}),r=H({itemKey:N.e.serialize(t),userKey:D.e.serialize({email:e.email||"",endpoint:t.endpoint}),user:{displayName:e.displayName,email:e.email}}).itemResolver;n.merge(r);return{itemResolver:n}}var Xi=Object(i.t)(function(){return function(e){e(Object(u.r)(k.e,st.e)(Ii));e(Object(u.r)(k.e,st.e)(Ii))}}),Vi=n(65),$i=Object(i.i)({mergeForSameItemKey:!1})(function e(t){var n=this,i=t.itemKey,s=t.options,o=s.isFollowed,u=s.progressItemKey,a=Mt.e.deserialize(i),f=a.driveItemKey,p=f.itemId,d=void 0===p?"":p,v=Object(l.n)(f);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,i,s,l,p,m,y,b,E;return Object(r.__generator)(this,function(S){switch(S.label){case 0:n=t(Object(h.e)({saveForLaterGraphEndpoint:w.A})).saveForLaterGraphEndpoint;i=new g.e({publisher:e});s=Mt.e.serialize(a);l=n||f.endpoint;u&&t(Object(it.e)({items:(y={},y[u]=Object(r.__assign)({},Vi.b.pack({itemKey:N.e.serialize(f)})),y)}));p=o?{url:"".concat(l,"/drives/").concat(f.driveId,"/items/").concat(d,"/follow"),method:"POST",qosName:"followItem"}:{url:"".concat(l,"/drives/").concat(f.driveId,"/following/").concat(d),method:"DELETE",qosName:"unfollowItem"};S.label=1;case 1:S.trys.push([1,3,,4]);return[4,t(Object(c.t)({url:p.url,driveUrl:v,method:p.method,qosName:p.qosName,endpoint:l}))];case 2:S.sent();i.invalidateItems({items:(b={},b[s]=[C.E],b)});i.resolveItems({items:(E={},E[s]=Object(r.__assign)({},C.E.pack(o||void 0)),E)});t(i.execute());return[3,4];case 3:m=S.sent();throw new Error(m.message);case 4:return[2]}})})}});var Ji=n(617),Ki=n(795),Qi=n(32),Gi=n(155),Yi=Object(i.n)()(function e(t){var n=this,i=t.items;return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,o,u,a,f,l,c,h,v,m,y,b,w,E,S,x;return Object(r.__generator)(this,function(T){switch(T.label){case 0:return[4,t(Object(I.e)(function(e){return e.demandItemFacet(Qi.h,Gi.e)}))];case 1:if(!T.sent())return[2];n=Object.keys(i);s=n[0];o=Mt.e.deserialize(s);if(!(u=o.driveItemKey.endpoint))throw new Error("No endpoint to determine followed items.");a=Lt.e.serialize({driveItemKey:{endpoint:u},sortBy:"",isAscending:!0});return[4,t(Object(Ki.e)(function(e){return e.demandItemFacet(d.e,a)}))];case 2:f=T.sent();l=f&&f.itemKeys||[];c=new g.e({publisher:e});h={};for(v=0,m=l;v<m.length;v++){E=m[v];h[E]=!0}for(y=0,b=n;y<b.length;y++){w=b[y];E=Mt.e.deserialize(w).driveItemKey;S=!!h[N.e.serialize(E)];c.resolveItems({items:(x={},x[w]=Object(r.__assign)(Object(r.__assign)({},C.E.pack(S||void 0)),Object(p.e)().forFacet(C.E).thenInvalidate(a,d.e).pack()),x)})}t(c.execute());return[2]}})})}});var Zi=Object(i.t)(function(){return function(e){e(Object(it.t)({keyFacet:Mt.e,facets:[C.E]}));e(Object(u.r)(Mt.e,st.e)(Yi));e(Object(u.r)(Mt.e,Ji.e)($i))}}),es=new v.e("sharesItem",{endpoint:Object(v.s)(),shareId:Object(v.s)()}),ts=n(300),ns=Object(i.i)({maxParallelOperationCount:8})(function e(t){var n=this,i=t.itemKey,s=es.deserialize(i),o=s.endpoint;return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,u,a,f,p,v,m,y,b,E,S,x,C,k,L,A;return Object(r.__generator)(this,function(O){switch(O.label){case 0:n=t(Object(h.e)({graphEndpoint:w.m,graphRecentEndpoint:w.b})),u=n.graphEndpoint,a=n.graphRecentEndpoint;return[4,t(Object(c.t)({url:"".concat(Object(l.r)(s),"?$expand=thumbnails&select=*,webDavUrl"),qosName:"getSharesItem",endpoint:o,headers:{Prefer:"redeemSharingLinkIfNecessary"}}))];case 1:f=O.sent();p=new g.e({publisher:e});v=f&&f.parentReference;m=v&&v.driveId;y={endpoint:o,driveId:m,itemId:f.id};b=N.e.serialize(y);E=v&&v.id?N.e.serialize({endpoint:o,driveId:m,itemId:v.id}):void 0;p.merge(t(Object(T.e)({itemKey:b,driveItem:f,endpoint:o,parentFolderItemKey:E})).itemResolver);S=t(Object(h.e)({processDriveItemFromSharePoint:w.N})).processDriveItemFromSharePoint;x=o.indexOf("/_api/v2.0")>-1||o.indexOf("/_api/v2.1")>-1;C=u||a;if(S&&(x||C)){k=t(S.process({itemKey:b,driveItem:f})).itemResolver;p.merge(k)}p.resolveItems({items:(L={},L[b]=Object(r.__assign)(Object(r.__assign)({},ts.n.pack(N.e)),d.t.pack({itemKey:z.e.serialize({driveItemKey:y,sortBy:"",isAscending:!0})})),L)});p.mapKeys({mappings:(A={},A[b]=i,A)});t(p.execute());return[2]}})})}});var rs=Object(i.t)(function(){return function(e){e(Object(u.r)(es,st.e)(ns))}}),is=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(bi);e(xi);e(Hi);e(o.e);e(s.e);e(vn);e(gt);e(kt);e(Ht);e(Ai);e(Xi);e(Zi);e(rs);return[2]})})}}),ss=n(800),os=n(110),us=Object(i.t)(function(){return function(e){e(Object(ut.e)(N.e,ss.e)(Object(ot.n)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,e(Object(os.u)())];case 1:t.sent();return[4,n.ee(27,4970)];case 2:return[2,t.sent().driveItemActivityFieldControlHandler]}})})})))}}),as=n(512),fs=n(594),ls=n(658),cs=n(71),hs=n(199),ps=n(588),ds=n(376),vs=n(159),ms=Object(cs.i)({key:new M.e("dateAccessedColumn").id,name:hs.e,fieldName:"",minWidth:cs.e.regularMin,maxWidth:cs.e.regularMax,isCollapsable:!0,data:{facets:Object(r.__assign)({},vs.e.pack("dateAccessed"))}},ps.e)(function(e,t){var n=e.demandItemFacet(C.o,t,{suppressGetItems:!0}),r=n&&new Date(n).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(Qi.T,Gi.e),s=i&&i.language||window.navigator.language;return s?{text:Object(ds.n)(new Date(r),s)}:{dateValue:r}},function(e,t){return"".concat(e.demandItemFacet(C.o,t))}),gs=n(2874),ys=Object(ot.t)()(function(){return function(e){return ws}});var bs=[ls.t,gs.e,ms];function ws(e,t){return{columns:bs}}var Es=n(231),Ss=n(429),xs=n(213),Ts=n(66),Ns=n(580),Cs=n(1247),ks=n(318);Object(zr.n)([{rawString:".iconContainer_6c203618{position:relative;font-size:16px;margin:0 4px;height:16px;width:16px}.brandIcon_6c203618{position:relative;margin:0 4px;height:16px;width:16px}.brandIcon_6c203618 img{display:block}.menuItemIconContainer_6c203618{position:relative;margin:0 4px;height:36px;line-height:36px;width:14px}.logoFillIcon_6c203618,.logoIcon_6c203618{height:100%;position:absolute;left:0;right:0}.logoFillIcon_6c203618[data-icon-name='ExcelLogo16'],.logoIcon_6c203618[data-icon-name='ExcelLogo16']{color:#217346}.logoFillIcon_6c203618[data-icon-name='OneNoteLogo16'],.logoIcon_6c203618[data-icon-name='OneNoteLogo16']{color:#5c2d91}.logoFillIcon_6c203618[data-icon-name='PowerPointLogo16'],.logoIcon_6c203618[data-icon-name='PowerPointLogo16']{color:#d24726}.logoFillIcon_6c203618[data-icon-name='WordLogo16'],.logoIcon_6c203618[data-icon-name='WordLogo16']{color:#2b579a}.logoFillIcon_6c203618[data-icon-name='VisioLogo16'],.logoIcon_6c203618[data-icon-name='VisioLogo16']{color:#3854a2}.logoFillIcon_6c203618{color:#ffffff}.contextualMenuItemLinkContent_6c203618{white-space:nowrap;height:inherit;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;max-width:100%}.contextualMenuItemTextLabel_6c203618{margin:0 4px;vertical-align:middle;display:inline-block;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}\n"}]);var Ls=n(14),As=n(1732),Os=n(22),Ms=n(30),_s=n(6),Ds=new _s.e("openInOfficeOnlineAction",{forceInSameWindow:_s.t}),Ps=n(50),Hs=n(165),Bs=Hs.n.isFeatureEnabled({ODC:"WebConvergenceEnabled"}),js=!de.t.isActivated("625E4237-E29D-466D-B5EB-E72582BE416E","03/18/2022","Enable wac ST localStroage, remove once WopiHelper is supported in WebFE"),Fs=Object(Rr.e)(function(e,t){var n=t.itemKey,i=e.demandItem({openUrl:C.O,appFacet:te.e,isMalwareDetected:C.k},n),s=i.openUrl,o=i.appFacet,u=i.isMalwareDetected,a=e.dispatch,f=!u&&!!o&&!!s,l=e.demandItemFacet(Ds,n);return Object(r.__assign)({isAvailable:f,onExecute:s?function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e,t,i,o,u,f,c;return Object(r.__generator)(this,function(r){e=(new Date).getTime().toString();t=As.e.AddWopiPerfMarkToTargetUrl(e,"ItemsView",s);if(js)try{localStorage.ODCWac_ST=(new Date).getTime().toString()}catch(e){}i=a(Object(I.e)(function(e){return Ds.evaluate(l)(e,{itemKey:n,forceInSameWindow:!1})})).forceInSameWindow;if(Bs){o=new Ps.t(t);if(-1!==o.getHost().indexOf("my.microsoftpersonalcontent.com")){(u=new Ps.t("https://".concat("onedrive.live.com","/edit.aspx"))).setQuery(o.getQuery());f=o.getPathSegments();c=f[1];u.setQueryParameter("cid",c);t=u.toString()}}i?window.location.href=t:window.open(t);return[2]})})}:void 0},Object(Ms.t)(e,{itemKey:n,engagement:{name:"OpenInOfficeOnline",isIntentional:!0}}))})(Os.e),Is=Object(Ls.s)()(Object(Ls.r)()(Fs)),qs={key:n(1507).e,automationId:"openInOfficeOnlineCommand",action:qr.createElement(Is,null),facets:Object(r.__assign)({},Ts.t.pack(!0))},Rs=n(95),Us=n(1502),zs=new _s.e("openInOfficeClientAction",{}),Ws=new Rs.e,Xs=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2]})})},Vs=Object(Rr.e)(function(e,t){var n=t.itemKey,i=e.demandItem({key:N.e,appMap:te.e,fileName:C.d,openUrl:C.O,canonicalUrl:C.i,isMalwareDetected:C.k},n),s=i.key,o=i.appMap,u=i.fileName,a=i.openUrl,f=i.canonicalUrl,l=i.isMalwareDetected,c=!1,h=Xs,p=Br(e,{itemKey:n,oneOfRequiredRoles:["write","owner"]});if(n){var d=!l&&!!o&&!!a&&(Ws.isMac||Ws.isWindows||Ws.isIOS||Ws.isWinPhone||Ws.isAndroid),v=e.demandItemFacet(zs,n),m=zs.evaluate(v)(e,{itemKey:n,isAvailable:d,protocolCallback:Js}),g=m.protocolCallback,y=m.isAvailable;c=d&&y;s&&c&&(h=(function(e){var t=this,n=e.key,i=e.openUrl,s=e.canonicalUrl,o=e.canEdit,u=e.appMap,a=e.fileName,f=e.isNew,l=e.defaultLocation,c=e.protocolCallback;return function(){return Object(r.__awaiter)(t,void 0,void 0,function(){var e,t;return Object(r.__generator)(this,function(r){if(!n)return[2];e=!!o;t=function(){i&&window.open(i)};Object(Us.e)({app:u||"",itemUrl:s||"",extension:a&&a.extension||"",shouldEdit:e,isNew:Boolean(f),defaultLocation:l||"",platformDetection:Ws,onNavigate:c,onFailureCallback:t});return[2]})})}})({key:s,openUrl:a,canonicalUrl:f,canEdit:p,appMap:o,fileName:u,protocolCallback:g}))}return Object(r.__assign)({isAvailable:c,onExecute:h},Object(Ms.t)(e,{itemKey:n,engagement:{name:"OpenInOfficeClient",isIntentional:!0}}))})(Os.e),$s=Object(Ls.s)()(Object(Ls.r)()(Vs));function Js(e){window.location.href=e}var Ks={key:n(1508).e,automationId:"openInOfficeClientCommand",action:qr.createElement($s,null),facets:Object(r.__assign)({},Ts.t.pack(!0))},Qs=n(1344),Gs=new M.e("fileHandlerOpenCommand").id,Ys={ODB:625,ODC:"CommandBarBrandIcons",Fallback:!1},Zs=Object(Ls.s)()(Object(Ls.r)()(Object(Rr.e)(function(e,t){var n=t.itemKey,r=t.item,i=e.demandItem({appMap:te.e},n).appMap,s=r.name;r.key===qs.key?s=s||(i?Object(ks.s)(i,!1):ks.e.OpenInBrowser):r.key===Ks.key&&(s=s||(i?Object(ks.o)(i,!0):ks.e.Open));return{name:s}})(function(e){return qr.createElement("div",{className:"contextualMenuItemLinkContent_6c203618"},qr.createElement("span",{dir:"auto",className:"contextualMenuItemTextLabel_6c203618"},e.name))}))),eo=Object(Ls.s)()(Object(Ls.r)()(Object(Rr.e)(function(e,t){var n=t.itemKey,i=t.menuProps,s=e.demandItem({appMap:te.e,fileName:C.d},n),o=s.appMap,u=s.fileName,a={};if(i&&i.items){var f=i.items[0];f&&-1!==f.key.indexOf(Gs)&&f.iconProps&&(a=f.iconProps)}var l=!!u&&!!u.extension&&".pdf"===u.extension.toLowerCase(),c={iconName:o?Object(ks.t)(o):l?"PDF":"OpenFile"},h=Hs.n.isFeatureEnabled(Ys),p=void 0;i&&i.items&&(p=i.items.map(function(e){return e.key===qs.key?Object(r.__assign)(Object(r.__assign)({},e),{iconProps:c,name:e.name||o&&Object(ks.s)(o,!0)||(l?ks.e.OpenInBrowser:ks.e.Open),onRenderIcon:o?to.bind(void 0,o,!0,h):void 0}):e.key===Ks.key?Object(r.__assign)(Object(r.__assign)({},e),{iconProps:c,name:e.name||o&&Object(ks.i)(o),onRenderIcon:o?to.bind(void 0,o,!0,h):void 0}):e}));return{iconProps:a||c,onRenderIcon:o?to.bind(void 0,o,!1,h):void 0,text:ks.e.Open,menuProps:p?Object(r.__assign)(Object(r.__assign)({},i),{items:p}):i}})(Cs.e)));function to(e,t,n){var r=e&&Object(ks.n)(e),i=e&&Object(ks.r)(e);return i&&n?qr.createElement(Qs.e,{size:16,extension:"",brand:i.toLowerCase(),className:"brandIcon_6c203618"}):r?qr.createElement("span",{className:t?"menuItemIconContainer_6c203618":"iconContainer_6c203618"},qr.createElement(Ns.e,{iconName:r.logoFill16,className:"logoFillIcon_6c203618"}),qr.createElement(Ns.e,{iconName:r.logo16,className:"logoIcon_6c203618"})):null}var no={key:Ss.e.key,automationId:Ss.e.automationId,subMenuProps:{items:[qs,Ks]},onRender:function(e){return qr.createElement(eo,Object(r.__assign)({},e,{menuProps:e.subMenuProps}))},facets:Object(r.__assign)({},Ts.t.pack(!0))},ro={key:Ss.e.key,automationId:Ss.e.automationId,name:Ss.e.name,subMenuProps:{items:[qs,Ks],contextualMenuItemAs:Zs},facets:Object(r.__assign)({},Ts.t.pack(!0))},io=Object(ot.t)()(function(){return function(e){return function(e,t){var n=t.commands,i=t.overflowCommands,s=t.farCommands,o=i?Object(r.__spreadArray)([],i,!0):[],u=n?Object(r.__spreadArray)([],n,!0):[],a=s;return{commands:u=so(e,{defaultCommands:u}).overrideDefaultCommands,overflowCommands:o,farCommands:a}}}});function so(e,t){for(var n=[],r=0,i=t.defaultCommands;r<i.length;r++){var s=i[r];s.key===Ss.e.key?n.push(no):n.push(s)}return{overrideDefaultCommands:n}}var oo=n(644),uo=Object(Ls.s)()(Object(Ls.r)()(Object(Rr.t)(function(e,t){var n=t.itemKey,r=e.demandItemFacet(C.M,n);return r?qr.createElement(oo.e,{itemKey:r.itemKey}):null}))),ao=n(408),fo={key:"OpenFileLocation",name:ao.i,title:ao.i,action:uo,iconProps:{iconName:"FabricFolder"}},lo=Object(ot.t)()(function(){return function(e){return ho}});var co=[Ss.e,fo,xs.n,xs.t];function ho(e,t){return{commands:so(0,{defaultCommands:co}).overrideDefaultCommands}}var po=n(279),vo=de.e.isActivated("EB854331-5340-42D0-8893-9E093DC56A47","03/10/2022","Use standard Open command for Office files"),mo=Object(ot.t)()(function(){return function(e){return bo}});var go={name:"-",key:"divider_1",itemType:po.e.Divider},yo=[vo?Ss.e:ro,fo,go,xs.n,xs.t];function bo(e,t){return{commands:yo}}var wo=n(649),Eo=Object(ot.t)()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}});var So=n(1148),xo=n(1353),To=Object(ot.t)()(function(){return function(){return No}});function No(e,t){var n=e.demandItemFacet(q.u,t.itemKey);return Object(r.__assign)({},n?{defaultLayout:xo.t.layoutType,isLayoutResolved:!0}:{layouts:[So.t,So.e]})}var Co=n(1294),ko=n(270),Lo=Object(ot.t)()(Oo),Ao=Object(ot.t)()(Oo);function Oo(){return function(e){return function(e,t){var n=t.itemKey;if(n){var r=e.demandItemFacet(jt.e,n);if(r&&r.filters&&Object(Ae.e)({extFilters:Object(Ae.t)(r.filters),allowedMediaTypes:[Ce.e.photo,Ce.e.video],fileTypeIconMap:Xt.e}))return{defaultLayout:ko.e,isLayoutResolved:!0}}return{}}}}var Mo=Object(i.t)(function(){return function(e){e(vn);e(Object(ut.e)(jt.e,Co.e)(Lo));e(Object(ut.e)(jt.e,fs.e)(Ao));e(Object(ut.e)(jt.e,as.e)(ys));e(Object(ut.e)(Wt.e,Es.e)(lo));e(Object(ut.e)(Wt.e,wo.e)(mo));e(Object(ut.e)(Vt,zn.e)(Eo));e(Object(ut.e)(jt.e,fs.e)(To))}}),_o=n(892),Do=Object(cs.i)({key:new M.e("dateFollowedColumn").id,name:hs.c,fieldName:"",minWidth:cs.e.regularMin,maxWidth:cs.e.regularMax,isCollapsable:!0,data:{facets:Object(r.__assign)({},vs.e.pack("dateFollowed"))}},ps.e)(function(e,t){var n=e.demandItemFacet(C.a,t),r=n&&new Date(n).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(Qi.T,Gi.e),s=i&&i.language||window.navigator.language;return s?{text:Object(ds.n)(new Date(r),s)}:{dateValue:r}},function(e,t){return"".concat(e.demandItemFacet(C.a,t))}),Po=n(1472),Ho=Object(ot.t)()(function(){return function(e){return jo}});var Bo=[ls.t,gs.e,Do,Po.e];function jo(e,t){return{columns:Bo}}var Fo=n(410);Object(zr.n)([{rawString:".root_de13c386{margin-top:15px;margin-bottom:15px;font-size:17px}[dir='ltr'] .root_de13c386{margin-left:96px}[dir='rtl'] .root_de13c386{margin-right:96px}\n"}]);var Io=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return this.props.group?qr.createElement("div",{className:"root_de13c386"},this.props.group.name):null};return t})(qr.PureComponent),qo=n(1806),Ro=n(1828),Uo=n(674),zo=n(445),Wo=n(770);function Xo(e,t){var n=t.signals;if(n){var i=Object(zo.t)(n,function(e){return e.key===Wo.n});if(i&&i.index>-1){var s=i.index;return{signals:Object(r.__spreadArray)(Object(r.__spreadArray)([],n.slice(0,s),!0),n.slice(s+1),!0)}}}return{}}var Vo=Object(ot.t)()(function(){return function(e){return Jo}});var $o=function(e){var t=e.defaultRender,n=Object(r.__assign)({},Uo.e.pack(Xo));return t?qr.createElement(Ro.e,{controlHandlers:n},qr.createElement(t,Object(r.__assign)({},e))):null};function Jo(){return{groupHeaderRenderer:Io,rowRenderer:$o,groupProps:{collapseAllVisibility:qo.e.hidden}}}var Ko=n(893),Qo=Object(ot.t)()(function(){return function(e){return Zo}});function Go(e,t){var n=t.itemKey,r=e.demandItemFacet(C.a,n,{suppressGetItems:!0}),i=r&&new Date(r).getTime();if("number"==typeof i&&!isNaN(i)){var s=e.demandItemFacet(Qi.T,Gi.e),o=s&&s.language||window.navigator.language,u=Object(ds.n)(new Date(i),o);return{itemActivity:u&&qr.createElement(ps.e,{text:u})||null}}return{}}var Yo=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.defaultRender,n=Object(r.__rest)(e,["defaultRender"]),i=Object(r.__assign)(Object(r.__assign)({},Uo.e.pack(Xo)),Ko.e.pack(Go));return t?qr.createElement(Ro.e,{controlHandlers:i},qr.createElement(t,Object(r.__assign)({},n))):null};return t})(qr.PureComponent);function Zo(){return{tileRenderer:Yo}}var eu=n(540),tu=n(4525),nu=Object(ot.t)()(function(){return function(e){return function(e,t){return{emptyFolderIconUrl:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20211207.001/onedrive-assets/images/empty_state_sfl.svg",emptyFolderTitle:tu.e}}}});var ru,iu=Object(i.t)(function(){return function(e){e(Ht);e(Object(ut.e)(Lt.e,Fo.e)(Vo));e(Object(ut.e)(Lt.e,_o.e)(Qo));e(Object(ut.e)(Lt.e,as.e)(Ho));e(Object(ut.e)(Lt.e,eu.e)(nu));e(Object(ut.e)(At.e,Es.e)(io))}}),su=n(480),ou=n(966),uu={action:qr.createElement(ou.e,null),automationId:"addShortcutFromSharedWithMeCommand",title:ao.t,iconProps:{iconName:"FabricFolderLink"},key:new M.e("AddShortcutFromSharedWithMe").id,name:ao.e},au=n(62),fu=n(690),lu={action:qr.createElement(au.t,null,qr.createElement(fu.t,null)),automationId:"removeShortcutFromSharedWithMeCommand",title:ao.a,iconProps:{iconName:"FabricFolderLink"},key:new M.e("RemoveShortcutFromSWM").id,name:ao.u},cu=n(164),hu=n(176),pu=n(1749),du=n(730),vu=n(1113),mu=n(141),gu=n(20),yu=n(1511),bu=Object(Rr.t)(function(e,t){var n=t.itemKeys,i=t.removeFromSharedListWizard,s=t.removeItemsFromSharedList,o=void 0===s?vu.t:s,u=Object(ft.e)(e)||"",a=e.demandItemFacet(f.e,u);if(0===n.length)return null;for(var l=a&&n.length<=200,c=i,h=0,p=n;h<p.length;h++){var d=p[h],v=e.demandItemFacet(yu.e,d),m=!de.t.isActivated("6c28a705-1f14-4f06-97c7-ee39b2d66e9e","11/5/2020","Action should be available unless otherwise stated in control handler");yu.e.evaluate(v)(e,{itemKey:d,isAvailable:m}).isAvailable||(l=!1)}var g=e.dispatch,y=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e,t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:e={itemSetKey:u};t=Object(mu.e)(n,function(){return e});return[4,g(o({items:t}))];case 1:r.sent();return[2]}})})},b=Object(gu.o)(function(e){return qr.createElement(c,Object(r.__assign)({},e,{onItemRemoved:y,itemKeys:n}))});return qr.createElement(Os.e,Object(r.__assign)({isAvailable:l,onExecute:b},Object(Ms.t)(e,{itemKey:void 0,engagement:{name:"RemoveFromSharedList",isIntentional:!0,extraData:{itemCount:n.length}}})))}),wu=Object(Ls.s)()(bu),Eu=n(4526),Su=n(4112),xu=n(473),Tu=n(97),Nu=((ru={})[Vi.r.started]=function(e){return Object(Ke.formatToArray)(Object(Ke.getLocalizedCountValue)(Su.s,Su.t,e)||"",e)},ru[Vi.r.completed]=function(e){return Object(Ke.formatToArray)(Object(Ke.getLocalizedCountValue)(Su.e,Su.t,e)||"",e)},ru[Vi.r.failed]=function(e){return Object(Ke.formatToArray)(Object(Ke.getLocalizedCountValue)(Su.n,Su.r,e)||"",e)},ru[Vi.r.canceled]=function(e){return Object(Ke.formatToArray)(Object(Ke.getLocalizedCountValue)(Su.n,Su.r,e)||"",e)},ru),Cu=Object(i.t)(function(){return function(e){e(Object(ut.e)(vu.e,xu.e)(Object(ot.t)()(ku)))}});function ku(){return function(e){return Lu}}function Lu(e,t){var n,i=Object(Tu.r)(e,t),s=i.phase,o=i.count;n=Nu[s](o);return Object(r.__assign)({},n&&"item"!==t.format?{title:n}:{})}var Au=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,n=t.resolve,i=t.reject,s=t.onItemRemoved,o=t.itemKeys,u=function(){return Object(r.__awaiter)(e,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:n();return[4,s()];case 1:e.sent();return[2]}})})},a=function(){return Object(r.__awaiter)(e,void 0,void 0,function(){return Object(r.__generator)(this,function(e){i(new cu.e);return[2]})})};return qr.createElement(hu.e,null,function(e){var t=e.itemCache,n=Ou(t,o),r=n.title,i=n.prompt;return qr.createElement(pu.ConfirmationDialog,{onCancel:a,onConfirm:u,yesText:Su.i,noText:Eu.o,defaultToYes:!0,title:r,prompt:i})})};return t})(qr.PureComponent),Ou=function(e,t){if(t.length>1)return{title:Eu.s,prompt:Eu.i};if(1===t.length){var n=e.demandItemFacet(C.m,t[0]);return{title:n?Eu.r:Eu.t,prompt:n?Eu.n:Eu.e}}return{title:"",prompt:""}},Mu=Object(du.e)({operationTypeFacet:vu.n,progressKeyFacet:vu.e,initializeBatch:function(){return Cu}});var _u=Object(Rr.e)(function(){return{removeFromSharedListWizard:Au,removeItemsFromSharedList:Mu}})(wu),Du={key:new M.e("removeFromSharedList").id,automationId:"removeFromSharedListCommand",name:ao.f,action:qr.createElement(au.t,null,qr.createElement(_u,null)),iconProps:{iconName:"Cancel"}},Pu=!de.t.isActivated("A62AD86A-B7EB-4EF6-A7F2-CC139D544AE7","",""),Hu={name:"-",key:"divider_1",itemType:po.e.Divider},Bu=Object(ot.t)()(function(){return function(e){return function(e,t){return{commands:Object(r.__spreadArray)(Object(r.__spreadArray)(Object(r.__spreadArray)(Object(r.__spreadArray)([vo?Ss.e:ro,xs.n,xs.t],Pu?[Hu]:[],!0),[uu],!1),Pu?[su.e]:[],!0),[lu,Du],!1)}}}});var ju=!de.t.isActivated("A62AD86A-B7EB-4EF6-A7F2-CC139D544AE7","",""),Fu=Object(ot.t)()(function(){return function(e){return function(e,t){return{commands:Object(r.__spreadArray)(Object(r.__spreadArray)([vo?Ss.e:no,xs.n,xs.t,uu],ju?[su.e]:[],!0),[lu,Du],!1)}}}});var Iu,qu=n(277),Ru=((Iu={})[Fe.r]=!0,Iu[Fe.n]=!0,Iu[Fe.u]=!0,Iu[he.a]=!0,Iu[he.e]=!0,Iu[he.o]=!0,Iu),Uu=Object(ot.t)()(function(){return function(e){return function(e,t){return{isAvailable:!0,sortHandler:function(e,t){var n=t.itemSetKey,i=t.handler,s=i.columnKey,o=i.isAscending;if(!Ru[s])return{};var u=e.demandItemFacet(f.e,n);if(!u)return{};var a=he.r[s];if(!a)return{};var l=u.driveItemKey.endpoint,h=u.sortBy;return Object(c.r)(e,l)&&!h&&s===Fe.n&&o?{newItemSetKey:n}:{newItemSetKey:f.e.serialize(Object(r.__assign)(Object(r.__assign)({},u),{sortBy:a,isAscending:o}))}}}}}});var zu,Wu=n(561),Xu=Object(ot.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,i=e.demandItemFacet(f.e,n),s=i&&i.driveItemKey.endpoint,o=s&&i&&Un(0,{itemSetKey:f.e.serialize(i),parentItemKey:Ne.e.serialize({endpoint:s}),stageItem:t.stageItem});return Object(r.__assign)({},o?{stageItem:o}:{})}}});var Vu=((zu={})[he.a]=!0,zu[he.e]=!0,zu),$u=Object(ot.t)()(function(){return function(e){return Ju}});function Ju(e,t){var n=t.itemSetKey,i=t.handler.columnKey;if(!Vu[i])return{};var s=e.demandItemFacet(f.e,n);if(!s)return{};var o=he.r[i];return o?{newItemSetKey:f.e.serialize(Object(r.__assign)(Object(r.__assign)({},s),{groupBy:o}))}:{}}var Ku=Object(ot.t)()(function(){return function(e){return Qu}});function Qu(e,t){var n=t.itemSetKey,i=e.demandItemFacet(f.e,n);return i?{newItemSetKey:f.e.serialize(Object(r.__assign)(Object(r.__assign)({},i),{groupBy:void 0}))}:{}}var Gu=n(531),Yu=n(1384),Zu=de.t.isActivated("d4cb8ed6-56a5-4c23-8c49-2f352054edd9","12/15/2021","Use cultureName instead of cultureUIName to display the date"),ea=Object(cs.i)({name:Yu.t,key:he.e,fieldName:"",minWidth:cs.e.regularMin,maxWidth:cs.e.regularMax,isCollapsable:!0,sortProps:cs.t},ps.e)(function(e,t){var n=e.demandItemFacet(K.e,t),r=n&&new Date(n.sharedDateTime).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(Qi.T,Gi.e),s=!Zu&&(null==i?void 0:i.cultureLCID)||(null==i?void 0:i.language)||window.navigator.language;return s?{text:Object(ds.n)(new Date(r),s)}:{dateValue:r}}),ta=n(789),na=new v.e("topCollaboratorSetKeyFacet",{endpoint:Object(v.s)()}),ra=n(1090),ia=n(1766),sa=n(4527);Object(zr.n)([{rawString:".topCollaPlaceHolder_7990aeb5{display:-webkit-box;display:-ms-flexbox;display:flex;min-width:13px;height:21px}[dir='ltr'] .topCollaPlaceHolder_7990aeb5{padding-right:10px}[dir='rtl'] .topCollaPlaceHolder_7990aeb5{padding-left:10px}.topCollaboratorIcon_7990aeb5{color:#0078d4;font-size:13px;line-height:21px;text-align:center}.topCollaboratorUserName_7990aeb5{font-weight:700}.topCollaboratorTooltip_7990aeb5{padding:0 2px}.userWithTopCollaborator_7990aeb5{display:-webkit-box;display:-ms-flexbox;display:flex}.userWithTopCollaborator_7990aeb5 .topCollaPlaceHolder_7990aeb5{min-width:13px}[dir='ltr'] .userWithTopCollaborator_7990aeb5 .topCollaPlaceHolder_7990aeb5{padding-right:7px}[dir='rtl'] .userWithTopCollaborator_7990aeb5 .topCollaPlaceHolder_7990aeb5{padding-left:7px}[dir='ltr'] .columnHeader_7990aeb5{margin-left:20px}[dir='rtl'] .columnHeader_7990aeb5{margin-right:20px}\n"}]);var oa=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.userName,n=e.isPlaceholder,r=qr.createElement(Ns.e,{className:"topCollaboratorIcon_7990aeb5",iconName:"TeamFavorite"}),i=qr.createElement("span",{className:"topCollaboratorUserName_7990aeb5"},t),s=qr.createElement("div",{className:"topCollaboratorTooltip_7990aeb5"},Ke.formatToArray(sa.e,i));return qr.createElement("div",{className:"topCollaPlaceHolder_7990aeb5"},n?null:t?qr.createElement(ia.e,{content:s},r):r)};return t})(ra.e),ua=Object(cs.i)({name:Yu.n,key:he.a,fieldName:"",minWidth:cs.e.regularMin,maxWidth:cs.e.regularMax,isCollapsable:!0,sortProps:cs.r,headerClassName:"columnHeader_7990aeb5"},ta.e)(function(e,t){var n,r=e.demandItem({shareByPerson:_},t).shareByPerson,i=e.demandItem({sharedBy:K.e},t).sharedBy,s=null==r?void 0:r.itemKey,o=i&&(null!==(n=i.sharedBy)&&void 0!==n?n:i.owner),u=(null==r?void 0:r.displayValue)||o&&o.user&&o.user.displayName,a=!1;if(s&&D.e.matches(s)){var f=D.e.deserialize(s).email,l=e.demandItemFacet(d.e,na.serialize({endpoint:"https://graph.microsoft.com/beta"}));l&&(a=l.itemKeys.slice(0,3).some(function(t){var n=e.demandItemFacet(O.e,t);return!!n&&n===f}))}return s||u?{people:[{itemKey:s||"",displayValue:u}],onRenderUser:function(e,t){if(!e||!t)return null;var n=t(e),r=e.user;return qr.createElement("div",{className:"userWithTopCollaborator_7990aeb5"},qr.createElement(oa,{userName:r.title,isPlaceholder:!a}),n)}}:{people:[]}},function(e,t){return"".concat(e.demandItemFacet(O.e,t))}),aa=Object(ot.t)()(function(){return function(e){return function(e,t){var n=t.itemSetKey,i=!1,s=e.demandItemFacet(f.e,n);if(s){var o=s.driveItemKey.endpoint;i=Object(c.r)(e,o)}return{columns:Object(r.__spreadArray)(Object(r.__spreadArray)([],i?[ls.e,Gu.t]:[ls.t,gs.e,ea],!0),[ua],!1)}}}});var fa=new v.e("topCollaboratorItemKeyFacet",{id:Object(v.s)()}),la=Object(i.i)()(function e(t){var n=this,i=t.itemKey;return function(s){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,o,u,a,f,l,p,v,m,y,b,E,S,x,T,N;return Object(r.__generator)(this,function(k){switch(k.label){case 0:n=new g.e({publisher:e});o=s(Object(h.e)({graphEndpoint:w.m})).graphEndpoint;u=na.deserialize(i);a=o||u.endpoint;f="".concat(a,"/me/people/");return[4,s(Object(c.t)({url:f,qosName:"getTopCollaborator",endpoint:a}))];case 1:l=k.sent();p=[];for(v=0,m=l.value;v<m.length;v++){y=m[v];b=y.id,E=y.displayName,S=y.userPrincipalName;x=fa.serialize({id:b});s(Object(it.e)({items:(T={},T[x]=Object(r.__assign)(Object(r.__assign)({},C.h.pack(E)),O.e.pack(S)),T)}));p.push(x)}n.resolveItems({items:(N={},N[t.itemKey]=Object(r.__assign)({},d.e.pack({itemKeys:p})),N)});s(n.execute());return[2]}})})}});var ca=Object(ot.t)()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}});var ha=Object(ot.t)()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}});var pa=Object(i.t)(function(){return function(e){e(gt);e(Object(ut.e)(Ne.e,Es.e)(Fu));e(Object(ut.e)(Ne.e,wo.e)(Bu));e(Object(ut.e)(f.e,qu.t)(Uu));e(Object(ut.e)(f.e,zn.e)(Xu));e(Object(ut.e)(f.e,Wu.e)($u));e(Object(ut.e)(f.e,Wu.t)(Ku));e(Object(ut.e)(f.e,as.e)(aa));e(Object(ut.e)(We,zn.e)(ca));e(Object(ut.e)(Ve,zn.e)(ha));e(Object(u.r)(na,st.e)(la))}}),da=n(1504),va=n(533),ma=n(1107),ga=Object(ot.t)()(function(){return function(){return function(e,t){var n=t.setItemKey,r=e.demandItemFacet(z.e,n);if(!n||!r)return{};var i=r.driveItemKey.endpoint,s=N.e.serialize(r.driveItemKey),o=e.demandItemFacet(Y.e,s),u=e.demandItemFacet(w.s,Gi.e)||B.t,a=e.demandItemFacet(w.M,Gi.e);if(a&&a(i,o)){return{totalItemCount:e.demandItemFacet(q.e,s),getPageKey:function(e,t){return Wn.serialize({setItemKey:n,endpoint:r.driveItemKey.endpoint,skip:e,top:t-e})},pageSize:u}}return{}}}});var ya=n(1127),ba=n(1341),wa=Object(cs.i)({key:Fe.t,name:hs.n,fieldName:"",minWidth:cs.e.regularMin,maxWidth:cs.e.regularMax,isCollapsable:!0,sortProps:cs.t,data:{facets:Object(r.__assign)({},vs.e.pack("dateTaken"))}},ba.t)(function(e,t){return function(){return{itemKey:t}}},function(e,t){return"".concat(e.demandItemFacet(G.u,t,{suppressGetItems:!0}))}),Ea=n(1055),Sa=n(1163),xa=n(1095),Ta=n(264),Na=!de.t.isActivated("637A4DC9-1258-4BD2-8166-5F852E5FEBBE","11/09/2021","The switch to add modifiedBy column in default column set."),Ca=Object(ot.t)()(function(){return function(e){return Oa}});var ka=[ls.e,Gu.e,ya.e,Ea.e,Sa.e],La=[ls.e,Gu.e,ya.e,xa.e,Ea.e,Sa.e],Aa=[ls.e,Gu.e,ya.e,wa,Ea.e,Sa.e];function Oa(e,t){var n,r=t.itemSetKey;if(r){var i=Object(Ta.e)(e,{itemKey:r}),s=e.demandItemFacet(X.e,i);if("photo"===(null===(n=null==s?void 0:s.folder)||void 0===n?void 0:n.folderType))return{columns:Aa}}if(Na){if(e.demandItemFacet(w.r,Gi.e))return{columns:ka}}return{columns:La}}var Ma=n(29),_a=Object(ot.t)()(function(){return function(e){return Da}});function Da(e,t){return n=z.e,{isAvailable:!0,sortHandler:function(e,t){var i=t.itemSetKey,s=t.handler,o=s.columnKey,u=s.isAscending,a=e.demandItemFacet(n,i);if(!a)return{};var f=N.e.serialize(Object(r.__assign)({},a.driveItemKey)),l=e.demandItemFacet(Y.e,f);if(!l||"business"===l||"documentLibrary"===l)return{};if(!a.sortBy)if(Cn.e){var c=e.demandItemFacet(d.u,f);if(o===(null==c?void 0:c.columnKey)&&(null==c?void 0:c.isAscending)===u)return{newItemSetKey:i}}else if(o===Gu.e.key&&!0===u)return{newItemSetKey:i};var h=Object(Ma.e)(e,{customColumnKeysToFieldNamesConfiguration:w.n}).customColumnKeysToFieldNamesConfiguration,p=Object(r.__assign)(Object(r.__assign)({},he.r),h),v=p?p[o]:void 0;return v?{newItemSetKey:n.serialize(Object(r.__assign)(Object(r.__assign)({},a),{sortBy:v,isAscending:u}))}:{}}};var n}var Pa=n(604),Ha=Object(ot.t)()(function(){return function(e){return function(e,t){var n=Object(Fr.e)(e),r=e.demandItemFacet(Wt.e,n),i=e.demandItemFacet(Ne.e,n),s=e.demandItemFacet(yt,n);return t.isMove?{isAvailable:!r&&!i&&!s}:{isAvailable:!r}}}});var Ba=n(1555),ja=Object(ot.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return e.demandItemFacet(V,n,{suppressGetItems:!0})?{renameDialogAs:Fa}:{}}}});function Fa(e){var t=e.defaultRender,n=Object(r.__rest)(e,["defaultRender"]);return t?qr.createElement(t,Object(r.__assign)({},n),function(e){return qr.createElement(Ba.e,Object(r.__assign)({},e))}):null}var Ia=n(590),qa=n(1501),Ra=n(543),Ua={key:new M.e("openInOfficeOnlineDefaultClickHandler").id,evaluate:function(e,t){var n=t.itemKey,r=e.demandItem({openUrl:C.O,appMap:te.e},n),i=r.openUrl,s=r.appMap;return{action:!!i&&!!s?qr.createElement(Ra.e,{itemKey:n,action:Object(gu.i)(e,qr.createElement(Fs,{itemKey:n}))}):void 0}}},za={key:new M.e("openInOfficeClientDefaultClickHandler").id,evaluate:function(e,t){var n=t.itemKey,r=e.demandItem({openUrl:C.O,appMap:te.e},n),i=r.openUrl,s=r.appMap;return{action:!!i&&!!s?qr.createElement(Ra.e,{itemKey:n,action:Object(gu.i)(e,qr.createElement(Vs,{itemKey:n}))}):void 0}}},Wa=Object(ot.t)()(function(){return function(e){return function(e,t){var n=t.handlers,i=void 0===n?[]:n;return{handlers:Object(r.__spreadArray)([qa.e,Ua,za],i,!0)}}}});var Xa=n(709),Va=n(1553),$a=n(699),Ja=n(183),Ka=n(855),Qa=function(e,t){return n=e,Object(r.__assign)(((i={version:2})[0]="",i[1]="",i[3]="",i[6]="",i[16]="",i),n);var n,i},Ga=function(e,t){var n=t.queryType,r=t.layoutType,i=r&&(function(e){return e===Ja.e?Ka.e:e===ko.e?Ka.n:Ka.t})(r),s=Qa(e);"number"==typeof n&&i&&(s[n]=i);return s},Ya=n(1943),Za=Object(jn.t)(function(e){e.itemsScopeItemKey;var t=e.localStorageKey,n=Object(r.__rest)(e,["itemsScopeItemKey","localStorageKey"]);return function(e){var i,s=e(Object(I.e)(function(e){return Object(Ya.e)(e,{name:t})}))||{},o=s&&Ga(s,Object(r.__assign)({},n));e(Object(Ya.n)({values:(i={},i[t]=o,i)}))}}),ef=new M.e("defaultLayoutTypeMapConfiguration"),tf=Object(ot.t)()(function(){return function(){return rf}}),nf=new v.e("itemsScopeList",{driveId:Object(v.s)(),itemsScopeItemKey:Object(v.s)()});function rf(e,t){var n=Object(Ma.e)(e,{isLayoutResolvedEnabled:Qi.x,isLocalStorageForLayoutEnabled:w.T,defaultLayoutTypeMapConfiguration:ef}),i=n.isLayoutResolvedEnabled,s=n.isLocalStorageForLayoutEnabled,o=n.defaultLayoutTypeMapConfiguration;if(!i||!s)return{};var u,a,f,l,c=t.itemsScopeItemKey,h=Object(ft.e)(e),p=e.demandItemFacet(z.e,h),d=void 0;if(h&&p&&c){var v=p.driveItemKey;if(v){var m=v.endpoint,g=v.driveId;if(!g||!m)return{};var y,b=nf.serialize({driveId:g,itemsScopeItemKey:c}),E=e.demandItemFacet(w.g,Gi.e),S=E&&E(e,{itemSetKey:h}),x=S&&S.queryType||0,T=void 0;y="ItemsStore".concat((u={endpoint:m,driveId:g,queryType:x},a=u.endpoint,f=u.driveId,l="Graph.Files.FilesQueryType.".concat(a),l=f?"".concat(l,".").concat(f):l).toLocaleLowerCase());var N=Object(Ya.e)(e,{name:y});d=Object(Ya.t)(e,{name:y});var C=N&&N[x]||"";T=!C&&d&&o&&o[x]?o[x]:d?(function(e){switch(e){case Ka.t:return Ja.t;case Ka.e:return Ja.e;default:return ko.e}})(C):void 0;var k=e.demandItemFacet(Qe.a,b);return{preferredLayoutType:e.demandItemFacet(Qe.u,b)||T,preferredLayoutVersion:k,setPreferredLayout:function(e){var t=e.layoutType;return function(n){var i,s;y&&g&&m&&n(Za({endpoint:m,driveId:g,itemsScopeItemKey:c,queryType:x,localStorageKey:y,layoutType:t}));n(Object(it.e)({items:(i={},i[b]=Object(r.__assign)({},Qe.u.pack(e.layoutType)),i)}));n(Object(it.e)({items:(s={},s[b]=Object(r.__assign)({},Qe.a.pack((k||0)+1)),s)}))}}}}}return{}}var sf=n(1147),of=n(248),uf=new M.e("itemRestrictedSignal").id,af=Object(ot.t)()(function(){return function(e){return function(e,t){var n=t.itemKey;if(e.demandItemFacet(pe.e,n)&&n){var i=Object(r.__spreadArray)([],t.signals||[],!0);i.push(ff);return{signals:i}}return{}}}});var ff={signal:qr.createElement(of.t,null),title:Q.e,key:uf},lf=n(596),cf=n(225),hf=n(349);Object(zr.n)([{rawString:".root_0b1cee7d{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;position:relative;vertical-align:bottom;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.vaultCoverIsSmall_0b1cee7d{width:72px;height:52px}.vaultCoverIsLarge_0b1cee7d{width:112px;height:80px}.cover_0b1cee7d{display:block;position:absolute;padding-bottom:12px;left:-3px;right:-3px;bottom:-4px}\n"}]);var pf,df="https://res-1.cdn.office.net/files/fabric-cdn-prod_20211207.001/",vf="".concat(df,"office-ui-fabric-react-assets/foldericons"),mf="".concat(df,"/assets/item-types/");(function(e){e.vaultOpen="vaultopen";e.vaultClosed="vaultclosed"})(pf||(pf={}));var gf={small:{vaultclosed:"vaultCoverSmallVaultClosed",vaultopen:"vaultCoverSmallVaultOpen"},large:{vaultclosed:"VaultCoverLargeVaultClosed",vaultopen:"VaultCoverLargeVaultOpen"}},yf=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e,t=this.props,n=t.vaultCoverSize,i=void 0===n?"large":n,s=t.vaultCoverType,o=void 0===s?"vaultclosed":s,u=(t.ref,t.children,t.isFluent),a=Object(r.__rest)(t,["vaultCoverSize","vaultCoverType","ref","children","isFluent"]),f=gf[i][o];"small"===i?e="vaultCoverIsSmall_0b1cee7d":"large"===i&&(e="vaultCoverIsLarge_0b1cee7d");return qr.createElement("div",Object(r.__assign)({},a,{className:"".concat("root_0b1cee7d"," ").concat(e," ").concat(u?"isFluent":"")}),qr.createElement(Ns.e,{"aria-hidden":!0,className:"ms-VaultCover ".concat("cover_0b1cee7d"),iconName:f}))};return t})(qr.Component);var bf=!de.t.isActivated("09B4F515-E6CC-4927-A43A-A12AD41B2334","","");(function(e,t){void 0===e&&(e=vf);Object(hf.n)({fontFace:{},style:{width:78,height:58,overflow:"hidden"},icons:{vaultCoverSmallVaultClosed:qr.createElement("img",{src:"".concat(e,"/vault-sm.svg")}),vaultCoverSmallVaultOpen:qr.createElement("img",{src:"".concat(e,"/vault-sm-open.svg")})}},t);Object(hf.n)({fontFace:{},style:{width:118,height:86,overflow:"hidden"},icons:{VaultCoverLargeVaultClosed:qr.createElement("img",{src:"".concat(e,"/vault-lg.svg")}),VaultCoverLargeVaultOpen:qr.createElement("img",{src:"".concat(e,"/vault-lg-open.svg")})}},t)})("https://res-1.cdn.office.net/files/fabric-cdn-prod_20211207.001/office-ui-fabric-react-assets/foldericons",{disableWarnings:!0});var wf=Object(ot.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,i=e.demandItemFacet(Z.e,n),s=bf&&(e.demandItemFacet($.e,n,{suppressGetItems:!0})||e.demandItemFacet(V,n,{suppressGetItems:!0}));return Object(r.__assign)(Object(r.__assign)({},i&&i.root?{tileAs:Sf}:{}),{folderCoverControlHandler:function(t,n){var i={};s&&(i={folderCoverAs:xf});var o=n.signalData;if(o&&o.signal)return i;var u=e.demandItem({specialFolder:ie.e},n.itemKey).specialFolder;if(!u)return i;var a=(function(e){var t=null;"desktop"===e?t=qr.createElement(of.n,null):"documents"===e?t=qr.createElement(of.r,null):"pictures"===e&&(t=qr.createElement(of.c,null));return{signal:t,key:e||""}})(u);return a&&a.signal?Object(r.__assign)(Object(r.__assign)({},i),{signalData:a}):i}})}}});var Ef=Object(Rr.t)(function(e,t){var n=t.itemKey,i=Object(r.__rest)(t,["itemKey"]),s=e.demandItemFacet(Z.e,n),o=s&&s.isLocked?pf.vaultClosed:pf.vaultOpen;return qr.createElement(yf,Object(r.__assign)({},i,{vaultCoverSize:i.folderCoverSize,vaultCoverType:o}))}),Sf=Object(Rr.t)(function(e,t){var n=t.defaultRender,i=t.foreground,s=Object(r.__rest)(t,["defaultRender","foreground"]),o=t.itemKey,u=i,a=e.demandItemFacet(Z.e,o);a&&a.root&&(u=Object(cf.r)(e,qr.createElement(Ef,Object(r.__assign)({},s,{folderCoverSize:s.tileSize,itemKey:o}))));return n?qr.createElement(n,Object(r.__assign)({},s,{foreground:u})):null});function xf(e){var t=e.defaultRender,n=Object(r.__rest)(e,["defaultRender"]);return t?qr.createElement(t,Object(r.__assign)({},n,{folderCoverType:"linked"})):null}var Tf=n(437),Nf=n(118),Cf=n(315);Object(zr.n)([{rawString:".fileHandlerFileTypeIcon_7f11123a{width:inherit;height:inherit}\n"}]);var kf=Object(ot.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItemFacet(Z.e,n);return r&&r.root?{iconAs:Lf}:{fileTypeIconAs:Af}}}});var Lf=Object(Rr.t)(function(e,t){var n,i,s,o,u,a,f,l=t.itemKey,c=Object(r.__rest)(t,["itemKey"]),h=e.demandItemFacet(Z.e,l);if(h&&h.root){var p=e.demandItemFacet(C.h,l),d=h.isLocked?pf.vaultClosed:pf.vaultOpen,v={iconType:Tf.e.Image,ariaLabel:p,imageProps:{src:(n=d,u=o&&"png"===s,a=i||"20",f=s||"png","".concat(mf).concat(a).concat(u?"_2x":"","/").concat(n,".").concat(f)),imageFit:Nf.t.contain,className:"fileHandlerFileTypeIcon_7f11123a"}};return qr.createElement(Ns.e,Object(r.__assign)({},c,v))}return null}),Af=Object(Rr.t)(function(e,t){var n=t.defaultRender,i=Object(r.__rest)(t,["defaultRender"]),s=i.isFolder,o=i.itemKey,u=i.type,a=u;if(s&&void 0===u){var f=e.demandItemFacet(ie.e,o);void 0!==f&&("desktop"===f?a=Cf.e.desktopFolder:"documents"===f?a=Cf.e.documentsFolder:"pictures"===f&&(a=Cf.e.picturesFolder))}return n?qr.createElement(n,Object(r.__assign)({},i,{type:a})):null}),Of=n(1398),Mf=n(1498),_f=Object(i.t)(function(){return function(e){e(bi);e(Object(ut.e)(z.e,as.e)(Ca));e(Object(ut.e)(z.e,sf.e)(Object(ot.n)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([10],5033)];case 1:return[2,e.sent().driveItemSortActionControlHandler]}})})})));e(Object(ut.e)(z.e,qu.t)(_a));e(Object(ut.e)(N.e,Uo.e)(af));e(Object(ut.e)(N.e,va.e)(da.e));e(Object(ut.e)(z.e,ma.e)(ga));Mf.e&&e(Object(ut.e)(N.e,Of.e)(ja));e(Object(ut.e)(N.e,Pa.e)(Ha));e(Object(ut.e)(N.e,lf.e)(kf));e(Object(ut.e)(N.e,Ko.e)(wf));e(Object(ut.e)(N.e,Ia.e)(Wa));e(Object(ut.e)(N.e,Xa.e)(Va.e));e(Object(ut.e)(z.e,$a.e)(tf))}}),Df=new v.e("specialDriveItem",{endpoint:Object(v.s)(),driveId:Object(v.s)({shouldNormalizeToEmpty:!0}),name:Object(v.s)()}),Pf=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=Df.deserialize(i),o=s.driveId,u=s.endpoint,a=Object(l.n)(s);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,f,h,p,v,m,y,b,w;return Object(r.__generator)(this,function(E){switch(E.label){case 0:return[4,t(Object(c.t)({url:Object(l.i)(s),driveUrl:a,qosName:"getItem",endpoint:u}))];case 1:n=E.sent();f=new g.e({publisher:e});h=n&&n.parentReference;p=h&&h.driveId;v={endpoint:u,driveId:p||o,itemId:n.id};m=N.e.serialize(v);y=h&&h.id?N.e.serialize({endpoint:u,driveId:p,itemId:h.id}):void 0;f.merge(t(Object(T.e)({itemKey:m,driveItem:n,endpoint:u,parentFolderItemKey:y})).itemResolver);f.resolveItems({items:(b={},b[m]=Object(r.__assign)(Object(r.__assign)({},ts.n.pack(N.e)),d.t.pack({itemKey:z.e.serialize({driveItemKey:v,sortBy:"",isAscending:!0})})),b)});f.mapKeys({mappings:(w={},w[m]=i,w)});t(f.execute());return[2]}})})}});var Hf=Object(ot.t)()(function(){return function(e){return function(e,t){var n=t.itemsScopeItemKey,i=t.engagement,s=t.itemKey,o=i&&i.name,u=e.demandItemFacet(Df,s);return{engagement:Object(r.__assign)(Object(r.__assign)({},(null==i?void 0:i.datasource)?{}:{datasource:"Graph"}),{objectType:"Folder",extraData:Object(r.__assign)({itemGraphId:null==u?void 0:u.driveId,specialGraphName:null==u?void 0:u.name},"ItemsView.Load"===o?lt(e,{itemsScopeItemKey:n}):{})})}}}});var Bf=Object(i.t)(function(){return function(e){e(Object(ut.e)(Df,at.e)(Hf))}}),jf=Object(i.t)(function(){return function(e){e(Object(u.r)(Df,st.e)(Pf));e(Bf)}}),Ff=Object(i.t)(function(){return function(e){e(jf);e(Object(ut.e)(Df,lf.e)(kf));e(Object(ut.e)(Df,Ko.e)(wf))}}),If=n(890),qf=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=ni.deserialize(i),o=s.endpoint,u=s.driveId;return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,a,f,c;return Object(r.__generator)(this,function(h){switch(h.label){case 0:n=Object(l.n)({endpoint:o,driveId:u});return[4,t(Object(If.getSessionToken)({endpoint:o,driveUrl:n}))];case 1:s=h.sent();a=s&&s.accessToken;(f=new g.e({publisher:e})).resolveItems({items:(c={},c[i]=Object(r.__assign)({},ri.e.pack(a)),c)});t(f.execute());return[2]}})})}});var Rf=Object(i.t)(function(){return function(e){e(Object(u.r)(ni,st.e)(qf))}}),Uf=n(931),zf=Object(ot.t)()(function(){return function(e){return function(e,t){for(var n=0,r=t.sourceItemKeys;n<r.length;n++){var i=r[n],s=e.demandItemFacet(N.e,i);if(!s)return{};var o=s.itemId;if((void 0===o?B.r:o)===B.r)return{};if(t.isMove){if(!e.demandItemFacet(Mr,i))return{}}if(e.demandItemFacet(V,i))return{}}var u=Object(Fr.e)(e),a=e.demandItemFacet(Wt.e,u),f=e.demandItemFacet(Ne.e,u),l=e.demandItemFacet(yt,u);return t.isMove?{isAvailable:!a&&!f&&!l}:{isAvailable:!a}}}});var Wf=Object(i.t)(function(){return function(e){e(Object(ut.e)(N.e,Uf.e)(zf))}}),Xf=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(is);e(_f);e(Rf);e(us);e(Mo);e(iu);e(pa);e(Ff);e(Wf);return[2]})})}})}}]);