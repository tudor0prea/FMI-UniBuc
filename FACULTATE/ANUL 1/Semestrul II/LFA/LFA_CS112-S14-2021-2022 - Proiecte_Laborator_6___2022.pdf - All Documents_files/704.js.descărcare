(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[704,543],{2022:function(e,t,n){"use strict";n.d(t,"r",function(){return u});n.d(t,"n",function(){return a});n.d(t,"e",function(){return f});n.d(t,"t",function(){return l});n.d(t,"i",function(){return c});n.d(t,"c",function(){return h});n.d(t,"h",function(){return p});n.d(t,"p",function(){return d});n.d(t,"o",function(){return v});n.d(t,"u",function(){return m});n.d(t,"s",function(){return g});n.d(t,"a",function(){return y});n.d(t,"f",function(){return b});n.d(t,"l",function(){return w});var r=n(2163),i=n(18),s=n(2164),o=n(31),u="_ComplianceTag",a="D4B6480A-4BED-4094-9A52-30181EA38F1D",f="ComplianceAssetId",l="_ComplianceFlags",c=200;function h(e){return!!(e&&e.schema&&(t=e.schema.FieldType,n=e.schema.Id,t&&"lookup"===t.toLowerCase()&&n&&n.toLowerCase()===a.toLowerCase()));var t,n}function p(e){return!!(e&&e.schema&&(t=e.schema.FieldType,n=e.schema.Id,t&&"boolean"===t.toLowerCase()&&n&&n.toLowerCase()==="96BE7325-AFA4-48CF-8503-9258F0A7817D".toLowerCase()));var t,n}function d(e){return!!(256&e)}function v(e){return g(e)?r.t:r.e}function m(e){if(e.properties.hasOwnProperty("_ComplianceFlags")){if(4&+e.properties._ComplianceFlags)return!0}return!1}function g(e){if(e.properties.hasOwnProperty("_ComplianceFlags")){var t=+e.properties._ComplianceFlags;if(Object(o.isFeatureEnabled)(o.IPRecordVersioningClient)){if(4&t||256&t)return!0}else if(4&t&&1&t)return!0}return!1}function y(){return s.RecordLabelHoverText}function b(e){if(!e.HasRetentionAction)return" ";if(0===e.TagDuration)return e.BlockDelete?s.RetainForeverText:" ";var t=E(e.TagDuration);return e.BlockDelete?i.format(s.PreserveTagText,t):e.AutoDelete?i.format(s.DeleteTagText,t):" "}function w(e){if(e.Notes)return e.Notes;if(!e.HasRetentionAction)return s.NoRetentionTooltip;if(0===e.TagDuration)return e.BlockDelete?s.PreserveForeverTooltip:s.NoRetentionTooltip;var t=E(e.TagDuration),n="",r="";if(e.BlockDelete){n="PreserveTag"+e.TagRetentionBasedOn+"Tooltip";e.BlockEdit&&(r=s.PreserveIsRecordTooltipModifier);e.ReviewerEmail?r+=s.ReviewTooltip:r+=e.AutoDelete?s.PreserveAutoDeleteTooltipModifier:s.PreserveNoDeleteTooltipModifier}else e.AutoDelete&&(n="DeleteTag"+e.TagRetentionBasedOn+"Tooltip");var o=s[n];return o?i.format(o,t)+r:null}function E(e){var t="";if(e>0){var n=Math.floor(e/365);if(n>0){var r=n>1?s.RetentionPeriodYears:s.RetentionPeriodYear;t=i.format(r,n)}else{var o=Math.floor(e/30);if(o>0){var u=o>1?s.RetentionPeriodMonths:s.RetentionPeriodMonth;t=i.format(u,o)}else{var a=e>1?s.RetentionPeriodDays:s.RetentionPeriodDay;t=i.format(a,e)}}}return t}},2053:function(e,t,n){"use strict";var r=n(2152),i=n(1970),s=n(1971),o=n(40),u=n(228),a=n(27),f=n(59),l=n(1072),c=n(2032),h=n(15),p=new RegExp("^".concat("Templates","$"),"i"),d=(function(){function e(){}e.isFolder=function(e,t){var n=!!e;n&&!(n=e.type===u.e.Folder)&&t&&e.type===u.e.OneNote&&(n=!!h.e.isActivated("94B1529C-14BB-4854-B5FC-748FCEFF2681","3/29/2022","Check for OneNote note")||(!e.contentTypeId||0!==e.contentTypeId.lastIndexOf("0x0101",0)));return n};e.isCheckedOut=function(e){return l.e(e)};e.isCheckedOutByUser=function(e,t){return l.n(e,t)};e.isCheckedOutByOther=function(t,n){return e.isCheckedOut(t)&&!e.isCheckedOutByUser(t,n)};e.showCheckedOutByOtherDialog=function(e){return e.requestDialog({title:r.i,component:{name:c.e.tagName,params:{text:r.r}},actions:[{name:i.cancelActionText,execute:function(){return f.n.wrap(2)},icon:new s.e("Cancel"),isDefault:!0}]}).wait().then(function(){return{resultType:o.e.Success}})};e.isPublished=function(t,n){return n.isModerated?t.properties[e.PublishProperty]&&"3"!==t.properties[e.PublishProperty]&&"1"!==t.properties[e.PublishProperty]:0===e.getVersionNoModeration(t,n).minor&&0!==e.getVersionNoModeration(t,n).major};e.needsPublishingReminder=function(t,n){return!e.isPublished(t,n)&&(!e.isPendingApproval(t,n)&&!e.isPageTemplate(t)&&((!t.properties||!t.properties._ScheduledVersion||t.properties.owshiddenversion!==t.properties._ScheduledVersion)&&(a.e.hasItemPermission(t,a.e.editListItems)&&n.enableMinorVersions&&!e.isFolder(t,!0))))};e.isPublishingRelevant=function(t,n){return a.e.hasItemPermission(t,a.e.editListItems)&&n.enableMinorVersions&&!e.isCheckedOut(t)&&!e.isFolder(t,!0)};e.getVersionNoModeration=function(e,t){return t.isModerated?{major:0,minor:0}:this.getVersion(e,t)};e.getVersion=function(t,n){if(t&&t.properties&&t.properties[e.VersionProperty]){var r=Number(t.properties[e.VersionProperty])%512;return{major:Math.floor(Number(t.properties[e.VersionProperty])/512),minor:r}}return{major:0,minor:0}};e.isPendingApproval=function(t,n){return!!n.isModerated&&(t&&t.properties&&t.properties[e.PublishProperty]&&"2"===t.properties[e.PublishProperty])};e.isPageTemplate=function(e){if(!e)return!1;var t=!1,n=!1;if(e.id){var r=e.id.split("/"),i=r.length;t=p.test(r[i-2])}if(!h.e.isActivated("6b8724d8-4409-4f96-b05b-706040d5a012","1/5/2021","make publish command unavailable on site page templates")&&e.properties){var s=e.properties._SPSitePageFlags;n=!!s&&s.filter(function(e){return"template"===e.toLowerCase()}).length>0}return t||n};e.isApprovalRelevant=function(t,n){return n&&n.isModerated&&!e.isCheckedOut(t)&&a.e.hasItemPermission(t,a.e.editListItems)&&a.e.hasItemPermission(t,a.e.approveItems)};e.FileTypeProperty="FSObjType";e.PublishProperty="_ModerationStatus.";e.VersionProperty="_UIVersion";return e})();t.e=d},2318:function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return J});var r=n(0),i=n(59),s=n(101),o=n(23),u=n(2010),a=n(228),f=n(2028),l=n(2554),c=n(1065),h=n("knockout-lib"),p=n(2278),d=n(50),v=n(64),m=n(2411),g=n(18),y=n(874),b=n(233),w=n(94),E=n(72),S=n(35),x=n(570),T=n(2326),N=n(187),C=n(864),k=n(31),L=n(2022),A=n(1168),O=n(2091),M=n(1684),_=n(745),D=n(2828),P=n(123),H=n(15),B=H.e.isActivated("6994349e-d867-48fc-a57f-5346b837c91a","11/10/2021","check the EnableAttachments from RLDAS call as a string value"),j="0x0120",F=1,I=2,q=4,R=8,U=32,z=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,n.pageContext,n)||this;r._clientForms=null;r._listContext=n.listContext;r._itemsDataSource=n.items;r._navigation=n.navigation;r._complianceTagDataSource=n.compliance;r._itemUrlHelper=n.itemUrlHelper;r._apiUrlHelper=n.apiUrlHelper;return r}t.prototype.createItem=function(e,t){var n=this,r=this._getUrlInfo(),i=r.listUrl,s=r.itemUrlParts,o="AddValidateUpdateItemUsingPath",u=t?"".concat(t,".CreateItem"):"CreateItem";return this._createOrUpdateItem(u,function(){return n._apiUrlHelper.build().webByItemUrl(s).method("GetList",i).method(o).toString()},function(t){var n=e.rootFolder||i;return JSON.stringify({listItemCreateInfo:{__metadata:{type:"SP.ListItemCreationInformationUsingPath"},FolderPath:{__metadata:{type:"SP.ResourcePath"},DecodedUrl:n}},formValues:t,bNewDocumentUpdate:e.newDocumentUpdate,checkInComment:e.checkInComment})},e,o).then(function(){return n._updateAttachmentsField(e)})};t.prototype.updateItem=function(e,t){var n=this,r=e.clientForm.isBulkEdit&&e.selection&&e.selection.length>1?e.selection:void 0;r&&r.filter(function(e){return!!e});var i=r&&r.length>0,s=t?"".concat(t,".UpdateItem"):"UpdateItem";return this._createOrUpdateItem(s,function(e){var t=n._getUrlInfo(),r=t.listUrl,s=t.itemUrlParts;return i?n._apiUrlHelper.build().webByItemUrl(s).method("GetList",r).method("BulkValidateUpdateListItems").toString():n._apiUrlHelper.build().webByItemUrl(s).method("GetList",r).method("items",e.peek().properties.ID).method("ValidateUpdateListItem").toString()},function(t){var s,o;if(i){s=[];for(var u=0,a=r;u<a.length;u++){var f=a[u];s.push(parseInt(f.peek().properties.ID,10))}if(!e.isRecursiveView){var l=(f=e.clientForm.item.peek())&&f.UNSAFE_parent;o=l&&n._itemUrlHelper.getItemUrlParts(l.key).normalizedItemUrl}}return JSON.stringify({itemIds:s,formValues:t,bNewDocumentUpdate:e.newDocumentUpdate,checkInComment:e.checkInComment,folderPath:o})},e,i?"BulkValidateUpdateListItems":"ValidateUpdateListItem",r).then(function(t){return n._updateAttachmentsField(e).then(function(){return t})})};t.prototype.getClientFormSchema=function(e,t,n){var s=this,o=function(){var i=s._locateClientFormWithContentTypeInfos(e,t);if(n&&i&&i.fields){var o=i.fields.filter(function(e){var t=e.FieldType.toLowerCase(),n=e.Name;return"file"!==t&&"attachments"!==t&&"Title"!==n&&"LinkTitle"!==n&&"LinkTitleNoMenu"!==n});return Object(r.__assign)(Object(r.__assign)({},i),{fields:o})}return i};if(null===this._clientForms||this._listContext.refreshClientForm){this._listContext.refreshClientForm=void 0;return this.fetchAllClientFormSchemas().then(function(){return o()})}return i.n.wrap(o())};t.prototype.updateFormValues=function(e,t){var n=this,r=e.item.peek();if(!r||!r.properties||!r.properties.ID)return i.n.wrap();for(var s=[],o=0,u=e.fields;o<u.length;o++){var a=u[o];0===a.state.peek()&&s.push(a)}return this._getData({url:(function(){var e=r.properties.ID,t=v.e.encodeRestUriStringToken(n._listContext.listUrl),i=F+I+q;i+=R;Object(k.isFeatureEnabled)(k.ClientFormImageField)&&(i+=U);var s=new d.t(window.location.href,{queryCaseInsensitive:!0}).getQueryParameter("VersionNo")||"0",o=",cutoffVersion=".concat(s);return"".concat(n._pageContext.webAbsoluteUrl,"/_api/web/GetList(@v1)")+"/RenderExtendedListFormData(itemId=".concat(e,",formId='editform',mode='2',options=").concat(i).concat(o,")")+"?@v1='".concat(t,"'")})(),parseResponse:function(e){if(null!=e){var t=JSON.parse(e);if(t.d.RenderExtendedListFormData){try{t=JSON.parse(t.d.RenderExtendedListFormData)}catch(e){return i.n.reject(e)}return t}}return null},qosName:"GetItemDataForClientForm",method:"POST",additionalHeaders:this._getAdditionalHeaders()}).then(function(r){n._handleServerData(e,r,t,s);for(var i=0,o=s;i<o.length;i++){o[i].state(0)}},function(e){for(var t=e?e.code?e.code.split(","):e.error?e.error.code.split(","):[]:[],n=e||t.length>1?Number(t[0]):-1,r=0,o=s;r<o.length;r++){o[r].state(0)}return i.n.wrapError({errorCode:n,message:e&&e.message?e.message.value?e.message.value:e.message:""})})};t.prototype.getFieldValueSuggestions=function(e,t,n,r){n=n||5;r=_.e.encodeText(r);var s=this._getSuggestionsViewXml(e,t,!0,n,r),o=this._getSuggestionsViewXml(e,t,!1,n,r),u=this._getAdditionalHeaders(),a=function(t){var n=JSON.parse(t);return n&&n.Row&&n.Row.length>0?n.Row.map(function(t){var n=t[e];return"string"==typeof n||n instanceof String?t[e].trim():JSON.stringify(t[e])}):[]},f=this._getData({url:this._getServerConnectionUrl().toString(),parseResponse:a,qosName:"GetLatestFieldValueModifiedByMe",additionalPostData:b.e.getAdditionalPostData({needsSchema:!1,viewXml:s}),method:"POST",additionalHeaders:u}),l=this._getData({url:this._getServerConnectionUrl().toString(),parseResponse:a,qosName:"GetLatestFieldValueModifiedByOther",additionalPostData:b.e.getAdditionalPostData({needsSchema:!1,viewXml:o}),method:"POST",additionalHeaders:u});return i.n.all([f,l]).then(function(e){for(var t={},r=[],i=0,s=e;i<s.length;i++)for(var o=0,u=s[i];o<u.length;o++){var a=u[o];if(!t[a]){r.push(a);t[a]=!0;if(r.length===n)return r}}return r})};t.prototype.getFieldFilterData=function(e,t){var n=x.t(this._navigation.viewParams);return this._itemsDataSource.getFilterData(e,n,t)};t.prototype.getContentTypes=function(e){var t=[];if(this._clientForms&&this._clientForms[e])for(var n in this._clientForms[e])this._clientForms[e].hasOwnProperty(n)&&t.push({displayName:n,description:n,templateUrl:null});return t};t.prototype.hasFormRenderMode=function(e){var t=this;return this._ensureClientForms(function(){return t._checkRenderModes(e)})};t.prototype.getFormRenderMode=function(e,t){var n=this;return this._ensureClientForms(function(){return n._getFormRenderMode(e,t)})};t.prototype.getPowerAppFormId=function(){return this._powerAppFormId};t.prototype.getPowerAppRenderInfo=function(){return this._powerAppFormInfo};t.prototype.getPowerAppAdditionalData=function(){return this._powerAppAdditionalData};t.prototype.getPowerAppFormCacheInfo=function(){return this._powerAppFormCacheInfo};t.prototype.getPowerAppFormDesignUrl=function(e){var t=this;return this._getData({url:"".concat(t._pageContext.webAbsoluteUrl,"/_api/SP.Internal.FormsCustomization.GetPowerAppsFormDesignUrl?listName='")+e+"'&visualizationTarget=1",parseResponse:function(e){var t=JSON.parse(e),n="";t.d&&t.d.Value&&(n=JSON.parse(t.d.Value));return n},qosName:"GetPowerAppFormDesignUrl",method:"GET"})};t.prototype.fetchAllClientFormSchemas=function(e){var t=this;void 0===e&&(e=!1);this._clientFormsDebouncer||(this._clientFormsDebouncer=new O.e);this._clientFormsDebouncer.isExecuting()&&!e||(this._clientFormsPromise=this._clientFormsDebouncer.debounce(this._getData({url:this._getServerConnectionUrl().toString(),parseResponse:function(e){t._clientForms={};var n=JSON.parse(e);n.ContentTypeIdToNameMap&&(t._contentTypeIdToNameMap=n.ContentTypeIdToNameMap);n.ClientFormCustomFormatter&&(t._ctIdToClientFormCustomFormatter=n.ClientFormCustomFormatter);var r=n.ClientForms;if(r){r.New&&t._processClientFormResponse(2,r.New);if(r.Edit){t._processClientFormResponse(1,r.Edit);t._processClientFormResponse(3,r.Edit)}}n.Navigation&&(t._listContext.leftNavigationData={quickLaunchNodes:n.Navigation.Nodes});B?void 0!==n.EnableAttachments&&(t._listContext.enableAttachments=n.EnableAttachments):t._listContext.enableAttachments="true"===n.EnableAttachments;n.FormRenderModes&&t._processFormRenderMode(n.FormRenderModes);(n.PowerAppFormId||n.AppId)&&(t._powerAppFormId=n.PowerAppFormId||n.AppId);n.AppRenderInfo&&(t._powerAppFormInfo=n.AppRenderInfo||{});n.AppAdditionalData&&(t._powerAppAdditionalData=n.AppAdditionalData);n.CachedFileUrlTemplate&&n.CacheAppFiles&&(t._powerAppFormCacheInfo=JSON.stringify({appFiles:n.CacheAppFiles,cachedFileUrlTemplate:n.CachedFileUrlTemplate}))},qosName:"GetClientForms",additionalPostData:b.e.getAdditionalPostData({needsSchema:!1,viewXml:'<View><ViewFields><FieldRef Name="ID"/></ViewFields></View>',needsForms:!0,needsQuickLaunch:!1}),method:"POST",additionalHeaders:this._getAdditionalHeaders(),noRedirect:!0})));return this._clientFormsPromise};t.prototype.getDataSourceName=function(){return"ClientFormDataSource"};t.prototype._processClientFormResponse=function(e,t){this._clientForms[e]||(this._clientForms[e]={});var n=this._clientForms[e];for(var r in t)if(t.hasOwnProperty(r)&&!n[r]){var i=this._reverseLookupContentTypeIdByName(r),s=this._ctIdToClientFormCustomFormatter?this._ctIdToClientFormCustomFormatter[i]:void 0;n[r]={contentType:r,contentTypeId:i,formType:e,fields:[],clientFormCustomFormatter:s?JSON.parse(s):void 0,mode:0};for(var o=n[r],u=t[r],a=0,f=u.length;a<f;a++)o.fields.push(u[a])}this._clientForms[e]=n};t.prototype._getServerConnectionUrl=function(e){var t=this._itemUrlHelper.getUrlParts({listUrl:this._listContext.listUrl});return y.t({webUrl:this._pageContext.webAbsoluteUrl,listId:this._listContext.listId,urlParts:t,rootFolder:this._listContext.folderPath,requestToken:"?"})};t.prototype._getUrlInfo=function(){var e=this._itemUrlHelper.getUrlParts({listUrl:this._listContext.listUrl});return{listUrl:e?e.serverRelativeListUrl:this._listContext.listUrl,itemUrlParts:e}};t.prototype._createOrUpdateItem=function(e,t,n,r,s,o){var u=this,a=r.clientForm.fields,f=[],l=[],c={},h=[],p=null,d=null,v=!1;this._failedUpdateComplianceTagIdsCount=0;for(var g=0,y=a;g<y.length;g++){var b=y[g];if(b.data&&0===b.state.peek()){var E=b.data.peek();if(L.c(b)&&E!==b.serverData){p=b;if(o){var S=this._getUpdateMultipleComplianceTagsPromises(E,o,b);if(S)for(var x=0,T=S;x<T.length;x++){var N=T[x];h.push(N)}}else{var C=this._getUpdateComplianceTagPromise(E,r.clientForm.item.peek(),b);C&&h.push(C)}}else if(L.h(b)){if(!Object(k.isFeatureEnabled)(k.IPRecordVersioningClient)){c[b.schema.Name]=!0;continue}var A=L.p(r.clientForm.item.peek().properties[L.t]);if(A===("1"===E)||o){c[b.schema.Name]=!0;continue}d=b;var O=this._getUpdateUnlockedRecordPromise(E,r.clientForm.item.peek(),b,A);O&&h.push(O)}else if(this._isClientFormFieldUpdated(r,E,b)&&"attachments"!==b.schema.FieldType.toLowerCase()){b.state(1);f.push(b);var M=b.schema.Name;if("ContentType"===M){E=this._reverseLookupContentTypeIdByName(E.displayName);M="ContentTypeId";v=!0}l.push({FieldName:M,FieldValue:E,HasException:!1,ErrorMessage:null})}else c[b.schema.Name]=!0}}2!==r.clientForm.formType||v?1===r.clientForm.formType&&r.clientForm.item&&!r.clientForm.isBulkEdit&&r.clientForm.item.peek()&&r.clientForm.item.peek().properties&&!v&&l.push({FieldName:"ContentTypeId",FieldValue:r.clientForm.item.peek().properties.ContentTypeId,HasException:!1,ErrorMessage:null}):l.push({FieldName:"ContentType",FieldValue:r.clientForm.contentType,HasException:!1,ErrorMessage:null});if(0===f.length&&0===h.length)return i.n.wrap({status:m.e.success});h.push(this._getUpdateItemPromise(e,t,n,r,s,f,l,r.clientForm.item,o));return i.n.all(h).then(function(e){for(var t={status:m.e.success},n=0,r=e;n<r.length;n++){var i=r[n];if(i&&i.hasOwnProperty("status")){t.status=i.status;i.failedItemIds&&(t.failedItemIds=i.failedItemIds)}break}u._failedUpdateComplianceTagIdsCount>0&&t.status===m.e.success&&(t.status=m.e.partialSuccess);return t},function(e){p&&p.state(0);d&&d.state(0);for(var t=0,n=f;t<n.length;t++){var i=n[t];i.hasException(!0);i.state(0)}var s=Object(w.r)(u._pageContext)+r.clientForm.item.peek().properties.FileRef;throw e=(e=Array.isArray(e)?e:[e]).filter(function(e){return e&&e.message&&e.message.value}).map(function(e){e.message.value=e.message.value.replace('"'.concat(s,'" '),"");return e})})};t.prototype._getUpdateItemPromise=function(e,t,n,r,s,o,u,a,f){return u&&0!==u.length&&o&&0!==o.length?this._getData({url:t(a),parseResponse:function(e){var t=JSON.parse(e);if(!t.d||!t.d[s]||!t.d[s].results){for(var n=0,u=o;n<u.length;n++){(L=u[n]).state(0)}return i.n.wrapError("The server response couldn't be processed")}for(var l=null,c={},h="",p=0,d=t.d[s].results;p<d.length;p++){var v=d[p];if(2===r.clientForm.formType&&"Id"===v.FieldName){var y=a.peek();y.properties||(y.properties={});y.properties.ID=v.FieldValue}if(!0===v.HasException||null!==v.ErrorMessage){var b=v.FieldName;c[b]||(c[b]=[]);void 0!==v.ItemId&&c[b].indexOf(v.ItemId)<0&&c[b].push(v.ItemId);if(!l){l={};for(var w=0,E=r.clientForm.fields;w<E.length;w++){var S=E[w];l[S.schema.Name]=S}}if(l[b]){l[b].errorMessage(v.ErrorMessage);l[b].hasException(!0);var x=l[b].schema.Title;h=h?h+", "+x:x}}}var T={status:h?m.e.fail:m.e.success};if(f&&f.length&&c.null){var N=c.null;N.length<f.length?T.status=m.e.partialSuccess:T.status=m.e.fail;T.failedItemIds=N}for(var C=0,k=o;C<k.length;C++){var L=k[C];if(h){if(!c[L.schema.Name]&&r.isInteractiveSave){L.errorMessage(g.format(D.e,h));L.hasException(!0)}}else{L.errorMessage("");L.hasException(!1)}L.state(0)}return T},qosName:e,additionalPostData:n(u),method:"POST",additionalHeaders:this._getAdditionalHeaders(),maxRetries:5}):i.n.wrap()};t.prototype._handleServerData=function(e,t,n,r){for(var i=t.ListData,s=t.Data.Row[0],o=e.item.peek(),u=e.isBulkEdit,a=0,f=r.length;a<f;a++){var l=r[a],c=l.schema;if(!n||!n.hasOwnProperty(c.Name)){void 0===l.data&&(l.data=h.observable(null));void 0===l.serverData&&(l.serverData=null);if(i.hasOwnProperty(c.Name)){"boolean"===c.FieldType.toLowerCase()&&""===s[c.Name]&&"0"===i[c.Name]?l.serverData="":c.FieldType&&"thumbnail"===c.FieldType.toLowerCase()&&s[c.Name]?l.serverData=s[c.Name]:l.serverData=i[c.Name];if(!o.hasOwnProperty(c.Name)&&!o.properties.hasOwnProperty(c.Name)){o.properties[c.Name]=s[c.Name];"DateTime"===c.Type&&s[c.Name+"."]&&(o.properties[c.Name+"."]=s[c.Name+"."])}}else if(L.c(l)){l.serverData=s[L.r];o.hasOwnProperty(c.Name)||o.properties.hasOwnProperty(c.Name)||(o.properties[c.Name]=s[c.Name])}else o.folder&&l.schema.FieldType&&"file"===l.schema.FieldType.toLowerCase()&&l.schema.Title&&"name"===l.schema.Title.toLowerCase()&&i.Title?l.serverData=i.Title:l.serverData=null;u&&(l.serverData=null);if(l.schema.AppendOnly){l.appendOnlyData=t[l.schema.Name];l.data("")}else l.data(l.serverData);if(H.e.isActivated("1E378923-8921-4A0C-A8F3-130823AB8BEB","Fix hotfix VSO#615577")){l.hasException(!1);l.errorMessage("");l.schema=c}}}Object(k.isFeatureEnabled)(k.DocumentSetsModernView)&&Object(k.isFeatureEnabled)(k.UseItemsScopeInTeamSites)&&this._handleWelcomeFields(e,t.WelcomeFields);o.properties[L.e]=i[L.e];o.hasClientFormData=!0};t.prototype._handleWelcomeFields=function(e,t){var n=e.fields;if(Array.isArray(t)&&t.length>0&&n){for(var r=n.map(function(e,t){return{index:t,name:e.schema.InternalName}}),i={},s=0;s<t.length;s++){var o=t[s];o&&(i[o]=s+2)}i.FileLeafRef=0;i.DocumentSetDescription=1;r.sort(function(e,t){if(e.name===t.name)return e.index-t.index;var n=i[e.name],r=i[t.name];return void 0!==n&&void 0!==r?n-r:void 0!==n?-1:void 0!==r?1:e.index-t.index});e.fields=r.map(function(e){return n[e.index]})}};t.prototype._getAdditionalHeaders=function(){return y.r(this._listContext)};t.prototype._processFormRenderMode=function(e){if(e)for(var t in e)for(var n in e[t]){var r=2;switch(n){case"Edit":r=1;break;case"Display":r=3}var i=0;switch(e[t][n].RenderType){case 1:i=1;break;case 2:i=2;break;case 3:i=3;break;case 4:i=4;break;default:A.e.logData({name:"ClientFormDataSource.InvalidFormRenderMode",message:"Server returned RenderType="+e[t][n].RenderType})}this._clientForms[r][t].mode=i}};t.prototype._checkRenderModes=function(e){for(var t in this._clientForms)for(var n in this._clientForms[t])if(this._clientForms[t][n].mode===e)return!0;return!1};t.prototype._getSuggestionsViewXml=function(e,t,n,r,i){var s=n?'<Eq><FieldRef Name="Editor" LookupId="TRUE"/><Value Type="int"><UserID/></Value></Eq>':'<Neq><FieldRef Name="Editor" LookupId="TRUE"/><Value Type="int"><UserID/></Value></Neq>';s=i?"<And>".concat(s,'<BeginsWith><FieldRef Name="').concat(e,'"/><Value Type="').concat(t,'">').concat(i,"</Value></BeginsWith></And>"):"<And>".concat(s,'<IsNotNull><FieldRef Name="').concat(e,'"/></IsNotNull></And>');var o='<Query><OrderBy><FieldRef Name="ID" Ascending="false"></FieldRef></OrderBy><Where>'.concat(s,"</Where></Query>"),u='<ViewFields><FieldRef Name="Modified"/><FieldRef Name="Editor"/><FieldRef Name="'.concat(e,'"/></ViewFields>');return'<View Scope="RecursiveAll">'.concat(o).concat(u,'<RowLimit Paged="TRUE">').concat(r,"</RowLimit></View>")};t.prototype._getUpdateComplianceTagPromise=function(e,t,n){var r,s=n.schema;s.ComplianceTags&&(r=s.ComplianceTags.filter(function(t){return t&&t.tagValue===e})[0]);return r?this._complianceTagDataSource.updateComplianceTag(t,r).then(null,function(e){if(e&&n){n.errorMessage(e.message&&e.message.value?e.message.value:e);n.hasException(!0)}}):i.n.wrap()};t.prototype._getUpdateUnlockedRecordPromise=function(e,t,n,r){var i=this._itemUrlHelper.getItemUrlParts(t.key).serverRelativeListUrl;return"1"===e?this._complianceTagDataSource.unlockRecord(t,i).then(function(e){n.serverData=e?"1":"0"},function(e){if(e&&n){n.serverData=r?"1":"0";n.errorMessage(e.message&&e.message.value?e.message.value:e);n.hasException(!0)}}):this._complianceTagDataSource.lockRecord(t,i).then(function(e){n.serverData=e?"1":"0"},function(e){if(e&&n){n.serverData=r?"1":"0";n.errorMessage(e.message&&e.message.value?e.message.value:e);n.hasException(!0)}})};t.prototype._getUpdateMultipleComplianceTagsPromises=function(e,t,n){var r,i=this,s=n.schema,o=[];s.ComplianceTags&&(r=s.ComplianceTags.filter(function(t){return t&&t.tagValue===e})[0]);if(r){for(var u=[],a=0,f=0,l=t.length;f<l;f++){var c=t[f];u.push(parseInt(c().properties.ID,10));if(++a===L.i||f===t.length-1){var h=this._itemUrlHelper.getItemUrlParts(t[0]().key).serverRelativeListUrl;o.push(this._complianceTagDataSource.updateComplianceTagInBatch(u,r,h).then(function(e){i._failedUpdateComplianceTagIdsCount+=e.length},function(e){if(e&&n){n.errorMessage(e.message&&e.message.value?e.message.value:e);n.hasException(!0)}}));u=[];a=0}}return o}return null};t.prototype._updateAttachmentsField=function(e){var t=this,n=e.clientForm.item.peek(),r=null;if(n&&n.properties.ID&&"0"!==n.properties.ID){for(var s=0,o=e.clientForm.fields;s<o.length;s++){var u=o[s];if("attachments"===u.schema.FieldType.toLowerCase()){r=u;break}}var a=r&&r.AttachmentOperationsManager;if(a&&a.operationsPool.length>0){a.setListItem(n);return a.executeAllOperations(a.operationsPool,!0).then(function(e){a.operationsPool=[];t.handleAttachmentsErrors(e,r)},function(e){a.operationsPool=[];t.handleAttachmentsErrors(e,r)})}}return i.n.wrap(null)};t.prototype.handleAttachmentsErrors=function(e,t){var n=[];e.forEach(function(e){e.result||n.push(e.errorMsg)});if(t&&n&&n.length>0){var r=n.reduce(function(e,t){return e+(e?"\r\n":"")+t+"\r\n"},"");t.errorMessage(r);t.hasException(!0)}};t.prototype._getFormRenderMode=function(e,t){var n=this._contentTypeIdToNameMap[t],r=this._clientForms[e][n];return r?2===r.mode&&r.clientFormCustomFormatter&&r.clientFormCustomFormatter.bodyJSONFormatter?5:r.mode:this._checkRenderModes(3)?3:0};t.prototype._reverseLookupContentTypeIdByName=function(e){for(var t in this._contentTypeIdToNameMap)if(e===this._contentTypeIdToNameMap[t])return t;return null};t.prototype._ensureClientForms=function(e){if(!this._clientForms||this._listContext.refreshClientForm){this._listContext.refreshClientForm=void 0;return this.fetchAllClientFormSchemas(!0).then(e)}return i.n.wrap(e())};t.prototype._isClientFormFieldUpdated=function(e,t,n){return(!e.clientForm.isBulkEdit||""!==t||null!==n.serverData)&&(n.schema.AppendOnly?!H.e.isActivated("E4E6F7C4-9ADB-4B1B-833D-350823F516DE","Fix hotfix VSO#617198")||!!t:!M.e(t,n.serverData))};t.prototype._locateClientForm=function(e,t,n){!t&&n&&this._contentTypeIdToNameMap&&(t=this._contentTypeIdToNameMap[n]);if(!t&&this._clientForms[e])for(var r in this._clientForms[e])if(this._clientForms[e].hasOwnProperty(r)){t=r;break}if(n&&0===n.lastIndexOf(j,0)&&this._clientForms[e]&&!this._clientForms[e][t]){var i={FileLeafRef:1,Title:1,URL:1};for(var r in this._clientForms[e])if(this._clientForms[e].hasOwnProperty(r)){var s=this._clientForms[e][r].fields.filter(function(e){return!!i[e.Name]})[0];if(s){this._clientForms[e].Folder={contentType:"Folder",contentTypeId:n,formType:e,fields:[s],mode:0};return this._clientForms[e].Folder}}}if(!this._clientForms[e]||!this._clientForms[e][t]){if("folder"===t.toLowerCase()&&!n)for(var r in this._clientForms[e])if(this._clientForms[e][r]&&!this._clientForms[e][r].contentTypeId)return this._clientForms[e][r];return null}return this._clientForms[e][t]};t.prototype._locateClientFormWithContentTypeInfos=function(e,t){if(!t||!t.length)return this._locateClientForm(e,void 0,void 0);var n=t[0],i=this._locateClientForm(e,n.contentType,n.contentTypeId);if(1===t.length||!i||!i.fields)return i;for(var s=i.fields.slice(),o=function(n){if(0===s.length)return"break";var r=t[n],i=u._locateClientForm(e,r.contentType,r.contentTypeId);s=s.filter(function(e){for(var t=0,n=i.fields;t<n.length;t++){if(n[t].Name===e.Name)return!0}return!1})},u=this,a=1;a<t.length;a++){if("break"===o(a))break}return Object(r.__assign)(Object(r.__assign)({},i),{fields:s})};t.prototype._getData=function(e){return this.dataRequestor.getData(e)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},p.e.dependencies),{pageContext:S.h,listContext:S.o,items:E.H,navigation:P.e,compliance:T.e,itemUrlHelper:N.a,apiUrlHelper:C.e});return t})(p.e),W=Object(s.s)("ClientFormDataSource",z),X=n(2602),V=o.t.isActivated("2e4ee191-19b8-4aad-b712-fe71f588fc9f","03/31/2022","when body json is empty, do not return mode as multi=column"),$=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._buffer=[];r._bufferSize=5;r._clientFormDataSource=n.clientFormDataSource;r._itemsStore=n.itemsStore;r._listContext=n.listContext;return r}t.prototype.getClientForm=function(e,t){var n=this;void 0===t&&(t=!1);t&&(this._listContext.refreshClientForm=!0);var r,s=e.item.peek(),o=this._getBufferKeyFromItem(s,e.contentType),u=e.isBulkEdit?void 0:this._getClientFormFromBuffer(o);s.type!==a.e.Folder||e.contentType||(e.contentType="Folder");if(u&&!this._listContext.refreshClientForm){if(s.hasClientFormData){u.item=e.item;return i.n.wrap(u)}this._deleteClientFormFromBuffer(o)}var f=this.getContentInfoTypes(e);return this._clientFormDataSource.getClientFormSchema(e.clientFormType,f,e.isBulkEdit).then(function(t){r={item:e.item,formType:t.formType,contentType:t.contentType,contentTypeId:t.contentTypeId,fields:[],clientFormCustomFormatter:t.clientFormCustomFormatter,isBulkEdit:e.isBulkEdit};n._generateFieldsFromSchema(r,t);if(2!==e.clientFormType)return n.updateFormValues(r)}).then(function(){n._addClientFormToBuffer(r);return i.n.wrap(r)})};t.prototype.getContentInfoTypes=function(e){var t=[];if(e.isBulkEdit&&e.selection&&!e.isSwitchingContentType)for(var n={},r=0,i=e.selection;r<i.length;r++){var s=i[r];if(s){var o=s.peek(),u=o.properties;if(u){var f=o.type!==a.e.Folder||u.ContentType?u.ContentType:"Folder",l=u.ContentTypeId,c=f+l;if(!n[c]){t.push({contentType:f,contentTypeId:l});n[c]=!0}}}}else t.push({contentType:e.contentType,contentTypeId:e.contentTypeId});return t};t.prototype.updateFormValues=function(e,t){return this._clientFormDataSource.updateFormValues(e,t)};t.prototype.createItem=function(e){return this._clientFormDataSource.createItem(e)};t.prototype.clearBuffer=function(){this._buffer=[]};t.prototype.updateItem=function(e){this._buffer=[];return this._clientFormDataSource.updateItem(e)};t.prototype.getContentTypes=function(e){return this._clientFormDataSource.getContentTypes(e)};t.prototype.updateItemMetadata=function(e,t){var n=this,r=e.items,s=e.metadata,o=e.parentItem,u=e.skipInvalidation,a=e.onComplete,c=r.length,h=0,p=[],d=function(){for(var e=[],t=s.group;t;){var r=t.fieldValue,i=t.fieldSchema;e.push({data:n.createObservable(r),serverData:null,state:n.createObservable(0),hasException:n.createObservable(!1),errorMessage:n.createObservable(""),schema:i});t=Object(X.e)(l.default.getParent(t,s.itemGroups))}return e};return i.n.wrap((function(){r.forEach(function(e,r){t&&(p[r]=new f.e(e.key,e));var i={item:n.createObservable(e),fields:d(),contentType:null,formType:1};n._clientFormDataSource.updateItem({clientForm:i,newDocumentUpdate:!1,checkInComment:null}).then(function(){h++;if(t){p[r]=p[r].succeed();t.update(p)}if(h===c){a&&a(!0);o&&!u&&n._itemsStore.invalidateItem(o.key)}},function(e){if(t){var n=e&&e.length>0&&e[0]&&e[0].message&&e[0].message.value;p[r]=p[r].fail(new Error(n));t.update(p)}})});t&&t.update(p)})())};t.prototype.hasFormRenderMode=function(e){return this._clientFormDataSource.hasFormRenderMode(e)};t.prototype.getFormRenderMode=function(e,t){var n,r,s,o,u,a;if(Object(k.isFeatureEnabled)(k.CustomActionPreFetch)&&this._listContext&&!1===this._listContext.checkPowerAppState){if(V){if(c=null===(o=this._listContext)||void 0===o?void 0:o.availableContentTypes)for(var f=0,l=c;f<l.length;f++){if((null===(u=(d=l[f]).ClientFormCustomFormatter)||void 0===u?void 0:u.bodyJSONFormatter)||(null===(a=d.ClientFormCustomFormatter)||void 0===a?void 0:a.toString().indexOf('"bodyJSONFormatter"'))>0)return i.n.resolve(5)}}else{var c;if(c=null===(n=this._listContext)||void 0===n?void 0:n.availableContentTypes)for(var h=0,p=c;h<p.length;h++){var d;if((null===(r=(d=p[h]).ClientFormCustomFormatter)||void 0===r?void 0:r.bodyJSONFormatter)||(null===(s=d.ClientFormCustomFormatter)||void 0===s?void 0:s.toString().indexOf('"bodyJSONFormatter"'))>0)try{var v=d.ClientFormCustomFormatter;if(v){var m=JSON.parse(v);if(""===(m&&m.bodyJSONFormatter))continue;return i.n.resolve(5)}}catch(e){return i.n.resolve(2)}}}return i.n.resolve(2)}return this._clientFormDataSource.getFormRenderMode(e,t)};t.prototype.getPowerAppFormId=function(){return this._clientFormDataSource.getPowerAppFormId()};t.prototype.getPowerAppRenderInfo=function(){return this._clientFormDataSource.getPowerAppRenderInfo()};t.prototype.getPowerAppAdditionalData=function(){return this._clientFormDataSource.getPowerAppAdditionalData()};t.prototype.getPowerAppFormCacheInfo=function(){return this._clientFormDataSource.getPowerAppFormCacheInfo()};t.prototype.getPowerAppFormDesignUrl=function(e){return this._clientFormDataSource.getPowerAppFormDesignUrl(e)};t.prototype.fetchAllClientFormSchemas=function(){return this._clientFormDataSource.fetchAllClientFormSchemas()};t.prototype._generateFieldsFromSchema=function(e,t){for(var n=this._listContext&&this._listContext.enableAttachments,r=0,i=t.fields.length;r<i;r++){var s=t.fields[r];("Attachments"!==s.Type||n)&&!(e.isBulkEdit&&s.ReadOnlyField)&&e.fields.push(this._generateField(e,s))}};t.prototype._generateField=function(e,t){return{hasException:this.createObservable(!1),errorMessage:this.createObservable(""),schema:t,state:this.createObservable(0)}};t.prototype._getBufferKeyFromItem=function(e,t){return e.properties.ID+e.name+"|"+t};t.prototype._getClientFormFromBuffer=function(e){for(var t=0,n=this._buffer.length;t<n;t++){var r=this._buffer[t].key;if(r===e){if(0===t)return this._buffer[t].form;var i=this._buffer[t].form;this._buffer.splice(t,1);this._buffer.unshift({key:r,form:i});return i}}return null};t.prototype._addClientFormToBuffer=function(e){if(!e.isBulkEdit&&!this._hasAppendOnlyField(e)){var t=e.item.peek();t&&void 0!==t.properties.ID&&this._buffer.unshift({key:this._getBufferKeyFromItem(t,e.contentType),form:e})>this._bufferSize&&this._buffer.pop()}};t.prototype._deleteClientFormFromBuffer=function(e){for(var t=0,n=this._buffer.length;t<n;t++){if(this._buffer[t].key===e){this._buffer.splice(t,1);break}}};t.prototype._hasAppendOnlyField=function(e){for(var t=0,n=e.fields;t<n.length;t++){if(n[t].schema.AppendOnly)return!0}return!1};t.dependencies=Object(r.__assign)(Object(r.__assign)({},c.default.dependencies),{clientFormDataSource:W,itemsStore:u.t,listContext:S.o});return t})(c.default),J=(t.default=$,Object(s.s)("ClientFormProvider",$))},2326:function(e,t,n){"use strict";n.d(t,"e",function(){return v});var r=n(0),i=n(1065),s=n(59),o=n(1196),u=n(35),a=n(864),f=n(187),l=n(2022),c=n(2692),h=n(101),p=n(1168),d=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._pageContext=n.pageContext;r._apiUrlHelper=n.apiUrlHelper;r._itemUrlHelper=n.itemUrlHelper;r._dataRequestor=new o.t({qosName:"ComplianceTagDataSource"},{pageContext:r._pageContext});return r}t.prototype.getAvailableTagsForSite=function(){var e=this;return this._dataRequestor.getData({url:this._buildComplianceTagsListUrl(),qosName:"GetAvailableTagsForSite",method:"GET",noRedirect:!0}).then(function(t){return e._transformToComplianceTags(t.d.GetAvailableTagsForSite.results)},function(e){return s.n.wrapError(c.e)})};t.prototype.updateComplianceTagInBatch=function(e,t,n){if(!e||0===e.length){p.e.logData({name:"ComplianceTagDataSource.EmptyItemIds",message:"Empty item IDs selected for list: "+n});return s.n.wrap([])}var r=JSON.stringify({itemIds:e,listUrl:n,complianceTagValue:t.tagValue,blockDelete:t.blockDelete,blockEdit:t.blockEdit});return this._dataRequestor.getData({url:this._buildApplyLabelOnBulkItemsUrl(),qosName:"ApplyLabelOnBulkItems",additionalPostData:r,method:"POST"}).then(function(e){return e&&e.d&&e.d.ApplyLabelOnBulkItems&&e.d.ApplyLabelOnBulkItems.results?e.d.ApplyLabelOnBulkItems.results:[]},function(e){return s.n.wrapError(e)})};t.prototype.updateComplianceTag=function(e,t){var n=t.blockEdit||t.blockDelete,r=t.blockEdit,i=t.isEventTag,o=JSON.stringify({complianceTag:t.tagValue,isTagPolicyHold:n,isTagPolicyRecord:r,isEventBasedTag:i,isTagSuperLock:t.superLock,isUnlockedAsDefault:t.unlockedAsDefault});return this._dataRequestor.getData({url:this._buildUpdateHashtagsUrl(e,"SetComplianceTag"),qosName:"SetComplianceTag",additionalPostData:o,method:"POST",noRedirect:!0}).then(function(){return t.tagName},function(e){return s.n.wrapError(e)})};t.prototype.unlockRecord=function(e,t){var n=JSON.stringify({listUrl:t,itemId:e.properties.ID});return this._dataRequestor.getData({url:this._buildUnlockRecordUrl(),qosName:"UnlockRecordItem",additionalPostData:n,method:"POST"}).then(function(e){if(e&&e.d&&e.d.UnlockRecordItem&&e.d.UnlockRecordItem.results){var t=e.d.UnlockRecordItem.results;return l.p(t)}return!1},function(e){return s.n.wrapError(e)})};t.prototype.lockRecord=function(e,t){var n=JSON.stringify({listUrl:t,itemId:e.properties.ID});return this._dataRequestor.getData({url:this._buildLockRecordUrl(),qosName:"LockRecordItem",additionalPostData:n,method:"POST"}).then(function(e){if(e&&e.d&&e.d.LockRecordItem&&e.d.LockRecordItem.results){var t=e.d.LockRecordItem.results;return l.p(t)}return!1},function(e){return s.n.wrapError(e)})};t.prototype._buildComplianceTagsListUrl=function(){return this._apiUrlHelper.build().methodWithAliases("SP.CompliancePolicy.SPPolicyStoreProxy.GetAvailableTagsForSite",{siteUrl:this._pageContext.webAbsoluteUrl}).toString()};t.prototype._buildUpdateHashtagsUrl=function(e,t){var n=this._itemUrlHelper.getItemUrlParts(e.key);return this._apiUrlHelper.build().webByItemUrl(n).method("GetList",n.serverRelativeListUrl).method("items",e.properties.ID).method(t).toString()};t.prototype._transformToComplianceTags=function(e){var t=[],n={tagName:c.n,tagValue:"",blockDelete:!1,blockEdit:!1,tagDescription:c.t,tagTooltip:c.t,hasRetentionAction:!1,autoDelete:!1,isEventTag:!1,reviewerEmail:"",notes:"",displayName:"",superLock:!1,tagId:"",unlockedAsDefault:!1};t.push(n);for(var r=0,i=e;r<i.length;r++){var s=i[r],o=l.f(s),u=l.l(s),a={tagName:s.TagName,tagValue:s.TagName,blockDelete:s.BlockDelete,blockEdit:!!s.BlockEdit,tagDescription:o,tagTooltip:u,hasRetentionAction:s.HasRetentionAction,autoDelete:s.AutoDelete,isEventTag:s.IsEventTag,reviewerEmail:s.ReviewerEmail,notes:s.Notes,displayName:s.DisplayName,superLock:s.SuperLock,tagId:s.TagId,unlockedAsDefault:s.UnlockedAsDefault};t.push(a)}return t};t.prototype._buildApplyLabelOnBulkItemsUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.ApplyLabelOnBulkItems").toString()};t.prototype._buildUnlockRecordUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.UnlockRecordItem").toString()};t.prototype._buildLockRecordUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.LockRecordItem").toString()};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.default.dependencies),{pageContext:u.h,apiUrlHelper:a.e,itemUrlHelper:f.a});return t})(i.default),v=Object(h.s)("ComplianceTagDataSource",d)},2411:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.fail=0]="fail";e[e.partialSuccess=1]="partialSuccess";e[e.success=2]="success"})(r||(r={}))},2483:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(59),i=n("knockout-lib"),s=n(2005),o=n(469),u=n(120),a=Object(s.e)("ms-client-form-react","./ReactClientFormConnector",function(){return r.n.resolve(n.ee([302,"deferred","deferred.odsp-common","deferred.odsp-datasources","deferred.office-ui-fabric-react","deferred.resx-deferred"],3075))});i.components.isRegistered(a.tagName)||i.components.register(a.tagName,a);var f=Object(s.e)("ms-properties-form","./propertiesForm/PropertiesFormConnector",function(){return r.n.resolve(n.ee([715,"deferred","deferred.items-view","deferred.odsp-common","deferred.odsp-datasources","deferred.office-ui-fabric-react","deferred.resx-deferred"],3052))});i.components.isRegistered(f.tagName)||i.components.register(f.tagName,f);function l(e,t){void 0===t&&(t=!1);var n=e&&e.consume(o.e)||null;if(t){n&&n.logData({name:"ClientForm.Instantiate.PropertiesForm",extraData:{TagName:"ms-properties-form",Host:Object(u.e)()}});return"ms-properties-form"}n&&n.logData({name:"ClientForm.Instantiate.ReactClientForm",extraData:{TagName:"ms-client-form-react",Host:Object(u.e)()}});return"ms-client-form-react"}},2875:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(59),s=n(27),o=n(40),u=n(11),a=n(2053),f=n(35),l=n("knockout-lib"),c=n(2483),h=n(2422),p=n(1971),d=(function(){function e(){}e.getDialog=function(e,t,n){var r=null;return t.requestDialog({title:h.m,actions:[{name:h.d,icon:new p.e("Save"),execute:function(){null===r&&i.n.wrap(1);return r.processAndSaveChanges().then(function(e){return e?2:1})},isAvailable:l.observable(!0),isDefault:!1,automationId:"saveClientFormDialog"},{name:h.n,icon:new p.e("Cancel"),execute:function(){return i.n.wrap(3)},isAvailable:l.observable(!0),isDefault:!0,automationId:"cancelClientFormDialog"}],component:{name:Object(c.e)(n),params:{clientForm:e,interactiveSave:!1,fieldsManagerAccessor:function(e){r=e}}},size:"XLarge"})};return e})(),v=n(144),m=n(1967),g=n(72),y=n(2017),b=n(2318),w=n(2373),E=n(1973),S=n(1979),x=n(1974),T=n(469),N=n(15),C=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="EditItemAction";r._isFullPageApp=!!t.isFullPageApp;r._isBulkEdit=!!t.isBulkEdit;r._dialogProvider=r.resources.consume(S.e);r._itemParentHelper=r.resources.consume(E.e);r._itemCommandHelper=r.resources.consume(y.t);r._pageContext=r.resources.consume(f.h);r._actionMap=r.resources.consume(v.e);r._urlDataSource=r.resources.consume(g.de);r._itemSelectionHelper=new(r.child(x.e))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this,t=this._itemSelectionHelper.firstItem(),n=t&&this.observables.unwrap(this._itemParentHelper.getFacetedAncestorOrSelf(t,"list"));return!(n&&n.list&&this._isBulkEdit&&(!N.e.isActivated("0F378815-7F92-48A5-B9E3-A127BEB75AC6","11/9/2020","disable bulk edit when list disableGridEditing is true")&&!0===n.list.disableGridEditing||this._itemSelectionHelper.selection().length<=1))&&(!!t&&!!n&&!!n.list&&n.list.templateType!==u.n.mySiteDocumentLibrary&&this._itemSelectionHelper.filterItems(function(t){return e._itemCommandHelper.isCommandSupported(t,w.t)&&s.e.hasItemPermission(t,s.e.editListItems)}))};t.prototype.onExecute=function(e,t){return Object(r.__awaiter)(this,void 0,i.n,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,this._itemSelectionHelper.resolveSelection()];case 1:if(!(t=r.sent())||!t.length)return[2,i.n.resolve({resultCode:"EmptySelection",resultType:o.e.Failure})];this.resources.consume(T.e).logData({name:"EditItem",isIntentional:!0,extraData:{isBulkEdit:t.length>1}});n=t[0];return t.length>1?[2,this._editInFullPageClientForm(n,e,!0)]:a.e.isCheckedOutByOther(n,this._pageContext.userId)?[2,a.e.showCheckedOutByOtherDialog(this._dialogProvider)]:[2,this._editInFullPageClientForm(n,e)]}})})};t.prototype._editInFullPageClientForm=function(e,t,n){return this._actionMap||n?new(this.managed(this._actionMap.LaunchListFormAction))({type:1,item:e,selection:n?this._itemSelectionHelper.selection():void 0,url:this._urlDataSource.getEditFormUrl(e),isFullPageApp:this._isFullPageApp}).execute(t):this._editInClientFormDialog(e)};t.prototype._editInClientFormDialog=function(e){var t=this;return this.resources.consume(b.resourceKey).getClientForm({item:this.observables.create(e),clientFormType:1,contentType:e.properties.ContentType}).then(function(e){var n=t.resources.consume(S.e);return d.getDialog(e,n,t.resources).wait()}).then(function(){return{resultType:o.e.Success}})};return t})(m.e);t.default=C}}]);