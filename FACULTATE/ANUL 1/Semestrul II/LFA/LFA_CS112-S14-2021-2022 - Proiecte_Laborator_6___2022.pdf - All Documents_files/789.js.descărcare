(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[789],{5176:function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return C});var r=n(8),i=n(4197),s=n(195),o=n(101),u=n(1287),a=(function(){function e(e,t){this._instrumentationProvider=t.instrumentationProvider;this._darkModeHelper=t.darkModeHelper}e.prototype.getEngagementData=function(){var e,t=this._instrumentationProvider,n=null===(e=this._darkModeHelper)||void 0===e?void 0:e.isODBDarkMode;return{currentPage:t.currentPageName()||"NA",previousPage:t.previousPageName()||"NA",extraData:{isDarkMode:void 0!==n?n:"NA"}}};e.dependencies={instrumentationProvider:s.u,darkModeHelper:u.e};return e})(),f=Object(o.s)("PageEngagementHandler",a),l=n(1096),c=(function(){function e(e,t){this._searchSession=t.searchSession}e.prototype.getEngagementData=function(){return{extraData:{olsSearchSessionId:this._searchSession}}};e.dependencies={searchSession:l.e};return e})(),h=Object(o.s)("SearchEngagementHandler",c),p=n(1801),d=n(144),v=n(2370),m=n(505),g=(function(){function e(e,t){this._currentItem=t.currentItem}e.prototype.getEngagementData=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._currentItem,r=Object(p.getMostSpecificMatchingContext)(v.e,e),i=r&&r.item||n&&n.peek();if(i){var s=i.list,o={extension:i.extension,createdFromExcel:s&&s.createdFromExcel,createdFromExisting:s&&s.createdFromExisting},u=i.graph&&i.graph.itemId||i.itemId;u&&(o.itemGraphId=u);var a=i.graph&&i.graph.driveId;a&&(o.itemGraphDriveId=a);var f=i.tsTraceId;f&&(o.tsTraceId=f);var l,c=i.queryType;c&&(o.queryType=c);Object(m.e)(i.queryType)&&(l=i.searchProperties.isMetadataSearch?"MetadataSearch":"DoclibSearch");return{scenario:l,extraData:o}}};e.dependencies={currentItem:d.o.optional};return e})(),y=Object(o.s)("ItemEngagementHandler",g),b=n(1973),w=n(35),E=n(198),S=n(2106),x=(function(){function e(e,t){this._currentItem=t.currentItem;this._itemParentHelper=t.itemParentHelper;this._pageContext=t.pageContext}e.prototype.getEngagementData=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._currentItem,r=Object(p.getMostSpecificMatchingContext)(v.e,e),i=r&&r.item||n&&n.peek();if(i){var s=this._itemParentHelper,o=s.getFacetedAncestorOrSelf(i,"list"),u=o&&o.peek(),a=s.getFacetedAncestorOrSelf(i,"subsite"),f=a&&a.peek(),l={docId:i.properties.uniqueId};if(u){var c=u.list,h=c.id,d=c.templateType;l.listId=h;l.listTemplateId="".concat(d)}if(f&&f.subsite.serverRelativeUrl!==this._pageContext.webAbsoluteUrl){var m=f.subsite,g=(h=m.id,m.siteCollectionId),y=m.webTemplateId;l.webId=h;l.webTemplateId="".concat(y);l.siteId=g}var b=this._pageContext.userDisplayName,w=this._pageContext.userLoginName,x=w&&-1!==w.lastIndexOf("@")?w.substring(0,w.lastIndexOf("@")):void 0;l.extraData||(l.extraData={});var T=void 0;if(i&&i.sharingType){var N=i&&i.sharingType;T=N===S.e.Shared||N===S.e.Public||N===S.e.PublicUnlisted}E.e(l.extraData,{isInODB:i.itemFromServer&&i.itemFromServer.SiteTitle&&b?-1!==i.itemFromServer.SiteTitle.indexOf(b):void 0,isInODBv2:i.openUrl&&x?-1!==i.openUrl.toLowerCase().indexOf(x.toLowerCase()):void 0,isItemShared:T});return l}};e.dependencies={currentItem:d.o.optional,itemParentHelper:b.e,pageContext:w.h};return e})(),T=Object(o.s)("ItemEngagementHandler",x),N={pageContext:i.e.optional,page:f.optional,search:h.optional,item:y.optional,sharePointItem:T.optional},C=new r.t({name:"LegacyKnockoutEngagementHandlers",factory:{dependencies:N,create:function(e){var t=[],n=e.pageContext,r=e.page,i=e.search,s=e.item,o=e.sharePointItem;n&&t.push(n);r&&t.push(r);i&&t.push(i);s&&t.push(s);o&&t.push(o);return{instance:t}}}})}}]);