(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[482],{4260:function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return v});var r=n(0),i=n(1978),s=n(31),o=n(1065),u=n(101),a=n(1091),f=n(168),l=n(428),c=n(72),h=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._dataSource=n.mruRecentDataSource;r._itemProvider=n.itemProvider;var i=n.location,s=void 0===i?window.location:i;r._origin=new f.e(s.href).authority;return r}t.prototype.changePinStatus=function(e){return this._dataSource.changePinStatus(e)};t.prototype.getTokenForMru=function(){return this._dataSource.getTokenForMru()};t.prototype.removeFromRecent=function(e){var t=this;return Object(s.isFeatureEnabled)(s.MruToMruPlusPlusSkyApi)?this._dataSource.removeRecentItem(e).then(function(n){t._itemProvider.invalidateItem(e.parentKey);return n}):this._itemProvider.removeFromRecent(e)};t.prototype.recordDocumentView=function(e){var t=e.graph,n=new f.e(e.openUrl),i="".concat(n.authority||this._origin).concat(n.path),s=e.sharingType,o=e.dateCreatedTime,u=e.dateModifiedTime,a=e.mruState,c=e.properties,h=void 0===c?{}:c,v=h.editorName,m=void 0===v?[]:v,g=h.creatorName,y=void 0===g?[]:g,b=a&&a.mruId,w=m[0],E=y[0],S=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({category:"Document",type:"DocumentUrl",app:p(e),url:i},(function(e){var t=e.name,n=e.extension,r=n&&n.replace(/^\.+/,"");return{title:t&&(n?t.replace(RegExp(".".concat(r,"$")),""):t),extension:r}})(e)),{file_size:e.size}),b?{mru_id:b}:{onedrive_info:t&&{drive_id:t.driveId,item_id:t.itemId,parent_reference_id:e.UNSAFE_parent&&e.UNSAFE_parent.graph&&e.UNSAFE_parent.graph.itemId,drive_type:t.driveType},resource_id:e.itemId}),{sharing_info:{state:"number"==typeof s&&s<l.e.Private?1:0},modification_info:d(w,u),creation_info:d(E,o)});return this._dataSource.recordDocumentView(e,S)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},o.default.dependencies),{itemProvider:i.resourceKey,mruRecentDataSource:c.q});return t})(o.default);t.default=h;function p(e){return Object(a.t)(e.extension)?"PdfViewer":e.audio||e.image360||e.photo||e.video?"Media":"OtherNonOffice"}function d(e,t){if(e&&t)return{timestamp:t.toISOString(),user_info:{upn:e.sip||e.email,display_name:e.title}}}var v=Object(u.s)("MruRecentProvider",h)}}]);