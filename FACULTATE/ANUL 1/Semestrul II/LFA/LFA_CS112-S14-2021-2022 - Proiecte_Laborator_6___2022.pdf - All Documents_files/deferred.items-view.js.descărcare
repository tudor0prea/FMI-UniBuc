(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred.items-view"],{1693:function(e,t,n){"use strict";n.r(t);n.d(t,"DropTargetHook",function(){return d});n.d(t,"DragSourceHook",function(){return v});n.d(t,"DragDropHook",function(){return b});var r=n(0),i=n("react-lib"),s=n(1405),o=n(1281),u=n(900),a=n(1541),f=n(4601),l=n(627),c=n(111),h=n(129),p=n(1521);var d=function(e){return i.createElement(s.e,null,i.createElement(o.e,Object(r.__assign)({},e)))};var v=function(e){var t=e.dragSourceKey,n=e.type,o=i.useState(),a=o[0],f=o[1],l=Object(h.e)(function(t){var n;e.hookCallback(t);f(null===(n=t.collectedProps)||void 0===n?void 0:n.isDragging)});return i.createElement(s.e,null,i.createElement(u.t,Object(r.__assign)({},e,{hookCallback:l})),e.showDefaultDragPreview||!a?null:i.createElement(u.e,{dragSourceKey:t,type:n},function(e){return i.createElement(y,{draggedItem:e.draggedItem,dropEffect:e.dropEffect})}))};function m(e){var t=e.resolve,n=Object(r.__rest)(e,["resolve"]);i.useEffect(function(){return function(){t()}},[]);return i.createElement(a.e,Object(r.__assign)({},n))}function g(e){var t=e.draggedItem,n=e.resolve;return i.createElement(s.e,null,i.createElement(u.e,{dragSourceKey:null==t?void 0:t.dragSourceKey,type:null==t?void 0:t.type,as:p.e,getItemStyles:p.n},function(e){return i.createElement(m,{draggedItem:e.draggedItem,dropEffect:e.dropEffect,resolve:n})}))}function y(e){var t=Object(l.i)({scope:"global"});i.useEffect(function(){if(e.draggedItem&&t){var n=new c.e,r=n.reject,s=n.resolve,o=n.promise,u=i.createElement(g,{draggedItem:e.draggedItem,reject:r,resolve:s});t.enqueue({content:u,promise:o,scope:"global"})}},[e.draggedItem]);return null}var b=i.memo(function(e){var t=e.dragDropKey,n=e.dragType,o=i.useState(),a=o[0],l=o[1],c=Object(h.e)(function(t){var n;e.hookCallback(t);l(null===(n=t.collectedDragProps)||void 0===n?void 0:n.isDragging)});return i.createElement(s.e,null,i.createElement(f.e,Object(r.__assign)({},e,{hookCallback:c})),e.showDefaultDragPreview||!a?null:i.createElement(u.e,{dragSourceKey:t,type:n},function(e){return i.createElement(y,{draggedItem:e.draggedItem,dropEffect:e.dropEffect})}))})},1779:function(e,t,n){"use strict";n.r(t);n.d(t,"ItemSwitchViewAction",function(){return b});n.d(t,"SwitchViewExecutor",function(){return w});var r=n(0),i=n("react-lib"),s=n(14),o=n(22),u=n(151),a=n(9),f=n(42),l=n(86),c=n(271),h=n(1),p=n(284),d=n(20),v=n(265),m=n(678),g=n(30),y=n(45),b=Object(y.t)(function(e,t){var n=t.itemKey,s=t.itemSetKey,y=t.viewId,b=t.currentDerivedView,w=e.demandItemFacet(f.e,n);if(!w)return null;var E=w.webAbsoluteUrl,S=w.listFullUrl,x=e.demandItemFacet(l.e,s),T=l.e.serialize({webAbsoluteUrl:E,listFullUrl:S,rootFolder:x&&x.rootFolder||"",viewKey:{viewId:y}}),N=b&&c.e.serialize({viewId:b.id}),C=e.isItemFacetResolved(h.jt,N)?e.demandItemFacet(h.jt,N):void 0,k=Object(g.t)(e,{itemKey:n,engagement:{name:"SwitchView",isIntentional:!0}}),L=e.dispatch,A=Object(d.i)(e,i.createElement(v.e,{itemKey:T}));return i.createElement(d.n,{action:A},function(e){var t=e.isAvailable,s=e.execute;return i.createElement(o.e,Object(r.__assign)({isAvailable:t,isToggled:b?y===b.id:""===y,onExecute:function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,i,o;return Object(r.__generator)(this,function(f){switch(f.label){case 0:L(Object(u.e)({items:Object(r.__assign)(Object(r.__assign)({},N?(t={},t[N]=Object(r.__assign)(Object(r.__assign)({},h.qt.pack(!1)),C&&b&&b.isDirty()?Object(r.__assign)({},h.y.pack(new p.e(C))):{}),t):{}),n?(i={},i[T]=Object(r.__assign)({},a.s.pack({itemKey:n})),i):{})}));N&&b&&b.isDirty()&&L(Object(m.e)({items:(o={},o[N]=[h.jt,h.y],o)}));return[4,s(e)];case 1:f.sent();return[2]}})})}},k))})}),w=Object(s.e)()(b)},2901:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(312),i=Object(r.e)(function(e){return{}})},3000:function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(7),i=new r.e("uploadProgress",{sourceEntryKey:Object(r.s)()});function s(e){return i.serialize({sourceEntryKey:e})}},3083:function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(6),i=new r.e("progressListGroup",{maxChildItemCount:r.t}),s=new r.e("progressList",{groupControlHandler:Object(r.n)(i)})},3104:function(e,t,n){"use strict";n.r(t);n.d(t,"hasManageListsPermission",function(){return m});n.d(t,"modifyColumn",function(){return g});var r=n(0),i=n(86),s=n(271),o=n(1729),u=n(13),a=n(108),f=n(1),l=n(9),c=n(219),h=n(122),p=n(1207),d=n(79),v=n(105);function m(e,t){var n=t.itemSetKey;if(n){var r=e.demandItemFacet(f.Ve,v.e.serialize({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl}));return!!(r&&r.permissions&&r.permissions.manageLists)}return!1}var g=Object(u.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.columnModifyTypeMap;return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var u,v,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_;return Object(r.__generator)(this,function(D){switch(D.label){case 0:if(!(u=e(Object(a.e)({setKey:i.e},t)).setKey))return[3,3];v=Object.keys(n)[0];g=n[v],y=g.modifyType,b=g.targetIndex;if(!(w=u.viewKey?s.e.serialize(u.viewKey):void 0))return[3,3];if(!(E=e(Object(a.e)({currentDerivedView:f.y},w)).currentDerivedView))return[3,3];S=E.getEffectiveFieldNames();if(!(x=e(Object(a.e)({internalName:f.Le},v)).internalName))return[3,3];if((T=S.indexOf(x))<0||1===y&&0===T||2===y&&T===S.length-1)return[2];N=E.isDirty();switch(y){case 0:E.updateField(x);break;case 1:E.updateField(x,T-1);break;case 2:E.updateField(x,T+1);break;case 3:E.updateField(x,b)}C=e(Object(h.e)(function(e){return m(e,{itemSetKey:u})}));k=!1;return C?[4,e(Object(p.e)({items:(A={},A[o.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl})]={views:(O={},O[w]={shouldSaveViewFieldsOnly:!0},O),qosName:"autoSaveModifyColumn"},A)})).then(function(){N||(E.baseViewXml=E.getEffectiveViewXml());k=!0},function(e){d.e.logError(e,{eventName:"ModifyColumn",feature:"ColumnFieldsAutoSave",columnFieldName:x,modifyType:y,errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status});throw e})]:[3,2];case 1:D.sent();D.label=2;case 2:L=new c.e;k||L.resolveItems({items:(M={},M[w]=Object(r.__assign)({},f.qt.pack(!0)),M)});L.invalidateItems({items:(_={},_[t]=[l.e],_[w]=[f.y],_)});e(L.execute());D.label=3;case 3:return[2]}})})}})},3245:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(2),i=new r.e("vault");new r.e("vaultQuotaRemainingFacet")},3738:function(e,t,n){"use strict";n.d(t,"h",function(){return r});n.d(t,"n",function(){return i});n.d(t,"u",function(){return s});n.d(t,"t",function(){return o});n.d(t,"s",function(){return u});n.d(t,"i",function(){return a});n.d(t,"r",function(){return f});n.d(t,"o",function(){return l});n.d(t,"m",function(){return c});n.d(t,"g",function(){return h});n.d(t,"y",function(){return p});n.d(t,"p",function(){return d});n.d(t,"v",function(){return v});n.d(t,"e",function(){return m});n.d(t,"f",function(){return g});n.d(t,"d",function(){return y});n.d(t,"l",function(){return b});n.d(t,"c",function(){return w});n.d(t,"a",function(){return E});var r="new",i="newFolder",s="newWordDocument",o="newExcelWorkbook",u="newPowerPointPresentation",a="newOneNoteNotebook",f="newFormsForExcel",l="newVisioDrawing",c="upload",h="uploadFile",p="uploadFolder",d="open",v="share",m="copyLink",g="download",y="rename",b="copyTo",w="moveTo",E="delete"},3758:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(76),s=n(9),o=n(86),u=n(308),a=n(56),f=n(402),l=n(60);var c=Object(i.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([607],4267)];case 1:return[2,e.sent().SortActionExecutor]}})})},function(e,t){var n=t.sortFieldKey,i=t.itemSetKey,s=t.isAscending,u=e.demandItemFacet(o.e,i);if(!u)return!1;var c=Object(a.e)(e).itemsScopeItemKey;if(!c)return!1;var h=o.e.serialize(Object(r.__assign)(Object(r.__assign)({},u),{sortFieldKey:n,sortAscending:s})),p=e.demandItemFacet(f.e,h),d=f.e.evaluate(p)(e,{itemKey:h,itemsScopeItemKey:c,isAvailable:!0}),v=d.itemKey;if(!d.isAvailable)return!1;var m=e.demandItemFacet(l.n,c),g=m&&m.itemKey;return!!v&&v!==g},function(e,t){var n=t.sortFieldKey,r=t.itemSetKey,i=t.isAscending,a=e.demandItemFacet(o.e,r);if(!a)return!1;var f=e.demandItemFacet(s.u,r),l=f&&e.demandItemFacet(u.e,f.columnKey),c=l&&l.internalName||a.sortFieldKey,h=f?f.isAscending:a.sortAscending;return c===n&&h===i})},3759:function(e,t,n){"use strict";n.d(t,"e",function(){return d});var r=n(0),i=n(45),s=n(22),o=n(86),u=n(271),a=n(1),f=n(774),l=n(3104),c=n(3980),h=n(30),p=!1,d=Object(i.e)(function(e,t){var n=t.itemSetKey,i=t.modifyType,s=t.columnKey,f=!1,c=e.demandItem({setKey:o.e,canModifySchema:a.l},n),d=c.setKey,v=c.canModifySchema,m=d&&d.viewKey?u.e.serialize(d.viewKey):void 0,g=e.demandItem({currentDerivedView:a.y},m).currentDerivedView,y=e.demandItemFacet(a.Le,s);if(d&&v&&g&&g.baseViewXml&&y)if(1===i||2===i){var b=g.getEffectiveFieldNames();if(b&&b.length){var w=b.indexOf(y),E=d.groupByFieldKey?1:0;f=1===i?w>E+1:w>=E&&w<b.length-1}}else f=!0;p=!!d&&Object(l.hasManageListsPermission)(e,{itemSetKey:d});return Object(r.__assign)({isAvailable:f},Object(h.t)(e,{itemKey:n,engagement:{name:"ModifyColumn",isIntentional:!0}}))},function(e,t){var n=t.itemSetKey,i=t.modifyType,s=t.columnKey,o=t.targetIndex,u=p?c.modifyColumnWithProgress:f.e;return{onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,a;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,e(u({items:(t={},t[n]={columnModifyTypeMap:(a={},a[s]={modifyType:i,targetIndex:o},a)},t)}))];case 1:r.sent();return[2]}})})}}})(s.e)},3762:function(e,t,n){"use strict";n.r(t);n.d(t,"CreateViewAction",function(){return w});var r=n(0),i=n("react-lib"),s=n(45),o=n(86),u=n(105),a=n(345),f=n(1),l=n(41),c=n(1131),h=n(30),p=n(20),d=n(22),v=n(78),m=n(56),g=n(474),y=n(517),b=Object(v.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(72,4348)];case 1:return[2,e.sent().FreshViewCreator]}})})}),w=Object(s.t)(function(e,t){var n=t.isEditing,s=t.currentViewKey,v=Object(l.e)(e),w=Object(m.e)(e).itemsScopeItemKey,E=e.demandItemFacet(o.e,v),S=e.demandItemFacet(c.e,v),x=e.demandItemFacet(f.y,s),T=c.e.evaluate(S)(e,{viewKey:s}).onViewSaved;if(!v||!w)return null;var N=!1;if(E&&x){var C=u.e.serialize({webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl}),k=e.demandItemFacet(f.Ve,C);N=!!(k&&x&&"POWER"!==x.viewType&&k.permissions&&(k.permissions.managePersonalViews||k.permissions.manageLists))}var L=E?e.demandItemFacet(f.gn,a.e.serialize({webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl})):void 0,A=Object(y.t)(e,{mapping:{fieldData:f.le},itemSetKey:v}).map(function(e){return e.fieldData}),O=e.demandItemFacet(f.ye,v),M=Number(null==O?void 0:O.ListTemplateType),_=Object(p.o)(function(e){return i.createElement(g.e,{itemsScopeItemKey:w},i.createElement(b,Object(r.__assign)({},e,t,{pageContext:L,itemSetKey:v,currentViewFields:A,listTemplateType:M,onViewSaved:T})))},{scope:"global"});return i.createElement(d.e,Object(r.__assign)({isAvailable:N,onExecute:_},Object(h.t)(e,{itemKey:v,engagement:{name:n?"EditView":"CreateNewView",isIntentional:!0}})))})},3980:function(e,t,n){"use strict";n.r(t);n.d(t,"modifyColumnWithProgress",function(){return k});var r,i=n(774),s=n(730),o=n(0),u=n(4136),a=n(13),f=n(420),l=n(10),c=n(473),h=n(331),p=n(3083),d=n(97),v=n(9),m=n(65),g=n(256),y=n(7),b=new y.e("modifyColumnProgressItem",{columnKey:Object(y.s)(),modifyType:Object(y.i)(),targetIndex:Object(y.i)()}),w=new g.e("modifyColumnProgress",function(e,t){var n=Object.keys(t.columnModifyTypeMap)[0],r=t.columnModifyTypeMap[n].modifyType,i=t.columnModifyTypeMap[n].targetIndex;return b.serialize({columnKey:n,modifyType:r,targetIndex:i})}),E=n(1),S=((r={})[m.r.started]=u.n,r[m.r.completed]=u.e,r[m.r.failed]=u.t,r),x=Object(a.t)(function(){return function(e){e(Object(f.e)(w,c.e)(Object(l.t)()(T)));e(Object(f.e)(w,h.n)(Object(l.t)()(N)));e(Object(f.e)(w,p.t)(Object(l.t)()(C)))}});function T(){return function(e){return function(e,t){var n,r=t.itemKey,i=t.format,s=Object(d.r)(e,t).phase,u=void 0,a=e.demandItemFacet(v.e,r),f=a&&a.itemKeys;if(f&&f.length>0)n=(u=S)&&u[s];else if("item"===i){var l=e.demandItemFacet(w,r),c=l&&l.taskKey;if(c){var h=e.demandItemFacet(b,c),p=h&&h.columnKey;if(p){n=e.demandItemFacet(E.Le,p)}}}return Object(o.__assign)({},n?{title:n}:{})}}}function N(){return function(e){return function(e,t){return{reportMode:h.e.pin}}}}function C(){return function(e){return function(e,t){return{maxChildItemCount:0}}}}var k=Object(s.e)({operationTypeFacet:i.t,progressKeyFacet:w,initializeBatch:function(){return x}})},4000:function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(0),i=n("react-lib"),s=n(86),o=n(271),u=n(45),a=n(164),f=n(22),l=n(20),c=n(30),h=n(6),p=new h.e("filterAction",{onFilter:h.t,isAvailable:h.t}),d=n(78),v=Object(d.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([603,"deferred.odsp-common","deferred.odsp-datasources","ondemand.resx-ondemand"],5174)];case 1:return[2,e.sent().FilterPanel]}})})}),m=Object(u.t)(function(e,t){var n=t.columnKey,u=t.itemSetKey,h=t.isToggled,d=e.demandItemFacet(p,u),m=e.demandItemFacet(s.e,u),g=m&&m.viewKey&&o.e.serialize(m.viewKey),y=p.evaluate(d)(e,{viewKey:g,isAvailable:!0}).isAvailable,b=Object(l.o)(function(e){return i.createElement(v,{onClose:function(){e.reject(new a.e)},onComplete:function(){e.resolve()},columnKey:n,itemSetKey:u})});return i.createElement(f.e,Object(r.__assign)({isAvailable:y,isToggled:h,onExecute:b},Object(c.t)(e,{itemKey:u,engagement:{name:"LaunchFilterPanel",isIntentional:!0}})))})},4028:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(6),i=new r.e("itemAutoRefresh",{isAvailable:r.t,subscribe:r.t,itemSubscriber:r.t})},4037:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(6),i=new r.e("openSyncIssuesAction",{action:r.t,isAvailable:r.t})},4111:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r,i;(function(e){e[e.MalwareDetected=0]="MalwareDetected";e[e.ThisFileIsCheckedOut=1]="ThisFileIsCheckedOut";e[e.DLPBlocked=2]="DLPBlocked";e[e.MissingMetaData=3]="MissingMetaData";e[e.DLPWarning=4]="DLPWarning";e[e.AwaitingApproval=5]="AwaitingApproval";e[e.Trending=6]="Trending";e[e.New=7]="New";e[e.NeedsRepublishing=8]="NeedsRepublishing"})(r||(r={}));(function(e){e[e.Mail=0]="Mail";e[e.CalendarEvent=1]="CalendarEvent";e[e.Teams=2]="Teams"})(i||(i={}))},4114:function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(0),i=n("react-lib"),s=n(45),o=n(30),u=n(22),a=n(14),f=n(181),l=n(214),c=n(2901),h=n(107),p=n(2902),d=function(e){var t=e.undoRedoActionType,n=e.dispatch,s=e.isAvailable,o=i.useState(0),a=o[0],f=o[1],l=i.useState(0),d=l[0],v=l[1],m=i.useRef(new h.e({})),g=s&&("undo"===t&&a>0||"redo"===t&&d>0);i.useEffect(function(){var e=n(c.e);m.current.on(e,p.e.undoRealCmdCountChangeEventName,function(e){f(e.undoRealCmdCount)});m.current.on(e,p.e.redoRealCmdCountChangeEventName,function(e){v(e.redoRealCmdCount)});return function(){m.current.dispose()}},[]);return i.createElement(u.e,Object(r.__assign)({},e,{isAvailable:g}))},v=Object(s.t)(function(e,t){var n=t.itemKey,s=t.undoRedoActionType,u="undo"===s,a=Object(f.e)(e)===l.e,v=e.dispatch;return i.createElement(d,Object(r.__assign)({undoRedoActionType:s,dispatch:v,isAvailable:a,onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){e=v(c.e);h.e.raise(e,u?p.e.undoChangeEventName:p.e.redoChangeEventName);return[2]})})}},Object(o.t)(e,{itemKey:n,engagement:{name:u?"QuickEditUndoAction":"QuickEditRedoAction",isIntentional:!0}})))}),m=Object(a.n)()(v)},4115:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n("react-lib"),s=n(22),o=n(45),u=Object(o.t)(function(e,t){return i.createElement(s.e,{onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(n){e=null;t.selector?e=document.querySelector(t.selector):t.elementId&&(e=document.getElementById(t.elementId));if(e){e.focus();t.shouldClick&&e.click&&e.click()}return[2]})})},engagement:{name:"SetFocus",isIntentional:!0}})})},4117:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n("react-lib"),i=n(61),s=n(62),o=n(4119),u={key:n(4118).e,automationId:"launchMovePickerCommand",name:i.m,ariaLabel:i.m,action:r.createElement(s.t,null,r.createElement(o.t,null)),iconProps:{iconName:"FabricMoveToFolder"}}},4118:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(2),i=Object(r.t)("launchMovePickerCommand")},4119:function(e,t,n){"use strict";n.d(t,"t",function(){return g});n.d(t,"e",function(){return y});var r=n(0),i=n("react-lib"),s=n(14),o=n(22),u=n(20),a=n(45),f=n(139),l=n(68),c=n(78),h=n(30),p=n(931),d=Object(l.e)()(Object(c.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(4,4788)];case 1:return[2,e.sent().LaunchMoveCopyPickerWizard]}})})})),v=Object(a.t)(function(e,t){var n=t.itemKeys,s=t.isMove,a=void 0!==s&&s;if(0===n.length)return null;var l=Object(f.e)(e);if(!l)return null;var c=e.demandItemFacet(p.e,n[0]),v=p.e.evaluate(c)(e,{entryItemKey:l,sourceItemKeys:n,isMove:a,isAvailable:!1,moveCopyPickerWizard:d}),m=v.isAvailable,g=v.moveCopyPickerWizard;if(!m||!g)return null;var y=Object(u.o)(function(e){return i.createElement(g,Object(r.__assign)({isMove:a,entryItemKey:l,sourceItemKeys:n},e))},{scope:"global"});return i.createElement(o.e,Object(r.__assign)({onExecute:y},Object(h.t)(e,{itemKey:n[0],engagement:{name:a?"MoveTo":"CopyTo"}})))}),m=Object(s.s)()(v),g=Object(a.e)(function(){return{isMove:!0}})(m),y=Object(a.e)(function(){return{isMove:!1}})(m)},4120:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n("react-lib"),i=n(61),s=n(62),o=n(4119),u={key:n(4121).e,automationId:"launchCopyPickerCommand",name:i.t,ariaLabel:i.t,action:r.createElement(s.t,null,r.createElement(o.e,null)),iconProps:{iconName:"Copy"}}},4121:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(2),i=Object(r.t)("launchCopyPickerCommand")},4135:function(e,t,n){"use strict";n.r(t);n.d(t,"GroupByActionExecutor",function(){return y});var r=n(0),i=n("react-lib"),s=n(86),o=n(42),u=n(271),a=n(22),f=n(9),l=n(1),c=n(265),h=n(20),p=n(30),d=n(45),v=n(225),m=n(219),g=n(2260),y=Object(d.t)(function(e,t){var n=t.groupByFieldKey,d=t.itemSetKey,y=e.demandItemFacet(s.e,d);if(!y)return i.createElement(h.n,null);var b=e.demandItemFacet(l.E,d),w=!y.groupByFieldKey&&!!b&&-1!==b.indexOf(n),E=y.groupByFieldKey===n||w,S=s.e.serialize(Object(r.__assign)(Object(r.__assign)({},y),{groupByFieldKey:E?void 0:n})),x=o.e.serialize(y),T=y.viewKey&&u.e.serialize(y.viewKey),N=e.demandItemFacet(l.y,T),C=Object(p.t)(e,{itemKey:d,engagement:{name:"GroupBy",isIntentional:!0}}),k=e.dispatch,L=Object(v.r)(e,i.createElement(c.e,{itemKey:S}));return i.createElement(h.n,{action:L},function(e){var t=e.execute,s=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i,o,u,a,c,h,p,d;return Object(r.__generator)(this,function(v){switch(v.label){case 0:i=new m.e({publisher:s});if(T&&w&&N&&(o=N.getDomParts())&&o.groupBy){u=Object(g.n)(o.groupBy);a=void 0;u.group1.fieldName===n?u.group2&&(a={isCollapsed:u.isCollapsed,group1:u.group2}):(null===(d=u.group2)||void 0===d?void 0:d.fieldName)===n&&(a={isCollapsed:u.isCollapsed,group1:u.group1});N.updateGroupBy(a);i.invalidateItems({items:(c={},c[S]=[f.e],c[T]=[l.y],c)})}i.resolveItems({items:Object(r.__assign)((h={},h[S]=Object(r.__assign)({},f.s.pack({itemKey:x})),h),T?(p={},p[T]=Object(r.__assign)({},l.qt.pack(!0)),p):{})});k(i.execute());return[4,t(e)];case 1:v.sent();return[2]}})})};return i.createElement(a.e,Object(r.__assign)({onExecute:s},C))})})},4138:function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"n",function(){return i});n.d(t,"r",function(){return s});n.d(t,"i",function(){return o});n.d(t,"s",function(){return u});n.d(t,"e",function(){return a});var r="socialBarList_36611a00",i="socialBarPanel_36611a00",s="socialBarPanelContent_36611a00",o="socialBarPanelPersona_36611a00",u="socialBarPanelPersonaDescription_36611a00",a="analyticsStatsLink_36611a00"},4371:function(e,t,n){"use strict";n.d(t,"e",function(){return p});var r=n(13),i=n(420),s=n(42),o=n(0),u=n("react-lib"),a=n(10),f=n(78),l=Object(f.e)(function(){return Object(o.__awaiter)(void 0,void 0,void 0,function(){return Object(o.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([40,"deferred.odsp-datasources","ondemand.resx-ondemand"],3601)];case 1:return[2,e.sent().PropertiesForm]}})})}),c=Object(a.t)()(function(){return function(e){return function(e,t){return{getPropertiesForm:function(e){return u.createElement(l,Object(o.__assign)({},e))}}}}});var h=n(1128),p=Object(r.t)(function(){return function(e){e(Object(i.e)(s.e,h.e)(c))}})},4377:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(0),i=n("react-lib"),s=n(1925),o=n(3467),u=n(2621),a=n(1776),f=n(441),l=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onClose=function(){n.setState({isOpen:!1})};n._iframeOnLoad=function(){var e=n.props.heightOffset;if(n._iframeElement&&n._iframeElement.contentDocument){var t=n._iframeElement.contentDocument.body.clientHeight;t<=0&&e&&(t=document.body.clientHeight*e);n._iframeElement.style.height=t+"px"}n.setState({isIFrameLoaded:!0});n.props.onLoad&&n._iframeElement&&n.props.onLoad(n._iframeElement)};n.state={isOpen:!0,isIFrameLoaded:!1};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({isIFrameLoaded:!1})};t.prototype.render=function(){var e=this,t=this.props,n=t.url,l=(t.heightOffset,Object(r.__rest)(t,["url","heightOffset"])),c=this.state.isIFrameLoaded;return i.createElement(o.e,Object(r.__assign)({className:"IFrameDialog_d45656a1",hidden:!this.state.isOpen,type:u.e.close},l),i.createElement(s.e,null,!c&&i.createElement(a.e,{size:f.e.large}),i.createElement("iframe",{ref:function(t){return e._setupIFrameElementFunctions(t)},src:n,style:{display:c?"block":"none"},onLoad:this._iframeOnLoad})))};t.prototype._setupIFrameElementFunctions=function(e){if(e){var t=e;t.cancelPopUp=this._onClose;t.commitPopup=this._onClose}this._iframeElement=e};return t})(i.Component)},4528:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(76),s=n(14),o=n(338);var u=Object(s.s)()(Object(s.r)()(Object(i.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([33],3737)];case 1:return[2,e.sent().GoToChannelAction]}})})},function(e,t){var n=t.itemKey;return!!e.demandItemFacet(o.e,n)})))},4530:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n("react-lib"),i=n(291),s=n(2),o=n(4115),u={key:new s.e("GetNPSSurveyFocusShortcut").id,automationId:"GetNPSSurveyFocusShortcut",shortcutProps:{keySequences:["AltDown"],content:i.o},action:r.createElement(o.e,{elementId:"obf-TPromptContainer"})}},4786:function(e,t,n){"use strict";n.r(t);n.d(t,"OpenAsHyperLinkExecutor",function(){return u});n.d(t,"OpenAsShortcutExecutor",function(){return a});n.d(t,"NewItemInOfficeClientAction",function(){return f.t});n.d(t,"ItemOpenInOfficeClientAction",function(){return f.e});n.d(t,"OpenInOfficeClientAction",function(){return f.n});n.d(t,"ItemOpenInOfficeOnlineAction",function(){return l.e});n.d(t,"OpenInOfficeOnlineAction",function(){return l.t});n.d(t,"OpenInBFileAction",function(){return x});n.d(t,"ItemSwitchViewAction",function(){return T.ItemSwitchViewAction});n.d(t,"SwitchViewExecutor",function(){return T.SwitchViewExecutor});n.d(t,"SetDefaultViewAction",function(){return N.e});n.d(t,"ViewCreator",function(){return ce});n.d(t,"LaunchFilterPanelAction",function(){return pe.e});n.d(t,"SortAction",function(){return de.e});n.d(t,"GroupByAction",function(){return we});n.d(t,"GroupByActionExecutor",function(){return Ee.GroupByActionExecutor});n.d(t,"ModifyColumnAction",function(){return Se.e});n.d(t,"ModifyColumnAggregateTypeAction",function(){return Ne});n.d(t,"ApproveRejectAction",function(){return Ce.e});n.d(t,"ItemFileHandlerOpenAction",function(){return ke.t});n.d(t,"FileHandlerOpenAction",function(){return ke.e});var r,i=n(0),s=n("react-lib"),o=n(4377),u=(function(e){Object(i.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onDismiss=function(){t.props.resolve()};return t}t.prototype.render=function(){var e=this.props,t=e.title,n=e.linkLocation,r=e.launchBehaviorType;if(n&&void 0!==r){if("dialog"===r)return s.createElement(o.e,{url:n,heightOffset:.7,dialogContentProps:{title:t},onDismiss:this._onDismiss});"inPageNavigation"===r?window.open(n,"_self"):window.open(n,"_blank")}this.props.resolve();return null};return t})(s.PureComponent),a=(function(e){Object(i.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.targetUrl;e&&window.open(e,"_blank");this.props.resolve();return null};return t})(s.PureComponent),f=n(928),l=n(936),c=n(45),h=n(22),p=n(30),d=n(42),v=n(105),m=n(1),g=n(595),y=n(5),b=n(964),w=n(102),E=n(23),S=n(47),x=Object(c.e)(function(e,t){var n=t.itemKey,r=e.demandItem({key:d.e,itemUrl:y.I,driveItem:w.e,fileName:y.d},n),s=r.key,o=r.itemUrl,u=r.driveItem,a=r.fileName,f=Object(S.e)(e,n),l="",c="",h="",x=!1;if(E.t.isActivated("3deefa50-273b-494f-81c7-72a6f9f4876a","09/21/2021","Use drive item to get driveId and itemId")&&s&&o){var T=v.e.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl}),N=e.demandItem({driveUrl:m.N},T).driveUrl;if(N){var C=Object(g.e)(N);if(C){l=C.driveId||"";if(a){h=a.extension;(C=Object(g.e)(o))&&(x=!!(c=C.itemId||""))}}}}else if(u){l=u.driveId||"";x=!!(c=u.itemId||"");h=(null==a?void 0:a.extension)||""}var k,L=s?Object(b.e)("spo:".concat(s.webAbsoluteUrl)):void 0,A=encodeURIComponent(null!=L?L:""),O=encodeURIComponent(l),M=encodeURIComponent(c),_=h.toLowerCase();if(".note"===_)k="https://www.onenote.com/meetingnotes/".concat(A,"/").concat(O,"/").concat(M);else if(".whiteboard"===_)if(!E.t.isActivated("A1AE7AB1-F5D8-49BE-AB01-4CC90527BADD","09/12/2021","Whiteboard GCCH support")&&f){var D="https://whiteboard.office.com";"gcch"===(null==f?void 0:f.cloudType)?D="https://whiteboard.office365.us":"dod"===(null==f?void 0:f.cloudType)&&(D="https://whiteboard.apps.mil");k="".concat(D,"/me/whiteboards/p/").concat(A,"/").concat(O,"/").concat(M)}else k="https://whiteboard.office.com/me/whiteboards/p/".concat(A,"/").concat(O,"/").concat(M);else{var P=e.demandItemFacet(y.i,n)||"",H=s?s.webAbsoluteUrl:"";k="https://www.office.com/launch/fluid/content?drive=".concat(l,"&item=").concat(c,"&file=").concat(encodeURIComponent(P),"&siteUrl=").concat(encodeURIComponent(H))}return Object(i.__assign)({isAvailable:x,onExecute:x?function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){window.open(k);return[2]})})}:void 0},Object(p.t)(e,{itemKey:n,engagement:{name:"OpenInBFile",isIntentional:!0}}))})(h.e),T=n(1779),N=n(1400),C=n(1489),k=n(164),L=n(1336),A=n(3557),O=n(18),M=n(390),_=n(108),D=n(246),P=n(86),H=n(271),B=n(78),j=n(129),F=n(205),I=n(56),q=n(9),R=n(1207),U=n(730),z=n(13),W=n(420),X=n(10),V=n(331),$=n(473),J=n(97),K=n(65),Q=new(n(256).e)("saveView",function(e,t){return Object.keys(t.views)[0]}),G=((r={})[K.r.started]=A.a,r[K.r.completed]=A.o,r[K.r.failed]=A.u,r),Y=Object(z.t)(function(){return function(e){e(Object(W.e)(Q,$.e)(Object(X.t)()(Z)));e(Object(W.e)(Q,V.n)(Object(X.t)()(te)))}});function Z(){return function(e){return ee}}function ee(e,t){var n,r=t.itemKey,s=t.format,o=Object(J.r)(e,t).phase,u=void 0,a=e.demandItemFacet(q.e,r),f=a&&a.itemKeys;if(f&&f.length>0)n=(u=G)&&u[o];else if("item"===s){var l=e.demandItemFacet(Q,r),c=l&&l.taskKey;if(c){var h=e.demandItemFacet(m.y,c);n=h&&h.title}}return Object(i.__assign)({},n?{title:n}:{})}function te(){return function(e){return function(e,t){return{reportMode:V.e.pin}}}}var ne=Object(U.e)({operationTypeFacet:R.t,progressKeyFacet:Q,initializeBatch:function(){return Y}}),re=n(1715),ie=n(219),se=n(678),oe=new M.e("saveViewProgressBatch"),ue=Object(B.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([31,"ondemand.resx-ondemand"],5313)];case 1:return[2,e.sent().SaveViewDialog]}})})});function ae(){return oe.serializeNext()}var fe=Object(D.t)()(T.SwitchViewExecutor);function le(e){var t=this,n=e.viewTitle,r=e.isPublicView,o=e.onViewSaved,u=e.currentViewKey,a=e.itemSetKey,f=e.itemsScopeItemKey,l=e.listViewSetKey,c=e.reject,h=e.resolve,p=e.currentDerivedView,d=e.saveViewOperation,v=s.useState(!0),m=v[0],g=v[1],y=s.useState(ae)[0],b=s.useState(),w=b[0],E=b[1],S=s.useState(),x=S[0],T=S[1],N=Object(F.t)(),M=Object(j.e)(function(){T(!0);o&&o();h()}),D=Object(j.e)(function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,n,r,s,o,h,v,m,b;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e.viewTitle,n=e.isPublicView;r=p&&p.title!==t;s=N(Object(_.e)({deserializedSetKey:P.e},a)).deserializedSetKey;if(!(r&&s&&p))return[3,3];if(!(o=t.trim()))throw new Error(A.e);return[4,N(Object(L.t)({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl}))];case 1:if(i.sent().some(function(e){return e.serverView.Title===t}))throw new Error(O.format(A.r,t));return[4,N(Object(C.e)({items:(m={},m[l]={views:(b={},b[o]={itemSetKey:a,isPublic:n,sourceView:p,progressItemKey:y},b)},m)}))];case 2:i.sent();if(h=N(Object(_.e)({createdViewKey:H.e},y)).createdViewKey){E(h.viewId);g(!1)}return[3,5];case 3:if(!f){c(new Error("Cannot save a view without a current ItemsScope"));return[2]}return[4,N(he({itemsScopeItemKey:f,listViewSetKey:l,itemSetKey:a,currentViewKey:u,saveViewOperation:d}))];case 4:i.sent();if(v=N(Object(_.e)({savedViewKey:H.e},u)).savedViewKey){E(v.viewId);g(!1)}i.label=5;case 5:return[2]}})})}),B=Object(j.e)(function(){c(new k.e)});return m?s.createElement(ue,{viewTitle:n,isPublicView:r,onContinue:D,onCancel:B}):!x&&w?s.createElement(fe,{viewId:w,currentDerivedView:p,onComplete:M,itemSetKey:a}):null}var ce=Object(c.t)(function(e,t){var n=Object(I.e)(e).itemsScopeItemKey,r=Object(S.e)(e,t.itemSetKey),o=!!r&&Object(E.n)(r).isActivated("49F1ADD5-332D-4BAF-A4F9-FBEA104C76BE","01/20/21","Use saveViewWithProgress operation"),u=e.demandItemFacet(m.y,t.currentViewKey),a=o?R.e:ne;return s.createElement(le,Object(i.__assign)({},t,{itemsScopeItemKey:n,currentDerivedView:u,saveViewOperation:a}))});function he(e){return function(t){var n,r,s=e.listViewSetKey,o=e.itemSetKey,u=e.currentViewKey,a=e.saveViewOperation,f=t(Object(_.e)({childItems:q.e,parentItem:q.s,deserializedItemSetKey:P.e},o)),l=f.childItems,c=f.parentItem,h=f.deserializedItemSetKey;return t(a({items:(n={},n[s]={views:(r={},r[u]={itemSetKey:o},r)},n)})).then(function(){var e,n;if(h){var r=P.e.serialize(Object(i.__assign)(Object(i.__assign)({},h),{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0})),s=t(Object(_.e)({filterOptionSets:q.n},r)).filterOptionSets;if(s&&h.filterParams){var o={};for(var a in s)s.hasOwnProperty(a)&&(o[s[a]]=!0);t(Object(re.e)({items:o}))}var f=new ie.e({publisher:he});f.resolveItems({items:(e={},e[r]=Object(i.__assign)(Object(i.__assign)({},l?q.e.pack(l):{}),c?q.s.pack(c):{}),e[u]=Object(i.__assign)({},m.qt.pack(!1)),e)});t(f.execute());t(Object(se.e)({items:(n={},n[u]=[m.jt,m.y],n[r]=[q.e],n)}))}})}}var pe=n(4000),de=n(3758),ve=n(76),me=n(6),ge=new me.e("groupByAction",{groupedItemSetKey:me.t,isAvailable:me.t,onGroupBy:me.t}),ye=n(11),be=n(29);var we=Object(ve.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(0,4135)];case 1:return[2,e.sent().GroupByActionExecutor]}})})},function(e,t){var n=t.groupByFieldKey,r=t.itemSetKey,s=e.demandItemFacet(P.e,r);if(!s)return!1;var o=v.e.serialize(s),u=e.demandItemFacet(m.Ve,o),a=u&&u.templateType===ye.n.mySiteDocumentLibrary,f=Object(be.e)(e,{enableGroupByInOneDrive:m.j}).enableGroupByInOneDrive,l=e.demandItemFacet(m.E,r),c=s.groupByFieldKey===n||!!l&&-1!==l.indexOf(n),h=P.e.serialize(Object(i.__assign)(Object(i.__assign)({},s),{groupByFieldKey:c?void 0:n})),p=s.viewKey&&H.e.serialize(s.viewKey),d=e.demandItemFacet(ge,r);return ge.evaluate(d)(e,{itemSetKey:r,viewKey:p,groupedItemSetKey:h,isAvailable:!a||!!f}).isAvailable},function(e,t){var n=t.groupByFieldKey,r=t.itemSetKey,i=e.demandItemFacet(P.e,r);if(!i)return!1;var s=e.demandItemFacet(m.E,r);return i.groupByFieldKey===n||!!s&&-1!==s.indexOf(n)}),Ee=n(4135),Se=n(3759),xe=n(1493),Te=n(609),Ne=Object(c.e)(function(e,t){var n=t.itemSetKey,r=t.columnKey,s=t.aggregateType,o=e.demandItemFacet(m.p,n),u=o&&o[r]&&o[r].aggregateFunctionType||Te.e[0],a=u===Te.e[s]?void 0:Te.e[s];return Object(i.__assign)({isAvailable:!0,isToggled:u===Te.e[s]},a?Object(p.t)(e,{itemKey:n,engagement:{isIntentional:!0,action:"ModifyColumnAggregateType",name:a||"AggregateTypeNone",extraData:{PreviousAggregateType:u||"AggregateTypeNone",component:"ColumnContextMenu"}}}):{})},function(e,t){var n=t.itemSetKey,r=t.columnKey,s=t.aggregateType;return{onExecute:function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var t;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(Object(xe.e)({items:(t={},t[n]={aggregateType:s,columnKey:r},t)}))];case 1:i.sent();return[2]}})})}}})(h.e),Ce=n(1129),ke=n(1130)},4826:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n("react-lib"),i=n(4114),s=n(43),o=n(2),u={key:Object(o.t)("quickEditUndo"),automationId:"quickEditUndoCommand",name:s.ae,iconProps:{iconName:"Undo"},isPermanent:!0,action:r.createElement(i.e,{undoRedoActionType:"undo"})}},4827:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n("react-lib"),i=n(43),s=n(2),o=Object(s.t)("quickEditRedo"),u=n(4114),a={key:o,automationId:"quickEditRedoCommand",name:i.ue,iconProps:{iconName:"Redo"},action:r.createElement(u.e,{undoRedoActionType:"redo"})}},4838:function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(0),i=n("react-lib"),s=n(1950),o=n(2543),u=n(20),a=n(14),f=n(22),l=n(78),c=n(30),h=n(45),p=Object(l.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([81,"ondemand.resx-ondemand"],5056)];case 1:return[2,e.sent().default]}})})}),d=Object(h.t)(function(e,t){var n=t.itemKey,s=Object(u.o)(function(e){return i.createElement(p,Object(r.__assign)({},e,{itemKey:n}))},{scope:"global"});return i.createElement(f.e,Object(r.__assign)({onExecute:s},Object(c.t)(e,{itemKey:n,engagement:{name:"SocialBar",isIntentional:!0}})))}),v=(Object(a.i)()(d),n(4138)),m=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.likeLabel,n=e.itemKey,r=i.createElement(o.e,{activityDescription:t,isCompact:!0});return i.createElement(u.n,{action:i.createElement(d,{itemKey:n})},function(e){var t=e.isAvailable,n=e.execute,o=t?function(){n().catch(function(){})}:void 0;return i.createElement(s.e,{disabled:!1,className:v.e,onClick:o},r)})};return t})(i.Component)},4887:function(e,t,n){"use strict";n.r(t);n.d(t,"ItemAutoRefresh",function(){return a});n.d(t,"CurrentItemAutoRefresh",function(){return f});var r=n("react-lib"),i=n(14),s=n(45),o=n(4028);function u(e){var t=e.subscribe;r.useLayoutEffect(function(){return t()},[t]);return null}var a=Object(s.t)(function(e,t){var n=t.itemKey,i=e.demandItemFacet(o.e,n),s=o.e.evaluate(i)(e,{itemKey:n,itemSubscriber:null}),a=s.isAvailable,f=s.itemSubscriber,l=s.subscribe;return a?f||(l?r.createElement(u,{subscribe:l}):null):null}),f=Object(i.n)()(a)},5154:function(e,t,n){"use strict";n.r(t);n.d(t,"sharePointAddonAutoRefresh",function(){return Le});var r,i=n(13),s=n(420),o=n(86),u=n(4028),a=n(0),f=n("react-lib"),l=n(353),c=n(10),h=n(29),p=n(9),d=n(5),v=n(219),m=n(153),g=n(220),y=n(23),b=n(1390),w=n(4122),E=n(573),S=n(80),x=n(40);(function(e){e[e.New=0]="New";e[e.Update=1]="Update";e[e.Delete=2]="Delete"})(r||(r={}));var T={ODB:819,ODC:"EnablePushChannelLogging"},N={ODB:459},C=(function(){function e(e){var t=this;this.subscribe=function(){t._log("Subscribe");if(0===t._subscribers){t._async=new m.e;y.t.isActivated("90f6bcb1-03a0-4a02-9370-1e6807d6763a","7/22/2021","Fix Item Auto Refresh Bug")||(t._syncToken="latest");var e=t._async.debounce(function(){return t._onNotification()},1e4,{leading:!0,maxWait:1e4});t._pushChannelService.setupNotificationHandler({source:w.t.WebhookSubscription},function(){t._log("PushChannelMessageSource",w.t.WebhookSubscription);e()});t._pushChannelService.setupNotificationHandler({source:w.t.EventHub},function(){t._log("PushChannelMessageSource",w.t.EventHub);e()});t._pushChannelService.addConnectionHandler(t._id,function(e){return t._onPushChannelConnection(e)})}t._subscribers++;t._pushChannelService.isConnected()||t._pushChannelService.connect(t._getNotification(),{methodInvoker:"ItemAutoRefreshHelper.subscribe"});return t._unsubscribe.bind(t)};this._id=e.id;this._driveUrlParts=e.driveUrl?Object(b.e)(e.driveUrl):void 0;this._dispatch=e.dispatch;this._template=e.template;this._itemScopeItemKey=e.itemsScopeItemKey||"";this._pushChannelService=e.pushChannelService;this._onUnsubscribe=e.onUnsubscribe;this._isTestMode=e.isTestMode;this._onPushChannelConnected=e.onPushChannelConnected;this._onNotificationReceived=e.onNotificationReceived;this._subscribers=0;this._syncToken="latest";this._getChangesAttempts=0}e.prototype._unsubscribe=function(){this._log("Unsubscribe");this._subscribers--;this._template.onUnsubscribe(this._subscribers);if(0===this._subscribers){if(this._async){this._async.dispose();this._async=void 0;this._refreshSubscriptionTimeoutId=void 0}this._pushChannelService.setupNotificationHandler({source:w.t.WebhookSubscription},function(){});this._pushChannelService.removeConnectionHandler(this._id);this._pushChannelService.disconnect()}this._onUnsubscribe(this._subscribers);return this._subscribers};e.prototype._onPushChannelConnection=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(a.__generator)(this,function(r){switch(r.label){case 0:if(!e){this._log("Disconnected");this._clearRefreshSubscriptionTimeout();return[2]}this._log("Connected");this._isTestMode&&this._onPushChannelConnected&&this._onPushChannelConnected();if(y.t.isActivated("90f6bcb1-03a0-4a02-9370-1e6807d6763a","7/22/2021","Fix Item Auto Refresh Bug"))return[3,5];r.label=1;case 1:r.trys.push([1,3,,4]);return[4,this._resolveChangeMessages()];case 2:r.sent();return[3,4];case 3:t=r.sent();this._handleError(t);return[2];case 4:return[3,9];case 5:if("latest"!==this._syncToken)return[3,9];r.label=6;case 6:r.trys.push([6,8,,9]);return[4,this._getChangeMessages()];case 7:r.sent();return[3,9];case 8:n=r.sent();this._handleError(n);return[2];case 9:this._refreshSubscriptionHandler();return[2]}})})};e.prototype._handleError=function(e){var t=this;this._getChangesAttempts++;if(!(this._getChangesAttempts>10)){var n=!1;if(Object(E.s)(e))switch(e.status){case 404:case 410:n=!0;this._syncToken="latest"}n&&this._async&&this._async.setTimeout(function(){return t._onPushChannelConnection(t._pushChannelService.isConnected())},500+Math.pow(2,this._getChangesAttempts))}};e.prototype._getNotification=function(){return this._template.getSubscription&&this._template.getSubscription(this._dispatch)};e.prototype._refreshSubscriptionHandler=function(){var e=this;if(this._async){var t=this._pushChannelService.getSocketIoSubscription();if(t){var n=105001*Math.random()+15e3,r=Date.parse(t.expirationDateTime),i=Date.now(),s=r-i-n;if(s<12e4){if(g.e.isFeatureEnabled(N)){var o={refreshDelay:s,expirationDateTime:t.expirationDateTime,expirationDateTimeinMS:r,dateTimeNow:i,recreateBufferRandom:n};new S.e({name:"ItemAutoRefreshHelper.refreshSubscription",extraData:o}).end({resultType:x.e.Failure,extraData:o})}s=12e4}this._clearRefreshSubscriptionTimeout();this._refreshSubscriptionTimeoutId=this._async.setTimeout(function(){return Object(a.__awaiter)(e,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:this._log("Refreshing subscription");this._refreshSubscriptionTimeoutId=void 0;return[4,this._pushChannelService.refreshSubscription()];case 1:!0===e.sent()&&this._refreshSubscriptionHandler();return[2]}})})},s)}}};e.prototype._clearRefreshSubscriptionTimeout=function(){if(this._async&&void 0!==this._refreshSubscriptionTimeoutId){this._async.clearTimeout(this._refreshSubscriptionTimeoutId);this._refreshSubscriptionTimeoutId=void 0}};e.prototype._getChangeMessages=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,this._template.getChangeMessages(this._dispatch,this._syncToken,this._driveUrlParts)];case 1:e=t.sent();this._syncToken=e.syncToken?e.syncToken:"latest";this._getChangesAttempts=0;return[2,e]}})})};e.prototype._onNotification=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:t.trys.push([0,2,,3]);if(this._template.hasPendingRequest())return[2];this._isTestMode&&this._onNotificationReceived&&this._onNotificationReceived();return[4,this._resolveChangeMessages()];case 1:t.sent();return[3,3];case 2:e=t.sent();this._log("onNotification error",e);return[3,3];case 3:return[2]}})})};e.prototype._resolveChangeMessages=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,i,s,o,u,f,l,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:t=new v.e({publisher:e});return[4,this._getChangeMessages()];case 1:n=a.sent();this._log("Change messages",n);i=this._processMessages(n.messages);this._log("Changes",i);t.merge(n.itemResolver);for(s=0,o=i;s<o.length;s++)switch((u=o[s]).type){case r.New:t.invalidateItems({items:(f={},f[u.invalidateKey]=[p.t],f)});break;case r.Update:u.hasSelection&&this._itemScopeItemKey?this._updateItems(u.invalidateKey):t.invalidateItems({items:(l={},l[u.invalidateKey]=[u.invalidateFacet],l)});break;case r.Delete:t.invalidateItems({items:(c={},c[u.invalidateKey]=[d.l],c)})}this._dispatch(t.execute());return[2]}})})};e.prototype._processMessages=function(e){var t=[];e.sort(function(e,t){return e.parentItemKey?0:1});for(var n=0;n<e.length;n++){var r=e[n],i=this._template.processMessage(this._dispatch,r,this._itemScopeItemKey);if(void 0!==i){this._log("Change",i.invalidateKey,i.reason);t.push(i)}else if(r.parentItemKey)for(var s=n+1;s<e.length;s++){if(e[s].itemKey===r.parentItemKey){e.splice(s,1);break}}}return t};e.prototype._updateItems=function(e){this._template.updateItems(this._dispatch,e)};e.prototype._log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];g.e.isFeatureEnabled(T)&&console.log.apply(console,Object(a.__spreadArray)(["ItemAutoRefreshHelper"],e,!0))};return e})(),k=n(747),L=n(890),A=n(83),O=n(4535),M=n(4531),_=n(11),D=n(243),P=n(55),H=n(1),B=n(42),j=n(345),F=n(105),I=n(108),q=n(122),R=n(171),U=n(102),z=n(595),W=n(749),X=n(1603),V=n(84),$=(function(){function e(e){this._dataRequestor=e.dataRequestor;this._rootItemKey=e.rootItemKey;this._pendingRequest=!1}e.prototype.onUnsubscribe=function(e){};e.prototype.getSubscription=function(e){var t=this,n=e(Object(q.e)(function(e){return{spItem:e.demandItemFacet(B.e,t._rootItemKey)}})).spItem;if((null==n?void 0:n.webAbsoluteUrl)&&n.listFullUrl){var r=F.e.serialize({webAbsoluteUrl:null==n?void 0:n.webAbsoluteUrl,listFullUrl:null==n?void 0:n.listFullUrl}),i=e(Object(q.e)(function(e){return e.demandItemFacet(H.Ye,r)}));if((null==i?void 0:i.notificationUrl)&&(null==i?void 0:i.expirationDateTime)&&(null==i?void 0:i.subscribeID))return{notificationUrl:null==i?void 0:i.notificationUrl,expirationDateTime:null==i?void 0:i.expirationDateTime,id:null==i?void 0:i.subscribeID}}};e.prototype.hasPendingRequest=function(){return this._pendingRequest};e.prototype.getChangeMessages=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var r,i,s,o,u,f,l,c,h,p,d,m,g,b,w,E,S,x,T,N,C,k,O,M,_,D,P,j,$,J,K,Q=this;return Object(a.__generator)(this,function(G){switch(G.label){case 0:if(void 0===n||void 0===n.endpoint||void 0===n.driveId)throw"Invalid drive url parts";r="".concat(n.endpoint,"/drives/").concat(n.driveId);i=e(Object(R.e)({isTAB:A.x})).isTAB;s=e(Object(q.e)(function(e){return{spItem:e.demandItemFacet(B.e,Q._rootItemKey)}})).spItem;o=new v.e;if("latest"===t&&s){u=F.e.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl});f=e(Object(q.e)(function(e){return e.demandItemFacet(H.Ve,u)}));if(l=null==f?void 0:f.tick){c=l-621355968e9;c/=1e4;h=new Date(c);if(!y.t.isActivated("90f6bcb1-03a0-4a02-9370-1e6807d6763a","7/22/2021","Fix Item Auto Refresh Bug")){t="".concat(h.toISOString());p=new Date;if((p.getTime()-h.getTime())/1e3<30)return[2,{syncToken:t,messages:[],itemResolver:o}]}return[2,{syncToken:"".concat(h.toISOString()),messages:[],itemResolver:o}]}}return(g=n.endpoint)?[4,e(Object(L.getSessionToken)({endpoint:n.endpoint,driveUrl:r}))]:[3,2];case 1:g=G.sent();G.label=2;case 2:if(void 0===(d=(m=g)&&m.accessToken))throw new V.e({code:"authFailure"});this._pendingRequest=!0;b="".concat(r,"/root/view.delta?token=").concat(encodeURIComponent(t));return[4,this._dataRequestor.send({apiName:"viewDelta",path:b,accessToken:{accessToken:d,tokenUrl:r},useAuthorizationHeaders:!0,headers:Object(a.__assign)({"X-RestrictedReadCapabilities":"ForceCheckOut,RequiredColumn,ContentApproval,Irm,ExcludeFromOfflineClient,DocumentParser,DraftItemSecurity,ItemLevelPermissions"},i?{}:{ScenarioType:"BGO"})})];case 3:w=G.sent();E=[];if(w&&w.value)for(S=0,x=w.value;S<x.length;S++){T=x[S];N=void 0;C={endpoint:n.endpoint,driveId:n.driveId,itemId:T.id};if(T.root){D=Object(z.t)(C);for(k=0,O=D;k<O.length;k++){$=O[k];o.mapKeys({mappings:(J={},J[$]=this._rootItemKey,J)})}}else if(T.webUrl&&(M=Object(W.n)(T.webUrl))){_=X.e.serialize({itemFullUrl:M});if(e(Object(I.e)({spItemKey:B.e},_)).spItemKey){D=Object(z.t)(C);for(P=0,j=D;P<j.length;P++){$=j[P];o.mapKeys({mappings:(K={},K[$]=_,K)})}}}if(!T.root){T.parentReference&&(N=T.parentReference.id);E.push({itemKey:U.e.serialize(C),parentItemKey:N&&U.e.serialize({endpoint:n.endpoint,driveId:n.driveId,itemId:N}),isDeleted:!!T.deleted,isShared:!!T.shared,name:T.name,dateModified:T.lastModifiedDateTime,eTag:T.eTag})}}this._pendingRequest=!1;return[2,{syncToken:w["@delta.token"],messages:E,itemResolver:o}]}})})};e.prototype.updateItems=function(e,t,n){};e.prototype.processMessage=function(e,t,n){if(t.isDeleted){if(e(Object(I.e)({deleted:d.l},t.itemKey)).deleted)return;return{type:r.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}var i=e(Object(I.e)({spItemKey:B.e,mediaTransformSchema:D.e,displayName:d.h},t.itemKey)),s=i.spItemKey,o=i.mediaTransformSchema,u=i.displayName;if(void 0===s){if(!t.parentItemKey)return;return{type:r.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(o&&t.eTag){var a=o[".etag"];if(a&&t.eTag&&t.eTag!==a)return{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:D.e,reason:"eTag changed from ".concat(a," to ").concat(t.eTag)}}if(void 0!==t.name&&u!==t.name)return{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:d.h,reason:"Name changed from ".concat(u," to ").concat(t.name)}};return e})(),J=n(284),K=n(36),Q=n(51),G=n(870),Y=n(49),Z=n(165),ee=n(154),te=n(558),ne={ODB:819,ODC:"EnablePushChannelLogging"},re=(function(){function e(e){this._dispatch=e.dispatch;this._webAbsoluteUrl=e.webAbsoluteUrl;this._listFullUrl=e.listFullUrl;this._listId=e.listId}e.prototype.getSocketIoSubscription=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,r,i,s,o,u,f,c,h,p,d,v,m,g;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(e.existingSubscription)return[3,5];n=Object(te.n)({webAbsoluteUrl:this._webAbsoluteUrl}).segments("microservicemanager","getserviceurls").parameter("service","push");return[4,this._dispatch(Object(ee.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:n.toString(),method:"GET",qosName:"GetServiceUrls",noRedirect:!0})).catch(function(e){Z.n.isFeatureEnabled(ne)&&console.log("Error getting service url: ",e)})];case 1:r=a.sent();i=this._dispatch(Object(R.e)({isTest:A.x})).isTest;if(!(s=r&&r.d&&r.d.GetServiceUrls&&r.d.GetServiceUrls.results&&r.d.GetServiceUrls.results[0])&&!i)throw new Error("Unable to retrieve PushChannel base url");i&&(s="https://northcentralus0-pushs.svc.ms");o="".concat(s,"/notifications/register");u=Y.e.generate();f=this._dispatch(Object(l.e)({name:"SubscriptionServiceGenericList.Register"}));c={correlationId:u};a.label=2;case 2:a.trys.push([2,4,,5]);return[4,G.e.start({url:o,method:"GET",headers:{"X-Correlation-Id":u},requestTimeoutInMS:1e4})];case 3:(h=a.sent())&&h.responseText&&h.responseText.length>0&&(p=JSON.parse(h.responseText))&&p.serverUrl&&p.webhookUrl&&(t=p.webhookUrl);if(void 0===t)throw new Error("Unable to retireve PushChannel notification url");this._dispatch(f({resultType:Q.t.success,extraData:c}));return[3,5];case 4:d=a.sent();this._dispatch(f({resultType:Q.t.failure,extraData:c}));throw d;case 5:v=Object(te.r)({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId);if(e.existingSubscription){v=v.method("Subscriptions",{guid:e.existingSubscription.id}).segment("Update");t=e.existingSubscription.notificationUrl}else v=v.segments("Subscriptions","Add");m={parameters:{resource:this._listId,notificationUrl:t,expirationDateTime:new Date(Date.now()+3e5).toISOString(),clientState:""}};return[4,this._dispatch(Object(ee.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:v.toString(),body:JSON.stringify(m),qosName:"SubscriptionServiceGenericList.getSocketIoSubscription",method:"POST",noRedirect:!0}))];case 6:if((g=a.sent())&&g.d){delete g.d.__metadata;if(e.existingSubscription){g.d.id=e.existingSubscription.id;g.d.notificationUrl=e.existingSubscription.notificationUrl;g.d.expirationDateTime=m.parameters.expirationDateTime}return[2,g.d]}throw new Error("Invalid subscription object")}})})};e.prototype.deleteSocketIoSubscription=function(e){var t=Object(te.r)({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId).method("Subscriptions",e.id);return this._dispatch(Object(ee.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:t.toString(),qosName:"SubscriptionServiceGenericList.deleteSocketIoSubscription",method:"DELETE",noRedirect:!0}))};return e})(),ie=n(333),se=n(47),oe=n(125),ue=n(334),ae=n(216),fe=(function(){function e(e){this._pushChannelService=e.pushChannelService;this._subscriptionService=e.subscriptionService;this._webAbsoluteUrl=e.webAbsoluteUrl;this._listFullUrl=e.listFullUrl;this._itemSetKey=e.itemSetKey;this._serverResponse=void 0;this._pendingRequest=!1}e.prototype.onUnsubscribe=function(e){if(0===e&&this._subscriptionService instanceof re){var t=this._pushChannelService.getSocketIoSubscription();t&&this._subscriptionService&&this._subscriptionService.deleteSocketIoSubscription(t)}};e.prototype.getSubscription=function(e){if(this._webAbsoluteUrl&&this._listFullUrl){var t=F.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),n=e(Object(q.e)(function(e){return e.demandItemFacet(H.Ye,t)}));if((null==n?void 0:n.notificationUrl)&&(null==n?void 0:n.expirationDateTime)&&(null==n?void 0:n.subscribeID))return{notificationUrl:null==n?void 0:n.notificationUrl,expirationDateTime:null==n?void 0:n.expirationDateTime,id:null==n?void 0:n.subscribeID}}};e.prototype.getChangeMessages=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var n,r,i,s,o,u,f,l,c,h,p,d,m,g,b,w,E,S,x,T,N,C,k,L,O,M,_,D,P,j,I,U,z,W=this;return Object(a.__generator)(this,function(X){switch(X.label){case 0:if("latest"===t){n=F.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl});r=e(Object(q.e)(function(e){return e.demandItemFacet(H.Ve,n)}));if(i=null==r?void 0:r.lastItemModifiedTime){s=new v.e;return[2,{syncToken:"".concat("SPO_LIST,").concat(i),messages:[],itemResolver:s}]}}this._pendingRequest=!0;if(f=!!t&&"SPO_LIST,"===t.substr(0,9)){l=t.split(",");c=l[1];h='<Gt><FieldRef Name="Modified" />';h+='<Value Type="DateTime" IncludeTimeValue="True" StorageTZ="True">'.concat(c,"</Value>");o=h+="</Gt>";u=["ID","FileRef","Modified","Title"];p=this._getListColumns(e);for(d=0,m=p;d<m.length;d++)"ID"!==(g=m[d]).internalName&&"FileRef"!==g.internalName&&"Modified"!==g.internalName&&"Title"!==g.internalName&&u.push(g.internalName)}else{if(!y.t.isActivated("9e144a63-594c-45c9-8189-a4b0eb40e708","10/26/2021","Return empty messages and current time as sync token for initial sync")){this._pendingRequest=!1;return[2,{syncToken:"SPO_LIST,".concat((new Date).toISOString()),messages:[],itemResolver:new v.e}]}u=["ID","FileRef","Modified"]}"ID";b=f;w=f?200:1;E=new J.e("<View></View>");o&&E.addFilters([o]);u&&E.replaceFields(u);E.updateSort({fieldName:"ID",isAscending:b});E.updateRowLimit({rowLimit:w,isPerPage:!1});S=e(Object(q.e)(function(e){return Object(se.e)(e,B.e.serialize({webAbsoluteUrl:W._webAbsoluteUrl,listFullUrl:W._listFullUrl}))}));return[4,e(Object(R.e)({isTAB:A.x}))];case 1:x=X.sent().isTAB;this._requestDatesInUtc=!S;return[4,e(Object(ie.e)({getItemContext:Object(a.__assign)(Object(a.__assign)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,qosName:"ItemAutoRefreshGenericList.GetChanges",viewXml:E.getEffectiveViewXml()},x?{}:{isBackground:!0}),{postDataContext:{requestDatesInUtc:this._requestDatesInUtc,needsSchema:!0},currentPageContext:S})}))];case 2:T=X.sent();this._serverResponse=T;N=T.ListData;C=N&&N.Row||[];k=[];L=f?this._getLastModifiedTimeInList(C,S):(new Date).toISOString();for(O=0,M=C;O<M.length;O++)if(void 0!==(_=M[O]).FileRef){D={};P=Object.keys(_);for(j=0,I=P;j<I.length;j++){U=I[j];z=0===U.indexOf("OData_")?U.substr(6):U;D[z]=_[U]}k.push(Object(a.__assign)(Object(a.__assign)({itemKey:B.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,itemId:_.ID}),parentItemKey:B.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1,name:_.Title||""},_.Modified?{dateModified:"".concat(_.Modified)}:{}),{fields:D}))}0===k.length&&k.push({itemKey:B.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1});this._pendingRequest=!1;return[2,{syncToken:"SPO_LIST,".concat(L),messages:k,itemResolver:new v.e}]}})})};e.prototype.hasPendingRequest=function(){return this._pendingRequest};e.prototype.updateItems=function(e,t){if(t&&o.e.matches(this._itemSetKey)&&this._serverResponse){var n=o.e.deserialize(this._itemSetKey),r={webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl,rootFolder:n.rootFolder||""},i=e(Object(ae.n)({itemSetKey:r})),s=e(Object(ae.e)(n,i,"getSPItem")),u=e(Object(ue.t)({serverData:this._serverResponse,itemSetKey:r,contentTypes:i,currentPageContext:s.currentPageContext,isItemSetRequest:!1})).itemResolver;e(u.execute())}this._serverResponse=void 0};e.prototype.processMessage=function(e,t,n){var i=e(Object(q.e)(function(e){var r=Object(oe.e)(e,{itemsScopeItemKey:n});return e.isItemFacetResolved(B.e,t.itemKey)?{rowData:e.demandItemFacet(H.Bt,t.itemKey),spItemKey:e.demandItemFacet(B.e,t.itemKey),title:e.demandItemFacet(H.Cn,t.itemKey),selectedItemKeys:r}:{rowData:void 0,spItemKey:void 0,title:void 0,selectedItemKeys:r}})),s=i.rowData,o=i.spItemKey,u=i.title,a=i.selectedItemKeys,f=a&&a.length>0;if(void 0===t.parentItemKey){if(f)return;return{type:r.New,invalidateKey:t.itemKey,reason:"Deleted an unknown item"}}if(t.isDeleted){if(e(Object(I.e)({deleted:d.l},t.itemKey)).deleted||f)return;return{type:r.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}if(void 0===o||void 0===s){if(!t.parentItemKey)return;if(void 0===e(Object(I.e)({spParentItemKey:B.e},t.parentItemKey)).spParentItemKey)return;return f?void 0:{type:r.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(void 0!==u&&void 0!==t.name&&u!==t.name)return{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:H.Cn,hasSelection:f,reason:'Item title changed from "'.concat(u,'" to ').concat(t.name,")")};if(t.fields){f||(this._serverResponse=void 0);for(var l=this._getListColumns(e),c=function(e){for(var n=e.internalName,i=0,o=Object.keys(t.fields).filter(function(e){return e!==n+".COUNT"&&0===e.indexOf(n)});i<o.length;i++){var u=o[i],a=s&&s[u],l=t.fields[u];try{"object"==typeof a&&(a=JSON.stringify(a));"object"==typeof l&&(l=JSON.stringify(l));if(h._requestDatesInUtc&&"DateTime"===e.fieldType){var c=Date.parse(a),p=Date.parse(l);if(!isNaN(c)&&!isNaN(p)){a=c;l=p}}}catch(e){continue}if(a!==l)return{value:{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:H.Bt,hasSelection:f,reason:'Item field "'.concat(n,'" changed from "').concat(a,'" (').concat(typeof a,")")+' to "'.concat(l,'" (').concat(typeof l,")")}}}},h=this,p=0,v=l;p<v.length;p++){var m=c(v[p]);if("object"==typeof m)return m.value}}};e.prototype._getLastModifiedTimeInList=function(e,t){var n=(new Date).toISOString();if(e&&e.length>0)for(var r=void 0,i=0,s=e;i<s.length;i++){var o=s[i];if(this._requestDatesInUtc){var u=o.Modified;if(u){f=new Date(u);if(void 0===r||r<f){r=f;n="".concat(u)}}}else{var a=o["Modified."];if(a){var f=new Date(a),l=t&&t.webTimeZoneData?t.webTimeZoneData.Bias-f.getTimezoneOffset():0;l&&f.setTime(f.getTime()+6e4*l);if(void 0===r||r<f){r=f;n=f.toISOString()}}}}return n};e.prototype._getListColumns=function(e){var t=[],n=e(Object(I.e)({schema:p.o},this._itemSetKey)).schema,r=n&&n.columnKeys;if(r)for(var i=0,s=r;i<s.length;i++){var o=s[i],u=e(Object(I.e)({internalName:H.Le,fieldType:H.de,mappedFieldType:H.Ze},o)),a=u.internalName,f=u.fieldType,l=u.mappedFieldType;void 0!==a&&void 0!==f&&void 0!==l&&l!==K.t.Title&&t.push({internalName:a,fieldType:f,mappedFieldType:l})}return t};return e})(),le=n(205),ce=n(312),he=n(56),pe=n(7),de=n(181),ve=n(214),me=n(155),ge=n(2681),ye=(function(){function e(e){this._connectionCallbacks={};this._notificationCallback=void 0;this._notificationId=void 0;this._siteId=e.siteId;this._listId=e.listId;this._isConnected=!1;this._client=e.dataSyncClient}e.prototype.isConnected=function(){return this._isConnected};e.prototype.getSocketIoSubscription=function(){};e.prototype.addConnectionHandler=function(e,t){this._connectionCallbacks[e]=t};e.prototype.removeConnectionHandler=function(e){this._connectionCallbacks[e]&&delete this._connectionCallbacks[e]};e.prototype.setupNotificationHandler=function(e,t){this._notificationCallback=t;return!0};e.prototype.disconnect=function(){this._notificationCallback=void 0;this._connectionCallbacks={};this._notificationId&&this._client&&this._client.removeListStatusCallback(this._notificationId);this._isConnected=!1};e.prototype.refreshSubscription=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2,!0]})})};e.prototype.connect=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,r,i,s;return Object(a.__generator)(this,function(o){switch(o.label){case 0:t=(e=this)._client,n=e._siteId,r=e._listId;i={siteId:n,listId:r};return[4,t.isListDataSyncEnabledAsync(i)];case 1:if(!o.sent())return[3,3];s=this;return[4,t.addListStatusCallbackAsync(this._onNotification.bind(this),i,{sendConnectionNotifications:!0})];case 2:s._notificationId=o.sent();return[2,!0];case 3:return[2,!1]}})})};e.prototype._onNotification=function(e){if(1===e.length){var t=e[0];t.dataRefreshNeeded?this._notificationCallback&&this._notificationCallback(void 0):t.state===ge.e.ListStatusConnected?this._notifyConnectionHandlers(!0):t.state===ge.e.ListStatusConnectionLost&&this._notifyConnectionHandlers(!1)}};e.prototype._notifyConnectionHandlers=function(e){this._isConnected=e;for(var t in this._connectionCallbacks)this._connectionCallbacks.hasOwnProperty(t)&&this._connectionCallbacks[t](e)};return e})(),be=n(232),we={ODB:860},Ee={ODB:818},Se=new pe.e("itemAutoRefreshHelper",{itemsScopeItemKey:Object(pe.s)(),spPageContextKey:Object(pe.s)()}),xe=Object(ce.e)(function(e){return{}});function Te(e){var t=e.spPageContextKey,n=e.pageContext,r=e.listId,i=e.webAbsoluteUrl,s=e.listFullUrl,o=e.isTAB,u=e.itemKey,a=e.driveUrl,f=e.itemsScopeItemKey,c=e.getDataSyncClient;return function(h){var p=h(xe),d=Se.serialize({itemsScopeItemKey:f,spPageContextKey:t}),v=p[d];if(!v){var m,g=void 0,b=void 0,w=!n||!Object(y.n)(n).isActivated("f3c67c53-3465-4927-924d-963e1011836b","09/29/2020","Skip checking the subscription service");if(c&&e.pushChannelService&&(w||e.subscriptionService)){g=e.pushChannelService;b=e.subscriptionService}else{if(n){var E=h(k.e).dataRequestor;b=new O.e({listId:r,webAbsoluteUrl:i},{dataRequestor:E})}else b=new re({dispatch:h,webAbsoluteUrl:i,listFullUrl:s,listId:r});g=new M.e({disableWebSockets:!0},{subscriptionService:b})}m=new fe({pushChannelService:g,subscriptionService:b,webAbsoluteUrl:i,listFullUrl:s,itemSetKey:u});v=p[d]=new C({id:d,isTestMode:o,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},onNotificationReceived:function(){return window._tabPushNotification=!0},driveUrl:a,dispatch:h,template:m,itemsScopeItemKey:f,pushChannelService:g,logQoS:function(e){var t=h(Object(l.e)(e));return function(e){return h(t(e))}},onUnsubscribe:function(e){0===e&&delete p[d]}})}return v}}function Ne(e){var t=Object(le.t)();f.useLayoutEffect(function(){if(e.getDataSyncClient){var n=new Promise(function(n){(function(e){var t=this,n=e.pageContext,r=e.listId,i=e.getDataSyncClient;return i?i.then(function(i){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,s,o;return Object(a.__generator)(this,function(u){switch(u.label){case 0:t=void 0;s=void 0;return(o=i&&n&&r&&n.siteId)?[4,i.isListDataSyncEnabledAsync({listId:r,siteId:n.siteId})]:[3,2];case 1:o=u.sent();u.label=2;case 2:if(o){t=new ye({listId:r,siteId:n.siteId,dataSyncClient:i});s=void 0;return[2,Te(Object(a.__assign)(Object(a.__assign)({},e),{subscriptionService:s,pushChannelService:t}))]}return[2,Te(e)]}})})}):Promise.resolve(Te(e))})(e).then(function(e){var r=t(e);n(r.subscribe())})});return function(){n.then(function(e){return e()})}}return t(Te(e)).subscribe()},[]);return null}function Ce(e){var t=Object(le.t)();f.useLayoutEffect(function(){return t((function(e){var t=this,n=e.spPageContextKey,r=e.webAbsoluteUrl,i=e.listFullUrl,s=e.isTAB,o=e.driveUrl,u=e.endpoint,f=e.itemsScopeItemKey;return function(e){var c=e(xe),h=Se.serialize({itemsScopeItemKey:f,spPageContextKey:n}),p=c[h];if(!p){var d,v,m=e(k.e).dataRequestor;v=new $({dataRequestor:m,rootItemKey:B.e.serialize({webAbsoluteUrl:r,listFullUrl:i,rootFolder:""})});d=new M.e({disableWebSockets:!0},{subscriptionService:new O.e({},{dataRequestor:m}),sessionTokenFetcher:function(){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,n,r;return Object(a.__generator)(this,function(i){switch(i.label){case 0:return(n=u)?[4,e(Object(L.getSessionToken)({endpoint:u,driveUrl:o}))]:[3,2];case 1:n=i.sent();i.label=2;case 2:if(!(r=(t=n)&&t.accessToken))throw new V.e({code:"authFailure"});return[2,{accessToken:r,tokenUrl:o}]}})})}});p=c[h]=new C({id:h,isTestMode:s,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},onNotificationReceived:function(){return window._tabPushNotification=!0},driveUrl:o,dispatch:e,itemsScopeItemKey:f,template:v,pushChannelService:d,logQoS:function(t){var n=e(Object(l.e)(t));return function(t){return e(n(t))}},onUnsubscribe:function(e){0===e&&delete c[h]}})}return p}})(e)).subscribe()},[]);return null}var ke=Object(c.t)()(function(){return function(e){return function(e,t){var n,r=t.itemKey;if(!r)return{};var i=e.demandItem({key:o.e},r).key;if(!i||!i.webAbsoluteUrl||!i.listFullUrl)return{};var s=i.webAbsoluteUrl,u=i.listFullUrl,a=j.e.serialize({webAbsoluteUrl:s,listFullUrl:u}),l=e.demandItemFacet(H.gn,a);if(!Object(P.e)(e,{feature:we,pageContext:l})||!Object(P.e)(e,{feature:Ee,pageContext:l}))return{};var c=Object(be.c)(function(t){return Object(P.e)(e,{feature:t})},be.e.SharePointList)?null===(n=e.demandItemFacet(H.Qt,me.e))||void 0===n?void 0:n.dataSyncClient:void 0,p=F.e.serialize({webAbsoluteUrl:s,listFullUrl:u}),d=e.demandItem({listFacets:H.Ve,listMediaTransformSchema:D.t},p),v=d.listFacets,m=d.listMediaTransformSchema;if(!v||void 0===v.id||void 0===v.templateType)return{};var g=v.isDocumentLibrary,y=_.s(v.templateType);if(!g&&!y)return{};var w,E=Object(h.e)(e,{isTAB:A.x}).isTAB,S=m&&m[".driveUrl"],x=S&&Object(b.e)(S),T=x&&x.endpoint,N=Object(he.e)(e).itemsScopeItemKey||"itemsSCopeItemKey";if(g&&!S)return{};var C=Object(de.e)(e,{itemsScopeItemKey:N});if(C&&C.id===ve.e.id)return{};if(g){if(!m)return{};if(!S)return{};if(E){var k=m[".driveAccessToken"];w=k&&k.replace("access_token=","")}if(!x)return{};var L=x.driveId;return T&&L?{isAvailable:!0,itemSubscriber:f.createElement(Ce,{spPageContextKey:a,driveUrl:S,isTAB:E,listFullUrl:u,endpoint:T,driveAccessToken:w,webAbsoluteUrl:s,pageContext:l,itemsScopeItemKey:N})}:{}}return{isAvailable:!0,itemSubscriber:f.createElement(Ne,{spPageContextKey:a,isTAB:E,itemKey:r,listFullUrl:u,webAbsoluteUrl:s,listId:v.id,pageContext:l,driveUrl:S,itemsScopeItemKey:N,getDataSyncClient:c})}}}});var Le=Object(i.t)(function(){return function(e){e(Object(s.e)(o.e,u.e)(ke))}})},5223:function(e,t,n){"use strict";n.r(t);n.d(t,"constrainLibrariesDropdownSizeKillswitchIsActive",function(){return O});n.d(t,"fixFocusKillswitchIsActive",function(){return M});n.d(t,"ItemLibrariesDropdown",function(){return H});n.d(t,"LibrariesDropdown",function(){return B});var r=n(0),i=n("react-lib"),s=n(119),o=n(4461),u=n(176),a=n(86),f=n(105),l=n(731),c=n(37),h=n(9),p=n(5),d=n(42),v=n(1),m=n(580),g=n(129),y=n(11),b=n(265),w=n(29),E=n(803),S=n(14),x=n(6),T=new x.e("LibrariesDropdown",{isAvailable:x.t}),N=n(145),C=n(127),k=n(190),L=n(78),A=n(23),O=A.t.isActivated("511cf8c4-478d-4428-be23-88fdb3dc803a","03/28/2022",'Constrain the size of the libraries dropdown so that very very long library names don"t break it'),M=A.t.isActivated("32E14D10-7F57-4A91-BF35-B6FB88FAD6F1","05/12/2022","Fix the focus style of the dropdown in all endpoints."),_=Object(L.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(5,1862)];case 1:return[2,e.sent().ActionContextMenu]}})})}),D={component:"LibrariesDropdown;"},P=Object(N.t)({withContext:D}),H=Object(k.n)(P)(function(e){var t,n=i.useRef(null),r=i.useState(!1),S=r[0],x=r[1],k=Object(g.e)(function(){return x(!1)}),L=Object(c.e)("librariesDropdown_c258b0e8",e.className,S?"librariesDropdownOpen_c258b0e8":"librariesDropdownNotOpen_c258b0e8",((t={}).librariesDropdownWithFocus_c258b0e8=!M,t));return i.createElement(u.e,null,function(t){var r,u=t.itemCache,g=(t.dispatch,null===(r=Object(N.n)(u))||void 0===r?void 0:r.telemetry),A=e.itemKey,M=u.demandItemFacet(d.e,A),D=u.demandItemFacet(a.e,A),P=Object(E.e)(u);if(M||D){var H=Object(w.e)(u,{enableLibrariesDropdown:v.q}).enableLibrariesDropdown,B=void 0,j=void 0,F=void 0;if(M){B=M.webAbsoluteUrl;j=M.rootFolder;F=f.e.serialize(M)}else{if(!D)return null;B=D.webAbsoluteUrl;j=D.rootFolder;F=f.e.serialize(D)}var I=u.demandItemFacet(v.Ve,F),q=!(P||!H||!I||I.templateType!==y.n.documentLibrary||""!==j),R=u.demandItemFacet(T,A);if(!T.evaluate(R)(u,{itemKey:A,isAvailable:q}).isAvailable)return null;var U=[],z=null;if(S){var W=u.demandItemFacet(h.e,l.e.serialize({webAbsoluteUrl:B}));if(W&&W.itemKeys&&W.itemKeys.length){z=function(){g&&g(C.e).logData({name:"LibrariesDropdown.Load",component:"LibrariesDropdown;",objectType:"Libraries",extraData:{numberOfLibraries:W.itemKeys.length},isIntentional:!0})};U=W.itemKeys.map(function(e){return{key:e,name:u.demandItemFacet(p.h,e)||"",action:i.createElement(b.e,{itemKey:e})}})}}return i.createElement(i.Fragment,null,i.createElement("button",{className:L,onClick:S?k:function(){g&&g(C.e).logData({name:"LibrariesDropdown.OpenDropdown",component:"LibrariesDropdown;",isIntentional:!0});x(!0)},ref:n,"aria-label":o.e,"aria-haspopup":"menu","aria-expanded":S?"true":"false",title:o.e},i.createElement(m.e,{iconName:"Library",className:Object(c.e)("librariesDropdownIcon_c258b0e8")}),i.createElement(m.e,{iconName:"ChevronDown",className:Object(c.e)("librariesDropdownChevron_c258b0e8")})),S?i.createElement(_,{commands:U,target:n.current,directionalHint:s.e.bottomLeftEdge,alignTargetEdge:!0,onDismiss:k,isOpen:!0,onMenuOpened:z||void 0,calloutProps:O?{}:{calloutMaxHeight:500,calloutMaxWidth:300}}):null)}return null})}),B=Object(S.e)()(H)}}]);