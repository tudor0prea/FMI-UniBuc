(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[480],{2114:function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return i});var r,i;(function(e){e[e.fail=0]="fail";e[e.partialSuccess=1]="partialSuccess";e[e.success=2]="success"})(r||(r={}));(function(e){e[e.pending=0]="pending";e[e.success=1]="success"})(i||(i={}))},2127:function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});n.d(t,"n",function(){return u});n.d(t,"u",function(){return a});n.d(t,"r",function(){return f});n.d(t,"i",function(){return l});n.d(t,"o",function(){return h});n.d(t,"s",function(){return p});var r=n(18),i=n(2268),s="_ComplianceTag",o="_ComplianceFlags",u=200;function a(e){return!!(256&e)}function f(e){if(!e.HasRetentionAction)return" ";if(0===e.TagDuration)return e.BlockDelete?i.RetainForeverText:" ";var t=c(e.TagDuration);return e.BlockDelete?r.format(i.PreserveTagText,t):e.AutoDelete?r.format(i.DeleteTagText,t):" "}function l(e){if(e.Notes)return e.Notes;if(!e.HasRetentionAction)return i.NoRetentionTooltip;if(0===e.TagDuration)return e.BlockDelete?i.PreserveForeverTooltip:i.NoRetentionTooltip;var t=c(e.TagDuration),n="",s="";if(e.BlockDelete){n="PreserveTag"+e.TagRetentionBasedOn+"Tooltip";e.BlockEdit&&(s=i.PreserveIsRecordTooltipModifier);e.ReviewerEmail?s+=i.ReviewTooltip:s+=e.AutoDelete?i.PreserveAutoDeleteTooltipModifier:i.PreserveNoDeleteTooltipModifier}else e.AutoDelete&&(n="DeleteTag"+e.TagRetentionBasedOn+"Tooltip");var o=i[n];return o?r.format(o,t)+s:null}function c(e){var t="";if(e>0){var n=Math.floor(e/365);if(n>0){var s=n>1?i.RetentionPeriodYears:i.RetentionPeriodYear;t=r.format(s,n)}else{var o=Math.floor(e/30);if(o>0){var u=o>1?i.RetentionPeriodMonths:i.RetentionPeriodMonth;t=r.format(u,o)}else{var a=e>1?i.RetentionPeriodDays:i.RetentionPeriodDay;t=r.format(a,e)}}}return t}function h(e){return!!(e&&e.schema&&(t=e.schema.FieldType,n=e.schema.Id,t&&"boolean"===t.toLowerCase()&&n&&n.toLowerCase()==="96BE7325-AFA4-48CF-8503-9258F0A7817D".toLowerCase()));var t,n}function p(e){return!!(e&&e.schema&&(t=e.schema.FieldType,n=e.schema.Id,t&&"lookup"===t.toLowerCase()&&n&&n.toLowerCase()==="D4B6480A-4BED-4094-9A52-30181EA38F1D".toLowerCase()));var t,n}},2146:function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(311),i=n(379);function s(e,t){var n=Object(r.e)(e).id;t&&t.urlParts&&(n===t.urlParts.fullListUrl||n===t.urlParts.serverRelativeListUrl)&&(n=void 0);return n}function o(e,t){var n=e;0!==n.indexOf("id")&&(n=Object(i.e)({id:e,listurl:t}));return n}},2244:function(e,t,n){"use strict";n.d(t,"e",function(){return re});var r=n(59),i=n(161),s=n(165),o=n(319),u=n(0),a=n(64),f=n(2091),l=n(1168),c=n(1684),h=n(641),p=n(2114),d=n(348),v=n(874),m=n(400),g=n(642),y=n(94),b=n(2300),w=n(1205),E=n(880),S=n(2282),x=n(1206),T=n(11),N=(function(){function e(e){this._listContext=e.listContext;this._pageContext=e.pageContext;this._itemStore=e.itemStore}e.prototype.processData=function(e,t){Object(w.updateListContext)(t,this._listContext);Object(w.updateListContextGroupInfo)(this._listContext);var n=t.ListSchema&&"TRUE"===t.ListSchema.Collapse,r=this._processSchema(t.ListSchema),i=t.ListContenTypes,s=t.ListData||t,o=S.e.buildRootItem(e,t,this._listContext,this._itemStore),u=this._processItems(s,n,o);return{root:o,items:u.items,groups:u.groups,totalCount:u.totalCount,startIndex:this._getStartIndex(s),columns:r,contentTypes:i,nextRequestToken:this._getNextRequestToken(s),isAllGroupsCollapsed:n}};e.prototype._processSchema=function(e){if(e){var t={},n={hasFixedSchema:this._listContext.listTemplateType===T.n.mySiteDocumentLibrary};this._listContext.listSchema=Object(E.buildSchema)(e,this._listContext,n,t);Object.keys(t).length&&(this._listContext.groupSchema=t)}return this._listContext.listSchema};e.prototype._processItems=function(e,t,n){var r;(r=t?x.e.buildCollapsedGroups(e.Row,this._listContext):S.e.buildItems(e,this._listContext,this._pageContext,n,this._itemStore)).groups&&r.groups.length>0&&(this._listContext.lastGroup=r.groups[r.groups.length-1]);return{items:r.items?r.items:[],groups:r.groups,totalCount:r.totalCount}};e.prototype._getStartIndex=function(e){var t=0;this._listContext.group?t=this._listContext.group.startIndex:e.FirstRow&&(t=e.FirstRow-1);return t};e.prototype._getNextRequestToken=function(e){var t="";e.NextHref&&(t=(t=e.NextHref).replace("&View=00000000-0000-0000-0000-000000000000",""));return t};return e})(),C=n(2247),k=n(2276),L=n(2127),A=n(127),O=n(50),M=n(79);function _(e,t){void 0===t&&(t=1);try{for(var n=e.fields.length,r=0;r<n;r++)if("TaxonomyFieldType"===e.fields[r].schema.FieldType||"TaxonomyFieldTypeMulti"===e.fields[r].schema.FieldType){var i=D(e.fields[r].serverData,e.fields[r].data);if(0===i.addedTagsCount&&0===i.deletedTagsCount)continue;var s=e.fields[r].schema.FieldType.toLowerCase();e.isBulkEdit||t>1?s+=".BulkEdit.":s+=".NotBulkEdit.";s+="OnChangingTags";for(var o=0;o<t;o++)A.e.logData({name:s,isIntentional:!0,extraData:{deletedTagsCount:i.deletedTagsCount,addedTagsCount:i.addedTagsCount}})}}catch(e){M.e.logError(e,{eventName:"OnChangingTags"});return}}function D(e,t){var n=P(e),r=P(t),i=0,s=Object.keys(n).length,o=Object.keys(r).length;if(s>0&&o>0)for(var u in n)r[u]&&i++;return{deletedTagsCount:s-i,addedTagsCount:o-i}}function P(e){if(!e)return{};for(var t={},n=0,r=e.split(";");n<r.length;n++){t[r[n]]=!0}delete t[""];return t}var H=n(23),B=n(1203),j=n(91),F=n(2270),I=n(872),q="0x0120",R={ODB:788,OneDrive:!0},U={ODB:573,OneDrive:!0},z={ODB:1261},W={ODB:1310},X={ODB:1293},V={ODB:60087,ODC:!1,OneDrive:!1,Fallback:!1},$={ODB:60092,ODC:void 0,Fallback:!1},J=1,K=2,Q=4,G=8,Y=16,Z=H.t.isActivated("3C62A64E-2514-4799-94EF-1E3FE4E4E7E0","02/22/2022","revert read contentTypd from server response instead of client-side caching"),ee=H.t.isActivated("DC2F1582-A7C4-4DDA-AB48-39490F5EBB18","04/18/2022","fix event fields on update"),te=(function(e){Object(u.__extends)(t,e);function t(t,n){var r=e.call(this,{},n)||this;r._clientForms=null;r._init=function(e,t){var n=t.pageContext,i=t.apiUrlHelper,o=t.itemUrlHelper;r._itemUrlHelper=o||new d.e({},{pageContext:n});r._apiUrlHelper=i||new g.e({},{itemUrlHelper:r._itemUrlHelper,pageContext:n});e.complianceTagProvider?r._complianceTagProvider=e.complianceTagProvider:r._complianceTagProvider=new k.e({pageContext:n});e.fileUploaderProvider?r._fileUploaderProvider=e.fileUploaderProvider:r._fileUploaderProvider=new C.e({pageContext:n});r.isFeatureEnabled=e.isFeatureEnabled?e.isFeatureEnabled:function(e){return s.n.isFeatureEnabled(e,r._pageContext&&r._pageContext.ExpFeatures)}};r._getAdditionalPostData=function(e){e.isListDataRenderOptionChangeFeatureEnabled=r.isFeatureEnabled(R);e.isSpotlightFeatureEnabled=r.isFeatureEnabled(U);return m.e(e)};r._init(t,n);return r}Object.defineProperty(t.prototype,"listContext",{set:function(e){this._listContext=e},enumerable:!1,configurable:!0});t.prototype.updateContext=function(e,t){this._init(e,t)};t.prototype.getClientFormSchema=function(e,t,n){var i,s=this,o=function(){var r=s._locateClientFormWithContentTypeInfos(e,t);if(n&&r&&r.fields){var i=r.fields.filter(function(e){return!s._isFieldRequireUniqueValue(e)});return Object(u.__assign)(Object(u.__assign)({},r),{fields:i})}return r};2===e&&t&&this._contentTypeIdToNameMap&&(i=this._contentTypeIdToNameMap[t[0].contentTypeId]);if(null===this._clientForms||this._listContext.refreshClientForm||!i){this._listContext.refreshClientForm=void 0;return this.fetchAllClientFormSchemas().then(function(){return o()})}return r.n.wrap(o())};t.prototype.getClientForm=function(e,t,n,i){var s=this;return new r.n(function(r,o){s.getData(function(){var t=a.e.encodeRestUriStringToken(s._listContext.listUrl),n=new O.t(window.location.href,{queryCaseInsensitive:!0}).getQueryParameter("VersionNo")||"0",r=",cutoffVersion=".concat(n),i=K+Q+G+Y;return"".concat(s._pageContext.webAbsoluteUrl,"/_api/web/GetList(@v1)")+"/RenderExtendedListFormData(itemId=".concat(e,",formId='editform',mode='2',options=").concat(i).concat(r,")")+"?@v1='".concat(t,"'")},function(e){if(null!=e){var t=JSON.parse(e);if(t.d.RenderExtendedListFormData){t=JSON.parse(t.d.RenderExtendedListFormData);n&&n.length>0&&!n[0].contentType&&t.ListData&&t.ListData.ContentType&&(n[0].contentType=t.ListData.ContentType);t.ListDataLite=t.ListData;t.ListData=t.Data;t.Data=void 0;return t}}return null},"GetItemDataForClientForm",function(){return""},"POST",s._getAdditionalHeaders()).then(function(e){var o=s._processGetClientFormServerData(e,t,n,i);r(o)},function(e){var t=e.code?e.code.split(","):e.error.code.split(","),n=t.length>1?Number(t[0]):-1;o({errorCode:n,message:e&&e.message?e.message.value?e.message.value:e.message:""})})})};t.prototype.updatePanelViewInfo=function(e){var t=this;return new r.n(function(n,r){t.getData(function(){var n=a.e.encodeRestUriStringToken(t._listContext.listUrl);return"".concat(t._pageContext.webAbsoluteUrl,"/_api/web/GetList(@v1)")+"/contentTypes('".concat(e.contentTypeId,"')")+"/ReorderFields()"+"?@v1='".concat(n,"'")},function(){return null},"CustomPanelSaveDataToServer",function(){return JSON.stringify({fieldNames:e.data})}).then(function(){n(e.serverResponse({message:{value:"updated Information"}}))},function(t){r(e.serverResponse(t))})})};t.prototype.saveCustomShowHideRules=function(e,t,n){var r=this,i={__metadata:{type:"SP.Field"},ClientValidationFormula:e.rules,ClientValidationMessage:e.errMsg};return this.getData(function(){return r._getListApiUrl(t).segment("Fields").method("GetByInternalNameOrTitle",n).toString()},function(e){return e},"saveCustomValidationRules",function(){return JSON.stringify(i)},"MERGE")};t.prototype._isFieldRequireUniqueValue=function(e){var t=e.FieldType.toLowerCase(),n=e.Name;return"file"===t||"attachments"===t||"Title"===n||"LinkTitle"===n||"LinkTitleNoMenu"===n||"thumbnail"===t};t.prototype._getListApiUrl=function(e){var t=this._itemUrlHelper.getUrlParts({path:e||this._pageContext.listUrl,listUrl:e||this._pageContext.listUrl});return this._apiUrlHelper.build().webByItemUrl(t).method("GetList",t.serverRelativeListUrl)};t.prototype.saveClientFormCustomFormatter=function(e,t){var n=this,r={__metadata:{type:"SP.ContentType"},ClientFormCustomFormatter:JSON.stringify(e.ClientFormCustomFormatterJson)};return this.getData(function(){return n._getListApiUrl(t).segment("contentTypes('"+e.ContentTypeId+"')").toString()},function(e){return e},"saveCustomFormFormatterJSON",function(){return JSON.stringify(r)},"MERGE")};t.prototype.getClientFormCustomFormatter=function(e,t){var n=this;return this.getData(function(){return n._getListApiUrl(t).segment("contentTypes('"+e+"')").toString()},function(e){return e},"GetCustomFormatter",null,"GET")};t.prototype.getResourceProviders=function(){return{ComplianceTagProvider:this._complianceTagProvider,FileUploaderProvider:this._fileUploaderProvider}};t.prototype._processGetClientFormServerData=function(e,t,n,r){var i=this,s=new N({listContext:this._listContext,pageContext:this._pageContext}).processData("parent",e),o=s&&s.items&&s.items[0];this._clientForms={};var a=e.ListSchema,f=e.ItemContentTypeId,l=e.ClientFormCustomFormatter;l&&(this._ctIdToClientFormCustomFormatter=l);if(a){a.New&&this._processClientFormResponse(2,a.New,f);if(a.Edit){this._processClientFormResponse(1,a.Edit,f);this._processClientFormResponse(3,a.Edit,f)}}var c=this._locateClientFormWithContentTypeInfos(t,n);if(r&&c&&c.fields){var h=c.fields.filter(function(e){return!i._isFieldRequireUniqueValue(e)});c=Object(u.__assign)(Object(u.__assign)({},c),{fields:h})}var p={item:o,formType:c.formType,contentType:c.contentType,contentTypeId:c.contentTypeId,fields:[],isBulkEdit:r,clientFormCustomFormatter:c.clientFormCustomFormatter};this._generateFieldsFromSchema(p,c);for(var d=[],v=0,m=p.fields;v<m.length;v++){if(0===(b=m[v]).state){b.state=2;d.push(b)}}2!==t&&this._handleServerData(p,e,{},d);for(var g=0,y=d;g<y.length;g++){var b;(b=y[g]).state=0}return p};t.prototype._generateFieldsFromSchema=function(e,t){for(var n=this._listContext&&(this._listContext.enableAttachments||void 0===this._listContext.enableAttachments),r=0,i=t.fields.length;r<i;r++){var s=t.fields[r];("Attachments"!==s.Type||n)&&!(e.isBulkEdit&&s.ReadOnlyField)&&e.fields.push(this._generateField(e,s))}};t.prototype._generateField=function(e,t){return{hasException:!1,errorMessage:"",schema:t,state:0}};t.prototype.updateFormValues=function(e,t){var n=this,i=e.item;if(!i||!i.properties||!i.properties.ID)return r.n.wrap();for(var s=[],o=0,u=e.fields;o<u.length;o++){var f=u[o];if(0===f.state){f.state=2;s.push(f)}}return this.getData(function(){var e=i.properties.ID,t=a.e.encodeRestUriStringToken(n._listContext.listUrl),r=J+K+Q+G,s=new O.t(window.location.href,{queryCaseInsensitive:!0}).getQueryParameter("VersionNo")||"0",o=",cutoffVersion=".concat(s);return"".concat(n._pageContext.webAbsoluteUrl,"/_api/web/GetList(@v1)")+"/RenderExtendedListFormData(itemId=".concat(e,",formId='editform',mode='2',options=").concat(r).concat(o,")")+"?@v1='".concat(t,"'")},function(e){if(null!=e){var t=JSON.parse(e);if(t.d.RenderExtendedListFormData)return t=JSON.parse(t.d.RenderExtendedListFormData)}return null},"GetItemDataForClientForm",function(){return""},"POST",this._getAdditionalHeaders(),"",0,!0).then(function(r){n._handleServerData(e,r,t,s);for(var i=0,o=s;i<o.length;i++){o[i].state=0}},function(e){for(var t=e.code?e.code.split(","):e.error.code.split(","),n=t.length>1?Number(t[0]):-1,i=0,o=s;i<o.length;i++){o[i].state=0}return r.n.wrapError({errorCode:n,message:e&&e.message?e.message.value?e.message.value:e.message:""})})};t.prototype.createItem=function(e){var t=this,n=this._getUrlInfo(),i=n.listUrl,s=n.itemUrlParts,o="AddValidateUpdateItemUsingPath",u=function(){return t._apiUrlHelper.build().webByItemUrl(s).method("GetList",i).method(o).toString()},a=!!e.clientForm.contentTypeId&&0===e.clientForm.contentTypeId.lastIndexOf(q,0),f=function(t){var n=e.rootFolder||i;return JSON.stringify({listItemCreateInfo:{__metadata:{type:"SP.ListItemCreationInformationUsingPath"},FolderPath:{__metadata:{type:"SP.ResourcePath"},DecodedUrl:n},UnderlyingObjectType:a?"1":void 0},formValues:t,bNewDocumentUpdate:e.newDocumentUpdate,checkInComment:e.checkInComment})};return this._ensureClientForms().then(function(){return t.isFeatureEnabled(W)&&t._fileUploaderProvider&&t._fileUploaderProvider.imageOperationsPool.length>0?t._updateImages(!0).then(function(n){var i=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()});t._fileUploaderProvider.imageOperationsPool=[];if(t.handleFileUploaderErrors(n,null,i)){n&&n.length>0&&n.forEach(function(t){if(t&&t.image){var n=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()&&e.schema.Name===t.image.fieldName})[0];if(n){var r=Object(I.e)(n.data);if(r){r.serverRelativeUrl=t.image.serverRelativeUrl;r.id=t.image.id;r.serverUrl=t.image.serverUrl}try{n.data=JSON.stringify(r)}catch(e){n.data=""}}}});return t._doCreateItem(u,f,e,o)}return r.n.wrap({status:p.e.fail})}):t._doCreateItem(u,f,e,o)})};t.prototype._doCreateItem=function(e,t,n,r){var i=this;return this._createOrUpdateItem("CreateItem",e,t,n,r).then(function(e){return i._postUpdateFields("CreateItem",n,[]).then(function(t){if(e.status===p.e.success&&t.status===p.e.fail){t.status=p.e.partialSuccess;return t}return e})})};t.prototype.updateItem=function(e){var t=this,n=e.clientForm.isBulkEdit&&e.itemdIds&&e.itemdIds.length>1?e.itemdIds:void 0,i=n&&n.length>1,s=function(e){var n=t._getUrlInfo(),r=n.listUrl,s=n.itemUrlParts;return i?t._apiUrlHelper.build().webByItemUrl(s).method("GetList",r).method("BulkValidateUpdateListItems").toString():t._apiUrlHelper.build().webByItemUrl(s).method("GetList",r).method("items",e.properties.ID).method("ValidateUpdateListItem").toString()},o=function(r){var s;i&&(s=t._listContext.folderPath);return JSON.stringify({itemIds:n,formValues:r,bNewDocumentUpdate:e.newDocumentUpdate,checkInComment:e.checkInComment,folderPath:s})};return this._ensureClientForms().then(function(){return t.isFeatureEnabled(W)&&t._fileUploaderProvider&&t._fileUploaderProvider.imageOperationsPool.length>0?t._updateImages(!1).then(function(u){var a=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()});t._fileUploaderProvider.imageOperationsPool=[];if(t.handleFileUploaderErrors(u,null,a)){u&&u.length>0&&u.forEach(function(t){if(t&&t.image){var n=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()&&e.schema.Name===t.image.fieldName})[0];if(n&&n.data!==n.serverData){var r=Object(I.e)(n.data);if(r){r.serverRelativeUrl=t.image.serverRelativeUrl;r.id=t.image.id;r.serverUrl=t.image.serverUrl}n.data=r?JSON.stringify(r):""}}});return t._doUpdateItem(s,o,e,i,n)}return r.n.wrap({status:p.e.fail})}):t._doUpdateItem(s,o,e,i,n)})};t.prototype._doUpdateItem=function(e,t,n,r,i){var s=this;return this._createOrUpdateItem("UpdateItem",e,t,n,r?"BulkValidateUpdateListItems":"ValidateUpdateListItem",i).then(function(e){return s._postUpdateFields("UpdateItem",n,i).then(function(t){if(e.status===p.e.success&&t.status===p.e.fail){t.status=p.e.partialSuccess;return t}return e})})};t.prototype.fetchAllClientFormSchemas=function(){var e=this;this._clientFormsDebouncer||(this._clientFormsDebouncer=new f.e);this._clientFormsDebouncer.isExecuting()||(this._clientFormsPromise=this._clientFormsDebouncer.debounce(this.getData(function(){return e._getServerConnectionUrl().toString()},function(t){e._clientForms={};var n=JSON.parse(t);n.ContentTypeIdToNameMap&&(e._contentTypeIdToNameMap=n.ContentTypeIdToNameMap);n.ClientFormCustomFormatter&&(e._ctIdToClientFormCustomFormatter=n.ClientFormCustomFormatter);var r=n.ClientForms;if(r){r.New&&e._processClientFormResponse(2,r.New);if(r.Edit){e._processClientFormResponse(1,r.Edit);e._processClientFormResponse(3,r.Edit)}}n.Navigation&&(e._listContext.leftNavigationData={quickLaunchNodes:n.Navigation.Nodes});e._listContext.enableAttachments="true"===n.EnableAttachments;n.FormRenderModes&&e._processFormRenderMode(n.FormRenderModes);(n.PowerAppFormId||n.AppId)&&(e._powerAppFormId=n.PowerAppFormId||n.AppId);n.AppRenderInfo&&(e._powerAppFormInfo=n.AppRenderInfo||{});n.AppAdditionalData&&(e._powerAppAdditionalData=n.AppAdditionalData);n.CachedFileUrlTemplate&&n.CacheAppFiles&&(e._powerAppFormCacheInfo=JSON.stringify({appFiles:n.CacheAppFiles,cachedFileUrlTemplate:n.CachedFileUrlTemplate}))},"GetClientForms",function(){return e._getAdditionalPostData({needsSchema:!1,viewXml:'<View><ViewFields><FieldRef Name="ID"/></ViewFields></View>',needsForms:!0,needsQuickLaunch:!1})},"POST",this._getAdditionalHeaders())));return this._clientFormsPromise};t.prototype.getFieldFilterData=function(e,t,n){return new b.e({parentKey:void 0,listContext:this._listContext,pageContext:this._pageContext,folderPath:n,itemUrlHelper:this._itemUrlHelper,apiUrlHelper:this._apiUrlHelper}).getFilterData(e,"",t,void 0)};t.prototype.getContentTypes=function(e){var t=[];if(this._clientForms&&this._clientForms[e])for(var n in this._clientForms[e])this._clientForms[e].hasOwnProperty(n)&&t.push({displayName:n,description:n,templateUrl:null});return t};t.prototype.hasFormRenderMode=function(e){var t=this;return this._ensureClientForms(function(){return t._checkRenderModes(e)})};t.prototype.getFormRenderMode=function(e,t){var n=this;return this._ensureClientForms(function(){return n._getFormRenderMode(e,t)})};t.prototype.getPowerAppFormId=function(){return this._powerAppFormId};t.prototype.getPowerAppRenderInfo=function(){return this._powerAppFormInfo};t.prototype.getPowerAppAdditionalData=function(){return this._powerAppAdditionalData};t.prototype.getPowerAppFormCacheInfo=function(){return this._powerAppFormCacheInfo};t.prototype.getPowerAppFormDesignUrl=function(e){var t=this;return this.getData(function(){return"".concat(t._pageContext.webAbsoluteUrl,"/_api/SP.Internal.FormsCustomization.GetPowerAppsFormDesignUrl?listName='")+e+"'&visualizationTarget=1"},function(e){var t=JSON.parse(e),n="";t.d&&t.d.Value&&(n=JSON.parse(t.d.Value));return n},"GetPowerAppFormDesignUrl",null,"GET")};t.prototype._getServerConnectionUrl=function(e){var t=this._itemUrlHelper.getUrlParts({listUrl:this._listContext.listUrl});return v.t({webUrl:this._pageContext.webAbsoluteUrl,listId:this._listContext.listId,urlParts:t,rootFolder:this._listContext.folderPath,requestToken:"?"})};t.prototype._processClientFormResponse=function(e,t,n){this._clientForms[e]||(this._clientForms[e]={});var r=this._clientForms[e];for(var i in t)if(t.hasOwnProperty(i)&&!r[i]){var s=n&&Z?n:this._reverseLookupContentTypeIdByName(i),o=this._ctIdToClientFormCustomFormatter?this._ctIdToClientFormCustomFormatter[s]:void 0;r[i]={contentType:i,contentTypeId:s,formType:e,fields:[],clientFormCustomFormatter:o?JSON.parse(o):void 0,mode:0};for(var u=r[i],a=t[i],f=0,l=a.length;f<l;f++)u.fields.push(a[f])}this._clientForms[e]=r};t.prototype._reverseLookupContentTypeIdByName=function(e){for(var t in this._contentTypeIdToNameMap)if(e===this._contentTypeIdToNameMap[t])return t;return null};t.prototype._processFormRenderMode=function(e){if(e)for(var t in e)for(var n in e[t]){var r=2;switch(n){case"Edit":r=1;break;case"Display":r=3}var i=0;switch(e[t][n].RenderType){case 1:i=2;break;case 2:i=3;break;case 3:i=4;break;case 4:i=5;break;default:l.e.logData({name:"ClientFormDataSource.InvalidFormRenderMode",message:"Server returned RenderType="+e[t][n].RenderType})}this._clientForms[r][t].mode=i}};t.prototype._locateClientFormWithContentTypeInfos=function(e,t){if(!t||!t.length)return this._locateClientForm(e,void 0,void 0);var n=t[0],r=this._locateClientForm(e,n.contentType,n.contentTypeId);if(1===t.length||!r||!r.fields)return r;for(var i=r.fields.slice(),s=function(n){if(0===i.length)return"break";var r=t[n],s=o._locateClientForm(e,r.contentType,r.contentTypeId);i=i.filter(function(e){for(var t=0,n=s.fields;t<n.length;t++){if(n[t].Name===e.Name)return!0}return!1})},o=this,a=1;a<t.length;a++){if("break"===s(a))break}return Object(u.__assign)(Object(u.__assign)({},r),{fields:i})};t.prototype._locateClientForm=function(e,t,n){!t&&n&&this._contentTypeIdToNameMap&&(t=this._contentTypeIdToNameMap[n]);if(!t&&this._clientForms[e])for(var r in this._clientForms[e])if(this._clientForms[e].hasOwnProperty(r)){t=r;break}if(n&&0===n.lastIndexOf(q,0)&&this._clientForms[e]&&!this._clientForms[e][t]){var i={FileLeafRef:1,Title:1,URL:1};for(var r in this._clientForms[e])if(this._clientForms[e].hasOwnProperty(r)){var s=this._clientForms[e][r].fields.filter(function(e){return!!i[e.Name]})[0];if(s){this._clientForms[e].Folder={contentType:"Folder",contentTypeId:n,formType:e,fields:[s],mode:0};return this._clientForms[e].Folder}}}if(!this._clientForms[e]||!this._clientForms[e][t]){if("folder"===t.toLowerCase()&&!n)for(var r in this._clientForms[e])if(this._clientForms[e][r]&&!this._clientForms[e][r].contentTypeId)return this._clientForms[e][r];return null}return this._clientForms[e][t]};t.prototype._getAdditionalHeaders=function(e){var t=v.r(this._listContext);if(this.isFeatureEnabled($)&&t&&e)if(2===e){t.Scenario="CreateListItem";t.ScenarioType="AUO"}else if(1===e){t.Scenario="EditListItem";t.ScenarioType="AUO"}return t};t.prototype._handleServerData=function(e,t,n,r){var i=t.ListDataLite?t.ListDataLite:t.ListData,s=t.ListDataLite?t.ListData.Row[0]:t.Data.Row[0],o=e.item;this._ctIdToClientFormCustomFormatter=t.ClientFormCustomFormatter;for(var u=0,a=r.length;u<a;u++){var f=r[u],l=f.schema;if(!n||!n.hasOwnProperty(l.Name)){void 0===f.data&&(f.data=null);void 0===f.serverData&&(f.serverData=null);if(i.hasOwnProperty(l.Name)){l.FieldType&&"boolean"===l.FieldType.toLowerCase()&&""===s[l.Name]&&"0"===i[l.Name]?f.serverData="":l.FieldType&&"thumbnail"===l.FieldType.toLowerCase()&&s[l.Name]?f.serverData=s[l.Name]:f.serverData=i[l.Name];o.hasOwnProperty(l.Name)||o.properties.hasOwnProperty(l.Name)||(o.properties[l.Name]=s[l.Name]);if(this.isFeatureEnabled(V)){o.properties.hasOwnProperty("ItemExpirationDate")||(o.properties.ItemExpirationDate=s._ExpirationDate);if(!o.properties.hasOwnProperty("IsItemExpirationModifiable")){var c=s.MetaInfo,h=c&&c[0]&&c[0].lookupValue||"",p=new RegExp(/vti_stream_isexpirationmodifiable:([a-zA-Z]{2})\|false/gi).test(h);o.properties.IsItemExpirationModifiable=!p}}}else if(L.s(f)){f.serverData=s[L.t];o.hasOwnProperty(l.Name)||o.properties.hasOwnProperty(l.Name)||(o.properties[l.Name]=s[l.Name])}else o.folder&&f.schema.FieldType&&"file"===f.schema.FieldType.toLowerCase()&&f.schema.Title&&"name"===f.schema.Title.toLowerCase()&&i.Title?f.serverData=i.Title:f.serverData=null;e.isBulkEdit&&(f.serverData=null);if(f.schema.AppendOnly){f.appendOnlyData=t[f.schema.Name];f.data=""}else f.data=f.serverData}}o.hasClientFormData=!0};t.prototype._createOrUpdateItem=function(e,t,n,i,s,o){var u=this,a=i.clientForm.fields,f=[],l=[],c={},h=[],d=!1,v=!1;1===i.clientForm.formType&&i.clientForm.item&&!i.clientForm.isBulkEdit&&this._listContext&&!this._listContext.isDocLib&&i.clientForm.item.properties&&"1"===i.clientForm.item.properties.FSObjType&&(v=!0);this.isFeatureEnabled(X)&&(o?_(i.clientForm,o.length):_(i.clientForm));for(var m=void 0,g=!1,b=0,w=a;b<w.length;b++){var E=w[b];if(null!==E.data&&void 0!==E.data){var S=E.data;if("thumbnail"===E.schema.FieldType.toLowerCase()&&"string"!=typeof S)try{S=JSON.stringify(S)}catch(e){}if(!this._isClientFormFieldUpdated(i,S,E.serverData,E)||"attachments"===E.schema.FieldType.toLowerCase()||L.s(E)||L.o(E)){c[E.schema.Name]=!0;ee||m||!this._isEventField(E)||(m=E)}else{f.push(E);var x=E.schema.Name;if("ContentType"===x){S=this._reverseLookupContentTypeIdByName(S.displayName);x="ContentTypeId";d=!0}l.push({FieldName:x,FieldValue:S,HasException:!1,ErrorMessage:null});ee||g||!this._isEventField(E)||(g=!0);"Title"===x&&v&&l.push({FieldName:"FileLeafRef",FieldValue:S,HasException:!1,ErrorMessage:null});var T=E.schema.FieldType.toLowerCase();A.e.logData({name:"ClientFormUpdate",extraData:{FieldType:T,Host:Object(B.e)()}})}}}!ee&&g&&m&&l.push({FieldName:m.schema.Name,FieldValue:m.data,HasException:!1,ErrorMessage:null});if(d){4096==(4096&this._listContext.flags2)&&l.push({FieldName:"PrimeCorrectedByUser",FieldValue:"true",HasException:!1,ErrorMessage:null})}else 2===i.clientForm.formType?l.push({FieldName:"ContentType",FieldValue:i.clientForm.contentType,HasException:!1,ErrorMessage:null}):1===i.clientForm.formType&&i.clientForm.item&&i.clientForm.item.properties&&!i.clientForm.isBulkEdit&&l.push({FieldName:"ContentTypeId",FieldValue:i.clientForm.item.properties.ContentTypeId,HasException:!1,ErrorMessage:null});if(0===f.length&&0===h.length)return r.n.wrap({status:p.e.success});h.push(this._getUpdateItemPromise(e,t,n,i,s,f,l,i.clientForm.item,o));return r.n.all(h).then(function(e){for(var t={status:p.e.success},n=0,r=e;n<r.length;n++){var i=r[n];if(i&&i.hasOwnProperty("status")){t.status=i.status;i.failedItemIds&&(t.failedItemIds=i.failedItemIds)}break}return t},function(e){var t,n;if((e=Array.isArray(e)?e:[e])&&e[0]&&e[0].code){var r=e[0].code.split(", ");if(r&&2===r.length){t=r[0];n=r[1]}}for(var s="-2146232832"===t&&"Microsoft.SharePoint.SPFieldValidationException"===n,o=0;o<f.length;o++){var a=f[o];a.hasException=0===o||s;a.state=0}var l=Object(y.r)(u._pageContext)+i.clientForm.item.properties.FileRef;throw e=e.filter(function(e){return e&&e.message&&e.message.value}).map(function(e){e.message.value=e.message.value.replace('"'.concat(l,'" '),"");return e})})};t.prototype._isEventField=function(e){var t,n,r=null===(n=null===(t=e.schema)||void 0===t?void 0:t.Id)||void 0===n?void 0:n.toLowerCase();return"64cd368d-2f95-4bfc-a1f9-8d4324ecb007"===r||"2684f9f2-54be-429f-ba06-76754fc056bf"===r};t.prototype._getUpdateItemPromise=function(e,t,n,i,s,o,u,a,f){var l=this;return u&&0!==u.length&&o&&0!==o.length?this.getData(t.bind(null,a),function(e){var t=JSON.parse(e);if(!t.d||!t.d[s]||!t.d[s].results){for(var n=0,u=o;n<u.length;n++){(L=u[n]).state=0}return r.n.wrapError("The server response couldn't be processed")}for(var c=null,h={},d="",v=0,m=t.d[s].results;v<m.length;v++){var g=m[v];if(2===i.clientForm.formType&&"Id"===g.FieldName){var y=a;y.properties||(y.properties={});y.properties.ID=g.FieldValue}if(!0===g.HasException||null!==g.ErrorMessage){var b=g.FieldName;h[b]||(h[b]=[]);void 0!==g.ItemId&&h[b].indexOf(g.ItemId)<0&&h[b].push(g.ItemId);if(!c){c={};for(var w=0,E=i.clientForm.fields;w<E.length;w++){var S=E[w];c[S.schema.Name]=S}}if(c[b]){c[b].errorMessage=g.ErrorMessage;c[b].hasException=!0;var x=c[b].schema.Title;d=d?d+", "+x:x}}}var T={status:d?p.e.fail:p.e.success};if(f&&f.length&&h.null){var N=h.null;N.length<f.length?T.status=p.e.partialSuccess:T.status=p.e.fail;T.failedItemIds=N}for(var C=0,k=o;C<k.length;C++){var L=k[C];if(d){if(!h[L.schema.Name]&&i.isInteractiveSave){L.errorMessage="Cannot save due to errors in other fields: "+d;L.hasException=!0}}else{L.errorMessage="";L.hasException=!1}L.state=0}l._raiseCreateOrUpdateEvents(i,T);return T},e,function(){return n(u)},"POST",this._getAdditionalHeaders(i.clientForm.formType),void 0,5):r.n.wrap()};t.prototype._getUrlInfo=function(){var e=this._itemUrlHelper.getUrlParts({listUrl:this._listContext.listUrl});return{listUrl:e&&e.serverRelativeListUrl?e.serverRelativeListUrl:this._listContext.listUrl,itemUrlParts:e}};t.prototype._isClientFormFieldUpdated=function(e,t,n,r){return(!e.clientForm.isBulkEdit||""!==t||null!==n)&&(!(r.schema.AppendOnly&&!t&&!Object(T.i)(this._pageContext.listBaseTemplate))&&!c.e(t,n))};t.prototype._postUpdateFields=function(e,t,n){var i=t.clientForm.item;if(!this.isValidItem(i))return r.n.wrap({status:p.e.fail});for(var s=this._itemUrlHelper.getItemUrlParts(i.key).serverRelativeListUrl,o=n&&n.length>1,u=[],a=null,f=0;f<t.clientForm.fields.length;f++){var l=t.clientForm.fields[f];if(L.s(l)){if(!o&&l.data===l.serverData)continue;if(o){var c=this._updateMultipleComplianceTagsPromises(n,l,s);if(c)for(var h=0,d=c;h<d.length;h++){var v=d[h];u.push(v)}}else u.push(this._updateComplianceTagField(l,i));A.e.logData({name:"ClientFormUpdate."+l.schema.FieldType.toLowerCase()})}else if(L.o(l)){if(!this.isFeatureEnabled(z)||l.data===l.serverData)continue;var m=L.u(i.properties[L.e]);if(m===("1"===l.data)||o)continue;u.push(this._updateUnlockRecordField(i,l,s,m));A.e.logData({name:"ClientFormUpdate."+l.schema.FieldType.toLowerCase()})}else"attachments"===l.schema.FieldType.toLowerCase()&&(a=l)}n&&0!==n.length||u.push(this._updateAttachmentsField(a,i,e));return r.n.all(u).then(function(e){for(var t,n={status:p.e.success},r=0,i=e;r<i.length;r++){var s=i[r];s&&s.status===p.e.fail&&(n.status=s.status);s&&s.failedItemIds&&s.failedItemIds.length>0&&(t=n.failedItemIds).push.apply(t,s.failedItemIds)}return n})};t.prototype._updateComplianceTagField=function(e,t){var n,i=e.schema;i.ComplianceTags&&(n=i.ComplianceTags.filter(function(t){return t&&t.tagValue===e.data})[0]);if(n){e.state=1;return this._complianceTagProvider.updateComplianceTag(t,n).then(function(){e.state=0;return{status:p.e.success}},function(t){if(t&&e){e.errorMessage=t.message&&t.message.value?t.message.value:t;e.hasException=!0}e.state=0;return{status:p.e.fail}})}return r.n.wrap(null)};t.prototype._updateMultipleComplianceTagsPromises=function(e,t,n){var r,i=t.schema,s=[];i.ComplianceTags&&(r=i.ComplianceTags.filter(function(e){return e&&e.tagValue===t.data})[0]);if(!r)return s;t.state=1;for(var o=[],u=0,a=0,f=e.length;a<f;a++){o.push(e[a]);if(++u===L.n||a===e.length-1){s.push(this._complianceTagProvider.updateComplianceTagInBatch(o,r,n).then(function(e){t.state=0;return e&&e.length>0?{status:p.e.fail,failedItemIds:e}:{status:p.e.success}},function(e){if(e&&t){t.errorMessage=e.message&&e.message.value?e.message.value:e;t.hasException=!0}t.state=0;return{status:p.e.fail,failedItemIds:o}}));o=[];u=0}}return s};t.prototype._updateUnlockRecordField=function(e,t,n,r){var i="1"===t.data;t.state=1;return i?this._complianceTagProvider.unlockRecord(e,n).then(function(e){t.serverData=e?"1":"0";t.state=0;return{status:p.e.success}},function(e){if(e&&t){t.serverData=r?"1":"0";t.data="0";t.errorMessage=e.message&&e.message.value?e.message.value:e;t.hasException=!0}t.state=0;return{status:p.e.fail}}):this._complianceTagProvider.lockRecord(e,n).then(function(e){t.serverData=e?"1":"0";t.state=0;return{status:p.e.success}},function(e){if(e&&t){t.serverData=r?"1":"0";t.data="1";t.errorMessage=e.message&&e.message.value?e.message.value:e;t.hasException=!0}t.state=0;return{status:p.e.fail}})};t.prototype._updateAttachmentsField=function(e,t,n){var i=this;if(this._fileUploaderProvider&&this._fileUploaderProvider.operationsPool.length>0){this._fileUploaderProvider.operationsPool.some(function(e){return 0===e.fileType})&&(e.state=1);return this._fileUploaderProvider.executeAllOperations(this._fileUploaderProvider.operationsPool,!0,"CreateItem"===n&&t&&t.properties?Number(t.properties.ID):void 0).then(function(t){i._fileUploaderProvider.operationsPool=[];return{status:i.handleFileUploaderErrors(t,e,[])?p.e.success:p.e.fail}},function(t){i._fileUploaderProvider.operationsPool=[];return{status:i.handleFileUploaderErrors(t,e,[])?p.e.success:p.e.fail}})}return r.n.wrap(null)};t.prototype.isValidItem=function(e){return e&&e.properties&&e.properties.ID&&"0"!==e.properties.ID};t.prototype.handleFileUploaderErrors=function(e,t,n){var r={attachments:[]},i=!0;e.forEach(function(e){if(!e.result){e.attachment&&r.attachments.push(e.errorMsg);e.image&&(r[e.image.fieldName]=e.errorMsg);i=!1}});if(t){if(r.attachments.length>0){var s=r.attachments.reduce(function(e,t){return e+(e?"\r\n":"")+t+"\r\n"},"");t.errorMessage=s;t.hasException=!0}t.state=0;A.e.logData({name:"ClientFormUpdate."+t.schema.FieldType.toLowerCase()})}n.forEach(function(e){if(r[e.schema.Name]){e.errorMessage=r[e.schema.Name];e.hasException=!0}e.state=0;A.e.logData({name:"ClientFormUpdate."+e.schema.FieldType.toLowerCase()})});return i};t.prototype._ensureClientForms=function(e){if(this._clientForms&&this._contentTypeIdToNameMap&&!this._listContext.refreshClientForm)return e?r.n.wrap(e()):r.n.wrap();this._listContext.refreshClientForm=void 0;return e?this.fetchAllClientFormSchemas().then(e):this.fetchAllClientFormSchemas().then(function(){return r.n.wrap()})};t.prototype._checkRenderModes=function(e){for(var t in this._clientForms)for(var n in this._clientForms[t])if(this._clientForms[t][n].mode===e)return!0;return!1};t.prototype._getFormRenderMode=function(e,t){var n=this._contentTypeIdToNameMap[t],r=this._clientForms[e][n];return r?r.mode:this._checkRenderModes(4)?4:0};t.prototype._raiseCreateOrUpdateEvents=function(e,t){var n=e.clientForm;if(t&&t.status===p.e.success&&n){var r=n.item&&n.item.properties&&n.item.properties.ID?n.item.properties.ID:void 0,i=e.itemdIds&&e.itemdIds.length?e.itemdIds.map(String):r?[r]:void 0;i&&j.t.raise(window,2===n.formType?F.e.newItemCreated:F.e.itemUpdated,{itemIds:i})}};t.prototype._updateImages=function(e){return this._fileUploaderProvider&&this._fileUploaderProvider.imageOperationsPool.length>0?this._fileUploaderProvider.executeAllOperations(this._fileUploaderProvider.imageOperationsPool,!0,e?0:void 0):r.n.wrap([])};return t})(h.t),ne={ODB:60087,ODC:!1,OneDrive:!1,Fallback:!1},re=(function(){function e(e,t){var n=this;this._buffer=[];this._bufferSize=5;this._init=function(e,t){var r,i;if(t&&t.pageContext){n._pageContext=t.pageContext;n._listContext=t.listContext;r=t.apiUrlHelper;i=t.itemUrlHelper}else{n._pageContext=e.pageContext;n._listContext=e.listContext;r=e.apiUrlHelper;i=e.itemUrlHelper;n._defaultValueOverride=e.defaultValueOverride||{}}var o={isFeatureEnabled:e.isFeatureEnabled,fileUploaderProvider:e.fileUploaderProvider,complianceTagProvider:e.complianceTagProvider},u={pageContext:n._pageContext,apiUrlHelper:r,itemUrlHelper:i};n._clientFormDataSource?n._clientFormDataSource.updateContext(o,u):n._clientFormDataSource=new te(o,u);n._clientFormDataSource.listContext=n._listContext;n.isFeatureEnabled=e.isFeatureEnabled?e.isFeatureEnabled:function(e){return s.n.isFeatureEnabled(e,n._pageContext&&n._pageContext.ExpFeatures)}};this._getStoredClientFormId=function(e,t,n){return e+"|"+t+"|"+n};this._getClientFormData=function(e){if(e.status===p.t.pending){var t=new o.e;e.onFinish=function(n){n=e.status||n;t.complete(e.clientForm)};return t.getPromise()}return r.n.resolve(e.clientForm)};this._init(e,t)}e.prototype.updateContext=function(e,t){this._init(e,t)};e.prototype.getClientForm=function(e,t,n){var s,o,u=this;void 0===t&&(t=!1);void 0===n&&(n=!1);t&&(this._listContext.refreshClientForm=!0);var a,f,l=e.itemId,c=e.item;if(!l&&c){var h=this._getBufferKeyFromItem(c,e.contentType);a=e.isBulkEdit?void 0:this._getClientFormFromBuffer(h);c.type!==i.t.Folder||e.contentType||(e.contentType="Folder");if(a){if(c.hasClientFormData){a.item=e.item;return r.n.wrap(a)}this._deleteClientFormFromBuffer(h)}}var d=[];if(e.isBulkEdit&&e.selection&&!e.isSwitchingContentType)for(var v={},m=0,g=e.selection;m<g.length;m++){var y=g[m];if(y){var b=y.properties;if(b){var w=(x=y.type!==i.t.Folder||b.ContentType?b.ContentType:"Folder")+(E=b.ContentTypeId);if(!v[w]){d.push({contentType:x,contentTypeId:E});v[w]=!0}}}}else d.push({contentType:e.contentType,contentTypeId:e.contentTypeId});if(l){var E,S=e.isBulkEdit,x=e.contentType,T=e.clientFormType,N=(E=e.contentTypeId)&&0===E.lastIndexOf(q,0),C="Media.Meeting"===(null===(o=null===(s=null==e?void 0:e.item)||void 0===s?void 0:s.properties)||void 0===o?void 0:o.ProgId)&&n&&!S&&!N;if(this.isFeatureEnabled(ne)&&C){var k=this._getStoredClientFormId(l,x,S),L=this._getStoredClientForm(k);if(L&&void 0!==L.status)return this._getClientFormData(L).then(function(e){u._deleteClientFormFromStoredClientForm(k);return e});this._completeStoredClientForm(L,p.t.pending);return this._clientFormDataSource.getClientForm(l,T,d,S).then(function(e){u._completeStoredClientForm(L,p.t.success,e);return e})}return this._clientFormDataSource.getClientForm(l,e.clientFormType,d,e.isBulkEdit)}return this._clientFormDataSource.getClientFormSchema(e.clientFormType,d).then(function(t){if(e.item&&!e.item.properties.ContentTypeId){e.item.properties.ContentTypeId=t.contentTypeId;e.item.properties.ContentType=t.contentType}f={item:e.item,formType:t.formType,contentType:t.contentType,contentTypeId:t.contentTypeId,fields:[],clientFormCustomFormatter:t.clientFormCustomFormatter,isBulkEdit:e.isBulkEdit};u._generateFieldsFromSchema(f,t);if(2!==e.clientFormType)return u.updateFormValues(f)}).then(function(){u._addClientFormToBuffer(f);return r.n.wrap(f)})};e.prototype.updateFormValues=function(e,t){return this._clientFormDataSource.updateFormValues(e,t)};e.prototype.updateItem=function(t){if(t.clientForm.isBulkEdit&&t.itemdIds){this._buffer=[];e._clientFormStore=[]}return this._clientFormDataSource.updateItem(t)};e.prototype.saveCustomShowHideRules=function(e,t,n){return this._clientFormDataSource.saveCustomShowHideRules(e,t,n)};e.prototype.saveClientFormCustomFormatter=function(e,t){return this._clientFormDataSource.saveClientFormCustomFormatter(e,t)};e.prototype.getClientFormCustomFormatter=function(e,t){return this._clientFormDataSource.getClientFormCustomFormatter(e,t)};e.prototype.createItem=function(e){return this._clientFormDataSource.createItem(e)};e.prototype.getFieldFilterData=function(e,t,n){return this._clientFormDataSource.getFieldFilterData(e,t,n)};e.prototype.getClientFormSchema=function(e,t,n){return this._clientFormDataSource.getClientFormSchema(e,[{contentType:t,contentTypeId:n}])};e.prototype.updatePanelViewInfo=function(e){return this._clientFormDataSource.updatePanelViewInfo(e)};e.prototype.getContentTypes=function(e){return this._clientFormDataSource.getContentTypes(e)};e.prototype.getContentInfoTypes=function(e){var t=[];if(e.isBulkEdit&&e.selection&&!e.isSwitchingContentType)for(var n={},r=0,s=e.selection;r<s.length;r++){var o=s[r];if(o){var u=o.properties;if(u){var a=o.type!==i.t.Folder||u.ContentType?u.ContentType:"Folder",f=u.ContentTypeId,l=a+f;if(!n[l]){t.push({contentType:a,contentTypeId:f});n[l]=!0}}}}else t.push({contentType:e.contentType,contentTypeId:e.contentTypeId});return t};e.prototype.hasFormRenderMode=function(e){return this._clientFormDataSource.hasFormRenderMode(e)};e.prototype.getFormRenderMode=function(e,t){return this._clientFormDataSource.getFormRenderMode(e,t)};e.prototype.getPowerAppFormId=function(){return this._clientFormDataSource.getPowerAppFormId()};e.prototype.getPowerAppRenderInfo=function(){return this._clientFormDataSource.getPowerAppRenderInfo()};e.prototype.getPowerAppAdditionalData=function(){return this._clientFormDataSource.getPowerAppAdditionalData()};e.prototype.getPowerAppFormCacheInfo=function(){return this._clientFormDataSource.getPowerAppFormCacheInfo()};e.prototype.getPowerAppFormDesignUrl=function(e){return this._clientFormDataSource.getPowerAppFormDesignUrl(e)};e.prototype.fetchAllClientFormSchemas=function(){return this._clientFormDataSource.fetchAllClientFormSchemas()};e.prototype.clearBuffer=function(){this._buffer=[]};e.prototype.updateListContext=function(e){this._listContext=e;this._clientFormDataSource.listContext=e};e.prototype.getResourceProviders=function(){return this._clientFormDataSource.getResourceProviders()};e.prototype.updateDefaultValueOverride=function(e){this._defaultValueOverride=e};e.prototype.clearStoreClientForm=function(){e._clientFormStore=[]};e.prototype._generateFieldsFromSchema=function(e,t){for(var n=this._listContext&&this._listContext.enableAttachments,r=0,i=t.fields.length;r<i;r++){var s=t.fields[r];if(void 0!==this._defaultValueOverride[s.InternalName]){s.DefaultValue=this._defaultValueOverride[s.InternalName];s.DefaultValueFormatted="";s.DefaultValueTyped=""}("Attachments"!==s.Type||n)&&!(e.isBulkEdit&&s.ReadOnlyField)&&e.fields.push(this._generateField(e,s))}};e.prototype._generateField=function(e,t){return{hasException:!1,errorMessage:"",schema:t,state:0}};e.prototype._getBufferKeyFromItem=function(e,t){return e.properties.ID+e.name+"|"+t};e.prototype._getClientFormFromBuffer=function(e){for(var t=0,n=this._buffer.length;t<n;t++){var r=this._buffer[t].key;if(r===e){if(0===t)return this._buffer[t].form;var i=this._buffer[t].form;this._buffer.splice(t,1);this._buffer.unshift({key:r,form:i});return i}}return null};e.prototype._addClientFormToBuffer=function(e){if(!e.isBulkEdit){var t=e.item;t&&void 0!==t.properties.ID&&this._buffer.unshift({key:this._getBufferKeyFromItem(t,e.contentType),form:e})>this._bufferSize&&this._buffer.pop()}};e.prototype._deleteClientFormFromBuffer=function(e){for(var t=0,n=this._buffer.length;t<n;t++){if(this._buffer[t].key===e){this._buffer.splice(t,1);break}}};e.prototype._getStoredClientForm=function(t){for(var n=0;n<e._clientFormStore.length;n++){if(e._clientFormStore[n].clientFormId===t)return e._clientFormStore[n]}var r={onFinish:void 0,clientFormId:t,clientForm:void 0,status:void 0};e._clientFormStore.push(r);return r};e.prototype._deleteClientFormFromStoredClientForm=function(t){for(var n=0;n<e._clientFormStore.length;n++){if(e._clientFormStore[n].clientFormId===t){e._clientFormStore.splice(n,1);break}}};e.prototype._completeStoredClientForm=function(t,n,r){for(var i=0;i<e._clientFormStore.length;i++){if(e._clientFormStore[i].clientFormId===t.clientFormId){e._clientFormStore[i].status=n;r&&(e._clientFormStore[i].clientForm=r);t.onFinish&&t.onFinish(n)}}};e._clientFormStore=[];return e})()},2247:function(e,t,n){"use strict";n.d(t,"e",function(){return v});var r=n(59),i=n(18),s=n(0),o=n(23),u=n(641),a=n(94),f=(function(e){Object(s.__extends)(t,e);function t(t,n){var r=e.call(this,{},n)||this,i=t.apiUrlHelper,s=t.itemUrlHelper;r._itemUrlHelper=s;r._apiUrlHelper=i;return r}t.prototype.getAttachments=function(e,t){var n=this;return this.getData(function(){return n.buildAttachmentBaseUrl(e,t).toString()},function(e){var t=JSON.parse(e);if(t&&t.d&&t.d.resultes&&0===t.d.results.length)return[];var r=t.d.results;return n.transformAttachmentData(r)},"Attachments")};t.prototype.addAttachment=function(e,t,n){var i=this;return new r.n(function(r,s){var o=new FileReader;o.onload=function(u){var a=o.result;i.doUploadAttachment(e,t,n.name,a).then(r,s)};o.readAsArrayBuffer(n)},function(){})};t.prototype.deleteAttachment=function(e,t,n,i){var s=this;return new r.n(function(r,o){s.doDeleteAttachment(e,t,n,i||!1).then(r,o)},function(){})};t.prototype.getDataSourceName=function(){return"AttachmentDataSource"};t.prototype.addImage=function(e,t,n,i,s,o,u){var a=this;return new r.n(function(r,f){var l=new FileReader;l.onload=function(c){var h=l.result;a.doUploadImage(t,i,s,u.name,h,n,e,o).then(r,f)};l.readAsArrayBuffer(u)},function(){})};t.prototype.buildAttachmentBaseUrl=function(e,t,n){var r=this._itemUrlHelper.getItemUrlParts(t),i=this._apiUrlHelper.build().webByItemUrl(r).method("GetList",r.serverRelativeListUrl).method("Items",e);return i=n?i.method("AttachmentFiles",n):i.segment("AttachmentFiles")};t.prototype.transformAttachmentData=function(e){var t=this;return e.map(function(e){return{type:"attachment",fileName:e.FileName,serverRelativeUrl:Object(a.r)(t._pageContext)+e.ServerRelativeUrl,uploaded:!0}})};t.prototype.doUploadAttachment=function(e,t,n,r){var i=this;return this.dataRequestor.getData({url:this.buildAttachmentBaseUrl(e,t).methodWithAliases("addUsingPath",{decodedUrl:n}).toString(),parseResponse:function(e){var t=JSON.parse(e);if(!t.d)return null;var n=[t.d],r=i.transformAttachmentData(n);return r&&1===r.length?r[0]:null},qosName:"UploadAttachment",additionalPostData:r,noRedirect:!0})};t.prototype.doDeleteAttachment=function(e,t,n,r){var i=this;return this.getData(function(){return i.buildAttachmentBaseUrl(e,t,n).segment(r?"DeleteObject":"RecycleObject").toString()},function(e){try{var t=JSON.parse(e);return r&&void 0!==t.d.DeleteObject||!r&&void 0!==t.d.RecycleObject}catch(e){return!1}},r?"DeleteAttachment":"RecycleAttachment")};t.prototype.doUploadImage=function(e,t,n,r,i,s,u,a){var f=this,l=this._itemUrlHelper.getItemUrlParts(e),c=this._apiUrlHelper.build().webByItemUrl(l).methodWithAliases("UploadImage",{listTitle:t,imageName:r,listId:s,itemId:u,fieldId:a});o.t.isActivated("dd617e52-55d0-40bc-9e0f-ffd875d6a25c","11/10/2021","pipe through filed id to UploadImage call")&&(c=this._apiUrlHelper.build().webByItemUrl(l).methodWithAliases("UploadImage",{listTitle:t,imageName:r,listId:s,itemId:u}));return this.dataRequestor.getData({url:c.toString(),parseResponse:function(e){var t=JSON.parse(e);if(!t.d||!t.d.UploadImage)return null;var r=t.d.UploadImage,i=f.transformImageData(r,n,a);return i||null},qosName:"UploadImage",additionalPostData:i,noRedirect:!0})};t.prototype.transformImageData=function(e,t,n){return{type:"thumbnail",fileName:e.Name,serverRelativeUrl:e.ServerRelativeUrl,id:e.UniqueId,fieldName:t,serverUrl:Object(a.r)(this._pageContext),fieldId:n}};return t})(u.e),l=n(642),c=n(348),h=n(2596),p=n(127),d=n(49),v=(function(){function e(e){this.operationsPool=[];this.imageOperationsPool=[];this.listTitle=e.pageContext.listTitle;this.listId=d.e.normalizeLower(e.pageContext.listId,!1);var t=new c.e({},{pageContext:e.pageContext}),n=new l.e({},{itemUrlHelper:t,pageContext:e.pageContext}),r={pageContext:e.pageContext};this.dataSource=new f({apiUrlHelper:n,itemUrlHelper:t},r)}e.prototype.createAddAttachmentOperation=function(e,t,n){var r={type:1,listItemId:e,listItemKey:t,fileType:0,fileName:n.name,file:n};this.handleNewOperation(r,this.operationsPool)};e.prototype.createDeleteAttachmentOperation=function(e,t,n){var r={type:0,listItemId:e,listItemKey:t,fileType:0,fileName:n};this.handleNewOperation(r,this.operationsPool)};e.prototype.createAddImageOperation=function(e,t,n,r,i){var s={type:1,listItemId:e,listItemKey:t,fileType:1,fileName:n.name,file:n,fieldName:r,fieldId:i};this.handleNewOperation(s,this.imageOperationsPool)};e.prototype.createDeleteImageOperation=function(e,t,n,r){var i={type:0,listItemId:e,listItemKey:t,fileType:1,fileName:n,fieldName:r};this.handleNewOperation(i,this.imageOperationsPool)};e.prototype.executeAllOperations=function(e,t,n){var i=this;return new r.n(function(t,r){if(e.length>0){var s=e[0],o=e.slice(1),u=void 0;if(1===s.type){void 0!==n&&(s.listItemId=n);u=i.processUpload(s.listItemId,s.listItemKey,s.file,s.fileType,s.fieldName,s.fieldId)}else u=i.processDelete(s.listItemId,s.listItemKey,s.fileName,s.fileType,s.fieldName);var a=function(e){i.executeAllOperations(o,!1,n).done(function(n){return t([e].concat(n))},r)};u.done(a,a);p.e.logData({name:"ClientFormUpdate.attachments"})}else t([])})};e.prototype.processUpload=function(e,t,n,r,s,o){return 1===r?this.dataSource.addImage(e,t,this.listId,this.listTitle,s,o,n).then(function(e){return{result:!0,attachment:null,image:e,errorMsg:e?null:i.format(h.n,n.name)+"."}},function(e){var t=i.format(h.n,n.name);e&&(e.code&&e.code.indexOf("InvalidDataException")>=0?t=h.r:e.message&&e.message.value&&(t+=" : "+e.message.value));throw{result:!1,attachment:null,image:{type:"thumbnail",fieldName:s,fileName:n.name,serverUrl:null,fieldId:o},errorMsg:t}}):this.dataSource.addAttachment(e,t,n).then(function(e){return{result:!0,attachment:e,errorMsg:e?null:i.format(h.t,n.name)+"."}},function(e){throw{result:!1,attachment:{type:"attachment",uploaded:!1,fileName:n.name},errorMsg:i.format(h.t,n.name)+(e&&e.message&&e.message.value?" : "+e.message.value:"")}})};e.prototype.processDelete=function(e,t,n,s,o,u){return 1===s?r.n.wrap({result:!0,image:{type:"thumbnail",fieldName:o,fileName:n,serverRelativeUrl:null,serverUrl:null,fieldId:u},errorMsg:null}):this.dataSource.deleteAttachment(e,t,n).then(function(e){return{result:e,errorMsg:e?null:i.format(h.e,n)+"."}},function(e){throw{result:!1,errorMsg:i.format(h.e,n)+(e&&e.message&&e.message.value?" : "+e.message.value:"")}})};e.prototype.handleNewOperation=function(e,t){var n=e.type,r=this.findDuplicateOperation(e,t);1===n?r<0&&t.push(e):r<0?t.push(e):t.splice(r,1)};e.prototype.findDuplicateOperation=function(e,t){var n=e.fileType,r=-1;t.some(function(t,i){if(1===t.type&&t.fileName===e.fileName&&(1!==n||t.fieldName===e.fieldName)){r=i;return!0}});return r};return e})()},2270:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=(function(){function e(){}e.newItemCreated="clientFormNewItemCreated";e.itemUpdated="clientFormItemUpdated";return e})()},2276:function(e,t,n){"use strict";var r=n(0),i=n(59),s=n(1168),o=n(641),u=n(2127),a=n(2268),f=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,{},n)||this,i=t.apiUrlHelper,s=t.itemUrlHelper;r._apiUrlHelper=i;r._itemUrlHelper=s;return r}t.prototype.isAdvancedRecordVersioningDisabled=function(){return this.dataRequestor.getData({url:this._buildRecordVersioningUrl(),qosName:"GetAdvancedRecordVersioningDisabled",method:"GET"}).then(function(e){return!!(e&&e.d&&e.d.GetAdvancedRecordVersioningDisabled)&&e.d.GetAdvancedRecordVersioningDisabled},function(e){return i.n.wrapError(e)})};t.prototype.getAvailableTagsForSite=function(){var e=this;return this.dataRequestor.getData({url:this._buildComplianceTagsListUrl(),qosName:"GetAvailableTagsForSite",method:"GET",noRedirect:!0}).then(function(t){return e._transformToComplianceTags(t.d.GetAvailableTagsForSite.results)},function(e){return i.n.wrapError(a.GetAvailableTagsForSiteFailed)})};t.prototype.updateComplianceTagInBatch=function(e,t,n){if(!e||0===e.length){s.e.logData({name:"ComplianceTagDataSource.EmptyItemIds",message:"Empty item IDs selected for list: "+n});return i.n.wrap([])}var r=JSON.stringify({itemIds:e,listUrl:n,complianceTagValue:t.tagValue,blockDelete:t.blockDelete,blockEdit:t.blockEdit});return this.dataRequestor.getData({url:this._buildApplyLabelOnBulkItemsUrl(),qosName:"ApplyLabelOnBulkItems",additionalPostData:r,method:"POST"}).then(function(e){return e&&e.d&&e.d.ApplyLabelOnBulkItems&&e.d.ApplyLabelOnBulkItems.results?e.d.ApplyLabelOnBulkItems.results:[]},function(e){return i.n.wrapError(e)})};t.prototype.updateComplianceTag=function(e,t){var n=t.blockEdit||t.blockDelete,r=t.blockEdit,s=t.isEventTag,o=JSON.stringify({complianceTag:t.tagValue,isTagPolicyHold:n,isTagPolicyRecord:r,isEventBasedTag:s,isTagSuperLock:t.superLock,isUnlockedAsDefault:t.unlockedAsDefault});return this.dataRequestor.getData({url:this._buildUpdateHashtagsUrl(e,"SetComplianceTag"),qosName:"SetComplianceTag",additionalPostData:o,method:"POST",noRedirect:!0}).then(function(){return t.tagName},function(e){return i.n.wrapError(e)})};t.prototype.unlockRecord=function(e,t){var n=JSON.stringify({listUrl:t,itemId:e.properties.ID});return this.dataRequestor.getData({url:this._buildUnlockRecordUrl(),qosName:"UnlockRecordItem",additionalPostData:n,method:"POST"}).then(function(e){if(e&&e.d&&e.d.UnlockRecordItem&&e.d.UnlockRecordItem.results){var t=e.d.UnlockRecordItem.results;return u.u(t)}return!1},function(e){return i.n.wrapError(e)})};t.prototype.lockRecord=function(e,t){var n=JSON.stringify({listUrl:t,itemId:e.properties.ID});return this.dataRequestor.getData({url:this._buildLockRecordUrl(),qosName:"LockRecordItem",additionalPostData:n,method:"POST"}).then(function(e){if(e&&e.d&&e.d.LockRecordItem&&e.d.LockRecordItem.results){var t=e.d.LockRecordItem.results;return u.u(t)}return!1},function(e){return i.n.wrapError(e)})};t.prototype._buildRecordVersioningUrl=function(){return this._apiUrlHelper.build().methodWithAliases("SP.CompliancePolicy.SPPolicyStoreProxy.GetAdvancedRecordVersioningDisabled",{}).toString()};t.prototype._buildComplianceTagsListUrl=function(){return this._apiUrlHelper.build().methodWithAliases("SP.CompliancePolicy.SPPolicyStoreProxy.GetAvailableTagsForSite",{siteUrl:this._pageContext.webAbsoluteUrl}).toString()};t.prototype._buildUpdateHashtagsUrl=function(e,t){var n=this._itemUrlHelper.getItemUrlParts(e.key);return this._apiUrlHelper.build().webByItemUrl(n).method("GetList",n.serverRelativeListUrl).method("items",e.properties.ID).method(t).toString()};t.prototype._transformToComplianceTags=function(e){var t=[],n={tagName:a.NoneComplianceTagName,tagValue:"",blockDelete:!1,blockEdit:!1,tagDescription:a.NoneComplianceTagDescription,tagTooltip:a.NoneComplianceTagDescription,hasRetentionAction:!1,autoDelete:!1,isEventTag:!1,reviewerEmail:"",notes:"",displayName:"",superLock:!1,tagId:"",unlockedAsDefault:!1};t.push(n);for(var r=0,i=e;r<i.length;r++){var s=i[r],o=u.r(s),f=u.i(s),l={tagName:s.TagName,tagValue:s.TagName,blockDelete:s.BlockDelete,blockEdit:!!s.BlockEdit,tagDescription:o,tagTooltip:f,hasRetentionAction:s.HasRetentionAction,autoDelete:s.AutoDelete,isEventTag:s.IsEventTag,reviewerEmail:s.ReviewerEmail,notes:s.Notes,displayName:s.DisplayName,superLock:s.SuperLock,tagId:s.TagId,unlockedAsDefault:s.UnlockedAsDefault};t.push(l)}return t};t.prototype._buildApplyLabelOnBulkItemsUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.ApplyLabelOnBulkItems").toString()};t.prototype._buildUnlockRecordUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.UnlockRecordItem").toString()};t.prototype._buildLockRecordUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.LockRecordItem").toString()};return t})(o.e),l=n(642),c=n(348),h=(function(){function e(e){var t=new c.e({},{pageContext:e.pageContext}),n=new l.e({},{itemUrlHelper:t,pageContext:e.pageContext}),r={pageContext:e.pageContext};this._dataSource=new f({apiUrlHelper:n,itemUrlHelper:t},r)}e.prototype.isAdvancedRecordVersioningDisabled=function(){return this._dataSource.isAdvancedRecordVersioningDisabled()};e.prototype.getAvailableTagsForSite=function(){this._cachedTagsPromise||(this._cachedTagsPromise=this._dataSource.getAvailableTagsForSite());return this._cachedTagsPromise};e.prototype.updateComplianceTag=function(e,t){return this._dataSource.updateComplianceTag(e,t)};e.prototype.updateComplianceTagInBatch=function(e,t,n){return this._dataSource.updateComplianceTagInBatch(e,t,n)};e.prototype.unlockRecord=function(e,t){return this._dataSource.unlockRecord(e,t)};e.prototype.lockRecord=function(e,t){return this._dataSource.lockRecord(e,t)};e.prototype.hasComplianceTags=function(){return this.getAvailableTagsForSite().then(function(e){return!!(e&&e.length>1)})};return e})();t.e=h},2282:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r,i=n(1205),s=n(1206),o=n(882),u=n(1181),a=n(49),f=n(2239),l=n(867),c=n(161),h=n(428),p=n(311),d=n(2146),v=n(865),m=n(11);(function(e){e.buildItems=function(e,n,r,i,s){for(var o=[],u=[],a=e.Row,f=a.length,l=0;l<f;l++){var c=t(a[l],u,n,r);c.parent=i;c.parentKey=i.key;s&&s.setItem(c.key,c);o.push(c)}var h=0;if(u.length>0){var p=u[u.length-1];h=p.startIndex+p.count}else{u=void 0;h=f>0?e.LastRow:0}return{items:o,groups:u,totalCount:h}};e.buildRootItem=function(e,t,n,r){var i=(function(e){var t=e;if(0===e.indexOf("id")){var n=Object(p.e)(e);t=n.id}return t})(e),s=Object(d.e)(i,n.listUrl),u={key:s},a=t.ListTitle,f=t.AllowCreateFolder,l=t.EnableMinorVersions,h=t.verEnabled,g=t.AllowGridMode,y=t.DisableGridEditing,b=t.ListTemplateType,w=t.BasePermissions,E=void 0===w?{}:w,S=E.ManageLists,x=void 0===S?void 0:S,T=E.ManagePersonalViews,N=void 0===T?void 0:T,C=E.OpenItems,k=void 0===C?void 0:C,L=t.ListSchema,A=(void 0===L?{}:L).DefaultItemOpen,O=void 0===A?void 0:A,M=t.ExcludeFromOfflineClient,_=t.WebExcludeFromOfflineClient,D=t.ListData,P="string"==typeof O?"0"===O:void 0;if(r){var H=r.getItem(s);H&&(u=H)}u.type=c.t.Folder;u.isRootFolder=i===n.listUrl;Object(v.default)(u,{permissions:v.optional(D?o.e(D.FolderPermissions):void 0)});void 0===u.list&&(u.list={});Object(v.default)(u.list,{id:v.optional(t.listName),title:v.optional(a),allowGridMode:"boolean"==typeof g?g:v.backup(!0),allowCreateFolder:v.optional(f),disableCommenting:"boolean"==typeof t.DisableCommenting&&t.DisableCommenting,disableGridEditing:"boolean"==typeof y?y:v.backup(!1),enableMinorVersions:v.optional(l),enableVersions:v.optional(h),templateType:v.optional("string"==typeof b?Number(b):void 0),isDocumentLibrary:v.optional("string"==typeof b?Object(m.i)(b):void 0),isPromotedLinks:v.optional("string"==typeof b?Object(m.o)(b):void 0),isForceCheckout:v.optional(t.isForceCheckout),isModerated:v.optional(t.isModerated),enableRequestSignOff:v.optional(t.EnableRequestSignOff),newWOPIDocumentEnabled:v.optional(t.NewWOPIDocumentEnabled),newWOPIDocumentTypes:v.optional(t.NewWOPIDocumentTypes),permissions:{manageLists:v.optional(x),managePersonalViews:v.optional(N),openItems:v.optional(k)},openInClient:v.optional(P),excludeFromOfflineClient:v.optional("boolean"==typeof M||"boolean"==typeof _?M||_:void 0),contentTypesEnabled:v.optional(t.ContentTypesEnabled),metadataNavFeatureEnabled:v.optional(t.metadataNavFeatureEnabled),canUserCreateMicrosoftForm:v.optional(t.canUserCreateMicrosoftForm),itemCount:v.optional(t.ListSchema&&t.ListSchema.ItemCount),rowLimit:v.optional(D&&D.RowLimit)});u.isRootFolder&&(u.name=u.displayName=a);r&&r.setItem(s,u);return u};function t(e,t,n,r){if(e){var p={key:Object(d.e)((function(e){return e.id||e.FileRef||e.ServerRelativeUrl})(e),n.listUrl)};p.id=e.id||e.FileRef;p.itemId=e["name.FileSystemItemId"];var v=e.File_x0020_Type;p.extension=v?"."+v:void 0;p.policyTip=e._ip_UnifiedCompliancePolicyUIAction?Number(e._ip_UnifiedCompliancePolicyUIAction):0;p.type=(function(e,t,n){var r=c.t.File,i=e.File_x0020_Type;if("1"===e.FSObjType){var s=e["File_x0020_Type.mapapp"],o=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];r=s&&"onenote"===s.substring(0,7)||o&&-1!==o.indexOf("onenote")?c.t.OneNote:c.t.Folder}else f.e.isShortcutEnabled()&&f.e.isShortcutFileType(i)?r=c.t.Shortcut:"pdf"===i?r=c.t.Media:(r=l.i(i))===c.t.Unknown&&Object(m.s)(n.listTemplateType)&&(r=c.t.File);".ai"!==t.extension&&".eps"!==t.extension&&".psd"!==t.extension||(r=c.t.Media);r===c.t.Folder?t.isDocSet="Sharepoint.DocumentSet"===e.ProgId:r===c.t.File&&n&&!n.isDocLib&&(t.listItem={});return r})(e,p,n);p.extension&&(p.iconName=l.r(p));p.isRootFolder=e.isRootFolder;var g=Object(i.getItemName)(e,p.type,n);g&&(p.displayName=p.name=g);p.dateModifiedValue=e.Modified;p.dateModified=e["Modified.FriendlyDisplay"]?Object(u.e)(e["Modified.FriendlyDisplay"]):String(e.Modified);p.permissions=e.PermMask?o.e(e.PermMask):void 0;p.isPlaceholder=!e.PermMask;p.hasMissingMetadata=(function(e,t){if(!t.listSchema)return!1;var n=t.listSchema.filter(function(e){return e.isRequired&&Boolean(e.name)}),r=!1;if(n&&n.length>0)for(var i in n)if(i){var s=n[i];if(!e[s.internalName]){r=!0;break}}return r})(e,n);var y=e["serverurl.progid"];p.openUrl=y?y.substring(1):e.FileRef;-1!==p.openUrl.toLowerCase().indexOf("/wopiframe?")&&(p.openUrl=p.openUrl.replace(/\/_layouts\/WopiFrame.aspx\?/,"/_layouts/15/WopiFrame.aspx?"));p.previewIFrameUrl=e.ServerRedirectedEmbedUrl;p.appMap=e["File_x0020_Type.mapapp"]||e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];p.size=e.File_x0020_Size?Number(e.File_x0020_Size):void 0;p.totalSize=e.SMTotalSize?Number(e.SMTotalSize):void 0;r.blockDownloadsExperienceEnabled&&(p.type===c.t.Media||p.openUrl&&p.appMap)?p.itemStatus=4:r.blockDownloadsExperienceEnabled?p.itemStatus=3:r.viewOnlyExperienceEnabled&&(p.itemStatus=4);if(p.type===c.t.Folder){p.folder={};p.childCount=Number(e.ItemChildCount)+Number(e.FolderChildCount);var b=Number(e.SMTotalFileCount);p.folder.totalCount=b>0?b:p.childCount;p.folder.childCount=p.childCount}p.isDraggable=!0;p.isDropEnabled=p.type===c.t.Folder;p.properties={};for(var w in e)e.hasOwnProperty(w)&&(p.properties[w]=e[w]);var E=e.UniqueId&&a.e.normalizeLower(e.UniqueId);E&&(p.properties.uniqueId=E);var S=p.name;p.extension&&(S=p.name.substring(0,p.name.toLowerCase().lastIndexOf(p.extension.toLowerCase())));p.properties.FileName=S;Number(e.PrincipalCount)>0?p.sharingType=h.e.Shared:void 0===e.PrincipalCount?p.sharingType=h.e.Unknown:p.sharingType=h.e.Private;s.e.buildGroupFromItem(e,t,n);return p}}e.buildItem=t})(r||(r={}))},2300:function(e,t,n){"use strict";n.d(t,"e",function(){return h});var r=n(0),i=n(641),s=n(64),o=n(36),u=n(348),a=n(642),f=n(350),l=n(2146),c=n(23).t.isActivated("29873e89-d94c-4bb0-8f5b-dfd437f6422c","6/19/2021","Look for filters within the folder structure for doclib by using GetListUsingPath API"),h=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{},{pageContext:t.pageContext})||this;n._listContext=t.listContext;n._itemUrlHelper=t.itemUrlHelper||new u.e({},{pageContext:t.pageContext});n._apiUrlHelper=t.apiUrlHelper||new a.e({},{pageContext:t.pageContext,itemUrlHelper:n._itemUrlHelper});n._folderPath=t.folderPath;void 0===n._folderPath&&(n._folderPath=Object(l.t)(t.parentKey,n._listContext));return n}t.prototype.getFilterData=function(e,t,n,r){var i=this;return this.getData(function(){return i._getFilterDataUrl(e,t,n,r)},function(e){return e},"GetFilterData")};t.prototype._getFilterDataUrl=function(e,t,n,r){var i,u,a=this._itemUrlHelper.getUrlParts({path:this._listContext.listUrl,listUrl:this._listContext.listUrl});u=c?this._apiUrlHelper.build().webByItemUrl(a).method("GetList",a.serverRelativeListUrl).segment("RenderListFilterData").parameter("FieldInternalName",e):this._apiUrlHelper.build().webByItemUrl(a).methodWithAliases("GetListUsingPath",{DecodedUrl:a.serverRelativeListUrl}).segment("RenderListFilterData").parameter("FieldInternalName",e);n&&"f9ebc8b2-a976-48f0-a8fa-0846164c0466"!==n&&(u=u.parameter("ViewId",n));this._folderPath&&(u=u.parameter("RootFolder",{raw:s.e.encodeURIComponent(this._folderPath)}));r&&r===o.e.Taxonomy&&(u=u.parameter("ExcludeFieldFilteringHtml",!0));var l=Object(f.getFilterParams)(t,!0,{replaceMeFormatFilterWithCurrentUser:!0,currentUserDisplayName:null===(i=this._pageContext)||void 0===i?void 0:i.userDisplayName});return(u=u.rawParameter(l)).toString()};return t})(i.t)},2516:function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});var r=n(8),i=n(35),s=n(2244),o={listContext:i.o,pageContext:i.h},u=new r.t({name:"ClientFormProviderV2",factory:{dependencies:o,create:function(e){var t=e.listContext,n=e.pageContext,r=new s.e({listContext:a(t),pageContext:n});return{instance:r,disposable:r}}}});function a(e){return{listUrl:e.listUrl,listId:e.listId,urlParts:e.urlParts,listTitle:e.listTitle,listTemplateType:e.listTemplateType,isDocLib:e.isDocLib,folderPath:e.folderPath,enableAttachments:!!e.enableAttachments,leftNavigationData:e.leftNavigationData,refreshClientForm:e.refreshClientForm,contentTypesEnabled:e.contentTypesEnabled,tenantTagPolicyEnabled:e.tenantTagPolicyEnabled,allowCreateFolder:e.allowCreateFolder,flags2:e.flags2}}},3643:function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return d});var r=n(101),i=n(0),s=n(59),o=n(94),u=n(80),a=n(211),f=n(2278),l=n(2516),c=n(2304),h=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,n.pageContext)||this;r._pageContext=n.pageContext;return r}t.prototype.getClientForm=function(e){var t=e.resources,n=e.item,r=e.isBulkEdit,i=e.forceToFetch,s=this._getClientFormParmsV2(n,r),o=new u.e({name:"TMR.getClientForm"});return t.consume(l.t).getClientForm(s,i,!0).then(function(e){return e},function(e){o.end(Object(a.e)(e));throw e})};t.prototype.setItemExpirationDate=function(e,t){var n,r=Object(o.n)(this._pageContext),i=encodeURI(null===(n=null==e?void 0:e.id)||void 0===n?void 0:n.replace(/'/g,"%27")),s=r+"/_api/web/GetFileByServerRelativeUrl('".concat(i,"')/SetExpirationDate"),u={},a=null;t&&(a=t.toISOString());u.expirationDate=a;return this.dataRequestor.getData({url:s,parseResponse:function(e){},qosName:"TMR.setItemExpirationDate",additionalPostData:JSON.stringify(u),method:"POST",noRedirect:!0})};t.prototype.clearStoreClientForm=function(e){return s.n.resolve(e.consumeAsync(l.t)).then(function(e){return e.clearStoreClientForm()})};t.prototype.getItemExpirationDate=function(e){var t=Object(o.n)(this._pageContext),n=e.id,r=t+"/_api/web/GetFileByServerRelativeUrl('".concat(n,"')/ExpirationDate");return this.dataRequestor.getData({url:r,parseResponse:function(e){var t,n=JSON.parse(e);return!!(null===(t=null==n?void 0:n.d)||void 0===t?void 0:t.ExpirationDate)},qosName:"TMR.getItemExpirationDate",method:"GET",noRedirect:!0})};t.prototype._getClientFormParmsV2=function(e,t){var n=e.peek(),r=Object(c.n)(n),i=n.properties||{};return{clientFormType:1,item:r,itemId:i.ID,contentType:i.ContentType,contentTypeId:i.ContentTypeId,isBulkEdit:t,selection:[r]}};return t})(f.e),p=n(35),d=Object(r.s)("ExpirationStore",h,{pageContext:p.h})}}]);