var shellPerformance=window.performance,HighResolutionTimingSupported=!!shellPerformance&&"function"==typeof shellPerformance.mark;HighResolutionTimingSupported&&shellPerformance.mark("shell_otellogging_start"),(self.suiteux_shell_webpackJsonp_main=self.suiteux_shell_webpackJsonp_main||[]).push([["otellogging"],{9460:function(e,n,t){t.d(n,{cb:function(){return r},fK:function(){return i},jA:function(){return o},hB:function(){return a},bO:function(){return s},Pw:function(){return u},V4:function(){return c},rl:function(){return l},yu:function(){return f},RJ:function(){return d},CY:function(){return v}});
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var r="function",i="object",o="undefined",a="prototype",s="hasOwnProperty",u=Object,c=u[a],l=u.assign,f=u.create,d=u.defineProperty,v=c[s]},57062:function(e,n,t){t.d(n,{Rd:function(){return o},ZU:function(){return a},pu:function(){return s}});var r=t(9460),i=null;
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
function o(e){return void 0===e&&(e=!0),i&&e||(typeof globalThis!==r.jA&&globalThis&&(i=globalThis),typeof self!==r.jA&&self&&(i=self),typeof window!==r.jA&&window&&(i=window),typeof t.g!==r.jA&&t.g&&(i=t.g)),i}function a(e){throw new TypeError(e)}function s(e){var n=r.yu;if(n)return n(e);if(null==e)return{};var t=typeof e;function i(){}return t!==r.fK&&t!==r.cb&&a("Object prototype may only be an Object:"+e),i[r.hB]=e,new i}},21777:function(e,n,t){t.d(n,{uc:function(){return o},ne:function(){return s},$h:function(){return u}});var r=t(9460),i=t(57062),o=(((0,i.Rd)()||{}).Symbol,((0,i.Rd)()||{}).Reflect,r.rl||function(e){for(var n,t=1,i=arguments.length;t<i;t++)for(var o in n=arguments[t])r.V4[r.bO].call(n,o)&&(e[o]=n[o]);return e}),a=function(e,n){return a=r.Pw.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n[r.bO](t)&&(e[t]=n[t])},a(e,n)};function s(e,n){function t(){this.constructor=e}typeof n!==r.cb&&null!==n&&(0,i.ZU)("Class extends value "+String(n)+" is not a constructor or null"),a(e,n),e[r.hB]=null===n?(0,i.pu)(n):(t[r.hB]=n[r.hB],new t)}function u(e,n){for(var t=0,r=n.length,i=e.length;t<r;t++,i++)e[i]=n[t];return e}},44353:function(e,n){
/*!
 * Microsoft Dynamic Proto Utility, 1.1.4
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
var t="constructor",r="prototype",i="function",o="_dynClass",a="_unknown_",s=Object,u=s.getPrototypeOf,c=0;function l(e,n){return e&&s.prototype.hasOwnProperty.call(e,n)}function f(e){return e&&(e===s.prototype||e===Array.prototype)}function d(e){return f(e)||e===Function.prototype}function v(e){if(e){if(u)return u(e);var n=e.__proto__||e.prototype||(e.constructor?e.constructor.prototype:null);if(n)return n}return null}function p(e,n){var t=[],r=s.getOwnPropertyNames;if(r)t=r(e);else for(var i in e)"string"==typeof i&&l(e,i)&&t.push(i);if(t&&t.length>0)for(var o=0;o<t.length;o++)n(t[o])}function g(e,n,r){return n!==t&&typeof e[n]===i&&(r||l(e,n))}function h(e){throw new TypeError("DynamicProto: "+e)}function y(e,n){for(var t=e.length-1;t>=0;t--)if(e[t]===n)return!0;return!1}function m(e,n,t,r){var a=null;if(e&&l(t,o)){var s=e._dynInstFuncs||{};if((a=(s[t._dynClass]||{})[n])||h("Missing ["+n+"] "+i),!a._dynInstChk&&!1!==s._dynInstChk){for(var u=!l(e,n),c=v(e),f=[];u&&c&&!d(c)&&!y(f,c);){var p=c[n];if(p){u=p===r;break}f.push(c),c=v(c)}try{u&&(e[n]=a),a._dynInstChk=1}catch(e){s._dynInstChk=!1}}}return a}function C(e,n,t){var r=n[e];return r===t&&(r=v(n)[e]),typeof r!==i&&h("["+e+"] is not a "+i),r}function T(e,n,t,r,i){if(!f(e)){var o=t._dynInstFuncs=t._dynInstFuncs||{},a=o[n]=o[n]||{};!1!==o._dynInstChk&&(o._dynInstChk=!!i),p(t,(function(n){g(t,n,!1)&&t[n]!==r[n]&&(a[n]=t[n],delete t[n],(!l(e,n)||e[n]&&!e[n]._isDynProxy)&&(e[n]=function(e,n){var t=function(){return(m(this,n,e,t)||C(n,e,t)).apply(this,arguments)};return t._isDynProxy=1,t}(e,n)))}))}}function S(e,n){return l(e,r)?e.name||n||a:((e||{}).constructor||{}).name||n||a}function x(e,n,t,i){l(e,r)||h("theClass is an invalid class definition.");var a=e.prototype;(function(e,n){if(u)for(var t=[],r=v(n);r&&!d(r)&&!y(t,r);){if(r===e)return!0;t.push(r),r=v(r)}return!1})(a,n)||h("["+S(e)+"] is not in class hierarchy of ["+S(n)+"]");var s=null;l(a,o)?s=a._dynClass:(s="_dynCls$"+S(e,"_")+"$"+c,c++,a._dynClass=s);var f=x._dfOpts,m=!!f.useBaseInst;m&&i&&void 0!==i.useBaseInst&&(m=!!i.useBaseInst);var C=function(e){var n={};return p(e,(function(t){!n[t]&&g(e,t,!1)&&(n[t]=e[t])})),n}(n),b=function(e,n,t,r){function i(e,n,t){var i=n[t];if(i._isDynProxy&&r){var o=e._dynInstFuncs||{};!1!==o._dynInstChk&&(i=(o[n._dynClass]||{})[t]||i)}return function(){return i.apply(e,arguments)}}var o={};p(t,(function(e){o[e]=i(n,t,e)}));for(var a=v(e),s=[];a&&!d(a)&&!y(s,a);)p(a,(function(e){!o[e]&&g(a,e,!u)&&(o[e]=i(n,a,e))})),s.push(a),a=v(a);return o}(a,n,C,m);t(n,b);var w=!!u&&!!f.setInstFuncs;w&&i&&(w=!!i.setInstFuncs),T(a,s,n,C,!1!==w)}x._dfOpts={setInstFuncs:!0,useBaseInst:!0},n.Z=x},95161:function(e,n,t){t.r(n),t.d(n,{initializeLogging:function(){return Jr}});var r=t(31191);var i,o=(i=[],{fireEvent:function(e){i.forEach((function(n){return n(e)}))},addListener:function(e){e&&i.push(e)}});function a(e,n,t){o.fireEvent({level:e,category:n,message:t})}function s(e,n,t){a(0,e,(function(){var e=t instanceof Error?t.message:"";return n+": "+e}))}var u,c={};!function(e){var n=9007199254740991,t=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,r=/^[a-zA-Z0-9_\.]{1,95}$/;function i(e){return r.test(e)}function o(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!i(e.name))throw new Error("Invalid dataField name");2===e.dataType&&a(e.value)}))}function a(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<-9007199254740991||e>n)throw new Error("Invalid integer "+JSON.stringify(e))}e.validateTelemetryEvent=function(e){if(!function(e){if(!e||e.length>98)return!1;return t.test(e)}(e.eventName))throw new Error("Invalid eventName");var n=e.eventContract;if(n){if(n.name&&!i(n.name))throw new Error("Invalid eventContract");o(n.dataFields)}o(e.dataFields)},e.validateInt=a}(u||(u={}));function l(e,n){return{name:e,dataType:1,value:n,classification:4}}function f(e,n){return{name:e,dataType:2,value:n,classification:4}}function d(e,n){return{name:e,dataType:0,value:n,classification:4}}function v(e){var n={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?(0,r.pi)({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(n.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),n}var p=function(){function e(e,n,t){var i,o;this.telemetrySinks=[],this.persistentDataFields=[],this.eventQueue=[],this.config=t||{},e&&(this.telemetrySinks=e.telemetrySinks,(i=this.persistentDataFields).push.apply(i,e.persistentDataFields),this.config=(0,r.pi)((0,r.pi)({},e.getConfig()),this.config)),n&&(o=this.persistentDataFields).push.apply(o,n)}return e.prototype.sendTelemetryEvent=function(e){var n=v(e),t=n.telemetryProperties;if(t.customerContentVersion||t.customerContentType)a(0,0,(function(){return"Customer content"}));else{if(!t.ariaTenantToken||!t.nexusTenantToken){var r=function(e){for(var n=e.length;n>0;){var t=e.substr(0,n);if(c[t])return c[t];n=e.lastIndexOf(".",n-1)}}(n.eventName);if(!r)return void a(0,0,(function(){return"No tenant token: "+e.eventName}));t.ariaTenantToken=r.ariaTenantToken,t.nexusTenantToken=r.nexusTenantToken}this.sendTelemetryEventInternal(n)}},e.prototype.sendCustomerContent=function(e){var n=v(e),t=n.telemetryProperties;return(!t.customerContentVersion||t.customerContentVersion>1)&&(t.customerContentVersion=1),t.ariaTenantToken=void 0,t.nexusTenantToken=void 0,n.dataFields.push(f("EventContent.Type",2)),this.sendTelemetryEventInternal(n)},e.prototype.sendTelemetryEventInternal=function(e){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push(e):a(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e)}catch(e){return void s(0,"SendTelemetryEvent",e)}try{this.telemetrySinks.forEach((function(n){var t=e.telemetryProperties;t.customerContentVersion&&t.customerContentType?n.sendCustomerContent&&n.sendCustomerContent(e):n.sendTelemetryEvent(e)}))}catch(e){}},e.prototype.processTelemetryEvent=function(e){var n,t;e.dataFields&&(null===(t=e.dataFields)||void 0===t||t.unshift(d("OTelJS.Version","4.5.3")),this.persistentDataFields&&(n=e.dataFields).unshift.apply(n,this.persistentDataFields)),this.config.disableValidation||u.validateTelemetryEvent(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e)},e.prototype.flushQueue=function(){var e=this,n=this.eventQueue;this.eventQueue=[],this.telemetrySinks.length>0&&n.forEach((function(n){e.sendTelemetryEventInternal(n)}))},e.prototype.setTenantToken=function(e,n,t){!function(e,n){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?c[e]=n:a(0,0,(function(){return"Namespace: "+e}))}(e,{ariaTenantToken:n,nexusTenantToken:t})},e.prototype.cloneEvent=function(e){return v(e)},e.prototype.getConfig=function(){return this.config},e}();function g(e,n){return e?e+"."+n:n}function h(e,n,t,r){t&&r.push(d(""+g(e,n),t))}function y(e,n,t,r){"boolean"==typeof t&&r.push(l(""+g(e,n),t))}function m(e,n,t,r){"number"==typeof t&&r.push(f(""+g(e,n),t))}var C,T=function(e){var n="Activity.Result",t=[];return m(n,"Code",e.code,t),h(n,"Type",e.type,t),m(n,"Tag",e.tag,t),y(n,"IsExpected",e.isExpected,t),t.push(d("zC.Activity.Result","Office.System.Result")),t},S={contractName:"Office.System.Activity",getFields:function(e){var n="Activity",t=[];return h(n,"CV",e.cV,t),m(n,"Duration",e.duration,t),m(n,"Count",e.count,t),m(n,"AggMode",e.aggMode,t),y(n,"Success",e.success,t),e.result&&t.push.apply(t,T(e.result)),t.push(d("zC.Activity",this.contractName)),t}},x=function(e){var n="User",t=[];return h(n,"PrimaryIdentityHash",e.primaryIdentityHash,t),h(n,"PrimaryIdentitySpace",e.primaryIdentitySpace,t),h(n,"TenantId",e.tenantId,t),h(n,"TenantGroup",e.tenantGroup,t),y(n,"IsAnonymous",e.isAnonymous,t),t},b=function(e){var n="App",t=[];return h(n,"Name",e.name,t),h(n,"Platform",e.platform,t),h(n,"Version",e.version,t),t},w=function(e){var n=[];return h("Session","Id",e.id,n),n};!function(e){var n,t=0;e.getNext=function(){return void 0===n&&(n=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=22,t=[],r=0;r<n;r++)t.push(e.charAt(Math.floor(Math.random()*e.length)));return t.join("")}()),new r(n,++t)},e.getNextChild=function(e){return new r(e.getString(),++e.nextChild)};var r=function(){function e(e,n){this.base=e,this.id=n,this.nextChild=0}return e.prototype.getString=function(){return this.base+"."+this.id},e}();e.CV=r}(C||(C={}));var I=function(){return 1e3*Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(I=function(){return 1e3*Math.floor(window.performance.now())});var E,P=function(e){var n,t=I(),r=v(e.telemetryEvent);return{cv:e.parentCv?C.getNextChild(e.parentCv):C.getNext(),eventName:e.telemetryEvent.eventName,dataFields:r.dataFields,eventFlags:r.eventFlags,telemetryProperties:r.telemetryProperties,createChildActivity:function(n){return P({telemetryEvent:n,sendTelemetryEvent:e.sendTelemetryEvent,parentCv:this.cv})},setResult:function(e,n,t){this.result={code:e,type:n,tag:t}},endNow:function(){if(!n){void 0===this.success&&void 0===this.result&&a(1,0,(function(){return"Activity does not have success or result set"}));var r=I();n=!0;var i={duration:r-t,count:1,aggMode:0,cV:this.cv.getString(),success:this.success,result:this.result},o=this.eventContract&&this.eventContract.dataFields?this.eventContract.dataFields:[];return o.push.apply(o,S.getFields(i)),this.eventContract={name:S.contractName,dataFields:o},e.sendTelemetryEvent(this)}a(0,0,(function(){return"Already ended"}))}}},k=function(e){var n=[];return n.push(d("Error.ErrorGroup",e.errorGroup)),n.push(f("Error.Tag",e.tag)),void 0!==e.code&&n.push(f("Error.Code",e.code)),void 0!==e.id&&n.push(f("Error.Id",e.id)),void 0!==e.count&&n.push(f("Error.Count",e.count)),n},_=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,r.ZT)(n,e),n.prototype.createActivity=function(e){return function(e,n){return P({telemetryEvent:n,sendTelemetryEvent:function(n){e.sendTelemetryEvent(n)}})}(this,e)},n.prototype.sendActivity=function(e,n,t,r){return this.sendTelemetryEvent({eventName:e,eventContract:{name:S.contractName,dataFields:S.getFields(n)},dataFields:t,eventFlags:r})},n.prototype.sendError=function(e){var n=k(e.error);return null!=e.dataFields&&n.push.apply(n,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:n,eventFlags:e.eventFlags})},n.prototype.createCustomerContentActivity=function(e){return function(e,n){return P({telemetryEvent:n,sendTelemetryEvent:function(n){e.sendCustomerContent(n)}})}(this,e)},n}(p),O=t(21777);!function(e){e[e.CRITICAL=1]="CRITICAL",e[e.WARNING=2]="WARNING"}(E||(E={}));var N={BrowserDoesNotSupportLocalStorage:0,BrowserCannotReadLocalStorage:1,BrowserCannotReadSessionStorage:2,BrowserCannotWriteLocalStorage:3,BrowserCannotWriteSessionStorage:4,BrowserFailedRemovalFromLocalStorage:5,BrowserFailedRemovalFromSessionStorage:6,CannotSendEmptyTelemetry:7,ClientPerformanceMathError:8,ErrorParsingAISessionCookie:9,ErrorPVCalc:10,ExceptionWhileLoggingError:11,FailedAddingTelemetryToBuffer:12,FailedMonitorAjaxAbort:13,FailedMonitorAjaxDur:14,FailedMonitorAjaxOpen:15,FailedMonitorAjaxRSC:16,FailedMonitorAjaxSend:17,FailedMonitorAjaxGetCorrelationHeader:18,FailedToAddHandlerForOnBeforeUnload:19,FailedToSendQueuedTelemetry:20,FailedToReportDataLoss:21,FlushFailed:22,MessageLimitPerPVExceeded:23,MissingRequiredFieldSpecification:24,NavigationTimingNotSupported:25,OnError:26,SessionRenewalDateIsZero:27,SenderNotInitialized:28,StartTrackEventFailed:29,StopTrackEventFailed:30,StartTrackFailed:31,StopTrackFailed:32,TelemetrySampledAndNotSent:33,TrackEventFailed:34,TrackExceptionFailed:35,TrackMetricFailed:36,TrackPVFailed:37,TrackPVFailedCalc:38,TrackTraceFailed:39,TransmissionFailed:40,FailedToSetStorageBuffer:41,FailedToRestoreStorageBuffer:42,InvalidBackendResponse:43,FailedToFixDepricatedValues:44,InvalidDurationValue:45,TelemetryEnvelopeInvalid:46,CreateEnvelopeError:47,CannotSerializeObject:48,CannotSerializeObjectNonSerializable:49,CircularReferenceDetected:50,ClearAuthContextFailed:51,ExceptionTruncated:52,IllegalCharsInName:53,ItemNotInArray:54,MaxAjaxPerPVExceeded:55,MessageTruncated:56,NameTooLong:57,SampleRateOutOfRange:58,SetAuthContextFailed:59,SetAuthContextFailedAccountName:60,StringValueTooLong:61,StartCalledMoreThanOnce:62,StopCalledWithoutStart:63,TelemetryInitializerFailed:64,TrackArgumentsNotSpecified:65,UrlTooLong:66,SessionStorageBufferFull:67,CannotAccessCookie:68,IdTooLong:69,InvalidEvent:70,FailedMonitorAjaxSetRequestHeader:71,SendBrowserInfoOnUserInit:72,PluginException:73,NotificationException:74,SnippetScriptLoadFailure:99,InvalidInstrumentationKey:100,CannotParseAiBlobValue:101,InvalidContentBlob:102,TrackPageActionEventFailed:103,FailedAddingCustomDefinedRequestContext:104,InMemoryStorageBufferFull:105},F=t(9460),R=t(57062),M=F.RJ;F.Pw.freeze,F.Pw.seal;function A(e){return F.V4.toString.call(e)}function L(e,n){return typeof e===n}function D(e){return void 0===e||typeof e===F.jA}function B(e){return null===e||D(e)}function K(e){return!B(e)}function U(e,n){return e&&F.CY.call(e,n)}function z(e){return typeof e===F.fK}function q(e){return typeof e===F.cb}function H(e,n,t,r){void 0===r&&(r=!1);var i=!1;if(!B(e))try{B(e.addEventListener)?B(e.attachEvent)||(e.attachEvent("on"+n,t),i=!0):(e.addEventListener(n,t,r),i=!0)}catch(e){}return i}function V(e,n){if(e)for(var t in e)F.CY.call(e,t)&&n.call(e,t,e[t])}function j(e,n){if(e&&n){var t=n.length,r=e.length;if(e===n)return!0;if(r>=t){for(var i=r-1,o=t-1;o>=0;o--){if(e[i]!=n[o])return!1;i--}return!0}}return!1}function Z(e,n){var t=!1;if(e&&n){var r=n.length;if(e===n)return!0;if(e.length>=r){for(var i=0;i<r;i++)if(e[i]!==n[i])return!1;t=!0}}return t}function W(e,n){return!(!e||!n)&&-1!==e.indexOf(n)}function G(e){return"[object Date]"===A(e)}function J(e){return"[object Array]"===A(e)}function Q(e){return"[object Error]"===A(e)}function X(e){return"string"==typeof e}function Y(e){return"number"==typeof e}function $(e){return"boolean"==typeof e}function ee(e){if(e){if(e.toISOString)return e.toISOString();if(G(e)){var n=function(e){var n=String(e);return 1===n.length&&(n="0"+n),n};return e.getUTCFullYear()+"-"+n(e.getUTCMonth()+1)+"-"+n(e.getUTCDate())+"T"+n(e.getUTCHours())+":"+n(e.getUTCMinutes())+":"+n(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}}function ne(e,n,t){var r=e.length;try{for(var i=0;i<r&&(!(i in e)||-1!==n.call(t||e,e[i],i,e));i++);}catch(e){}}function te(e,n,t){var r=e.length,i=t||0;try{for(var o=Math.max(i>=0?i:r-Math.abs(i),0);o<r;o++)if(o in e&&e[o]===n)return o}catch(e){}return-1}function re(e,n,t){var r=e.length,i=t||e,o=new Array(r);try{for(var a=0;a<r;a++)a in e&&(o[a]=n.call(i,e[a],e))}catch(e){}return o}function ie(e,n,t){var r,i=e.length,o=0;if(arguments.length>=3)r=arguments[2];else{for(;o<i&&!(o in e);)o++;r=e[o++]}for(;o<i;)o in e&&(r=n(r,e[o],o,e)),o++;return r}function oe(e){return"string"!=typeof e?e:e.replace(/^\s+|\s+$/g,"")}var ae=!{toString:null}.propertyIsEnumerable("toString"),se=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function ue(e){var n=typeof e;n===F.cb||n===F.fK&&null!==e||(0,R.ZU)("objKeys called on non-object");var t=[];for(var r in e)e&&F.CY.call(e,r)&&t.push(r);if(ae)for(var i=se.length,o=0;o<i;o++)e&&F.CY.call(e,se[o])&&t.push(se[o]);return t}function ce(e,n,t,r){if(M)try{var i={enumerable:!0,configurable:!0};return t&&(i.get=t),r&&(i.set=r),M(e,n,i),!0}catch(e){}return!1}function le(){var e=Date;return e.now?e.now():(new e).getTime()}function fe(e,n,t,r,i){var o=t;return e&&((o=e[n])===t||i&&!i(o)||r&&!r(t)||(o=t,e[n]=o)),o}function de(e){return!e}function ve(e){return!!e}function pe(e){throw new Error(e)}function ge(e){return e&&(e=(0,F.Pw)(F.rl?(0,F.rl)({},e):e)),e}
/*
 * Application Insights JavaScript SDK - Core, 2.7.3
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
var he="window",ye="JSON",me="msie",Ce="trident/",Te=null,Se=null,xe=!1,be=null,we=null;function Ie(e,n){var t=!1;if(e){try{if(!(t=n in e)){var r=e[F.hB];r&&(t=n in r)}}catch(e){}if(!t)try{t=!D((new e)[n])}catch(e){}}return t}function Ee(e){var n=(0,R.Rd)();return n&&n[e]?n[e]:e===he&&Pe()?window:null}function Pe(){return Boolean(typeof window===F.fK&&window)}function ke(){return Pe()?window:Ee(he)}function _e(){return Boolean(typeof document===F.fK&&document)?document:Ee("document")}function Oe(){return Boolean(typeof navigator===F.fK&&navigator)}function Ne(){return Oe()?navigator:Ee("navigator")}function Fe(e){if(e&&xe){var n=Ee("__mockLocation");if(n)return n}return typeof location===F.fK&&location?location:Ee("location")}function Re(){return Boolean(typeof JSON===F.fK&&JSON||null!==Ee(ye))}function Me(){return Re()?JSON||Ee(ye):null}function Ae(){var e=Ne();return!(!e||!e.product)&&"ReactNative"===e.product}function Le(){var e=Ne();if(e&&(e.userAgent!==Se||null===Te)){var n=((Se=e.userAgent)||"").toLowerCase();Te=W(n,me)||W(n,Ce)}return Te}function De(e){var n=Object[F.hB].toString.call(e),t="";return"[object Error]"===n?t="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":Re()&&(t=Me().stringify(e)),n+t}function Be(){return null===we&&(we=Oe()&&Boolean(Ne().sendBeacon)),we}function Ke(e){var n=!1;try{n=!!Ee("fetch");var t=Ee("Request");n&&e&&t&&(n=Ie(t,"keepalive"))}catch(e){}return n}function Ue(){return null===be&&(be="undefined"!=typeof XDomainRequest)&&ze()&&(be=be&&!Ie(Ee("XMLHttpRequest"),"withCredentials")),be}function ze(){var e=!1;try{e=!!Ee("XMLHttpRequest")}catch(e){}return e}var qe,He=t(44353),Ve=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],je=null;function Ze(e,n){return function(){var t=arguments,r=We(n);if(r){var i=r.listener;i&&i[e]&&i[e].apply(i,t)}}}function We(e){var n,t=je;return t||!0===e.disableDbgExt||(t=je||((n=Ee("Microsoft"))&&(je=n.ApplicationInsights),je)),t?t.ChromeDbgExt:null}function Ge(e){return e?'"'+e.replace(/\"/g,"")+'"':""}function Je(e,n){var t=typeof console!==F.jA?console:Ee("console");if(t){var r="log";t[e]&&(r=e),q(t[r])&&t[r](n)}}var Qe=function(){function e(e,n,t,r){void 0===t&&(t=!1);var i=this;i.messageId=e,i.message=(t?"AI: ":"AI (Internal): ")+e;var o="";Re()&&(o=Me().stringify(r));var a=(n?" message:"+Ge(n):"")+(r?" props:"+Ge(o):"");i.message+=a}return e.dataType="MessageData",e}();var Xe=function e(n){this.identifier="DiagnosticLogger",this.queue=[];var t=0,r={};(0,He.Z)(e,this,(function(e){function i(e,t){var r=n[e];return B(r)?t:r}function o(e,t){var r=We(n);r&&r.diagLog&&r.diagLog(e,t)}B(n)&&(n={}),e.consoleLoggingLevel=function(){return i("loggingLevelConsole",0)},e.telemetryLoggingLevel=function(){return i("loggingLevelTelemetry",1)},e.maxInternalMessageLimit=function(){return i("maxMessageLimit",25)},e.enableDebugExceptions=function(){return i("enableDebugExceptions",!1)},e.throwInternal=function(n,t,i,a,s){void 0===s&&(s=!1);var u=new Qe(t,i,s,a);if(e.enableDebugExceptions())throw u;var c=n===E.CRITICAL?"errorToConsole":"warnToConsole";if(D(u.message))o("throw"+(n===E.CRITICAL?"Critical":"Warning"),u);else{var l=e.consoleLoggingLevel();if(s){var f=+u.messageId;!r[f]&&l>=n&&(e[c](u.message),r[f]=!0)}else l>=n&&e[c](u.message);e.logInternalMessage(n,u)}},e.warnToConsole=function(e){Je("warn",e),o("warning",e)},e.errorToConsole=function(e){Je("error",e),o("error",e)},e.resetInternalMessageCount=function(){t=0,r={}},e.logInternalMessage=function(n,i){if(!(t>=e.maxInternalMessageLimit())){var a=!0,s="AITR_"+i.messageId;if(r[s]?a=!1:r[s]=!0,a&&(n<=e.telemetryLoggingLevel()&&(e.queue.push(i),t++,o(n===E.CRITICAL?"error":"warn",i)),t===e.maxInternalMessageLimit())){var u="Internal events throttle limit per PageView reached for this app.",c=new Qe(N.MessageLimitPerPVExceeded,u,!1);e.queue.push(c),n===E.CRITICAL?e.errorToConsole(u):e.warnToConsole(u)}}}}))},Ye=null,$e=function(){function e(n,t,r){var i,o=this,a=!1;(o.start=le(),o.name=n,o.isAsync=r,o.isChildEvt=function(){return!1},q(t))&&(a=ce(o,"payload",(function(){return!i&&q(t)&&(i=t(),t=null),i})));o.getCtx=function(n){return n?n===e.ParentContextKey||n===e.ChildrenContextKey?o[n]:(o.ctx||{})[n]:null},o.setCtx=function(n,t){if(n)if(n===e.ParentContextKey)o[n]||(o.isChildEvt=function(){return!0}),o[n]=t;else if(n===e.ChildrenContextKey)o[n]=t;else{(o.ctx=o.ctx||{})[n]=t}},o.complete=function(){var n=0,r=o.getCtx(e.ChildrenContextKey);if(J(r))for(var i=0;i<r.length;i++){var s=r[i];s&&(n+=s.time)}o.time=le()-o.start,o.exTime=o.time-n,o.complete=function(){},!a&&q(t)&&(o.payload=t())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),en=function e(n){this.ctx={},(0,He.Z)(e,this,(function(e){e.create=function(e,n,t){return new $e(e,n,t)},e.fire=function(e){e&&(e.complete(),n&&q(n.perfEvent)&&n.perfEvent(e))},e.setCtx=function(n,t){n&&((e.ctx=e.ctx||{})[n]=t)},e.getCtx=function(n){return(e.ctx||{})[n]}}))},nn="CoreUtils.doPerf";function tn(e,n,t,r,i){if(e){var o=e;if(q(o.getPerfMgr)&&(o=o.getPerfMgr()),o){var a=void 0,s=o.getCtx(nn);try{if(a=o.create(n(),r,i)){if(s&&a.setCtx&&(a.setCtx($e.ParentContextKey,s),s.getCtx&&s.setCtx)){var u=s.getCtx($e.ChildrenContextKey);u||(u=[],s.setCtx($e.ChildrenContextKey,u)),u.push(a)}return o.setCtx(nn,a),t(a)}}catch(e){a&&a.setCtx&&a.setCtx("exception",e)}finally{a&&o.fire(a),o.setCtx(nn,s)}}}return t()}
/*
 * Application Insights JavaScript SDK - Core, 2.7.3
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
var rn=function(e,n){var t=this,r=null,i=q(e.processTelemetry),o=q(e.setNextPlugin);t._hasRun=!1,t.getPlugin=function(){return e},t.getNext=function(){return r},t.setNext=function(e){r=e},t.processTelemetry=function(a,s){s||(s=n);var u=e?e.identifier:"TelemetryPluginChain";tn(s?s.core():null,(function(){return u+":processTelemetry"}),(function(){if(e&&i){t._hasRun=!0;try{s.setNext(r),o&&e.setNextPlugin(r),r&&(r._hasRun=!1),e.processTelemetry(a,s)}catch(t){var n=r&&r._hasRun;r&&n||s.diagLog().throwInternal(E.CRITICAL,N.PluginException,"Plugin ["+e.identifier+"] failed during processTelemetry - "+De(t)),r&&!n&&r.processTelemetry(a,s)}}else r&&(t._hasRun=!0,r.processTelemetry(a,s))}),(function(){return{item:a}}),!a.sync)}};
/*
 * Application Insights JavaScript SDK - Core, 2.7.3
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
function on(e,n){var t=[];if(e&&e.length>0)for(var r=null,i=0;i<e.length;i++){var o=e[i];if(o&&q(o.processTelemetry)){var a=new rn(o,n);t.push(a),r&&r.setNext(a),r=a}}return t.length>0?t[0]:null}var an=function e(n,t,r,i){var o=this,a=null;null!==i&&(n&&q(n.getPlugin)?a=function(e,n,t){var r=[],i=!t;if(e)for(;e;){var o=e.getPlugin();(i||o===t)&&(i=!0,r.push(o)),e=e.getNext()}return i||r.push(t),on(r,n)}(n,o,i||n.getPlugin()):i?a=function(e,n,t){var r=e,i=!1;return t&&e&&(r=[],ne(e,(function(e){(i||e===t)&&(i=!0,r.push(e))}))),t&&!i&&(r||(r=[]),r.push(t)),on(r,n)}(n,o,i):D(i)&&(a=on(n,o))),o.core=function(){return r},o.diagLog=function(){return function(e,n){return(e||{}).logger||new Xe(n)}(r,t)},o.getCfg=function(){return t},o.getExtCfg=function(e,n){var r;if(void 0===n&&(n={}),t){var i=t.extensionConfig;i&&e&&(r=i[e])}return r||n},o.getConfig=function(e,n,r){var i;void 0===r&&(r=!1);var a=o.getExtCfg(e,null);return a&&!B(a[n])?i=a[n]:t&&!B(t[n])&&(i=t[n]),B(i)?r:i},o.hasNext=function(){return null!=a},o.getNext=function(){return a},o.setNext=function(e){a=e},o.processNext=function(e){var n=a;n&&(a=n.getNext(),n.processTelemetry(e,o))},o.createNew=function(n,i){return void 0===n&&(n=null),new e(n||a,t,r,i)}},sn="extensionConfig",un=function(){function e(){var e=this,n=!1,t=null,r=null;e.core=null,e.diagLog=function(n){return e._getTelCtx(n).diagLog()},e.isInitialized=function(){return n},e.setInitialized=function(e){n=e},e.setNextPlugin=function(e){r=e},e.processNext=function(e,n){n?n.processNext(e):r&&q(r.processTelemetry)&&r.processTelemetry(e,null)},e._getTelCtx=function(n){void 0===n&&(n=null);var i=n;if(!i){var o=t||new an(null,{},e.core);i=r&&r.getPlugin?o.createNew(null,r.getPlugin):o.createNew(null,r)}return i},e._baseTelInit=function(i,o,a,s){i&&fe(i,sn,[],null,B),!s&&o&&(s=o.getProcessTelContext().getNext());var u=r;r&&r.getPlugin&&(u=r.getPlugin()),e.core=o,t=new an(s,i,o,u),n=!0}}return e.prototype.initialize=function(e,n,t,r){this._baseTelInit(e,n,t,r)},e}();function cn(e,n){for(var t=[],r=null,i=e.getNext();i;){var o=i.getPlugin();o&&(r&&q(r.setNextPlugin)&&q(o.processTelemetry)&&r.setNextPlugin(o),q(o.isInitialized)&&o.isInitialized()||t.push(o),r=o,i=i.getNext())}ne(t,(function(t){t.initialize(e.getCfg(),e.core(),n,e.getNext())}))}function ln(e){return e.sort((function(e,n){var t=0,r=q(n.processTelemetry);return q(e.processTelemetry)?t=r?e.priority-n.priority:1:r&&(t=-1),t}))}
/*
 * Application Insights JavaScript SDK - Core, 2.7.3
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
var fn=500,dn=function(e){function n(){var t,r=e.call(this)||this;function i(e){e&&e.length>0&&(function(e){ne(e,(function(e){e.priority<fn&&pe("Channel has invalid priority"+e.identifier)}))}(e=e.sort((function(e,n){return e.priority-n.priority}))),t.push(e))}return r.identifier="ChannelControllerPlugin",r.priority=500,(0,He.Z)(n,r,(function(e,n){e.setNextPlugin=function(e){},e.processTelemetry=function(e,n){t&&ne(t,(function(t){t.length>0&&r._getTelCtx(n).createNew(t).processNext(e)}))},e.getChannelControls=function(){return t},e.initialize=function(r,o,a){e.isInitialized()||(n.initialize(r,o,a),function(e,n){t=[],e&&ne(e,(function(e){return i(e)}));if(n){var r=[];ne(n,(function(e){e.priority>fn&&r.push(e)})),i(r)}}((r||{}).channels,a),ne(t,(function(e){return cn(new an(e,r,o),a)})))}})),r}var t;return(0,O.ne)(n,e),n._staticInit=(ce(t=n.prototype,"ChannelControls",t.getChannelControls),void ce(t,"channelQueue",t.getChannelControls)),n}(un),vn="toGMTString",pn="toUTCString",gn="expires",hn="",yn=null,mn=null,Cn=null,Tn=_e(),Sn={},xn={};function bn(e,n){var t=In._ckMgr||xn._ckMgr;return t||(t=In._ckMgr=In(e,n),xn._ckMgr=t),t}function wn(e){return!e||e.isEnabled()}function In(e,n){var t=function(e){var n=e.cookieCfg=e.cookieCfg||{};if(fe(n,"domain",e.cookieDomain,K,B),fe(n,"path",e.cookiePath||"/",null,B),B(n.enabled)){var t=void 0;D(e.isCookieUseDisabled)||(t=!e.isCookieUseDisabled),D(e.disableCookiesUsage)||(t=!e.disableCookiesUsage),n.enabled=t}return n}(e||xn),r=t.path||"/",i=t.domain,o=!1!==t.enabled,a={isEnabled:function(){var e=o&&En(n),t=xn._ckMgr;return e&&t&&a!==t&&(e=wn(t)),e},setEnabled:function(e){o=!1!==e},set:function(e,n,o,s,u){var c=!1;if(wn(a)){var l={},f=oe(n||hn),d=f.indexOf(";");if(-1!==d&&(f=oe(n.substring(0,d)),l=Pn(n.substring(d+1))),fe(l,"domain",s||i,ve,D),!B(o)){var v=Le();if(D(l.expires)){var p=le()+1e3*o;if(p>0){var g=new Date;g.setTime(p),fe(l,gn,kn(g,v?vn:pn)||kn(g,v?vn:pn)||hn,ve)}}v||fe(l,"max-age",hn+o,null,D)}var h=Fe();h&&"https:"===h.protocol&&(fe(l,"secure",null,null,D),null===mn&&(mn=!Fn((Ne()||{}).userAgent)),mn&&fe(l,"SameSite","None",null,D)),fe(l,"path",u||r,null,D),(t.setCookie||Nn)(e,_n(f,l)),c=!0}return c},get:function(e){var n=hn;return wn(a)&&(n=(t.getCookie||On)(e)),n},del:function(e,n){var t=!1;return wn(a)&&(t=a.purge(e,n)),t},purge:function(e,r){var i,o=!1;if(En(n)){var a=((i={}).path=r||"/",i.expires="Thu, 01 Jan 1970 00:00:01 GMT",i);Le()||(a["max-age"]="0"),(t.delCookie||Nn)(e,_n(hn,a)),o=!0}return o}};return a._ckMgr=a,a}function En(e){if(null===yn){yn=!1;try{yn=void 0!==(Tn||{}).cookie}catch(t){e&&e.throwInternal(E.WARNING,N.CannotAccessCookie,"Cannot access document.cookie - "+(Q(n=t)?n.name:""),{exception:De(t)})}}var n;return yn}function Pn(e){var n={};e&&e.length&&ne(oe(e).split(";"),(function(e){if(e=oe(e||hn)){var t=e.indexOf("=");-1===t?n[e]=null:n[oe(e.substring(0,t))]=oe(e.substring(t+1))}}));return n}function kn(e,n){return q(e[n])?e[n]():null}function _n(e,n){var t=e||hn;return V(n,(function(e,n){t+="; "+e+(B(n)?hn:"="+n)})),t}function On(e){var n=hn;if(Tn){var t=Tn.cookie||hn;Cn!==t&&(Sn=Pn(t),Cn=t),n=oe(Sn[e]||hn)}return n}function Nn(e,n){Tn&&(Tn.cookie=e+"="+n)}function Fn(e){return!!X(e)&&(!(!W(e,"CPU iPhone OS 12")&&!W(e,"iPad; CPU OS 12"))||(!!(W(e,"Macintosh; Intel Mac OS X 10_14")&&W(e,"Version/")&&W(e,"Safari"))||(!(!W(e,"Macintosh; Intel Mac OS X 10_14")||!j(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))||(!(!W(e,"Chrome/5")&&!W(e,"Chrome/6"))||(!(!W(e,"UnrealEngine")||W(e,"Chrome"))||!(!W(e,"UCBrowser/12")&&!W(e,"UCBrowser/11")))))))}function Rn(e,n){return new en(n)}var Mn=0,An=1,Ln=2,Dn=4,Bn=5,Kn=function e(n){this.listeners=[];var t=!!(n||{}).perfEvtsSendAll;(0,He.Z)(e,this,(function(e){e.addNotificationListener=function(n){e.listeners.push(n)},e.removeNotificationListener=function(n){for(var t=te(e.listeners,n);t>-1;)e.listeners.splice(t,1),t=te(e.listeners,n)},e.eventsSent=function(n){ne(e.listeners,(function(e){e&&e.eventsSent&&setTimeout((function(){return e.eventsSent(n)}),0)}))},e.eventsDiscarded=function(n,t){ne(e.listeners,(function(e){e&&e.eventsDiscarded&&setTimeout((function(){return e.eventsDiscarded(n,t)}),0)}))},e.eventsSendRequest=function(n,t){ne(e.listeners,(function(e){if(e&&e.eventsSendRequest)if(t)setTimeout((function(){return e.eventsSendRequest(n,t)}),0);else try{e.eventsSendRequest(n,t)}catch(e){}}))},e.perfEvent=function(n){n&&(!t&&n.isChildEvt()||ne(e.listeners,(function(e){if(e&&e.perfEvent)if(n.isAsync)setTimeout((function(){return e.perfEvent(n)}),0);else try{e.perfEvent(n)}catch(e){}})))}}))},Un=function(e){function n(){var t=e.call(this)||this,r=0;return(0,He.Z)(n,t,(function(e,n){function t(n){var t=e.getNotifyMgr();t&&t.eventsDiscarded([n],Ln)}e.initialize=function(e,t,r,i){n.initialize(e,t,r||new Xe(e),i||new Kn(e))},e.track=function(r){tn(e.getPerfMgr(),(function(){return"AppInsightsCore:track"}),(function(){null===r&&(t(r),pe("Invalid telemetry item")),function(e){if(B(e.name))throw t(e),Error("telemetry name required")}(r),n.track(r)}),(function(){return{item:r}}),!r.sync)},e.addNotificationListener=function(n){var t=e.getNotifyMgr();t&&t.addNotificationListener(n)},e.removeNotificationListener=function(n){var t=e.getNotifyMgr();t&&t.removeNotificationListener(n)},e.pollInternalLogs=function(n){var t=e.config.diagnosticLogInterval;return t&&t>0||(t=1e4),r&&e.stopPollingInternalLogs(),r=setInterval((function(){var t=e.logger?e.logger.queue:[];ne(t,(function(t){var r={name:n||"InternalMessageId: "+t.messageId,iKey:e.config.instrumentationKey,time:ee(new Date),baseType:Qe.dataType,baseData:{message:t.message}};e.track(r)})),t.length=0}),t)},e.stopPollingInternalLogs=function(){r&&(clearInterval(r),r=0)}})),t}return(0,O.ne)(n,e),n}((function e(){var n,t,r,i,o,a=!1;(0,He.Z)(e,this,(function(e){e._extensions=new Array,t=new dn,e.logger=new Xe({loggingLevelConsole:E.CRITICAL}),n=[],e.isInitialized=function(){return a},e.initialize=function(n,i,o,s){var u,c,l,f;e.isInitialized()&&pe("Core should not be initialized more than once"),n&&!B(n.instrumentationKey)||pe("Please provide instrumentation key"),r=s,e._notificationManager=s,e.config=n||{},s&&!0!==e.config.disableDbgExt&&s.addNotificationListener(function(e){if(!qe){qe={};for(var n=0;n<Ve.length;n++)qe[Ve[n]]=Ze(Ve[n],e)}return qe}(n)),e.config.enablePerfMgr&&fe(e.config,"createPerfMgr",Rn),n.extensions=B(n.extensions)?[]:n.extensions,(c=sn,(u=n)?!(f=u[c])&&B(f)&&(f=D(l)?{}:l,u[c]=f):f=D(l)?{}:l,f).NotificationManager=s,o&&(e.logger=o);var d=[];d.push.apply(d,(0,O.$h)((0,O.$h)([],i,!1),n.extensions,!1)),d=ln(d);var v=[],p=[],g={};ne(d,(function(e){(B(e)||B(e.initialize))&&pe("Extensions must provide callback to initialize");var n=e.priority,r=e.identifier;e&&n&&(B(g[n])?g[n]=r:o.warnToConsole("Two extensions have same priority #"+n+" - "+g[n]+", "+r)),!n||n<t.priority?v.push(e):p.push(e)})),d.push(t),v.push(t),d=ln(d),e._extensions=d,cn(new an([t],n,e),d),cn(new an(v,n,e),d),e._extensions=v,0===e.getTransmissionControls().length&&pe("No channels available"),a=!0,e.releaseQueue()},e.getTransmissionControls=function(){return t.getChannelControls()},e.track=function(t){fe(t,"iKey",e.config.instrumentationKey,null,de),fe(t,"time",ee(new Date),null,de),fe(t,"ver","4.0",null,B),e.isInitialized()?e.getProcessTelContext().processNext(t):n.push(t)},e.getProcessTelContext=function(){var n=e._extensions,r=n;return n&&0!==n.length||(r=[t]),new an(r,e.config,e)},e.getNotifyMgr=function(){return r||(r=(0,R.pu)({addNotificationListener:function(e){},removeNotificationListener:function(e){},eventsSent:function(e){},eventsDiscarded:function(e,n){},eventsSendRequest:function(e,n){}}),e._notificationManager=r),r},e.getCookieMgr=function(){return o||(o=In(e.config,e.logger)),o},e.setCookieMgr=function(e){o=e},e.getPerfMgr=function(){return i||e.config&&e.config.enablePerfMgr&&q(e.config.createPerfMgr)&&(i=e.config.createPerfMgr(e,e.getNotifyMgr())),i||Ye},e.setPerfMgr=function(e){i=e},e.eventCnt=function(){return n.length},e.releaseQueue=function(){n.length>0&&(ne(n,(function(n){e.getProcessTelContext().processNext(n)})),n=[])}}))})),zn=0,qn=13,Hn=32,Vn=1,jn=2,Zn=3,Wn=4,Gn=0,Jn=1,Qn=6,Xn=7,Yn=(0,O.uc)((0,O.uc)({},N),{AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517,SendPostOnCompleteFailure:518,PostResponseHandler:519,SDKNotInitialized:520}),$n=4294967296,et=4294967295,nt=!1,tt=123456789,rt=987654321;function it(e){e<0&&(e>>>=0),tt=123456789+e&et,rt=987654321-e&et,nt=!0}function ot(){try{var e=2147483647&le();it((Math.random()*$n^e)+e)}catch(e){}}function at(e){return e>0?Math.floor(st()/et*(e+1))>>>0:0}function st(e){var n,t=Ee("crypto")||Ee("msCrypto");return t&&t.getRandomValues?n=t.getRandomValues(new Uint32Array(1))[0]&et:Le()?(nt||ot(),n=ct()&et):n=Math.floor($n*Math.random()|0),e||(n>>>=0),n}function ut(e){e?it(e):ot()}function ct(e){var n=((rt=36969*(65535&rt)+(rt>>16)&et)<<16)+(65535&(tt=18e3*(65535&tt)+(tt>>16)&et))>>>0&et|0;return e||(n>>>=0),n}
/*
 * Application Insights JavaScript SDK - Core, 2.7.3
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
var lt,ft="visibilitychange",dt="pagehide",vt="pageshow",pt=null;function gt(e,n){var t=!1,r=ke();r&&(t=H(r,e,n),t=H(r.body,e,n)||t);var i=_e();return i&&(t=H(i,e,n)||t),t}function ht(e,n,t){var r=!1;if(n&&e&&J(e)){var i=[];ne(e,(function(e){X(e)&&(t&&-1!==te(t,e)?i.push(e):r=gt(e,n)||r)})),!r&&i.length>0&&(r=ht(i,n))}return r}function yt(e,n){return ht(["beforeunload","unload","pagehide"],e,n)}function mt(e,n){var t=!1;return n&&-1!==te(n,dt)||(t=gt(dt,e)),n&&-1!==te(n,ft)||(t=gt(ft,(function(n){var t=_e();e&&t&&"hidden"===t.visibilityState&&e(n)}))||t),!t&&n&&(t=mt(e)),t}function Ct(e,n){var t=!1;return n&&-1!==te(n,vt)||(t=gt(vt,e)),n&&-1!==te(n,ft)||(t=gt(ft,(function(n){var t=_e();e&&t&&"visible"===t.visibilityState&&e(n)}))||t),!t&&n&&(t=Ct(e)),t}function Tt(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(Et,(function(e){var n=0|at(15);return("x"===e?n:3&n|8).toString(16)}))}function St(){var e=Ee("performance");return e&&e.now?e.now():le()}function xt(e){void 0===e&&(e=22);for(var n=st()>>>0,t=0,r="";r.length<e;)t++,r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&n),n>>>=6,5===t&&(n=(st()<<2&4294967295|3&n)>>>0,t=0);return r}function bt(){for(var e,n=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],t="",r=0;r<4;r++)t+=n[15&(e=st())]+n[e>>4&15]+n[e>>8&15]+n[e>>12&15]+n[e>>16&15]+n[e>>20&15]+n[e>>24&15]+n[e>>28&15];var i=n[8+(3&st())|0];return t.substr(0,8)+t.substr(9,4)+"4"+t.substr(13,3)+i+t.substr(16,3)+t.substr(19,12)}var wt,It={_canUseCookies:void 0,isTypeof:L,isUndefined:D,isNullOrUndefined:B,hasOwnProperty:U,isFunction:q,isObject:z,isDate:G,isArray:J,isError:Q,isString:X,isNumber:Y,isBoolean:$,toISOString:ee,arrForEach:ne,arrIndexOf:te,arrMap:re,arrReduce:ie,strTrim:oe,objCreate:R.pu,objKeys:ue,objDefineAccessors:ce,addEventHandler:gt,dateNow:le,isIE:Le,disableCookies:function(){Pt().setEnabled(!1)},newGuid:Tt,perfNow:St,newId:xt,randomValue:at,random32:st,mwcRandomSeed:ut,mwcRandom32:ct,generateW3CId:bt},Et=/[xy]/g;function Pt(e,n){var t=bn(e,n),r=It._canUseCookies;return null===pt&&(pt=[],lt=r,ce(It,"_canUseCookies",(function(){return lt}),(function(e){lt=e,ne(pt,(function(n){n.setEnabled(e)}))}))),-1===te(pt,t)&&pt.push(t),$(r)&&t.setEnabled(r),$(lt)&&t.setEnabled(lt),t}
/**
 * Utils.ts
 * @author  Abhilash Panwar (abpanwar) Hector Hernandez (hectorh)
 * @copyright Microsoft 2018
 * File containing utility functions.
 */
var kt="1DS-Web-JS-3.1.10",_t="withCredentials",Ot=((wt={})[0]=Gn,wt[2]=Qn,wt[1]=Jn,wt[3]=Xn,wt[4098]=Qn,wt[4097]=Jn,wt[4099]=Xn,wt),Nt=(Boolean(_e()),Boolean(ke()));function Ft(e){return!(""===e||B(e))}function Rt(e){if(e){var n=e.indexOf("-");if(n>-1)return e.substring(0,n)}return""}function Mt(e){return!!(e&&Y(e)&&e>=Vn&&e<=Wn)}function At(e,n,t){if(!n&&!Ft(n)||"string"!=typeof e)return null;var r=typeof n;if("string"===r||"number"===r||"boolean"===r||J(n))n={value:n};else if("object"!==r||n.hasOwnProperty("value")){if(B(n.value)||""===n.value||!X(n.value)&&!Y(n.value)&&!$(n.value)&&!J(n.value))return null}else n={value:t?JSON.stringify(n):n};if(J(n.value)&&!zt(n.value))return null;if(!B(n.kind)){if(J(n.value)||!Ut(n.kind))return null;n.value=n.value.toString()}return n}function Lt(e,n,t){var r=-1;if(!D(e))if(n>0&&(32===n?r=8192:n<=13&&(r=n<<5)),function(e){if(e>=0&&e<=9)return!0;return!1}(t))-1===r&&(r=0),r|=t;else{var i=Ot[Ht(e)]||-1;-1!==r&&-1!==i?r|=i:i===Qn&&(r=i)}return r}function Dt(e){void 0===e&&(e="D");var n=Tt();return"B"===e?n="{"+n+"}":"P"===e?n="("+n+")":"N"===e&&(n=n.replace(/-/g,"")),n}function Bt(e,n,t,r,i){var o={},a=!1,s=0,u=arguments.length,c=Object[F.hB],l=arguments;for("[object Boolean]"===c.toString.call(l[0])&&(a=l[0],s++);s<u;s++){V(e=l[s],(function(e,n){a&&n&&z(n)?J(n)?(o[e]=o[e]||[],ne(n,(function(n,t){n&&z(n)?o[e][t]=Bt(!0,o[e][t],n):o[e][t]=n}))):o[e]=Bt(!0,o[e],n):o[e]=n}))}return o}var Kt=St;function Ut(e){return e===zn||e>zn&&e<=qn||e===Hn}function zt(e){return e.length>0}function qt(e,n){var t=e;t.timings=t.timings||{},t.timings.processTelemetryStart=t.timings.processTelemetryStart||{},t.timings.processTelemetryStart[n]=Kt()}function Ht(e){var n=0;if(null!=e){var t=typeof e;"string"===t?n=1:"number"===t?n=2:"boolean"===t?n=3:t===F.fK&&(n=4,J(e)?(n=4096,e.length>0&&(n|=Ht(e[0]))):U(e,"value")&&(n=8192|Ht(e.value)))}return n}F.jA,F.fK,F.jA,R.pu;
/*
 * 1DS JS SDK Core, 3.1.10
 * Copyright (c) Microsoft and contributors. All rights reserved.
 * (Microsoft Internal Only)
 */
/**
 * AppInsightsCore.ts
 * @author Abhilash Panwar (abpanwar) Hector Hernandez (hectorh)
 * @copyright Microsoft 2018
 */
var Vt=function(e){function n(){var t=e.call(this)||this;return t.pluginVersionStringArr=[],t.pluginVersionString="",(0,He.Z)(n,t,(function(e,n){e.logger&&e.logger.queue||(e.logger=new Xe({loggingLevelConsole:E.CRITICAL})),e.initialize=function(t,r,i,o){tn(e,(function(){return"AppInsightsCore.initialize"}),(function(){if(t){t.endpointUrl||(t.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var a=t.propertyStorageOverride;if(a&&(!a.getProperty||!a.setProperty))throw new Error("Invalid property storage override passed.");t.channels&&ne(t.channels,(function(n){n&&ne(n,(function(n){if(n.identifier&&n.version){var t=n.identifier+"="+n.version;e.pluginVersionStringArr.push(t)}}))}))}e.getWParam=function(){return"undefined"!=typeof document?0:-1},r&&ne(r,(function(n){if(n&&n.identifier&&n.version){var t=n.identifier+"="+n.version;e.pluginVersionStringArr.push(t)}})),e.pluginVersionString=e.pluginVersionStringArr.join(";");try{n.initialize(t,r,i,o),e.pollInternalLogs("InternalLog")}catch(n){var s=e.logger,u=De(n);-1!==u.indexOf("channels")&&(u+="\n - Channels must be provided through config.channels only!"),s.throwInternal(E.CRITICAL,Yn.FailedToInitializeSDK,"SDK Initialization Failed - no telemetry will be sent: "+u)}}),(function(){return{config:t,extensions:r,logger:i,notificationManager:o}}))},e.track=function(t){tn(e,(function(){return"AppInsightsCore.track"}),(function(){var r=t;if(r){r.timings=r.timings||{},r.timings.trackStart=Kt(),Mt(r.latency)||(r.latency=Vn);var i=r.ext=r.ext||{};i.sdk=i.sdk||{},i.sdk.ver=kt;var o=r.baseData=r.baseData||{};o.properties||(o.properties={});var a=o.properties;a.version||(a.version=""),""!==e.pluginVersionString&&(a.version=e.pluginVersionString)}n.track(r)}),(function(){return{item:t}}),!t.sync)}})),t}return(0,O.ne)(n,e),n}(Un),jt=Vt,Zt="REAL_TIME",Wt="POST",Gt="drop",Jt="send",Qt="requeue",Xt="rspFail",Yt="application/x-json-stream",$t="cache-control",er="content-type",nr="kill-duration",tr="time-delta-millis",rr="AuthMsaDeviceTicket";
/*
 * 1DS JS SDK POST plugin, 3.1.10
 * Copyright (c) Microsoft and contributors. All rights reserved.
 * (Microsoft Internal Only)
 */
function ir(e){var n=(e.ext||{}).intweb;return n&&Ft(n.msfpc)?n.msfpc:null}function or(e){for(var n=null,t=0;null===n&&t<e.length;t++)n=ir(e[t]);return n}var ar=function(){function e(n,t){var r=t?[].concat(t):[],i=this,o=or(r);i.iKey=function(){return n},i.Msfpc=function(){return o||""},i.count=function(){return r.length},i.events=function(){return r},i.addEvent=function(e){return!!e&&(r.push(e),o||(o=ir(e)),!0)},i.split=function(t,i){var a;if(t<r.length){var s=r.length-t;B(i)||(s=i<s?i:s),a=r.splice(t,s),o=or(r)}return new e(n,a)}}return e.create=function(n,t){return new e(n,t)},e}(),sr=2e6,ur=Math.min(sr,65e3),cr=/\./,lr=function e(n,t,r,i){var o="data",a="baseData",s=!!i,u=t,c={};(0,He.Z)(e,this,(function(e){function t(e,n,i,o,a,l,f){V(e,(function(e,d){var v=null;if(d||Ft(d)){var p=i,g=e,h=a,y=n;if(s&&!o&&cr.test(e)){var m=e.split("."),C=m.length;if(C>1){h&&(h=h.slice());for(var T=0;T<C-1;T++){var S=m[T];y=y[S]=y[S]||{},p+="."+S,h&&h.push(S)}g=m[C-1]}}var x=o&&function(e,n){var t=c[e];return void 0===t&&(e.length>=7&&(t=Z(e,"ext.metadata")||Z(e,"ext.web")),c[e]=t),t}(p);if(v=!x&&u&&u.handleField(p,g)?u.value(p,g,d,r):At(g,d,r)){var b=v.value;if(y[g]=b,l&&l(h,g,v),f&&"object"==typeof b&&!J(b)){var w=h;w&&(w=w.slice()).push(g),t(d,b,p+"."+g,o,w,l,f)}}}}))}e.createPayload=function(e,n,t,r,i,o){return{apiKeys:[],payloadBlob:"",overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:n,isSync:t,isBeacon:r,sendType:o,sendReason:i}},e.appendPayload=function(t,r,i){var o=t&&r&&!t.overflow;return o&&tn(n,(function(){return"Serializer:appendPayload"}),(function(){for(var n=r.events(),o=t.payloadBlob,a=t.numEvents,s=!1,u=[],c=[],l=t.isBeacon,f=l?65e3:3984588,d=l?ur:sr,v=0,p=0;v<n.length;){var g=n[v];if(g){if(a>=i){t.overflow=r.split(v);break}var h=e.getEventBlob(g);if(h&&h.length<=d){var y=h.length;if(o.length+y>f){t.overflow=r.split(v);break}o&&(o+="\n"),o+=h,++p>20&&(o.substr(0,1),p=0),s=!0,a++}else h?u.push(g):c.push(g),n.splice(v,1),v--}v++}if(u&&u.length>0&&t.sizeExceed.push(ar.create(r.iKey(),u)),c&&c.length>0&&t.failedEvts.push(ar.create(r.iKey(),c)),s){t.batches.push(r),t.payloadBlob=o,t.numEvents=a;var m=r.iKey();-1===te(t.apiKeys,m)&&t.apiKeys.push(m)}}),(function(){return{payload:t,theBatch:{iKey:r.iKey(),evts:r.events()},max:i}})),o},e.getEventBlob=function(e){try{return tn(n,(function(){return"Serializer.getEventBlob"}),(function(){var n={};n.name=e.name,n.time=e.time,n.ver=e.ver,n.iKey="o:"+Rt(e.iKey);var r={},i=e.ext;i&&(n.ext=r,V(i,(function(e,n){t(n,r[e]={},"ext."+e,!0,null,null,!0)})));var s=n.data={};s.baseType=e.baseType;var u=s.baseData={};return t(e.baseData,u,a,!1,[a],(function(e,n,t){fr(r,e,n,t)}),!0),t(e.data,s,o,!1,[],(function(e,n,t){fr(r,e,n,t)}),!0),JSON.stringify(n)}),(function(){return{item:e}}))}catch(e){return null}}}))};function fr(e,n,t,r){if(r&&e){var i=Lt(r.value,r.kind,r.propertyType);if(i>-1){var o=e.metadata;o||(o=e.metadata={f:{}});var a=o.f;if(a||(a=o.f={}),n)for(var s=0;s<n.length;s++){var u=n[s];a[u]||(a[u]={f:{}});var c=a[u].f;c||(c=a[u].f={}),a=c}a=a[t]={},J(r.value)?a.a={t:i}:a.t=i}}}
/*
 * 1DS JS SDK POST plugin, 3.1.10
 * Copyright (c) Microsoft and contributors. All rights reserved.
 * (Microsoft Internal Only)
 */
/**
* RetryPolicy.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2018
*/
var dr,vr,pr,gr=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!=e&&429!=e||501==e||505==e)},e.getMillisToBackoffForRetry=function(e){var n,t=Math.floor(1200*Math.random())+2400;return n=Math.pow(2,e)*t,Math.min(n,6e5)},e}(),hr=function e(){var n={};(0,He.Z)(e,this,(function(e){e.setKillSwitchTenants=function(e,t){if(e&&t)try{var r=(a=e.split(","),s=[],a&&ne(a,(function(e){s.push(oe(e))})),s);if("this-request-only"===t)return r;for(var i=1e3*parseInt(t,10),o=0;o<r.length;++o)n[r[o]]=le()+i}catch(e){return[]}var a,s;return[]},e.isTenantKilled=function(e){var t=n,r=oe(e);return void 0!==t[r]&&t[r]>le()||(delete t[r],!1)}}))},yr=function e(){var n=!0,t=!0,r=!0,i="use-collector-delta",o=!1;(0,He.Z)(e,this,(function(e){e.allowRequestSending=function(){return n},e.firstRequestSent=function(){r&&(r=!1,o||(n=!1))},e.shouldAddClockSkewHeaders=function(){return t},e.getClockSkewHeaderValue=function(){return i},e.setClockSkew=function(e){o||(e?(i=e,t=!0,o=!0):t=!1,n=!0)}}))},mr=((dr={})[1]=Qt,dr[100]=Qt,dr[200]="sent",dr[8004]=Gt,dr[8003]=Gt,dr),Cr={},Tr={};function Sr(e){try{return e.responseText}catch(e){}return""}function xr(e,n){var t=!1;if(e&&n){var r=ue(e);if(r&&r.length>0)for(var i=n.toLowerCase(),o=0;o<r.length;o++){var a=r[o];if(a&&U(n,a)&&a.toLowerCase()===i){t=!0;break}}}return t}function br(e,n,t,r){n&&t&&t.length>0&&(r&&Cr[n]?(e.hdrs[Cr[n]]=t,e.useHdrs=!0):e.url+="&"+n+"="+t)}pr=rr,Cr[vr=rr]=pr,Tr[pr]=vr;var wr=function e(n,t,r,i){this._responseHandlers=[];var o,a,s,u,c="?cors=true&"+er.toLowerCase()+"="+Yt,l=new hr,f=!1,d=new yr,v=!1,p=0,g=!0,h=[],y={},m=[],C=null,T=!1,S=!1,x=!1;(0,He.Z)(e,this,(function(e){var b=!0;function w(e,n){for(var t=0,r=null,i=0;null==r&&i<e.length;)1===(t=e[i])?Ue()?r=I:ze()&&(r=k):2===t&&Ke(n)?r=P:v&&3===t&&Be()&&(r=O),i++;return r?{_transport:t,_isSync:n,sendPOST:r}:null}function I(e,n,t){var r=new XDomainRequest;r.open(Wt,e.urlString),r.onload=function(){var e=Sr(r);_(n,200,{},e),Z(e)},r.onerror=function(){_(n,400,{})},r.ontimeout=function(){_(n,500,{})},r.onprogress=function(){},t?r.send(e.data):o._setTimeoutOverride((function(){r.send(e.data)}),0)}function P(e,n,t){var r,i=!1,o=!1,a=((r={body:e.data,method:Wt}).Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,r);t&&(a.keepalive=!0,2===e._sendReason&&(i=!0)),b&&(a.credentials="include"),e.headers&&ue(e.headers).length>0&&(a.headers=e.headers),fetch(e.urlString,a).then((function(e){var t={},r="";e.headers&&e.headers.forEach((function(e,n){t[n]=e})),e.body&&e.text().then((function(e){r=e})),o||(o=!0,_(n,e.status,t,r),Z(r))})).catch((function(e){o||(o=!0,_(n,0,{}))})),i&&!o&&(o=!0,_(n,200,{}))}function k(e,n,t){function r(e,n,t){if(!e[t]&&n&&n.getResponseHeader){var r=n.getResponseHeader(t);r&&(e[t]=oe(r))}return e}function i(e){var n,t,i={};return e.getAllResponseHeaders?(n=e.getAllResponseHeaders(),t={},X(n)&&ne(oe(n).split(/[\r\n]+/),(function(e){if(e){var n=e.indexOf(": ");if(-1!==n){var r=oe(e.substring(0,n)).toLowerCase(),i=oe(e.substring(n+1));t[r]=i}else t[oe(e)]=1}})),i=t):(i=r(i,e,tr),i=r(i,e,nr),i=r(i,e,"kill-duration-seconds")),i}function o(e,t){_(n,e.status,i(e),t)}var a=function(e,n,t,r,i){function o(e,n,t){try{e[n]=t}catch(e){}}void 0===r&&(r=!1),void 0===i&&(i=!1);var a=new XMLHttpRequest;return r&&o(a,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",r),t&&o(a,_t,t),a.open(e,n,!i),t&&o(a,_t,t),a}(Wt,e.urlString,b,!0,t);V(e.headers,(function(e,n){a.setRequestHeader(e,n)})),a.onload=function(){var e=Sr(a);o(a,e),Z(e)},a.onerror=function(){o(a)},a.ontimeout=function(){o(a)},a.send(e.data)}function _(e,n,t,r){try{e(n,t,r)}catch(e){o.diagLog().throwInternal(E.WARNING,Yn.SendPostOnCompleteFailure,De(e))}}function O(e,n,t){var r=200,i=e._thePayload;try{var a=Ne();if(!a.sendBeacon(e.urlString,e.data))if(i){var s=[];ne(i.batches,(function(n){if(s&&n&&n.count()>0){for(var t=n.events(),r=0;r<t.length;r++)if(!a.sendBeacon(e.urlString,C.getEventBlob(t[r]))){s.push(n.split(r));break}}else s.push(n.split(0))})),W(s,8003,i.sendType,!0)}else r=0}catch(e){o.diagLog().warnToConsole("Failed to send telemetry using sendBeacon API. Ex:"+e),r=0}finally{_(n,r,{},"")}}function N(e){return 2===e||3===e}function R(e){return S&&N(e)&&(e=2),e}function M(){return!f&&p<t}function A(){var e=m;return m=[],e}function L(e,n,t){var r=!1;return e&&e.length>0&&!f&&a[n]&&C&&(r=0!==n||M()&&(t>0||d.allowRequestSending())),r}function K(e){var n={};return e&&ne(e,(function(e,t){n[t]={iKey:e.iKey(),evts:e.events()}})),n}function U(e,t,r,i,u){if(e&&0!==e.length)if(f)W(e,1,i);else{i=R(i);try{var c=e,d=0!==i;tn(s,(function(){return"HttpManager:_sendBatches"}),(function(o){o&&(e=e.slice(0));for(var s=[],c=null,f=Kt(),p=a[i]||(d?a[1]:a[0]),h=(S||N(i)||p&&3===p._transport)&&!g&&v&&Be();L(e,i,t);){var y=e.shift();y&&y.count()>0&&(l.isTenantKilled(y.iKey())?s.push(y):(c=c||C.createPayload(t,r,d,h,u,i),C.appendPayload(c,y,n)?null!==c.overflow&&(e=[c.overflow].concat(e),c.overflow=null,H(c,f,Kt(),u),f=Kt(),c=null):(H(c,f,Kt(),u),f=Kt(),e=[y].concat(e),c=null)))}c&&H(c,f,Kt(),u),e.length>0&&(m=e.concat(m)),W(s,8004,i)}),(function(){return{batches:K(c),retryCount:t,isTeardown:r,isSynchronous:d,sendReason:u,useSendBeacon:N(i),sendType:i}}),!d)}catch(e){o.diagLog().throwInternal(E.WARNING,Yn.CannotSerializeObject,"Unexpected Exception sending batch: "+De(e))}}}function z(e,n){var t={url:c,hdrs:{},useHdrs:!1};t.hdrs=Bt(t.hdrs,y),t.useHdrs=ue(t.hdrs).length>0,br(t,"client-id","NO_AUTH",n),br(t,"client-version",kt,n);var r="";ne(e.apiKeys,(function(e){r.length>0&&(r+=","),r+=e})),br(t,"apikey",r,n),br(t,"upload-time",le().toString(),n);var i=function(e){for(var n=0;n<e.batches.length;n++){var t=e.batches[n].Msfpc();if(t)return encodeURIComponent(t)}return""}(e);if(Ft(i)&&(t.url+="&ext.intweb.msfpc="+i),d.shouldAddClockSkewHeaders()&&br(t,"time-delta-to-apply-millis",d.getClockSkewHeaderValue(),n),s.getWParam){var o=s.getWParam();o>=0&&(t.url+="&w="+o)}for(var a=0;a<h.length;a++)t.url+="&"+h[a].name+"="+h[a].value;return t}function q(e,n,t){e[n]=e[n]||{},e[n][o.identifier]=t}function H(n,t,i,u){if(n&&n.payloadBlob&&n.payloadBlob.length>0){var c=!!e.sendHook,f=a[n.sendType];!N(n.sendType)&&n.isBeacon&&2===n.sendReason&&(f=a[2]||a[3]||f);var v=x;(n.isBeacon||3===f._transport)&&(v=!1);var h=z(n,v);v=v||h.useHdrs;var y=Kt();tn(s,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var a=0;a<n.batches.length;a++)for(var m=n.batches[a].events(),C=0;C<m.length;C++){var x=m[C];if(T){var b=x.timings=x.timings||{};q(b,"sendEventStart",y),q(b,"serializationStart",t),q(b,"serializationCompleted",i)}x.sendAttempt>0?x.sendAttempt++:x.sendAttempt=1}W(n.batches,1e3+(u||0),n.sendType,!0);var w={data:n.payloadBlob,urlString:h.url,headers:h.hdrs,_thePayload:n,_sendReason:u};v&&(xr(w.headers,$t)||(w.headers[$t]="no-cache, no-store"),xr(w.headers,er)||(w.headers["content-type"]=Yt));var I=null;f&&(I=function(t){d.firstRequestSent();var i=function(t,i){!function(n,t,i,a){var s=9e3,u=null,c=!1,f=!1;try{var v=!0;if(typeof n!==F.jA){if(t){d.setClockSkew(t[tr]);var g=t["kill-duration"]||t["kill-duration-seconds"];ne(l.setKillSwitchTenants(t["kill-tokens"],g),(function(e){ne(i.batches,(function(n){if(n.iKey()===e){u=u||[];var t=n.split(0);i.numEvents-=t.count(),u.push(t)}}))}))}if(200==n)return void(s=200);(!gr.shouldRetryForStatus(n)||i.numEvents<=0)&&(v=!1),s=9e3+n%1e3}if(v){s=100;var h=i.retryCnt;0===i.sendType&&(h<r?(c=!0,j((function(){0===i.sendType&&p--,U(i.batches,h+1,i.isTeardown,S?2:i.sendType,5)}),S,gr.getMillisToBackoffForRetry(h))):f=!0)}}finally{c||(d.setClockSkew(),function(n,t,r,i){try{i&&o._backOffTransmission(),200===t&&(i||n.isSync||o._clearBackOff(),function(e){if(T){var n=Kt();ne(e,(function(e){e&&e.count()>0&&function(e,n){T&&ne(e,(function(e){q(e.timings=e.timings||{},"sendEventCompleted",n)}))}(e.events(),n)}))}}(n.batches)),W(n.batches,t,n.sendType,!0)}finally{0===n.sendType&&(p--,5!==r&&e.sendQueuedRequests(n.sendType,r))}}(i,s,a,f)),W(u,8004,i.sendType)}}(t,i,n,u)},a=n.isTeardown||n.isSync;try{f.sendPOST(t,i,a),e.sendListener&&e.sendListener(w,t,a,n.isBeacon)}catch(e){o.diagLog().warnToConsole("Unexpected exception sending payload. Ex:"+De(e)),_(i,0,{})}}),tn(s,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(I)if(0===n.sendType&&p++,c&&!n.isBeacon&&3!==f._transport){var t={data:w.data,urlString:w.urlString,headers:Bt({},w.headers)},r=!1;tn(s,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(t,(function(e){r=!0,g||e._thePayload||(e._thePayload=e._thePayload||w._thePayload,e._sendReason=e._sendReason||w._sendReason),I(e)}),n.isSync||n.isTeardown)}catch(e){r||I(w)}}))}else I(w)}))}),(function(){return{thePayload:n,serializationStart:t,serializationCompleted:i,sendReason:u}}),n.isSync)}n.sizeExceed&&n.sizeExceed.length>0&&W(n.sizeExceed,8003,n.sendType),n.failedEvts&&n.failedEvts.length>0&&W(n.failedEvts,8002,n.sendType)}function j(e,n,t){n?e():o._setTimeoutOverride(e,t)}function Z(n){var t=e._responseHandlers;try{for(var r=0;r<t.length;r++)try{t[r](n)}catch(e){o.diagLog().throwInternal(E.CRITICAL,Yn.PostResponseHandler,"Response handler failed: "+e)}if(n){var i=JSON.parse(n);Ft(i.webResult)&&Ft(i.webResult.msfpc)&&u.set("MSFPC",i.webResult.msfpc,31536e3)}}catch(e){}}function W(e,n,t,r){if(e&&e.length>0&&i){var a=i[(c=n,l=mr[c],Ft(l)||(l="oth",c>=9e3&&c<=9999?l=Xt:c>=8e3&&c<=8999?l=Gt:c>=1e3&&c<=1999&&(l=Jt)),l)];if(a){var u=0!==t;tn(s,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){j((function(){try{a.call(i,e,n,u,t)}catch(e){o.diagLog().throwInternal(E.CRITICAL,Yn.NotificationException,"send request notification failed: "+e)}}),r||u,0)}),(function(){return{batches:K(e),reason:n,isSync:u,sendSync:r,sendType:t}}),!u)}}var c,l}e.initialize=function(e,n,t,r,i){var l;i||(i={}),c=e+c,x=!D(i.avoidOptions)&&!i.avoidOptions,s=n,u=n.getCookieMgr(),T=!s.config.disableEventTimings;var f=!!s.config.enableCompoundKey;o=t;var d=i.valueSanitizer,p=i.stringifyObjects;D(i.enableCompoundKey)||(f=!!i.enableCompoundKey),v=!Ae(),C=new lr(s,d,p,f);var h=r;if(!r){g=!1;var y=Fe();y&&y.protocol&&"file:"===y.protocol.toLowerCase()&&(b=!1);var m=[];m=Ae()?[2,1]:[1,2,3];var S=i.transports;S&&(Y(S)?m=[S].concat(m):J(S)&&(m=S.concat(m))),r=w(m,!1),h=w(m,!0),r||o.diagLog().warnToConsole("No available transport to send events")}(l={})[0]=r,l[1]=h||w([1,2,3],!0),l[2]=w([3,2,1],!0)||h,l[3]=w([2,3,1],!0)||h,a=l},e._getDbgPlgTargets=function(){return[a[0],l,C,a]},e.addQueryStringParameter=function(e,n){for(var t=0;t<h.length;t++)if(h[t].name===e)return void(h[t].value=n);h.push({name:e,value:n})},e.addHeader=function(e,n){y[e]=n},e.canSendRequest=function(){return M()&&d.allowRequestSending()},e.sendQueuedRequests=function(e,n){D(e)&&(e=0),S&&(e=R(e),n=2),L(m,e,0)&&U(A(),0,!1,e,n||0)},e.isCompletelyIdle=function(){return!f&&0===p&&0===m.length},e.setUnloading=function(e){S=e},e.addBatch=function(e){if(e&&e.count()>0){if(l.isTenantKilled(e.iKey()))return!1;m.push(e)}return!0},e.teardown=function(){m.length>0&&U(A(),0,!0,2,2)},e.pause=function(){f=!0},e.resume=function(){f=!1,e.sendQueuedRequests(0,4)},e.sendSynchronousBatch=function(e,n,t){e&&e.count()>0&&(B(n)&&(n=1),S&&(n=R(n),t=2),U([e],0,!1,n,t||0))}}))},Ir=Nt?window:void 0,Er="eventsDiscarded",Pr=function(e){function n(){var t,r=e.call(this)||this;r.identifier="PostChannel",r.priority=1011,r.version="3.1.10";var i,o,a,s,u,c=!1,l=[],f=null,d=!1,v=0,p=500,g=0,h=1e4,y={},m=Zt,C=null,T=null,S=0,x=0,b={},w=-1,I=!0,P=!1;return(0,He.Z)(n,r,(function(e,n){function r(e,n){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=Vn),e.ext&&e.ext.trace&&delete e.ext.trace,e.ext&&e.ext.user&&e.ext.user.id&&delete e.ext.user.id,I&&(e.ext=ge(e.ext),e.baseData&&(e.baseData=ge(e.baseData)),e.data&&(e.data=ge(e.data))),e.sync)if(S||d)e.latency=Zn,e.sync=!1;else if(o)return I&&(e=ge(e)),void o.sendSynchronousBatch(ar.create(e.iKey,[e]),!0===e.sync?1:e.sync,3);var t=e.latency,r=g,i=h;t===Wn&&(r=v,i=p);var a=!1;if(r<i)a=!L(e,n);else{var s=Vn,u=20;t===Wn&&(s=Wn,u=1),a=!0,function(e,n,t,r){for(;t<=n;){var i=M(e,n,!0);if(i&&i.count()>0){var o=i.split(0,r),a=o.count();if(a>0)return t===Wn?v-=a:g-=a,j(Er,[o],Bn),!0}t++}return D(),!1}(e.iKey,e.latency,s,u)&&(a=!L(e,n))}a&&H(Er,[e],Bn)}function k(e,n,t){var r=B(e,n,t);return o.sendQueuedRequests(n,t),r}function _(){return g>0}function O(){if(w>=0&&B(w,0,u)&&o.sendQueuedRequests(0,u),v>0&&!T&&!d){var e=y[m][2];e>=0&&(T=N((function(){T=null,k(Wn,0,1),O()}),e))}var n=y[m][1];!C&&!f&&n>=0&&!d&&(_()?C=N((function(){C=null,k(0===x?Zn:Vn,0,1),x++,x%=2,O()}),n):x=0)}function N(n,t){0===t&&S&&(t=1);var r=1e3;return S&&(r=gr.getMillisToBackoffForRetry(S-1)),e._setTimeoutOverride(n,t*r)}function F(){null!==C&&(e._clearTimeoutOverride(C),C=null,x=0)}function R(n,t){F(),f&&(e._clearTimeoutOverride(f),f=null),d||k(Vn,n,t)}function M(e,n,t){var r=b[n];r||(r=b[n=Vn]);var i=r.iKeyMap[e];return!i&&t&&(i=ar.create(e),r.batches.push(i),r.iKeyMap[e]=i),i}function A(n,t){o.canSendRequest()&&!S&&(a>0&&g>a&&(t=!0),t&&null==f&&e.flush(n,null,20))}function L(e,n){I&&(e=ge(e));var t=e.latency,r=M(e.iKey,t,!0);return!!r.addEvent(e)&&(t!==Wn?(g++,n&&0===e.sendAttempt&&A(!e.sync,s>0&&r.count()>=s)):v++,!0)}function D(){for(var e=0,n=0,t=function(t){var r=b[t];r&&r.batches&&ne(r.batches,(function(r){t===Wn?e+=r.count():n+=r.count()}))},r=Vn;r<=Wn;r++)t(r);g=n,v=e}function B(n,t,r){var i=!1,a=0===t;return!a||o.canSendRequest()?tn(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],t=Wn;t>=n;){var r=b[t];r&&r.batches&&r.batches.length>0&&(ne(r.batches,(function(n){o.addBatch(n)?i=i||n&&n.count()>0:e=e.concat(n.events()),t===Wn?v-=n.count():g-=n.count()})),r.batches=[],r.iKeyMap={}),t--}e.length>0&&H(Er,e,Dn),i&&w>=n&&(w=-1,u=0)}),(function(){return{latency:n,sendType:t,sendReason:r}}),!a):(w=w>=0?Math.min(w,n):n,u=Math.max(u,r)),i}function K(e,n){k(Vn,0,n),U((function(){e&&e(),l.length>0?f=N((function(){return K(l.shift(),n)}),0):(f=null,_()&&O())}))}function U(e){o.isCompletelyIdle()?e():f=N((function(){U(e)}),.25)}function z(){(y={}).REAL_TIME=[2,1,0],y.NEAR_REAL_TIME=[6,3,0],y.BEST_EFFORT=[18,9,0]}function q(n,t){var r=e._notificationManager||{},i=r[n];if(i)try{i.apply(r,t)}catch(t){e.diagLog().throwInternal(E.CRITICAL,Yn.NotificationException,n+" notification failed: "+t)}}function H(e,n){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];n&&n.length>0&&q(e,[n].concat(t))}function j(e,n){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];n&&n.length>0&&ne(n,(function(n){n&&n.count()>0&&q(e,[n.events()].concat(t))}))}function Z(){s=t&&t.disableAutoBatchFlushLimit?0:Math.max(1500,h/6)}z(),b[Wn]={batches:[],iKeyMap:{}},b[Zn]={batches:[],iKeyMap:{}},b[jn]={batches:[],iKeyMap:{}},b[Vn]={batches:[],iKeyMap:{}},Z(),o=new wr(500,2,1,{requeue:function(n,t){var i=[];ne(n,(function(n){n&&n.count()>0&&ne(n.events(),(function(n){n&&(n.sync&&(n.latency=Wn,n.sync=!1),n.sendAttempt<6?(qt(n,e.identifier),r(n,!1)):i.push(n))}))})),i.length>0&&H(Er,i,An);P&&R(2,2)},send:function(e,n,t){e&&e.length>0&&q("eventsSendRequest",[n>=1e3&&n<=1999?n-1e3:0,!0!==t])},sent:function(e,n){j("eventsSent",e,n),O()},drop:function(e,n){j(Er,e,n>=8e3&&n<=8999?n-8e3:Mn)},rspFail:function(e){j(Er,e,An),O()},oth:function(e,n){j(Er,e,Mn),O()}}),e._getDbgPlgTargets=function(){return[o]},e.initialize=function(r,s,u){tn(s,(function(){return"PostChannel:initialize"}),(function(){var c=s;n.initialize(r,s,u),e.setInitialized(!1);var l=e._getTelCtx();r.extensionConfig[e.identifier]=r.extensionConfig[e.identifier]||{},t=l.getExtCfg(e.identifier),e._setTimeoutOverride=t.setTimeoutOverride?t.setTimeoutOverride:setTimeout.bind(Ir),e._clearTimeoutOverride=t.clearTimeoutOverride?t.clearTimeoutOverride:clearTimeout.bind(Ir),I=!t.disableOptimizeObj&&!!Ee("chrome");var f=c.getWParam;c.getWParam=function(){var e=0;return t.ignoreMc1Ms0CookieProcessing&&(e|=2),e|f()},t.eventsLimitInMem>0&&(h=t.eventsLimitInMem),t.immediateEventLimit>0&&(p=t.immediateEventLimit),t.autoFlushEventsLimit>0&&(a=t.autoFlushEventsLimit),Z(),t.httpXHROverride&&t.httpXHROverride.sendPOST&&(i=t.httpXHROverride),Ft(r.anonCookieName)&&o.addQueryStringParameter("anoncknm",r.anonCookieName),o.sendHook=t.payloadPreprocessor,o.sendListener=t.payloadListener;var d=t.overrideEndpointUrl?t.overrideEndpointUrl:r.endpointUrl;function v(e){"beforeunload"!==(e||ke().event).type&&(P=!0,o.setUnloading(P)),R(2,2)}e._notificationManager=r.extensionConfig.NotificationManager,o.initialize(d,e.core,e,i,t);var g=r.disablePageUnloadEvents||[];yt(v,g),mt(v,g),Ct((function(e){P=!1,o.setUnloading(P)}),r.disablePageShowEvents),e.setInitialized(!0)}),(function(){return{coreConfig:r,core:s,extensions:u}}))},e.processTelemetry=function(n,i){qt(n,e.identifier);var o=(i=e._getTelCtx(i)).getExtCfg(e.identifier),a=!!t.disableTelemetry;o&&(a=a||!!o.disableTelemetry);var s=n;a||c||(t.overrideInstrumentationKey&&(s.iKey=t.overrideInstrumentationKey),o&&o.overrideInstrumentationKey&&(s.iKey=o.overrideInstrumentationKey),r(s,!0),P?R(2,2):O()),e.processNext(s,i)},e.setEventQueueLimits=function(e,n){h=e>0?e:1e4,a=n>0?n:0,Z();var t=g>e;if(!t&&s>0)for(var r=Vn;!t&&r<=Zn;r++){var i=b[r];i&&i.batches&&ne(i.batches,(function(e){e&&e.count()>=s&&(t=!0)}))}A(!0,t)},e.teardown=function(){R(2,2),c=!0,o.teardown()},e.pause=function(){F(),d=!0,o.pause()},e.resume=function(){d=!1,o.resume(),O()},e.addResponseHandler=function(e){o._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){F(),z(),m=Zt,O(),V(e,(function(e,n){var t=n.length;if(t>=2){var r=t>2?n[2]:0;if(n.splice(0,t-2),n[1]<0&&(n[0]=-1),n[1]>0&&n[0]>0){var i=n[0]/n[1];n[0]=Math.ceil(i)*n[1]}r>=0&&n[1]>=0&&r>n[1]&&(r=n[1]),n.push(r),y[e]=n}}))},e.flush=function(e,n,t){void 0===e&&(e=!0),d||(F(),t=t||1,e?(B(Vn,0,t),D(),null==f?f=N((function(){K(n,t)}),0):l.push(n)):(k(Vn,1,t),null!=n&&n()))},e.setMsaAuthTicket=function(e){o.addHeader(rr,e)},e.hasEvents=_,e._setTransmitProfile=function(e){m!==e&&void 0!==y[e]&&(F(),m=e,O())},e._backOffTransmission=function(){S<4&&(S++,F(),O())},e._clearBackOff=function(){S&&(S=0,F(),O())}})),r}return(0,O.ne)(n,e),n}(un),kr=Pr,_r=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,r.ZT)(n,e),n.prototype.initialize=function(n,t){this._postChannel=new kr;var i=[];t&&(i=i.concat(t)),n.channels=[[this._postChannel]],n.extensionConfig=n.extensionConfig||[],n.extensionConfig[this._postChannel.identifier]=(0,r.pi)((0,r.pi)({},n.channelConfiguration),n.extensionConfig[this._postChannel.identifier]);try{e.prototype.initialize.call(this,n,i)}catch(e){this.logger.warnToConsole("Failed to initialize SDK."+e)}},n.prototype.setUploadFrequency=function(e){if(this._postChannel&&e){var n=e/1e3,t=n/2,r={};r.OTelCustomTransmissionProfile=[n,t],this._postChannel._loadTransmitProfiles(r),this._postChannel._setTransmitProfile("OTelCustomTransmissionProfile")}},n.prototype.flush=function(e){this._postChannel&&this._postChannel.flush(e)},n.prototype.shutdown=function(){this._postChannel&&this._postChannel.teardown()},n}(jt),Or="Data.",Nr="b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121";function Fr(e,n,t){n&&n.forEach((function(n){if(!n.classification||4===n.classification||1===n.classification||t.customerContentEnabled&&32===n.classification){var r,i;switch(r=t.prependDataToken?"zC."===n.name.substr(0,3)?"zC.Data."+n.name.substr(3):Or+n.name:n.name,n.dataType){case 3:i=6;break;case 2:i=4;break;case 4:i=8;break;case 0:return void(e[r]="string"==typeof n.value?n.value.substr(0,25e3):n.value);default:return void(e[r]=n.value)}var o={value:n.value,propertyType:i};e[r]=o}}))}function Rr(e,n){try{return e()}catch(e){return s(1,"1DS Sink",e),n}}var Mr,Ar=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.identifier="PartAPlugin",n.priority=3,n._properties={},n}return(0,r.ZT)(n,e),n.prototype.initialize=function(n,t,r){e.prototype.initialize.call(this,n,t,r)},n.prototype.processTelemetry=function(e,n){e.data=Bt(this._properties,e.data);var t=this._getTelCtx(n);this.processNext(e,t)},n.prototype.addDataFields=function(e){Fr(this._properties,e,{prependDataToken:!1,customerContentEnabled:!1})},n}(un),Lr="HttpManager:_sendBatches",Dr="HttpManager:_sendBatchesNotification",Br=function(){function e(e,n,t){this.start=Date.now(),this.name=e,this.isAsync=!0===t,this.payload=n}return e.prototype.isChildEvt=function(){return!1},e.prototype.complete=function(){this.time=Date.now()-this.start,this.exTime=this.time},e}(),Kr=function(){function e(e){this._callbacks=e}return e.prototype.create=function(e,n,t){return e===Lr||e===Dr?new Br(e,n,t):null},e.prototype.fire=function(e){if(e&&e.complete(),this._callbacks)switch(e.name){case Lr:this.handleSendBatches(e);break;case Dr:this.handleSendBatchesNotification(e)}},e.prototype.setCtx=function(e,n){},e.prototype.getCtx=function(e){},e.prototype.handleSendBatches=function(e){this._callbacks.requestProcessingStats&&this._callbacks.requestProcessingStats(e.time||0,0)},e.prototype.handleSendBatchesNotification=function(e){if(this._callbacks.requestProcessingStats&&e.payload){var n=e.payload();if(n.batches&&n.reason&&n.reason>=1e3&&n.reason<=1999){var t=0;for(var r in n.batches)t+=n.batches[r].evts.length;this._callbacks.requestProcessingStats(0,t)}}},e}();!function(e){e.USGOV_DOD="https://pf.events.data.microsoft.com/OneCollector/1.0/",e.USGOV_DOJ="https://tb.events.data.microsoft.com/OneCollector/1.0/",e.PUBLIC="https://browser.events.data.microsoft.com/OneCollector/1.0/",e.CUSTOMER_CONTENT="https://office-c.events.data.microsoft.com/OneCollector/1.0/",e.EUDB="https://eu-office.events.data.microsoft.com/OneCollector/1.0/"}(Mr||(Mr={}));var Ur=void 0,zr=function(e){function n(n,t){var i,o,s=e.call(this,n,t)||this;s.usePartAPlugin=!0;var u=new Ar,c=function(e){e&&e.addNotificationListener({eventsSent:function(e){a(2,2,(function(){return"Successfully sent "+e.length+" event(s)"})),a(3,2,(function(){return"Sent event(s) details : "+JSON.stringify(e,null,2)})),s.eventsSent+=e.length},eventsDiscarded:function(e,n){a(0,2,(function(){return"Discarded "+e.length+" event(s) because "+n})),a(3,2,(function(){return"Discarded event(s) details : "+JSON.stringify(e,null,2)})),s.eventsDiscarded+=e.length}})};function l(e,n,t,i){var o={instrumentationKey:n,endpointUrl:t,channelConfiguration:{eventsLimitInMem:e.eventsLimitInMem,httpXHROverride:e.httpXHROverride,setTimeoutOverride:e.setTimeoutOverride,clearTimeoutOverride:e.clearTimeoutOverride,ignoreMc1Ms0CookieProcessing:!0,disableOptimizeObj:!0},disableCookiesUsage:!0,extensionConfig:(0,r.pi)({},e.extensionConfig)};e.stats&&e.stats.networkStats&&o.channelConfiguration&&(o.channelConfiguration.payloadListener=function(n,t){var r,i=t||n;i.data&&(null===(r=e.stats)||void 0===r||r.networkStats(i.data.length))});var a=new _r;return a.initialize(o,i),a.setUploadFrequency(e.uploadFrequency),e.notificationListener&&a.addNotificationListener(e.notificationListener),e.stats&&a.setPerfMgr(new Kr(e.stats)),a}s.sendTelemetryEvent=function(e){return Rr((function(){var n=s.getOneDSTelemetryEvent(e);n&&i&&i.track(n)}),Ur)},s.sendCustomerContent=function(e){return Rr((function(){var n=s.getOneDSCustomerContent(e);n&&o&&o.track(n)}),Ur)},s.addPersistentDataFields=function(e){u.addDataFields(e)},s.flush=function(e){i&&i.flush(e)},s.shutdown=function(){try{i&&i.shutdown()}catch(e){a(0,2,(function(){return"An error occurred on shutdown"}))}};var f=[u];if(t.plugins&&f.push.apply(f,t.plugins),!t.endpointUrl)throw new Error("Missing Endpoint Url");return i=l(t,"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",t.endpointUrl,f),t.enableCustomerContent&&t.endpointUrl===Mr.PUBLIC&&(o=l(t,Nr,Mr.CUSTOMER_CONTENT,f)),t.disableStatsTracking||(c(i),c(o)),s.addPersistentDataFields(n),s}return(0,r.ZT)(n,e),n}((function(e,n){var t=this;this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0,this.usePartAPlugin=!1;var i=[],o=!1,s={name:"DiagnosticLevel",processEvent:function(e){var n=e.eventFlags.diagnosticLevel;return o||10===n||110===n||120===n}},u={},c=Dt(),l=(new Date).getTime().toString(),f=function(e,n){if(1===n.eventType)return Nr;if(!e.telemetryProperties||!e.telemetryProperties.ariaTenantToken)throw new Error("Missing Tenant Token");return e.telemetryProperties.ariaTenantToken},d=function(e,n){var o,s=v(e);if(function(e){for(var n=function(n){var t=i[n];if(!t.processEvent(e))return a(2,1,(function(){return e.eventName+" suppressed by "+t.name})),{value:!1}},t=0;t<i.length;t++){var r=n(t);if("object"==typeof r)return r.value}return!0}(s)){t.eventsProcessed++;var d=((o=s.timestamp)?new Date(o):new Date).toISOString(),p={"Event.Sequence":{value:t.eventsProcessed,propertyType:4},"Event.Name":s.eventName,"Event.Source":"OTelJS","Event.Time":{value:d,propertyType:9}};Fr(p,s.dataFields,{prependDataToken:!0,customerContentEnabled:1===n.eventType}),p["Event.Id"]=c+"."+t.eventsProcessed;var g="custom";s.eventContract&&(s.eventContract.name&&(p["Event.Contract"]=s.eventContract.name,g+="."+s.eventContract.name.toLowerCase().replace(/\./g,"_")),Fr(p,s.eventContract.dataFields,{prependDataToken:!1,customerContentEnabled:1===n.eventType}));var h={iKey:f(s,n),name:s.eventName,data:p,time:d,baseType:g,ext:{sdk:{seq:t.eventsProcessed,epoch:l}}};return t.usePartAPlugin||(h.data=(0,r.pi)((0,r.pi)({},h.data),u)),h}};this.getOneDSTelemetryEvent=function(e){return d(e,{eventType:0})},this.getOneDSCustomerContent=function(e){if(n.enableCustomerContent&&e.telemetryProperties.customerContentVersion&&Math.floor(e.telemetryProperties.customerContentVersion)<=1&&1===e.telemetryProperties.customerContentType)return d(e,{eventType:1})},this.addPreprocessor=function(e){i.push(e)},this.addPersistentDataFields=function(e){Fr(u,e,{prependDataToken:!1,customerContentEnabled:!1})},this.setOptionalEventsEnabled=function(e){o=e},this.setFullEventsEnabled=this.setOptionalEventsEnabled,n.enableOptionalEvents&&(o=!0),this.addPersistentDataFields(e),this.addPreprocessor(s)})),qr=t(18092),Hr=t(37344),Vr=t(37831),jr=t(74688),Zr=t(12708),Wr=null,Gr=function(){function e(e,n,t,r,i){void 0===i&&(i=5),this.serverRequestInfluxControl=i,this.context={},this.otelLogger=new _,this.intentionalPageViewLogTime=null;var o=new zr(e,{endpointUrl:this.getOneDSEndpoint(t,r)});this.otelLogger.addSink(o);this.otelLogger.setTenantToken("Office.Taos.Shell",n,-1),this.serverRequestInfluxControl<0?this.serverRequestInfluxControl=0:this.serverRequestInfluxControl>100&&(this.serverRequestInfluxControl=100)}return e.prototype.getOneDSEndpoint=function(e,n){if(n&&n.length>0)return n;if(!e)return Mr.PUBLIC;var t=e.toLowerCase();return-1!==t.indexOf("tbprod")?Mr.USGOV_DOJ:-1!==t.indexOf("pfprod")?Mr.USGOV_DOD:Mr.PUBLIC},e.prototype.registerContextParam=function(e,n){this.context[e]=n},e.prototype.writeEvent=function(e){if(null!=e){if(e.name===qr.F5.ServerRequest){var n=e.properties.filter((function(e){return"ServerRequest_Status"===e.name}));if(n.length>0&&n[0].value>=200&&n[0].value<300)if(Math.floor(100*Math.random())+1>this.serverRequestInfluxControl)return}var t=[];if(e.name===qr.F5.Click){var r=void 0;null===this.intentionalPageViewLogTime||this.intentionalPageViewLogTime>e.timestamp+864e5?(this.intentionalPageViewLogTime=e.timestamp,r=!0):r=!1,t.push(l("Click_IntentionalPageView",r))}t.push(d("Event_Type",qr.hi[e.type])),e.properties.forEach((function(e){switch(e.type){case 1:t.push(l(e.name,e.value));break;case 3:t.push((n=e.name,r=e.value,{name:n,dataType:3,value:r,classification:4}));break;case 4:t.push(function(e,n){return{name:e,dataType:4,value:n,classification:4}}(e.name,e.value));break;case 2:t.push(f(e.name,e.value));break;default:t.push(d(e.name,e.value))}var n,r}));var i={eventName:e.elementName?"Office.Taos.Shell.".concat(qr.F5[e.name],".").concat(e.elementName.replace(/^./,e.elementName[0].toUpperCase())):"Office.Taos.Shell.".concat(qr.F5[e.name]),dataFields:t,eventFlags:{dataCategories:4,diagnosticLevel:110}};this.otelLogger.sendTelemetryEvent(i);0}},e}();function Jr(e,n){if(null==Wr&&(0,Zr.i)(n.PUID)){var t=qr.cO.getNewID(),i=(0,Vr.aH)(),o=n.OTelTelemetryTenantToken||"b0c82c6598ad49f3848b1d3dc0d8dd25-299cbfe9-b72e-4e9d-a5e3-20319efba5b5-7268",a=(0,r.ev)((0,r.ev)((0,r.ev)((0,r.ev)((0,r.ev)([],b({name:"OfficeTaosShell",platform:"Web",version:window.O365ShellVerStr||"unknown"}),!0),w({id:n.SHSID}),!0),[d("Release.AudienceGroup",Hr.Pr(n.FlightRing,i&&i.testTraffic))],!1),x({primaryIdentityHash:n.PUID,primaryIdentitySpace:n.IsConsumerShell?"MSAPUID":"OrgIdPUID",isAnonymous:!1,tenantId:n.TID,tenantGroup:n.IsConsumerShell?"Consumer":"Commercial"}),!0),[d("Context_Env",n.Environment||"unknown"),d("Context_Site",n.WorkloadId),d("Context_SiteSubId",e.CurrentMainLinkElementID),d("Context_WorkloadAppId",(0,jr.Dd)(n.WorkloadId,e.CurrentMainLinkElementID,document.URL)),d("Context_CID",Hr.Eu(i.correlationID)),d("Context_PID",t),d("Context_UID",n.UID),d("Context_Language",e.CultureName),d("Context_Flights",e.FlightName),d("Context_FlightRings",n.FlightRing),d("Context_Segment",n.ActiveExperiences)],!1);window.O365ShellContext.SID=n.SHSID,window.O365ShellContext.PID=t,i.correlationID&&(window.O365ShellContext.CID=i.correlationID),(Wr=new Gr(a,o,n.Environment,n.OTelTelemetryUri,n.AriaTelemetryServerRequestInfluxControl)).registerContextParam("Context_IsConsumer",n.IsConsumerShell?"true":"false"),Wr.registerContextParam("Context_Site",n.WorkloadId);var s=(0,Vr.jl)();s.registerService(Wr),s.IsConsumer=n.IsConsumerShell}}}}]),HighResolutionTimingSupported&&(shellPerformance.mark("shell_otellogging_end"),shellPerformance.measure("shell_otellogging","shell_otellogging_start","shell_otellogging_end"));