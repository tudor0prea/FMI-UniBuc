(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[577],{2279:function(e,t,n){"use strict";n.d(t,"a",function(){return a});n.d(t,"e",function(){return f});n.d(t,"l",function(){return c});n.d(t,"f",function(){return h});n.d(t,"p",function(){return p});n.d(t,"r",function(){return d});n.d(t,"o",function(){return v});n.d(t,"u",function(){return m});n.d(t,"t",function(){return g});n.d(t,"h",function(){return y});n.d(t,"s",function(){return b});n.d(t,"i",function(){return w});n.d(t,"c",function(){return E});n.d(t,"n",function(){return S});n.d(t,"m",function(){return T});n.d(t,"b",function(){return N});n.d(t,"g",function(){return C});n.d(t,"y",function(){return k});n.d(t,"T",function(){return L});n.d(t,"v",function(){return A});n.d(t,"w",function(){return O});n.d(t,"E",function(){return M});n.d(t,"S",function(){return _});n.d(t,"d",function(){return D});n.d(t,"x",function(){return P});var r=n(2424),i=n(54),s=n(127),o=n(380),u=n(90),a="_spAppBarNewsSitesCachedData",f="_spAppBarHomeClientContext",l=36e5,c=1*l,h=3e5,p=4*l,d=9e5,v=1*l,m=4*l,g=4*l,y=30,b="SPHomeWeb:sites/feed",w="SPHomeWeb:sites/followed",E="SPHomeWeb:sites/recent",S=30,x=function(e){var t;switch(e){case"STS":t=i.t.teamSite;break;case"SPSPERS":t=i.t.mySite;break;case"GROUP":t=i.t.group;break;case"SITEPAGEPUBLISHING":t=i.t.sitePagePublishing;break;default:t=i.t.invalid}return t},T=function(e,t,n,r,i,s,o,u,a){if(e)return t({cachingStrategy:2,spHomeCachedItem:{cacheContext:null,cacheValue:""},spHomeClientContext:{Urls:[""],Token:{AccessToken:"",ExpiresOn:""}},returnStatistics:!0}).then(function(e){var t;if(e){if((null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.Items)&&e.data.Items.length>0){a(e,r);return C(e.cacheStats.lastModified,n)?{data:u(e.data),stale:!1,date:e.cacheStats.lastModified}:{data:u(e.data),stale:!0,date:e.cacheStats.lastModified}}return{data:[],stale:!0,date:0}}return{data:[],stale:!0,date:0}});var f=s&&s.find(function(e){return e.Key===o}),l=null;f&&i?l=t({cachingStrategy:1,spHomeCachedItem:f.Value,spHomeClientContext:i,returnStatistics:!0,cacheTimeoutTime:n}):i&&i.Token&&(l=t({cachingStrategy:1,spHomeCachedItem:{cacheContext:null,cacheValue:""},spHomeClientContext:i,returnStatistics:!0,cacheTimeoutTime:n}));return l?l.then(function(e){var t;if((null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.Items)&&e.data.Items.length>0){a(e,r);return{data:u(e.data),stale:!1,date:Date.now()}}return{data:[],stale:!0,date:0}}):Promise.resolve({data:[],stale:!0,date:0})},N=function(e,t){try{if(e){var n=JSON.parse(e);if(n)return t(n)}}catch(e){}},C=function(e,t){return Date.now()-e<=t},k=function(e){return function(t){1!==t.button&&2!==t.button||s.e.logData({name:e})}},L=function(e){return e.which===Object(o.t)(u.e.right)},A=function(e){return function(t){if(t.which===u.e.enter){var n=document.getElementById(e);null==n||n.click()}}},O=function(e){return e.map(function(e){var t,n,i;return{author:r.i()?e.createdBy:{Title:null===(n=null===(t=e.createdBy)||void 0===t?void 0:t.user)||void 0===n?void 0:n.displayName},description:e.description,publishDate:new Date(e.firstPublishedDate),title:e.title,url:e.webUrl,isAuthoritative:!1,site:{id:e.sharepointIds.siteId,serverRelativeUrl:e.parentReference.path,title:e.parentReference.siteTitle,webTemplateId:0},image:null===(i=e.thumbnails)||void 0===i?void 0:i[0].source.url}})},M=function(e){return e.map(function(e){return{id:e.id,serverRelativeUrl:e.webUrl,title:e.title,WebTemplate:e.template.name,color:e.resourceVisualization.color,acronym:e.resourceVisualization.acronym,icon:e.resourceVisualization.previewImageUrl}})},_=function(e){return e.Items.map(function(e){var t=e.ItemReference,n=t.WebId,r=t.SiteId,i=t.IndexId,s=e.Title,o=e.IsExternalContent,u=e.ItemReference,a=e.BannerImageUrl,f=e.BannerColor,l=e.Acronym,c=e.Weight,h=e.PinOrder,p=e.WebTemplate;return{id:n,siteCollectionId:r,title:s,isExternal:o,serverRelativeUrl:e.OriginalUrl||e.Url,icon:a,color:f,acronym:l,indexId:i,itemReference:u,weight:c||0,pinOrder:h,allowPinning:!!u&&!!u.SiteId&&!!u.WebId,webTemplateId:x(p),WebTemplate:p}})},D=function(e,t,n,r){var i=(r?t.filter(function(e){return e.serverRelativeUrl!==r}):t).slice(0,n);return[e.filter(function(e){return r?e.serverRelativeUrl!==r:i.reduce(function(t,n){return t&&n.serverRelativeUrl!==e.serverRelativeUrl},!0)}),i]};function P(e,t){var n;if(e&&t){if(e.name)this.componentData[t]=e;else{var r=this.componentData[t];if(null===(n=null==r?void 0:r.cacheStats)||void 0===n?void 0:n.lastModified){if(e.cacheStats.lastModified>r.cacheStats.lastModified)this.componentData[t]=e;else if(isNaN(e.cacheStats.lastModified)){e.cacheStats.lastModified=Date.now();this.componentData[t]=e}}else this.componentData[t]=e}}}},2424:function(e,t,n){"use strict";n.d(t,"s",function(){return i});n.d(t,"e",function(){return s});n.d(t,"n",function(){return o});n.d(t,"o",function(){return u});n.d(t,"i",function(){return a});n.d(t,"u",function(){return f});n.d(t,"a",function(){return l});n.d(t,"r",function(){return c});n.d(t,"t",function(){return h});var r=n(23);function i(){return r.t.isActivated("12CAD4FC-9A1B-4B23-BB68-29EA398076DB","11/18/2021","populate followed sites from recent")}function s(){return r.t.isActivated("5643629B-9946-480C-8350-1A5F94F83451","01/06/2022","appbar data-interception off")}function o(){return r.t.isActivated("BDE02695-1F9C-43DB-9CE2-6BEEE228C632","02/09/2022","Close app bar panel after btn click")}function u(){return r.t.isActivated("94DD7E46-1CB4-4B6B-AD62-C8CA0767EC7B","02/09/2022","Prevent closing app bar callout when dialog is open")}function a(){return r.t.isActivated("612999AE-948C-4B53-A1DF-6F25A70EABA5","02/14/2022","my news author fix")}function f(){return r.t.isActivated("F063D9B0-7F69-418B-BF7C-A21F8690E273","03/11/2022","respect link target in app bar global nav")}function l(){return r.t.isActivated("E096F969-65F3-40C4-8FEB-36ADDC85C221","04/28/2022","send news data to parent")}function c(){return r.t.isActivated("7AB73E58-6A5C-4A5E-9B95-F644D41184BF","05/02/2022","Fix for cutoff app bar panel on iOS Edge")}function h(){return r.t.isActivated("26ECA8D5-6BF9-4A63-99FC-9BFD1386E75A","05/18/2022","fix teams panel blank render")}},2502:function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"n",function(){return i});n.d(t,"e",function(){return s});var r=function(e,t){return e.replace("spappbarwebpack/spappbarwebpack.js","odsp-media/images/spappbar/".concat(t))},i=function(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp(e+"=([^&]*)").exec(t);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))},s=function(e,t,n){return e<768?"lists"===n?3:t?10:5:e<1024?"lists"===n?9:t?15:10:"lists"===n?14:t?20:15}},3004:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(425),s=n(346),o=n(23),u=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{dataSourceName:"SharePointDataSource",id:"SharePointDataSource"},{pageContext:t})||this;n._isCachedResultWithStatistic=function(e){return!!e.cacheStats};n._parseResponse=function(e,t){var i,s=!1;if(n._isCachedResultWithStatistic(e)){i=e.data;s=!0}else i=e;var o=t(i);return s?Object(r.__assign)(Object(r.__assign)({},e),{data:o}):o};n._cacheKey="sharepointAppBar"+"_".concat(t.aadUserId);n.pageContext=t;return n}t.prototype.canCreatePage=function(e){var t=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return"".concat(e.siteUrl,"/_api/sitepages/cancreatepage")},qosName:"spAppBarCanCreatePage",method:"GET",noRedirect:!0,cacheRequestKey:"".concat(this._cacheKey,"_canCreatePage_").concat(e.siteCache),cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return t._parseResponse(e,function(e){return!(!e||!e.d)&&e.d.CanCreatePage})})};t.prototype.canCreatePromotedPage=function(e){var t=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return"".concat(e.siteUrl,"/_api/sitepages/cancreatepromotedpage")},qosName:"spAppBarCanCreatePromotedPage",method:"GET",noRedirect:!0,cacheRequestKey:"".concat(this._cacheKey,"_canCreatePromotedPage_").concat(e.siteCache),cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return t._parseResponse(e,function(e){return!(!e||!e.d)&&e.d.CanCreatePromotedPage})})};t.prototype.getRecentLists=function(e){var t=this;return this.getDataUtilizingPersistentCache({url:"".concat(this.pageContext.webAbsoluteUrl,"/_api/sp.RecentListProxy.GetRecentListsProxy/"),qosName:"spAppBarGetRecentLists",method:"GET",noRedirect:!0,cacheRequestKey:"".concat(this._cacheKey,"_getRecentLists"),cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return e?t._parseResponse(e,function(e){var t;return(null===(t=null==e?void 0:e.value)||void 0===t?void 0:t.length)>0?e.value.map(function(e){var t=e.color,n=e.icon,r=e.listId,i=e.listUrl,s=e.listTitle,o=e.siteId,u=e.siteTitle,a=e.siteUrl;return{listColor:Number(t),listIcon:Number(n),listId:r,listUrl:i,listTitle:s,siteId:o,siteTitle:u,siteUrl:a}}):[]}):[]})};t.prototype.getFavoriteLists=function(e){var t=this;return this.getDataUtilizingPersistentCache({url:"".concat(this.pageContext.webAbsoluteUrl,"/_api/SP.FavoriteLists.GetListsBy"),qosName:"spAppBarGetFavoriteLists",method:"GET",noRedirect:!0,cacheRequestKey:"".concat(this._cacheKey,"_getFavoriteLists"),cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return e?t._parseResponse(e,function(e){var t,n,r;return(null===(r=null===(n=null===(t=null==e?void 0:e.d)||void 0===t?void 0:t.GetListsBy)||void 0===n?void 0:n.results)||void 0===r?void 0:r.length)>0?e.d.GetListsBy.results.map(function(e){var t=e.color,n=e.icon,r=e.listId,i=e.listUrl,s=e.title,o=e.siteId,u=e.siteTitle,a=e.siteUrl;return{listColor:Number(t),listIcon:Number(n),listId:r,listUrl:i,listTitle:s,siteId:o,siteTitle:u,siteUrl:a}}):[]}):[]}).catch(function(e){if(e&&"-1, System.NotSupportedException"===(null==e?void 0:e.code))return[]})};t.prototype.getNewsFeed=function(e){var t=this,n=o.t.isActivated("1BD4234E-AE05-4D4D-8B8C-CEAF1F536B79","04/27/2022","dont sort news")?"".concat(this.pageContext.webAbsoluteUrl,"/_api/v2.1/getNewsFeed?section=SharePointNewsFeedTargeted&preferredLanguage=").concat(s.e.language,"&$expand=analytics($expand=allTime),thumbnails&$orderby=FirstPublishedDate desc"):"".concat(this.pageContext.webAbsoluteUrl,"/_api/v2.1/getNewsFeed?section=SharePointNewsFeedTargeted&preferredLanguage=").concat(s.e.language,"&$expand=analytics($expand=allTime),thumbnails");return this.getDataUtilizingPersistentCache({url:n,additionalHeaders:{scenario:"SharePointAppBar",Caller:"WebAppBar"},qosName:"spAppBarGetNewsFeed",qosExtraData:{cacheTimeoutTime:e.cacheTimeoutTime,cachingStrategy:e.cachingStrategy},method:"GET",noRedirect:!0,cacheRequestKey:"".concat(this._cacheKey,"_getNewsFeed"),cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return e?t._parseResponse(e,function(e){return(null==e?void 0:e.value)?e.value:[]}):{value:[]}})};t.prototype.getFrequentSites=function(e){var t=this,n="".concat(this.pageContext.webAbsoluteUrl,"/_api/v2.1/insights/frequentSites?$top=").concat(e.top);return this.getDataUtilizingPersistentCache({url:n,additionalHeaders:{Caller:"WebAppBar"},qosName:"spAppBarGetFrequentSites",method:"GET",noRedirect:!0,cacheRequestKey:"".concat(this._cacheKey,"_getFrequentSites"),cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return t._parseResponse(e,function(e){return(null==e?void 0:e.value)?e.value:[]})})};t.prototype.getFollowedSites=function(e){var t=this,n="".concat(this.pageContext.webAbsoluteUrl,"/_api/v2.1/favorites/followedSites?$top=").concat(e.top);return this.getDataUtilizingPersistentCache({url:n,additionalHeaders:{Caller:"WebAppBar",Prefer:"fillSiteCount=".concat(e.top)},qosName:"spAppBarGetFollowedSites",method:"GET",noRedirect:!0,cacheRequestKey:"".concat(this._cacheKey,"_getFollowedSites"),cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return t._parseResponse(e,function(e){return(null==e?void 0:e.value)?e.value:[]})})};t.prototype.getRecentSites=function(e){var t=this,n="".concat(this.pageContext.webAbsoluteUrl,"/_api/v2.1/insights/recentSites?$top=").concat(e.top);return this.getDataUtilizingPersistentCache({url:n,additionalHeaders:{Caller:"WebAppBar"},qosName:"spAppBarGetRecentSites",method:"GET",noRedirect:!0,cacheRequestKey:"".concat(this._cacheKey,"_getRecentSites"),cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return t._parseResponse(e,function(e){return(null==e?void 0:e.value)?e.value:[]})})};t.prototype.getMySiteUrl=function(e){var t=this;return this._pageContext.isAnonymousGuestUser||this._pageContext.isEmailAuthenticationGuestUser||this._pageContext.isExternalGuestUser?Promise.resolve(void 0):this.getDataUtilizingPersistentCache({url:"".concat(this.pageContext.webAbsoluteUrl,"/_api/SP.Directory.DirectorySession/me?$select=mySite"),qosName:"spAppBarGetMySiteUrl",method:"GET",noRedirect:!0,cacheRequestKey:"".concat(this._cacheKey,"_getMySiteUrl"),cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){if(e)return t._parseResponse(e,function(e){return(null==e?void 0:e.d)?e.d.mySite&&e.d.mySite.replace(/\/$/,""):void 0})})};t.prototype.getDefaultDocumentLibraryName=function(e){var t=e.webAbsoluteUrl,n=e.authToken,i=e.cacheTimeoutTime,s=e.cachingStrategy;return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,this.getDataUtilizingPersistentCache({url:"".concat(t,"/_api/web/DefaultDocumentLibrary/RootFolder/Name"),authToken:n,method:"GET",qosName:"spAppBarGetDefaultDocumentLibrary",noRedirect:!0,parseResponse:function(e){return JSON.parse(e).d.Name},cachingStrategy:s,cacheRequestKey:"".concat(this._cacheKey,"_getDefaultDocumentLibrary"),cacheTimeoutTime:i})]})})};t.prototype.createDocumentAndGetEditLink=function(e){var t=e.apiUrl,n=e.authToken;return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,this.dataRequestor.getData({method:"POST",url:t,qosName:"spAppBarCreateDocumentAndGetEditLink",authToken:n,parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})];case 1:return[2,e.sent()]}})})};return t})(i.e)},3220:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(0),i=n(425),s=n(59),o=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{dataSourceName:"SPHomeDataSource",id:"SPHomeDataSource"},{pageContext:t})||this;n.isMicroserviceToken=function(e){return!!e.access_token};n._isDataSourceParam=function(e){return!!e.spHomeClientContext};n._spHomeCacheKey="spHome"+"_".concat(t.aadUserId);return n}t.prototype.getFrequentSites=function(e,t,n,r,i,s,o,u){void 0===n&&(n=!0);var a,f;if(this._isDataSourceParam(e)){var l=e;a=l.spHomeClientContext;t=l.spHomeCachedItem;s=l.returnStatistics;o=l.cachingStrategy;u=l.cacheTimeoutTime}else{a=e;o=0;r?o=3:i&&(o=2)}f=(null==a?void 0:a.Urls)&&a.Urls[0]?"".concat(a.Urls[0],"/api/v1/sites/feed?start=0&count=30&acronyms=true"):"";return this.getSPHomeData({spHomeClientContext:a,spHomeSitesCachedData:t,url:f,qosName:"spAppBarGetFrequentSites",cacheRequestKey:this._spHomeCacheKey+"frequentSites",returnStatistics:!!s,cachingStrategy:o,cacheTimeoutTime:u})};t.prototype.getFollowedSites=function(e,t,n,r,i,s,o,u){void 0===n&&(n=!0);var a,f;if(this._isDataSourceParam(e)){var l=e;a=l.spHomeClientContext;t=l.spHomeCachedItem;s=l.returnStatistics;o=l.cachingStrategy;u=l.cacheTimeoutTime}else{a=e;o=0;r?o=3:i&&(o=2)}f=(null==a?void 0:a.Urls)&&a.Urls[0]?"".concat(a.Urls[0],"/api/v1/sites/followed?mostRecentFirst=true&start=0&count=30&fillSiteData=true&fillSiteCount=10"):"";return this.getSPHomeData({spHomeClientContext:a,spHomeSitesCachedData:t,url:f,qosName:"spAppBarGetFollowedSites",cacheRequestKey:this._spHomeCacheKey+"followedSites",returnStatistics:!!s,cachingStrategy:o,cacheTimeoutTime:u})};t.prototype.getRecentSites=function(e,t,n,r,i,s,o,u){void 0===n&&(n=!0);var a,f;if(this._isDataSourceParam(e)){var l=e;a=l.spHomeClientContext;t=l.spHomeCachedItem;s=l.returnStatistics;o=l.cachingStrategy;u=l.cacheTimeoutTime}else{a=e;o=0;r?o=3:i&&(o=2)}f=(null==a?void 0:a.Urls)&&a.Urls[0]?"".concat(a.Urls[0],"/api/v1/sites/recent?mostRecentFirst=true&start=0&count=30&fillSiteData=true&fillSiteCount=10"):"";return this.getSPHomeData({spHomeClientContext:a,spHomeSitesCachedData:t,url:f,qosName:"spAppBarGetRecentSites",cacheRequestKey:this._spHomeCacheKey+"recentSites",returnStatistics:!!s,cachingStrategy:o,cacheTimeoutTime:u})};t.prototype.getHomeContext=function(){var e={url:"".concat(this._pageContext.webAbsoluteUrl,"/_api/sphomeservice/context?$expand=Token,Payload"),qosName:"spAppBarGetSPHomeToken",method:"GET",additionalHeaders:{accept:"application/json","SPHome-ClientType":"WebAppBar","Service-Worker-Navigation-Preload":"true"},cachingStrategy:3,cacheRequestKey:this._spHomeCacheKey+"token"};return this.getDataUtilizingPersistentCache(e)};t.prototype.shouldShowPostNewsTip=function(){return this.getDataUtilizingPersistentCache({url:"".concat(this._pageContext.webAbsoluteUrl,"/_api/sitepages/pages/feed?promotedstate=2&published=true&$top=3"),qosName:"GetFeedCount",method:"GET",cachingStrategy:3,parseResponse:function(e){var t,n;try{var r=JSON.parse(e);return(null===(n=null===(t=null==r?void 0:r.d)||void 0===t?void 0:t.results)||void 0===n?void 0:n.length)<2}catch(e){return!0}}})};t.prototype.getSPHomeData=function(e){var t=e.cachingStrategy,n={url:e.url,qosName:e.qosName,method:"GET",additionalHeaders:{"sphome-apicontext":e.spHomeClientContext.Payload,"sphome-cachecontext":e.spHomeSitesCachedData.cacheContext,"sphome-clienttype":"WebAppBar"},cacheRequestKey:e.cacheRequestKey,cachingStrategy:t,returnStatistics:e.returnStatistics},r=e.spHomeClientContext.Token;r&&(this.isMicroserviceToken(r)?n.authToken=r.access_token:n.authToken=r.AccessToken);e.url&&0!==e.url.length||(n.getData=function(){return s.n.resolve()});e.cacheTimeoutTime&&(n.cacheTimeoutTime=e.cacheTimeoutTime);return this.getDataUtilizingPersistentCache(n)};return t})(i.e)},4047:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(0),i=n(425),s=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{dataSourceName:"RecentFilesGraphDataSource",id:"RecentFilesGraphDataSource"},{pageContext:t})||this;n._parseFilesResponse=function(e,t){var i,s;if(e){var o,u=!1;if(n._isCachedResultWithStatistic(e)){o=e.data;u=!0}else o=e;var a=null===(s=null===(i=null==o?void 0:o.data)||void 0===i?void 0:i.me)||void 0===s?void 0:s.recent;if(null!=a){if(!a||0===a.length)return t?{data:[],cacheStats:{lastModified:Date.now(),lastRead:Date.now(),reads:0}}:[];var f=null==(a=n._sortByAccessTime(a.filter(function(e){var t,n=e.remoteItem;return n.name&&(null===(t=n.sharepointIds)||void 0===t?void 0:t.siteUrl)&&n.webDavUrl})))?void 0:a.slice(0,n._maxNumber).map(function(e){var t,n,i,s,o,u,a=e.remoteItem,f=null,l=a.name;if("oneNote"===(null===(t=a.package)||void 0===t?void 0:t.type)){o="one";u=l}else{var c=l.lastIndexOf(".");o=l.substr(c+1);u=l.substr(0,c)}var h=a.sharepointIds.siteUrl,p=document.createElement("a");p.href=a.webDavUrl;if("documentLibrary"===a.parentReference.driveType){var d=h.substr(h.lastIndexOf("/")+1);h=null===(n=a.webDavUrl)||void 0===n?void 0:n.substr(0,a.webDavUrl.lastIndexOf("/"));var v=p.pathname,m=v.substr(v.indexOf(d)+d.length+1),g=decodeURI(m).split("/");g.pop();f=g.length>=3?"".concat(d," > ... > ").concat(g[g.length-1]):Object(r.__spreadArray)([d],g,!0).join(" > ")}else{var y=null===(s=null===(i=a.createdBy)||void 0===i?void 0:i.user)||void 0===s?void 0:s.displayName;f=y&&y.length>0?"OneDrive > ".concat(y):"OneDrive > Documents"}return{name:u,url:"".concat(a.webDavUrl,"?web=1"),path:f,extension:o,siteurl:h}});return u?Object(r.__assign)(Object(r.__assign)({},e),{data:f}):f}}};n._sortByAccessTime=function(e){if(!e||e.length<=1)return e;var t=e.length,n={},r=-1;n[t-1]=new Date(e[t-1].remoteItem.fileSystemInfo.lastAccessedDateTime);for(var i=t-2;i>=0;i--){var s=new Date(e[i].remoteItem.fileSystemInfo.lastAccessedDateTime);n[i]=s;s<n[i+1]&&i+1>r&&(r=i+1)}var o=function(t,n,r){if(t===n)return t;if(new Date(e[t].remoteItem.fileSystemInfo.lastAccessedDateTime)<r)return t;if(new Date(e[n].remoteItem.fileSystemInfo.lastAccessedDateTime)>r)return n+1;if(t===n-1)return n;var i=Math.floor((t+n)/2);return new Date(e[i].remoteItem.fileSystemInfo.lastAccessedDateTime)>r?u(i,n,r):u(t,i,r)},u=function(t,n,r){if(t===n)return t;if(t===n-1)return new Date(e[t].remoteItem.fileSystemInfo.lastAccessedDateTime)<r?t:new Date(e[n].remoteItem.fileSystemInfo.lastAccessedDateTime)>r?n+1:n;var i=Math.floor((t+n)/2);return new Date(e[i].remoteItem.fileSystemInfo.lastAccessedDateTime)>r?u(i,n,r):u(t,i,r)},a=[];for(i=0;i<r;i++)a.push(e.shift());for(i=0;i<a.length;i++){var f=o(0,t-r-1+i,new Date(a[i].remoteItem.fileSystemInfo.lastAccessedDateTime));e.splice(f,0,a[i])}return e};n._isCachedResultWithStatistic=function(e){return!!e.cacheStats};n._recentFilesGraphCacheKey="recentFiles"+"_".concat(t.aadUserId);n.pageContext=t;return n}t.prototype.getRecentFiles=function(e){var t=this;this._maxNumber=e.maxItems;return this.getDataUtilizingPersistentCache({url:"".concat(this.pageContext.webAbsoluteUrl,"/_api/v2.1/graphql"),qosName:"RecentFilesGraph",method:"POST",contentType:"application/graphql",additionalPostData:"{ me { recent { remoteItem { name webUrl webDavUrl parentReference { driveType } package { type } sharepointIds { siteUrl } fileSystemInfo { lastAccessedDateTime } createdBy { user { displayName } } } } } }",cachingStrategy:e.cachingStrategy,cacheRequestKey:this._recentFilesGraphCacheKey+"recent",cacheTimeoutTime:e.cacheTimeoutTime?e.cacheTimeoutTime:864e5,returnStatistics:e.returnStatistics}).then(function(n){return t._parseFilesResponse(n,e.returnStatistics)})};return t})(i.e)},4806:function(e,t,n){"use strict";n.r(t);n.d(t,"PreventSPAppBarCalloutDismissContext",function(){return H});var r=n(0),i=n("react-lib"),s=n(2424),o=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.state={hasError:!1};return n}t.getDerivedStateFromError=function(){return{hasError:!0}};t.prototype.componentDidCatch=function(e,t){this.props.onError(e,JSON.stringify(t))};t.prototype.render=function(){return this.state.hasError?i.createElement(i.Fragment,null):i.createElement(i.Fragment,null,this.props.children)};return t})(i.Component),u=n(925),a=n(2279),f=n(2502),l=n(1688),c=n(3004),h=n(4047),p=n(3220),d=n(153),v=n(304),m=i.lazy(function(){return n.ee([500,"deferred.odsp-datasources","deferred.office-ui-fabric-react","ondemand.resx-ondemand"],5171)}),g=i.lazy(function(){return n.ee([501,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],4988)}),y=i.lazy(function(){return n.ee([502,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],4208)}),b=i.lazy(function(){return n.ee([503,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],4210)}),w=i.lazy(function(){return n.ee([504,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],3471)}),E=i.lazy(function(){return n.ee([505,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],4989)}),S=i.lazy(function(){return n.ee([506,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],4336)}),x=i.lazy(function(){return n.ee([507,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],4213)}),T=i.lazy(function(){return n.ee([508,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],3496)}),N=i.lazy(function(){return n.ee([510,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],4214)}),C=i.lazy(function(){return n.ee([512,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],4215)}),k=i.lazy(function(){return n.ee([511,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],2983)}),L=i.lazy(function(){return n.ee([509],4990)}),A=i.lazy(function(){return n.ee([513,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],4991)}),O=(function(e){Object(r.__extends)(t,e);function t(t){var r,i=this;(i=e.call(this,t)||this).tokenRefreshTimer=0;i.tokenRefreshAsync=new d.e;i._isMyListsFeatureEnabled=u.n();i._isMultipleHomeSitesGlobalNavFeatureEnabled=u.t();i._useNewSitesDataSource=u.o();i.componentData={};i._initializeFileTypeIcons=function(){n.ee([641],1070).then(v.e).then(function(e){i.initializedIcons=!0;e.initializeFileTypeIcons()})};i._isTokenExpired=function(e){return!(null==e?void 0:e.Token)||i._getExpirationTimeLeft(e.Token)<=0};i._getExpirationTimeLeft=function(e){return i.spHomeDataSource.isMicroserviceToken(e)?1e3*parseInt(e.expires_on,10)-Date.now():1e3*parseInt(e.ExpiresOn,10)-Date.now()};i._clearClientContext=function(){i.state.clientContext||null===i.state.clientContext||i.setState({clientContext:null})};i._setTimeoutAndGetHomeContext=function(e){e>0&&(i.tokenRefreshTimer=i.tokenRefreshAsync.setTimeout(function(){i.spHomeDataSource.getHomeContext().then(function(e){i._checkAndSetContext(e)}).catch(function(){i._clearClientContext()})},e))};i._checkAndSetContext=function(e,t){if(e.Token){var n=e.Token,r=i._getExpirationTimeLeft(n);if(r>=3e4){t||i.setState({clientContext:e});i._setTimeoutAndGetHomeContext(r-3e4)}}else i._clearClientContext()};i._shouldPrewarm=function(e){return!i.hasGottenFreshData&&("blank"===e.workload&&"blank"!==i.state.workload||"teams"===i.state.workload)};i._handleWorkloadMessages=function(e){if(e.origin===i.windowOrigin&&e.data&&e.data.type)if("spAppBarWorkload"===e.data.type){var t=Object(f.n)("workload",e.data.payload);i.setState({workload:t})}else if("setRTL"===e.data.type){var n=e.data.isRTL?"rtl":"ltr";document.documentElement.setAttribute("dir",n)}else"spAppBarWorkloadBlank"===e.data.type&&i.setState({workload:"blank"})};i._messageParentAppStarted=function(){window.postMessage({type:"spAppBarPanelStarted"},i.windowOrigin)};i._setUpAndPrewarm=function(e){i._useNewSitesDataSource||i._fetchTokenIfExpired();i.hasGottenFreshData=!0;i.filesDataSource=new h.e(i.pageContext);i.globalnavDataSource=new l.t(i.pageContext);i.sharePointDataSource=new c.e(i.pageContext);i._prewarmDataClick(e)};i._fetchTokenIfExpired=function(){i._isTokenExpired(i.state.clientContext)&&i.spHomeDataSource.getHomeContext().then(function(e){i.tokenRefreshTimer&&i.tokenRefreshAsync.clearTimeout(i.tokenRefreshTimer);i._checkAndSetContext(e)}).catch(function(){i._clearClientContext()})};i._prewarmDataClick=function(e){n.ee([578],260).then(v.e).then(function(t){var n,r;if("files"!==e){t.logData({name:"SPAppBar.Files.DataClick"});i._getFilesNetwork()}var s=i._isMultipleHomeSitesGlobalNavFeatureEnabled?i.pageContext.isHomeSiteEnabled:null===(n=i.pageContext.companyPortalReference)||void 0===n?void 0:n.SiteId;if("globalnav"!==e&&(null===(r=i.pageContext.appBarParams)||void 0===r?void 0:r.isGlobalNavEnabled)&&s){t.logData({name:"SPAppBar.GlobalNav.DataClick"});i.globalnavDataSource.getGlobalNav(!1).catch()}if("news"!==e){t.logData({name:"SPAppBar.News.DataClick"});i.sharePointDataSource.getNewsFeed({cachingStrategy:0,cacheTimeoutTime:a.f,returnStatistics:!0}).then(function(e){i.receivedNewData(e,"news")}).catch()}if("sites"!==e)if(i._useNewSitesDataSource){t.logData({name:"SPAppBar.Frequent.DataClick"});i.sharePointDataSource.getFrequentSites({top:a.h,cachingStrategy:0,cacheTimeoutTime:a.p,returnStatistics:!0}).then(function(e){i.receivedNewData(e,"frequentSites")});t.logData({name:"SPAppBar.Recent.DataClick"});i.sharePointDataSource.getRecentSites({top:a.h,cachingStrategy:0,cacheTimeoutTime:a.p,returnStatistics:!0}).then(function(e){i.receivedNewData(e,"recentSites")});t.logData({name:"SPAppBar.Followed.DataClick"});i.sharePointDataSource.getFollowedSites({top:a.h,cachingStrategy:0,cacheTimeoutTime:a.p,returnStatistics:!0}).then(function(e){i.receivedNewData(e,"followedSites")})}else{t.logData({name:"SPAppBar.Frequent.DataClick"});i._getSPHomeNetwork(i.spHomeDataSource.getFrequentSites.bind(i.spHomeDataSource),a.p,a.s,"frequentSites");t.logData({name:"SPAppBar.Followed.DataClick"});i._getSPHomeNetwork(i.spHomeDataSource.getFollowedSites.bind(i.spHomeDataSource),a.p,a.i,"followedSites");t.logData({name:"SPAppBar.Recent.DataClick"});i._getSPHomeNetwork(i.spHomeDataSource.getRecentSites.bind(i.spHomeDataSource),a.p,a.c,"recentSites")}if("lists"!==e&&i._isMyListsFeatureEnabled){t.logData({name:"SPAppBar.Lists.Recent.DataClick"});i._getRecentListsNetwork();t.logData({name:"SPAppBar.Lists.Favorite.DataClick"});i._getFavoriteListsNetwork()}})};i._getFilesNetwork=function(){i.filesDataSource.getRecentFiles({cachingStrategy:1,returnStatistics:!0,maxItems:a.n}).then(function(e){i.receivedNewData(e,"files")}).catch()};i._getRecentListsNetwork=function(){i.sharePointDataSource.getRecentLists({cachingStrategy:0,cacheTimeoutTime:a.o,returnStatistics:!0}).then(function(e){i.receivedNewData(e,"recentLists")}).catch()};i._getFavoriteListsNetwork=function(){i.sharePointDataSource.getFavoriteLists({cachingStrategy:0,cacheTimeoutTime:a.o,returnStatistics:!0}).then(function(e){i.receivedNewData(e,"favoriteLists")}).catch()};i._getSPHomeNetwork=function(e,t,n,r){var s=i.state.cachedData&&i.state.cachedData.find(function(e){return e.Key===n}),o=null;s&&i.state.clientContext?o=e({cachingStrategy:1,spHomeCachedItem:s.Value,spHomeClientContext:i.state.clientContext,returnStatistics:!0,cacheTimeoutTime:t}):i.state.clientContext&&i.state.clientContext.Token&&(o=e({cachingStrategy:1,spHomeCachedItem:{cacheContext:null,cacheValue:""},spHomeClientContext:i.state.clientContext,returnStatistics:!0,cacheTimeoutTime:t}));if(o){switch(r){case"frequentSites":i.needsFrequentSitesData=!1;break;case"followedSites":i.needsFollowedSitesData=!1;break;case"recentSites":i.needsRecentSitesData=!1}o.then(function(e){i.receivedNewData(e,r)}).catch()}else switch(r){case"frequentSites":i.needsFrequentSitesData=!1;break;case"followedSites":i.needsFollowedSitesData=!1;break;case"recentSites":i.needsRecentSitesData=!1}};var s=Object(f.n)("workload",t.query);i.state={workload:s,cachedData:void 0,clientContext:void 0};i.pageContext=null!==(r=i.props.spPageContextInfo)&&void 0!==r?r:window._spPageContextInfo;i.windowOrigin=window.location.origin;i.spHomeDataSource=new p.e(i.pageContext);i.receivedNewData=a.x.bind(i);return i}t.prototype.componentDidUpdate=function(e,t){if(!t.clientContext&&this.state.clientContext){this.needsFrequentSitesData&&this._getSPHomeNetwork(this.spHomeDataSource.getFrequentSites.bind(this.spHomeDataSource),a.p,a.s,"frequentSites");this.needsFollowedSitesData&&this._getSPHomeNetwork(this.spHomeDataSource.getFollowedSites.bind(this.spHomeDataSource),a.p,a.i,"followedSites");this.needsRecentSitesData&&this._getSPHomeNetwork(this.spHomeDataSource.getRecentSites.bind(this.spHomeDataSource),a.p,a.c,"recentSites")}this._useNewSitesDataSource||this._fetchTokenIfExpired();this._shouldPrewarm(t)&&this._setUpAndPrewarm(this.state.workload)};t.prototype.componentDidMount=function(){window.addEventListener("message",this._handleWorkloadMessages);this._messageParentAppStarted();"blank"!==this.state.workload&&this._setUpAndPrewarm(this.state.workload)};t.prototype.componentWillUnmount=function(){window.removeEventListener("message",this._handleWorkloadMessages)};t.prototype.render=function(){var e=null,t={useRouterNavigation:!1,pageContext:this.pageContext,onDismissAppBarPanel:this.props.onDismissAppBarPanel},n=Object(r.__assign)(Object(r.__assign)({},t),{sendUpdatedDataToParent:this.receivedNewData,clientContext:this.state.clientContext,cachedData:this.state.cachedData});switch(this.state.workload){case"globalnav":e=this.componentData.globalnav?i.createElement(w,Object(r.__assign)({rawNavData:this.componentData.globalnav},t)):i.createElement(b,Object(r.__assign)({},n));break;case"sites":if(this.componentData.frequentSites&&this.componentData.followedSites&&this.componentData.recentSites)if(this._useNewSitesDataSource){var s=this.componentData.frequentSites,o=this.componentData.followedSites,u=this.componentData.recentSites;if(Object(a.g)(s.cacheStats.lastModified,a.p)&&Object(a.g)(o.cacheStats.lastModified,a.p)&&Object(a.g)(u.cacheStats.lastModified,a.p)){var l=!1;e=i.createElement(k,Object(r.__assign)({},t,{frequentSites:Object(a.E)(s.data||[]),followedSites:Object(a.E)(o.data||[]),recentSites:Object(a.E)(u.data||[]),hideFrequentSites:l,countToRender:Object(f.e)(window.innerHeight,!1)}))}else e=i.createElement(N,Object(r.__assign)({},n,{countToRender:Object(f.e)(window.innerHeight,!1)}))}else{s=this.componentData.frequentSites,o=this.componentData.followedSites,u=this.componentData.recentSites;if(Object(a.g)(s.cacheStats.lastModified,a.p)&&Object(a.g)(o.cacheStats.lastModified,a.p)){l=!1;e=i.createElement(k,Object(r.__assign)({},t,{frequentSites:Object(a.S)(s.data),followedSites:Object(a.S)(o.data),recentSites:Object(a.S)(u.data),hideFrequentSites:l,countToRender:Object(f.e)(window.innerHeight,!1)}))}else e=i.createElement(C,Object(r.__assign)({},n,{countToRender:Object(f.e)(window.innerHeight,!1)}))}else e=this._useNewSitesDataSource?i.createElement(N,Object(r.__assign)({},n,{countToRender:Object(f.e)(window.innerHeight,!1)})):i.createElement(C,Object(r.__assign)({},n,{countToRender:Object(f.e)(window.innerHeight,!1)}));break;case"news":if(this.componentData.news){var c=this.componentData.news;e=Object(a.g)(c.cacheStats.lastModified,a.f)?i.createElement(T,Object(r.__assign)({},t,{news:Object(a.w)(c.data),countToRender:Object(f.e)(window.innerHeight,!0)})):i.createElement(x,Object(r.__assign)({},n,{countToRender:Object(f.e)(window.innerHeight,!0)}))}else e=i.createElement(x,Object(r.__assign)({},n,{countToRender:Object(f.e)(window.innerHeight,!0)}));break;case"files":if(this.componentData.files){this.initializedIcons||this._initializeFileTypeIcons();var h=this.componentData.files;e=Object(a.g)(h.cacheStats.lastModified,a.r)?i.createElement(y,Object(r.__assign)({},t,{files:h.data,countToRender:Object(f.e)(window.innerHeight,!0)})):i.createElement(g,Object(r.__assign)({},n,{countToRender:Object(f.e)(window.innerHeight,!0)}))}else{this.initializedIcons||this._initializeFileTypeIcons();e=i.createElement(g,Object(r.__assign)({},n,{countToRender:Object(f.e)(window.innerHeight,!0)}))}break;case"teams":e=i.createElement(A,{useRouterNavigation:!0,clientContext:this.state.clientContext,cachedData:this.state.cachedData,pageContext:this.pageContext});break;case"create":this.initializedIcons||this._initializeFileTypeIcons();e=i.createElement(m,Object(r.__assign)({},t));break;case"lists":if(this.componentData.recentLists&&this.componentData.favoriteLists){var p=this.componentData.recentLists,d=this.componentData.favoriteLists;e=Object(a.g)(p.cacheStats.lastModified,a.o)&&Object(a.g)(d.cacheStats.lastModified,a.o)?i.createElement(S,Object(r.__assign)({},t,{recentLists:p.data,favoriteLists:d.data,countToRender:Object(f.e)(window.innerHeight,!1,"lists")})):i.createElement(E,Object(r.__assign)({},n,{countToRender:Object(f.e)(window.innerHeight,!1,"lists")}))}else e=i.createElement(E,Object(r.__assign)({},n,{countToRender:Object(f.e)(window.innerHeight,!1,"lists")}));break;case"blank":default:e=null}return e?i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(L,{content:i.createElement(i.Suspense,{fallback:i.createElement("div",null)},e)})):i.createElement(i.Fragment,null)};return t})(i.PureComponent),M=n(40),_=n(80),D=n(1414),P=n(119),H=i.createContext([!1,function(){}]),B=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._isPreventClosingPanelWhenNameDialogIsOpenKSActivated=s.o();n._isMobileEdgeFixKSActivated=s.r();n._preventDismissOnEvent=function(e){var t;return!n._isPreventClosingPanelWhenNameDialogIsOpenKSActivated&&(null!==(t=n.state.preventDismissal)&&void 0!==t&&t)};n._onErrorBoundary=function(e,t){e&&n._qos.end({resultType:M.e.Failure,error:e.message,extraData:{errorInfo:t}})};n._handleEventFromAppBar=function(e){e.origin===window.location.origin&&e.data&&e.data.type&&("spAppBarWorkload"===e.data.type?e.data.payload!==n.state.appbarQueryString?n.setState({showAppBarCallout:!0,appbarQueryString:e.data.payload}):n.state.showAppBarCallout||(n.state.firstClose?n.setState({firstClose:!1}):n.setState({showAppBarCallout:!0,appbarQueryString:e.data.payload})):"CLOSE_CALLOUT"!==e.data.type&&"spAppBarCreateSite"!==e.data.type||n.state.showAppBarCallout&&n.setState({showAppBarCallout:!1}))};n._dismissAppBarPanel=function(e){if(n.state.showAppBarCallout&&(!e||!e.target||"sp-appBar-link"!==e.target.className)){if("focus"===(null==e?void 0:e.type))return;n.setState({showAppBarCallout:!1});window.postMessage({type:"CLOSE_CALLOUT"},window.location.origin);window.postMessage({type:"spAppBarWorkloadBlank"},window.location.origin)}};window.addEventListener("message",n._handleEventFromAppBar);n.state={showAppBarCallout:!1,appbarQueryString:"/_layouts/15/spappbar.aspx?workload=blank",firstClose:!1,preventDismissal:!1};return n}t.prototype.componentDidMount=function(){this._qos=new _.e({name:"SPAppBar.Callout.Render"})};t.prototype.render=function(){var e=this,t=document.getElementById("sp-appBar"),n=null==t?void 0:t.classList.contains("sp-appBar-mobile"),r={root:{height:"100%",display:"flex",flexDirection:"column",minWidth:n?this._isMobileEdgeFixKSActivated?"100vw":"100%":"320px",maxWidth:n?"unset":"320px",borderRadius:0,boxShadow:"10px 5.4px 14.4px -10px rgb(0 0 0 / 13%), 10px 0.2px 3.6px -10px rgb(0 0 0 / 11%)",animation:"none",bottom:"0px !important"},container:{height:"100%",zIndex:11,minWidth:!this._isMobileEdgeFixKSActivated&&this.state.showAppBarCallout&&n?"100%":"unset"},calloutMain:{display:"flex",flexDirection:"column",height:"100%",borderRadius:0},beak:{height:"97%"},beakCurtain:{height:"96%"}},s=i.createElement(H.Provider,{value:[this.state.preventDismissal,function(t){return e.setState({preventDismissal:t})}]},i.createElement(D.e,{className:"spappbar-callout",id:"sp-appBar-callout",gapSpace:0,target:".sp-appBar",isBeakVisible:!1,directionalHint:P.e.topCenter,setInitialFocus:!0,styles:r,doNotLayer:!0,minPagePadding:-1,hidden:!this.state.showAppBarCallout,onDismiss:this._dismissAppBarPanel,shouldUpdateWhenHidden:!0,dismissOnTargetClick:!0,preventDismissOnEvent:this._preventDismissOnEvent,role:"dialog"},i.createElement(O,{query:this.state.appbarQueryString,onDismissAppBarPanel:this._dismissAppBarPanel,spPageContextInfo:this.props.spPageContextInfo})));return i.createElement(o,{onError:this._onErrorBoundary},s)};return t})(i.Component);t.default=B}}]);