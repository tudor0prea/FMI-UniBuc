(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[216],{2801:function(e,t,n){"use strict";var r=(function(){function e(){}e.supportMSPdfViewer=function(){return!!window.SharedArrayBuffer};return e})();t.e=r},4245:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(59),s=n(40),o=n(1967),u=n(1974),a=n(173),f=n(123),l=n(31),c=n(72),h=n(2017),p=n(2227),d=n(752),v=n(27),m=n(2801),g=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="PrintPdf";r._platform=r.resources.consume(a.e);r._navigation=r.resources.consume(f.e);r._itemCommandHelper=r.resources.consume(h.t);r._itemSelectionHelper=new(r.child(u.e))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&!(".pdf"!==e.extension&&(!e.officeBundle||"ms-powerpoint"!==e.appMap&&"ms-word"!==e.appMap||!e.urls[d.t.viewInBrowser]||this._platform.isEdge||this._platform.isIE))&&!this._platform.isMobile&&Object(l.isFeatureEnabled)(l.UseWebPdfViewer)&&this._itemCommandHelper.isCommandSupported(e,p.l)&&4!==e.itemStatus&&3!==e.itemStatus&&v.e.hasItemPermission(e,v.e.openItems)};t.prototype.onExecute=function(e,t){return Object(r.__awaiter)(this,void 0,i.n,function(){var e,t,o,u,a=this;return Object(r.__generator)(this,function(f){switch(f.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:if(!(e=f.sent()))return[2,i.n.resolve({resultCode:"EmptySelection",resultType:s.e.Failure})];if(this._platform.isIE){this._navigation.navigateTo({url:e.openUrl,frameId:"_blank"});return[2,i.n.resolve({resultType:s.e.Success})]}t=Object(l.isFeatureEnabled)(l.PDFiumBasedPDFViewer)&&m.e.supportMSPdfViewer();o=t?"":"printPdf_".concat(Math.random());u=t?void 0:window.open("",o);void 0;return[2,(e.officeBundle&&("ms-powerpoint"===e.appMap||"ms-word"===e.appMap)&&e.urls&&e.urls[d.t.viewInBrowser]?i.n.resolve(e.urls[d.t.viewInBrowser]):"pdf"===e.iconName&&e.openUrl?i.n.resolve(e.openUrl):this.resources.consumeAsync(c.a).then(function(t){return t.getDownloadUrl(e,{downloadType:1})})).then(function(e){t?Object(r.__awaiter)(a,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,n.ee([523,"ondemand.resx-ondemand"],4004)];case 1:(0,t.sent().printDocument)(e);return[2]}})}):null==u||u.location.assign(e);return{resultType:s.e.Success}},function(){u&&u.close();return{resultType:s.e.Failure}})]}})})};return t})(o.e);t.default=g}}]);