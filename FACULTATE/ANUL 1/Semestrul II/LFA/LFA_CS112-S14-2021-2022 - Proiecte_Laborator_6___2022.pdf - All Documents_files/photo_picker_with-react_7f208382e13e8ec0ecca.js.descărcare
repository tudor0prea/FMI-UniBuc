/*! Version: 4.2.18; Third Party Notices: https://res-1.cdn.office.net/midgard/versionless/tpn-051bef26f294aad48d7d2c6c9f68d420e57dcaf2a94d49ca38799572faa8aea06ad5c9e2affa2eb8bc6dacd881cb2182fce35aecdad68ab1530a7401af444b32.txt */
(window.webpackJsonpLpc=window.webpackJsonpLpc||[]).push([[143],{1291:function(t,e,o){"use strict";o.d(e,"a",function(){return i});var n=o(2),a=o(0),r=o(84),i=function(t){function e(e){var o=t.call(this,e)||this;return o.state={isRendered:void 0===Object(r.a)()},o}return Object(n.__extends)(e,t),e.prototype.componentDidMount=function(){var t=this,e=this.props.delay;this._timeoutId=window.setTimeout(function(){t.setState({isRendered:!0})},e)},e.prototype.componentWillUnmount=function(){this._timeoutId&&clearTimeout(this._timeoutId)},e.prototype.render=function(){return this.state.isRendered?a.Children.only(this.props.children):null},e.defaultProps={delay:0},e}(a.Component)},1334:function(t,e,o){"use strict";o.d(e,"a",function(){return r});var n=o(142),a=["TEMPLATE","STYLE","SCRIPT"];function r(t){var e=Object(n.a)(t);if(!e)return function(){};for(var o=[];t!==e.body&&t.parentElement;){for(var r=0,i=t.parentElement.children;r<i.length;r++){var s=i[r],l=s.getAttribute("aria-hidden");s!==t&&"true"!==(null==l?void 0:l.toLowerCase())&&-1===a.indexOf(s.tagName)&&o.push([s,l])}t=t.parentElement}return o.forEach(function(t){t[0].setAttribute("aria-hidden","true")}),function(){!function(t){t.forEach(function(t){var e=t[0],o=t[1];o?e.setAttribute("aria-hidden",o):e.removeAttribute("aria-hidden")})}(o),o=[]}}},2410:function(t,e,o){"use strict";o.d(e,"a",function(){return c});var n=o(2473),a=o(0),r=o(1),i=o(40),s=(Object(r.declareStringWithPlaceholders)("accessibility-utils-ui.accessibility-utils.positionInSet")),l=function(t,e){return Object(i.b)(s,{pos:t.toString(),size:e.toString()})};function c(t){var e=t.posInSet,o=t.setSize,r=t.onRenderDescribedElement,i=l(e,o),s=Object(n.a)();return a.createElement(a.Fragment,null,a.createElement("div",{id:s,hidden:!0},i),r(s))}},2547:function(t,e,o){"use strict";o.r(e),o.d(e,"PhotoPickerStore",function(){return M}),o.d(e,"StandalonePhotoPicker",function(){return ye}),o.d(e,"PhotoPicker",function(){return de}),o.d(e,"initIcons",function(){return he});var n=o(9),a=o(43),r=o(41),i=o(62),s=o(3),l="PhotoPicker";function c(t,e){void 0===e&&(e=null);var o="".concat(l).concat(t,"Action");return Object(s.a)(o,{featureName:l,exportOptions:e?{exportType:"UserInteraction",exportName:e}:void 0})}var u=c("UploadedPhotoTooSmall"),p=c("CancelButtonClicked","PhotoPickerCancelButtonClicked"),d=c("CloseButtonClicked","PhotoPickerCloseButtonClickedAction"),m=c("DoneButtonClicked","PhotoPickerDoneButtonClickedAction"),h=c("UploadNewPhotoButtonClicked","PhotoPickerUploadNewPhotoButtonClickedAction"),g=c("ImageEditPaneDismissed","PhotoPickerImageEditPaneDismissed"),f=c("ImageUpdated"),v=c("LoadedCurrentImage"),b=c("LoadedEmptyImage"),S=c("LoadedNewImage"),y=c("SomethingWentWrong"),P=c("UploadStarted","PhotoPickerApplyButtonClicked"),E=c("UploadProgress"),I=c("UploadSucceeded"),C=c("WarningDismissed"),U=c("Keyboard"),x=c("Zoom"),w=c("ImageLoaded"),O=c("DragStarted"),L=c("DragProgress"),k=c("ResetEditCanvas"),D=c("EmptyImageRendered"),R=c("SetImageUpdated"),N=c("PhotoListImageSelected"),A=c("NewImageUploaded"),B=c("PhotoListLoadPhotos"),T=function(t,e,o){if(o||2===arguments.length)for(var n,a=0,r=e.length;a<r;a++)!n&&a in e||(n||(n=Array.prototype.slice.call(e,0,a)),n[a]=e[a]);return t.concat(n||Array.prototype.slice.call(e))},j={photoPicker:{dataUrl:void 0,currentImageDataUrl:void 0,status:"READY",warning:void 0,show:!1,isUpdated:!1,uploadStart:0,uploadDuration:0,isUploadedPhotoTooSmall:!1},editCanvas:{xpos:0,ypos:0,absoluteScale:1,relativeScale:0,stepSize:.1,orientation:1,maximumScale:1,naturalMin:0,naturalWidth:0,naturalHeight:0,moving:!1,lastMouseX:0,lastMouseY:0,zoomInDisabled:!0,zoomOutDisabled:!0,image:void 0,initialRender:!0,imageUpdated:!0},photoList:{selectedIndex:0,imageUrls:[]}},_=Object(i.combineReducers)({photoPicker:Object(a.a)().handleAction(p,W).handleAction(d,W).handleAction(m,W).handleAction(g,W).handleAction(C,function(t){return Object(n.j)(t,{status:"READY",warning:void 0})}).handleAction(v,function(t,e){var o=e.payload.dataUrl;return Object(n.j)(t,{dataUrl:t.dataUrl||o,currentImageDataUrl:t.currentImageDataUrl||o,isUpdated:!!e.payload.isSuggestedPhoto||!!e.payload.isPhotoListPresent})}).handleAction(S,function(t,e){return Object(n.j)(t,{dataUrl:e.payload.dataUrl,status:"READY",warning:void 0,isUpdated:e.payload.dataUrl!==t.currentImageDataUrl||!!e.payload.isPhotoListPresent,fileName:e.payload.fileName})}).handleAction(b,function(t,e){return Object(n.j)(t,{dataUrl:"",status:"READY",warning:void 0,isUpdated:!!t.currentImageDataUrl||!!e.payload.isPhotoListPresent,fileName:void 0})}).handleAction(P,function(t,e){return Object(n.j)(t,{status:"IN_PROGRESS",warning:void 0,uploadStart:e.payload.now,uploadDuration:0})}).handleAction(E,function(t,e){return"IN_PROGRESS"===t.status?Object(n.j)(t,{uploadDuration:e.payload.now-t.uploadStart}):t}).handleAction(I,function(t,e){return Object(n.j)(t,{currentImageDataUrl:e.payload.dataUrl,status:"SUCCESS",warning:void 0})}).handleAction(y,function(t,e){return Object(n.j)(t,{status:"SOMETHING_WENT_WRONG",warning:e.payload.warning})}).handleAction(f,function(t){return Object(n.j)(t,{isUpdated:!0})}).handleAction(u,function(t,e){return Object(n.j)(t,e.payload)}).done(j.photoPicker),editCanvas:Object(a.a)().handleAction(k,z).handleAction(U,function(t,e){return Object(n.j)(t,e.payload)}).handleAction(x,function(t,e){return Object(n.j)(t,e.payload)}).handleAction(w,function(t,e){return Object(n.j)(t,e.payload)}).handleAction(O,function(t,e){return Object(n.j)(t,e.payload)}).handleAction(L,function(t,e){return Object(n.j)(t,e.payload)}).handleAction(R,function(t){return Object(n.j)(t,{imageUpdated:!0})}).handleAction(D,function(t){return Object(n.j)(t,{initialRender:!1})}).handleAction(p,z).handleAction(d,z).handleAction(m,z).handleAction(g,z).done(j.editCanvas),photoList:Object(a.a)().handleAction(N,function(t,e){return Object(n.j)(t,e.payload)}).handleAction(A,function(t,e){return Object(n.j)(t,{selectedIndex:e.payload.selectedIndex,imageUrls:T([e.payload.newImageUrl],t.imageUrls,!0)})}).handleAction(B,function(t,e){return Object(n.j)(t,e.payload)}).handleAction(p,F).handleAction(d,F).handleAction(m,F).handleAction(g,F).done(j.photoList)}),M=Object(r.a)("PhotoPickerStore",_,function(t){return{getPhotoPickerState:function(){return t.photoPicker},getEditCanvasState:function(){return t.editCanvas},getPhotoListState:function(){return t.photoList}}});function W(t){return Object(n.j)(t,{dataUrl:void 0,currentImageDataUrl:void 0,status:"READY",warning:void 0,isUpdated:!1,fileName:void 0})}function z(t){return Object(n.j)(t,j.editCanvas)}function F(t){return Object(n.j)(t,j.photoList)}var H=o(4),G=o.n(H),Y=o(636),X=o.n(Y),K=o(445),Z=o.n(K),V=o(864),q=o(444),J=o(1062),Q=o(0),$=o(59),tt=o.n($),et=o(73),ot=o.n(et),nt=o(127);function at(t,e){try{return e?t.toDataURL():t.toDataURL("image/jpeg")}catch(t){return console.error(t),""}}var rt={1:[1,0,0,1,0,0],2:[-1,0,0,1,0,0],3:[-1,0,0,-1,0,0],4:[1,0,0,-1,0,0],5:[0,1,1,0,0,0],6:[0,1,-1,0,0,0],7:[0,-1,-1,0,0,0],8:[0,-1,1,0,0,0]},it=256,st=it/2-3;function lt(t,e,o,n,a){t.save(),t.translate(e/2,e/2),t.transform.apply(t,rt[o]),t.translate(-e/2,-e/2),a(t,n),t.restore()}function ct(t,e,o){var n=rt[o],a=n[0],r=n[2],i=n[1],s=n[3];return{x:(t-=it/2)*a+(e-=it/2)*i+it/2,y:t*r+e*s+it/2}}function ut(t,e,o){return Math.min(o,Math.max(t,e))}var pt=o(110),dt=o(879),mt=o(1699),ht=o(1627),gt=o(1830),ft=o(1602),vt=o(901),bt=o(20),St=o(278),yt=Object(St.c)(function(t){var e=t.palette;return Object(bt.cb)({picker:t.fonts.medium,uploadHeader:t.fonts.xLarge,messageBarText:t.fonts.medium},{modal:{width:512,maxWidth:512,margin:0,selectors:{"#lpc-photo-picker .ms-Button-icon":{display:"inline-block",minWidth:16,padding:"0px 4px",backgroundColor:"transparent"},"#lpc-photo-picker .ms-Slider-slideBox:focus":{outline:"transparent"},"#lpc-photo-picker .ms-Button--icon &hover":{color:e.themePrimary},"#lpc-photo-picker .ms-Button--icon &active":{color:e.themeDarker},"#lpc-photo-picker .ms-Button--primary &:not([disabled])":{backgroundColor:e.themePrimary},"#lpc-photo-picker .ms-Button--primary &:hover":{backgroundColor:e.themeDarkAlt},"#lpc-photo-picker .ms-Button--primary &:active":{backgroundColor:e.themeDark},"#lpc-photo-picker .ms-Button--default .ms-Button-label":{color:e.neutralDark},"#lpc-photo-picker .ms-Button--default &:hover":{backgroundColor:e.neutralLight},"#lpc-photo-picker .ms-Button--default &:active":{backgroundColor:e.neutralTertiaryAlt}}},picker:{padding:32,overflow:"hidden"},header:{display:"flex",alignContent:"space-between"},uploadHeader:{color:e.neutralPrimary,fontWeight:300,marginBottom:7,flexGrow:1},messageBar:{margin:"7px 0",color:e.neutralPrimary},fileInput:{display:"none"},fileInputButton:{color:e.themePrimary,padding:0,margin:"0 0 12px -4px"},closeButton:{float:"right",marginTop:-20,marginRight:-20},removeButton:{marginLeft:"auto"},endActions:{alignItems:"center",display:"flex",selectors:{button:{marginRight:12,minWidth:90,padding:"0px 16px"}}},editCanvasAndPhotoListContainer:{display:"flex",padding:"0px 8px"}})}),Pt=function(t){var e=t.onClick,o=t.dataLogName,n=t.ariaLabel,a=t.title,r=yt(Object(dt.a)());switch(t.buttonType){case"Primary":return Q.createElement(mt.a,{disabled:t.disabled,onClick:e,"data-log-name":o,ariaLabel:n,title:a,componentRef:t.buttonRef},t.buttonLabel);case"Action":return Q.createElement(ht.a,{className:r.removeButton,iconProps:{iconName:t.iconName},onClick:e,"data-log-name":o,disabled:t.disabled,title:a},t.buttonLabel);case"Icon":return Q.createElement(vt.a,{content:a,styles:{root:r.closeButton}},Q.createElement(gt.a,{iconProps:{iconName:t.iconName},onClick:e,"data-log-name":o,ariaLabel:n}));case"Default":return Q.createElement(ft.a,{onClick:e,"data-log-name":o,ariaLabel:n,title:a},t.buttonLabel);default:return t}},Et=o(1630),It=o(2e3),Ct=function(t){var e=yt(Object(dt.a)()),o="UNKNOWN"===t.warning,n="IMAGE_TOO_SMALL_ERROR"===t.warning,a=o||n?Et.a.error:Et.a.warning,r=o?void 0:t.onDismiss;return Q.createElement(It.a,{className:e.messageBar,messageBarType:a,onDismiss:r,isMultiline:!0,"aria-live":"polite",dismissButtonAriaLabel:t.dismissButtonAriaLabel},Q.createElement("div",{className:e.messageBarText},t.warningText))},Ut=o(1889),xt=o(1891),wt=function(t){var e=t.hideTitleText,o=t.isComponentInline,n=t.titleText,a=t.closeIcon,r=t.infoBar,i=t.uploadPhoto,s=t.editCanvas,l=t.applyButton,c=t.cancelButton,u=t.removeButton,p=t.onDismiss,d=t.focusTrapRef,m=t.hideEndActions,h=t.imageEditorDescription,g=t.customUploadButton,f=t.photoList,v=yt(Object(dt.a)()),b=Q.createElement(Q.Fragment,null,!o&&a,!e&&Q.createElement("div",{className:v.header,id:"dialogTitle",role:"heading","aria-level":1},Q.createElement("div",{className:v.uploadHeader},n)),r,i,Q.createElement("div",{className:v.editCanvasAndPhotoListContainer},s,f),h,!m&&Q.createElement("div",{className:v.endActions},l,c,u),g);return Q.createElement(Q.Fragment,null,o?Q.createElement("div",{id:"lpc-photo-picker",className:v.picker},b):Q.createElement(xt.a,{className:"lpc_nested_popup",containerClassName:v.modal,isOpen:!0,onDismiss:p,titleAriaId:"dialogTitle"},Q.createElement(Ut.a,{id:"lpc-photo-picker",className:v.picker,componentRef:d,firstFocusableSelector:"photoPickerFirstFocusableSelector"},b)))},Ot=function(t){var e=yt(Object(dt.a)()),o=null;return Q.createElement(Q.Fragment,null,Q.createElement("input",{role:"button",className:e.fileInput,type:"file",ref:function(t){return o=t},onClick:function(t){return t.currentTarget.value=""},onChange:function(e){return e.currentTarget.files&&t.onFileSelected(e.currentTarget.files[0],t.isPhotoListPresent)},"data-log-name":"PhotoPickerFileInput",accept:"image/*"}),Q.createElement(ht.a,{componentRef:t.buttonRef,className:"".concat(e.fileInputButton," ").concat("photoPickerFirstFocusableSelector"),iconProps:{iconName:"Add"},onClick:function(){o&&o.click(),t.onUploadNewPhoto()}},t.uploadText))},Lt=o(481),kt=o(497),Dt=o(78),Rt=o(1016),Nt=o(205);function At(t){var e=new DataView(function(t){for(var e=t.replace(/^data\:([^\;]+)\;base64,/i,""),o=atob(e),n=o.length,a=new ArrayBuffer(n),r=new Uint8Array(a),i=0;i<n;i++)r[i]=o.charCodeAt(i);return a}(t));if(65496!==e.getUint16(0,!1))return 1;for(var o,n=e.byteLength,a=2;a<n;){var r=e.getUint16(a,!1);if(a+=2,65505===r){if(1165519206!==e.getUint32(a+=2,!1))break;var i=18761===e.getUint16(a+=6,!1);a+=e.getUint32(a+4,i);var s=e.getUint16(a,i);a+=2;for(var l=0;l<s;l++)if(274===e.getUint16(a+12*l,i))return(o=e.getUint16(a+12*l+8,i))<1||o>8?1:o}else{if(65280!=(65280&r))break;a+=e.getUint16(a,!1)}}return 1}var Bt,Tt=o(2015),jt=function(){return(jt=G.a||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var a in e=arguments[o])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},_t=Object(St.c)(function(t,e,o){var n=t.palette;return Object(bt.cb)({editControls:{display:"flex",flexDirection:"row",width:"100%",height:54},zoomButton:{selectors:{"&:disabled":{background:n.white}}},editCanvas:{backgroundColor:n.white,cursor:e?"move":"inherit"},isDropActive:{outline:"1px solid purple"},invisible:jt({clip:"rect(1px, 1px, 1px, 1px)"},{height:1,overflow:"hidden",position:"absolute",whiteSpace:"nowrap",width:1}),slider:{flexGrow:1,marginTop:2,marginBottom:24,selectors:{".ms-Slider-thumb":{border:"2px solid ".concat(n.themePrimary)},".ms-Slider-active":{backgroundColor:n.themePrimary},".ms-Slider-inactive":{backgroundColor:n.themeLight}}},canvasContainer:{margin:o?"0 0 0 auto":"0 auto",display:"flex",alignItems:"center",flexDirection:"column",width:256,position:"relative"},textboy:{color:n.white,position:"absolute",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",top:0,left:0,width:256,height:256},initials:{fontSize:128,lineHeight:128},zoomAnnouncement:{position:"absolute",width:1,height:1,margin:-1,overflowX:"hidden",overflowY:"hidden"}})}),Mt=function(t){var e=Q.useState(!1),o=e[0],n=e[1],a=Q.useState(),r=a[0],i=a[1],s=Q.useCallback(function(e,o){!t.image||t.maximumScale<1||t.zoom(v(e)-t.relativeScale,.5*o,.5*o,!1)},[t.image,t.maximumScale,t.zoom]),l=Q.useCallback(function(e,a){t.zoom(e,a/2,a/2,!0),o&&clearTimeout(r),n(!0),i(window.setTimeout(function(){return n(!1)},3e3))},[t.zoom,o,r]),c=Object(dt.a)(),u=t.maximumScale,p=!(!t.image||u<=1||t.progress>0)||t.naturalHeight!==t.naturalWidth,d=_t(c,p),m=ut(2*t.stepSize,.1,.2),h=t.canvasSize,g=function(t){return"".concat(t,"%")},f=function(t){return Math.round(100*(t*(u-1)+1))},v=function(t){return Math.round((t/100-1)/(u-1)*100)/100};return Q.createElement("div",{className:d.editControls},Q.createElement(gt.a,{className:d.zoomButton,iconProps:{iconName:"CalculatorSubtract"},title:t.zoomOutString,ariaLabel:t.zoomOutString,onClick:function(){l(-m,h)},disabled:t.zoomOutDisabled,tabIndex:-1}),Q.createElement(vt.a,{content:t.zoomString,styles:{root:d.slider}},Q.createElement(Tt.a,{ariaValueText:g,ariaLabel:t.zoomString,min:f(0),max:f(1),step:f(ut(t.stepSize,.05,.1))-f(0),value:f(t.relativeScale),showValue:!1,onChange:function(t){return s(t,h)}})),Q.createElement(gt.a,{className:d.zoomButton,iconProps:{iconName:"CalculatorAddition"},title:t.zoomInString,ariaLabel:t.zoomInString,onClick:function(){l(m,h)},disabled:t.zoomInDisabled,tabIndex:-1}),o&&Q.createElement("div",{"aria-live":"assertive",role:"status",className:d.zoomAnnouncement},g(f(t.relativeScale))))},Wt=function(t){var e=!1,o=Q.useRef(null),n=null,a=Object(Rt.a)(t.personDisplayName,Object(Nt.a)()),r=!t.image||t.maximumScale<=1||t.progress>0,i=!r||t.naturalHeight!==t.naturalWidth,s=Object(dt.a)(),l=_t(s,i,t.isPhotoListPresent),c=Q.useState(),u=c[0],p=c[1],d=Q.useCallback(function(e,o,n,a){if(void 0===a&&(a=!0),t.image&&!(t.maximumScale<1)){var r=Math.min(1,Math.max(0,t.relativeScale+e));if(r!==t.relativeScale){var i=Math.exp(r*Math.log(t.maximumScale)),s=i<=1,l=i>=t.maximumScale,c=h(o,t.xpos,t.naturalWidth,i),u=h(n,t.ypos,t.naturalHeight,i);a&&(s||l)&&t.onRefocus(),t.onZoomEvent({absoluteScale:i,relativeScale:r,zoomOutDisabled:s,zoomInDisabled:l,xpos:c,ypos:u}),t.onUpdate()}}},[t.image,t.maximumScale,t.relativeScale,t.xpos,t.ypos,t.naturalWidth,t.naturalHeight,t.onRefocus,t.onZoomEvent,t.onUpdate]),m=Q.useCallback(function(e){switch(e.key){case"+":return d(t.stepSize,it/2,it/2,!1);case"-":return d(-1*t.stepSize,it/2,it/2,!1)}var o=ct((e.which===Dt.a.left?1:e.which===Dt.a.right&&-1)||0,(e.which===Dt.a.up?1:e.which===Dt.a.down&&-1)||0,t.orientation),n=o.x,a=o.y;if(t.image){var r=n*t.naturalWidth/100,i=a*t.naturalHeight/100,s=C(t.xpos+r,t.naturalWidth*t.absoluteScale/t.maximumScale),l=C(t.ypos+i,t.naturalHeight*t.absoluteScale/t.maximumScale);t.onKeybordEvent({xpos:s,ypos:l})}},[t.stepSize,t.orientation,t.image,t.naturalWidth,t.naturalHeight,t.xpos,t.ypos,t.absoluteScale,t.maximumScale,t.onKeybordEvent,d]),h=Q.useCallback(function(e,o,n,a){var r=e+(o-e)*a/t.absoluteScale,i=a*n/t.maximumScale;return C(r,i)},[t.absoluteScale,t.maximumScale]),g=Q.useCallback(function(n){var a,r,i,s=1;"Fit"===t.imageScaling?(s=1.2,r=Math.max(n.naturalWidth,n.naturalHeight),i=r*s/it):(r=Math.min(n.naturalWidth,n.naturalHeight),i=r/it);var l=function(t){return-.5*(t/i-it)},c=Math.min(1,Math.max(.01,it/(2*Math.max(n.naturalWidth,n.naturalHeight))));!t.initialRender&&i<1&&(n.naturalHeight<48||n.naturalWidth<48?setTimeout(function(){return t.onError("IMAGE_TOO_SMALL_ERROR")},0):setTimeout(function(){return t.onError("IMAGE_TOO_SMALL_WARNING")},0)),t.isUploadedPhotoTooSmall(n.naturalHeight<48||n.naturalWidth<48),e||t.onImageLoaded({naturalMin:r,naturalWidth:n.naturalWidth*s,naturalHeight:n.naturalHeight*s,stepSize:c,maximumScale:i,orientation:At(n.src),image:n,zoomInDisabled:!1,initialRender:!1,xpos:l(n.naturalWidth*s),ypos:l(n.naturalHeight*s),absoluteScale:1,relativeScale:0,imageUpdated:!1}),!t.initialRender&&(null===(a=o.current)||void 0===a||a.focus())},[t.initialRender,t.onError,t.isUploadedPhotoTooSmall,t.onImageLoaded,e,o]),f=Q.useCallback(function(e){if(e){var o=new Image;o.onload=function(){return g(o)},o.src=e}else t.onReset(),""===e&&t.onEmptyImageRendered()},[t.onReset,g]),v=Q.useCallback(function(e){if(t.image){zt(e);var o=e.deltaY>0?-1:1,n=ct(e.nativeEvent.offsetX,e.nativeEvent.offsetY,t.orientation),a=n.x,r=n.y;d(ut(t.stepSize,.05,.1)*o,a,r)}},[t.image,t.orientation,t.stepSize,d]),b=Q.useCallback(function(e){var o=Ft(e),n=ct(o[0],o[1],t.orientation),a=n.x,r=n.y;t.image&&(zt(e),t.onDragStart({moving:!0,lastMouseX:a,lastMouseY:r}))},[t.image,t.onDragStart]),S=Q.useCallback(function(e){zt(e);var o="mousemove"===e.type||"touchmove"===e.type,n=Ft(e),a=ct(n[0],n[1],t.orientation),r=a.x,i=a.y;if(t.image&&t.moving){var s=C(t.xpos+(r-t.lastMouseX),t.naturalWidth*t.absoluteScale/t.maximumScale),l=C(t.ypos+(i-t.lastMouseY),t.naturalHeight*t.absoluteScale/t.maximumScale);(t.xpos!==s||t.ypos!==l)&&t.onUpdate(),t.onDragProgress({moving:o,xpos:s,ypos:l,lastMouseX:r,lastMouseY:i})}},[t.orientation,t.image,t.moving,t.xpos,t.ypos,t.lastMouseX,t.lastMouseY,t.naturalWidth,t.naturalHeight,t.absoluteScale,t.maximumScale,t.onUpdate,t.onDragProgress]),y=Q.useCallback(function(t){zt(t),p(!0)},[p]),P=Q.useCallback(function(t){zt(t),p(!1)},[p]),E=Q.useCallback(function(e){P(e),e.dataTransfer&&t.onFileSelected(e.dataTransfer.files[0],t.isPhotoListPresent)},[t.onFileSelected]),I=Q.useCallback(function(){var e,a=o.current;if(a&&n){var r=a.getContext("2d");if(r){var i=window.getComputedStyle(a);r.fillStyle=i.backgroundColor||"#ffffff",r.fillRect(0,0,1,1);var s=r.getImageData(0,0,1,1).data,l="rgba(".concat(s[0],", ").concat(s[1],", ").concat(s[2],", 0.6)"),c="rgba(".concat(s[0],", ").concat(s[1],", ").concat(s[2],", 1)"),u=Object(kt.a)({text:t.personDisplayName});""===t.dataUrl?(r.fillStyle=u,n.style.display="flex"):(r.fillStyle=t.customBackgroundColor||"white",n.style.display="none"),r.fillRect(0,0,it,it),t.image&&lt(r,it,t.orientation,t.image,function(e,o){return e.drawImage(o,t.xpos,t.ypos,t.naturalWidth*t.absoluteScale/t.maximumScale,t.naturalHeight*t.absoluteScale/t.maximumScale)}),null===(e=t.onCanvasUpdated)||void 0===e||e.call(t,a),"Circle"===t.imageCropShape&&(r.save(),r.beginPath(),r.rect(0,0,it,it),r.arc(it/2,it/2,st,0,2*Math.PI,!0),r.clip(),r.fillStyle=l,r.fillRect(0,0,it,it),r.restore(),r.save(),r.beginPath(),r.arc(it/2,it/2,st+1,0,2*Math.PI,!0),r.lineWidth=2,r.strokeStyle=c,r.stroke(),r.restore(),r.save(),r.beginPath(),r.lineWidth=4,r.fillStyle="rgba(0, 120, 215, 0.5)",r.strokeStyle="rgba(0, 120, 215, 0.5)",r.arc(it/2,it/2,st,-Math.PI/2,2*t.progress*Math.PI-Math.PI/2,!1),1===t.progress&&r.fill(),r.stroke(),r.restore())}else t.onError("UNSUPPORTED_BROWSER")}},[t.personDisplayName,t.dataUrl,t.image,t.orientation,t.xpos,t.ypos,t.naturalWidth,t.naturalHeight,t.absoluteScale,t.maximumScale,t.progress,t.onError,t.customBackgroundColor,t.onCanvasUpdated,t.imageCropShape]),C=Q.useCallback(function(e,o){return"Fit"===t.imageScaling&&o<it?(it-o)/2:e>0?0:e+o<it?it-o:e},[t.imageScaling]);Q.useEffect(function(){return I(),function(){e=!0}},[]),Q.useEffect(function(){I()}),Q.useEffect(function(){1===t.progress&&t.onRefocus()},[t.progress]),Q.useEffect(function(){t.dataUrl?t.imageUpdated&&f(t.dataUrl):(t.onReset(),""===t.dataUrl&&t.onEmptyImageRendered())},[t.dataUrl,t.imageUpdated]);var U=Q.useMemo(function(){var e,o;return t.image?1===t.progress?t.strings.success:t.fileName?null===(o=(e=t.strings).photoSelected)||void 0===o?void 0:o.call(e,{p0:t.fileName}):t.strings.dropZoneImageAriaLabel:t.strings.dropZoneEmptyAriaLabel},[t.image,t.fileName,t.progress]);return Q.createElement("div",{className:l.canvasContainer},Q.createElement("canvas",{className:"".concat(l.editCanvas," ").concat(u?l.isDropActive:""),role:"img",tabIndex:0,ref:o,width:it,height:it,onKeyDown:function(t){return m(t)},"aria-label":U,onDragEnter:y,onDrop:E,onDragLeave:P,onDragOver:zt,onMouseDown:b,onMouseMove:S,onMouseUp:S,onMouseLeave:S,onWheel:v,onTouchStart:b,onTouchMove:S,onTouchEnd:S}),Q.createElement("div",{className:l.textboy,ref:function(t){return n=t},onDragEnter:y,onDragLeave:P,onDragOver:zt,onDrop:E},Q.createElement("div",{className:l.initials},a),Q.createElement("div",null,t.strings.dropZone)),Q.createElement("div",{role:"region","aria-live":"assertive","aria-atomic":!0},1===t.progress?Q.createElement("div",{className:l.textboy},Q.createElement("span",{className:l.invisible},t.strings.success),Q.createElement(Lt.a,{className:l.initials,iconName:"CheckMark"})):null),r?Q.createElement("div",{className:l.editControls}):Q.createElement(Mt,{progress:t.progress,zoomOutString:t.strings.zoomOut,zoomInString:t.strings.zoomIn,zoomString:t.strings.zoom,image:t.image,maximumScale:t.maximumScale,naturalHeight:t.naturalHeight,naturalWidth:t.naturalWidth,stepSize:t.stepSize,zoomOutDisabled:t.zoomOutDisabled,relativeScale:t.relativeScale,zoomInDisabled:t.zoomInDisabled,canvasSize:it,zoom:d}))},zt=function(t){t.stopPropagation(),t.preventDefault()},Ft=function(t){return"targetTouches"in t?[t.targetTouches[0].clientX,t.targetTouches[0].clientY]:[t.clientX,t.clientY]},Ht=(Bt=function(t,e){return(Bt=Z.a||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}Bt(t,e),t.prototype=null===e?X()(e):(o.prototype=e.prototype,new o)}),Gt=function(){return(Gt=G.a||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var a in e=arguments[o])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},Yt=function(t){function e(e){return t.call(this,e)||this}return Ht(e,t),e.prototype.render=function(){return Q.createElement(Wt,Gt({},this.props))},e}(Q.Component);var Xt=Object(nt.c)(function(t){return M.getSelectors(t).getEditCanvasState()},function(t){return{onReset:function(){return t(k())},onKeybordEvent:function(e){return t(U({xpos:e.xpos,ypos:e.ypos}))},onZoomEvent:function(e){return t(x({absoluteScale:e.absoluteScale,relativeScale:e.relativeScale,zoomOutDisabled:e.zoomOutDisabled,zoomInDisabled:e.zoomInDisabled,xpos:e.xpos,ypos:e.ypos}))},onImageLoaded:function(e){return t(w({naturalMin:e.naturalMin,naturalWidth:e.naturalWidth,naturalHeight:e.naturalHeight,stepSize:e.stepSize,maximumScale:e.maximumScale,orientation:e.orientation,image:e.image,zoomInDisabled:e.zoomInDisabled,initialRender:e.initialRender,xpos:e.xpos,ypos:e.ypos,absoluteScale:e.absoluteScale,relativeScale:e.relativeScale,imageUpdated:e.imageUpdated}))},onDragStart:function(e){return t(O({moving:e.moving,lastMouseX:e.lastMouseX,lastMouseY:e.lastMouseY}))},onDragProgress:function(e){return t(L({moving:e.moving,xpos:e.xpos,ypos:e.ypos,lastMouseX:e.lastMouseX,lastMouseY:e.lastMouseY}))},onEmptyImageRendered:function(){return t(D())}}})(Yt),Kt=o(2410),Zt=o(711),Vt=o(422),qt=o(58),Jt=o(566),Qt=function(t){var e,o,n,a=Object(dt.a)(),r=(e=t.isLastPhoto,o=t.index===t.selectedIndex,n=t.isEmptyPhoto,Object(Jt.a)(function(t){var a=t.palette;return{photoListItem:{height:56,width:56,marginBottom:e?0:10,border:o?"2px solid ".concat(a.themePrimary):"none",boxSizing:"border-box",display:"flex",padding:0,background:n?a.neutralLighter:"transparent",cursor:"pointer"},photoListItemImage:{height:"100%",width:"100%"},emptyPhotoIcon:{margin:"auto",fontSize:"24px",color:a.neutralSecondaryAlt}}}))(a);return Q.createElement("button",{className:r.photoListItem,onClick:function(){var e;t.onClickHandler({selectedIndex:t.index,imageUrl:t.imageUrl||"",fileName:"".concat(t.photoListImageAriaLabel," ").concat(t.index+1)}),t.isEmptyPhoto&&(null===(e=t.onPhotoRemoved)||void 0===e||e.call(t))},"aria-describedby":t.ariaDescribedBy},t.isEmptyPhoto?Q.createElement(Zt.a,{"aria-label":t.photoListEmptyImageAriaLabel,iconName:"Contact",className:r.emptyPhotoIcon}):Q.createElement(Vt.a,{src:t.imageUrl,className:r.photoListItemImage,alt:t.photoListImageAriaLabel,imageFit:qt.b.cover}))},$t=Object(Jt.b)({photoList:{height:256,width:56,padding:"0px 25px 0px 12px",overflowY:"auto",margin:0,listStyle:"none"}}),te=function(t){var e=$t(),o=t.imageUrls,n=t.showEmptyPhoto?o.length:o.length-1;return Q.createElement("ul",{className:e.photoList,"aria-label":t.strings.photoListAriaLabel},o.map(function(e,o){return Q.createElement(Kt.a,{posInSet:o+1,setSize:n+1,key:o,onRenderDescribedElement:function(a){return Q.createElement("li",{key:o},Q.createElement(Qt,{key:o,imageUrl:e,index:o,selectedIndex:t.selectedIndex,isLastPhoto:o===n,photoListImageAriaLabel:t.strings.photoListImageAriaLabel,onClickHandler:t.onPhotoListImageSelected,ariaDescribedBy:a}))}})}),!!t.showEmptyPhoto&&Q.createElement(Kt.a,{posInSet:n+1,setSize:n+1,onRenderDescribedElement:function(e){return Q.createElement("li",null,Q.createElement(Qt,{key:o.length,index:o.length,selectedIndex:t.selectedIndex,isLastPhoto:!0,isEmptyPhoto:!0,photoListEmptyImageAriaLabel:t.strings.photoListEmptyImageAriaLabel,onClickHandler:t.onPhotoListImageSelected,onPhotoRemoved:t.onPhotoRemoved,ariaDescribedBy:e}))}}))},ee=function(){var t=function(e,o){return(t=Z.a||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=e}t(e,o),e.prototype=null===o?X()(o):(n.prototype=o.prototype,new n)}}(),oe=function(){return(oe=G.a||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var a in e=arguments[o])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},ne=function(t){function e(e){return t.call(this,e)||this}return ee(e,t),e.prototype.componentDidMount=function(){this.props.photoListLoadPhotos(this.props.photoListSelectedIndex||0,this.props.photoListImageUrls)},e.prototype.render=function(){return Q.createElement(te,oe({},this.props))},e}(Q.Component);var ae=Object(nt.c)(function(t){return M.getSelectors(t).getPhotoListState()},function(t){return{photoListLoadPhotos:function(e,o){t(B({selectedIndex:e,imageUrls:o}))},onPhotoListImageSelected:function(e){!function(t,e,o,n){if(!e)return t(b({isPhotoListPresent:!0})),void t(N({selectedIndex:o}));if(e.startsWith("data:image/"))return t(S({dataUrl:e,isPhotoListPresent:!0,fileName:n})),t(R()),void t(N({selectedIndex:o}));var a=new Image;a.crossOrigin="Anonymous",a.onload=function(){var e=document.createElement("canvas");e.width=a.naturalWidth,e.height=a.naturalHeight;var r=e.getContext("2d");r&&(r.drawImage(a,0,0),t(S({dataUrl:at(e,!1),isPhotoListPresent:!0,fileName:n})),t(R()),t(N({selectedIndex:o})))},a.src=e}(t,e.imageUrl,e.selectedIndex,e.fileName)}}})(ne),re=function(){var t=function(e,o){return(t=Z.a||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=e}t(e,o),e.prototype=null===o?X()(o):(n.prototype=o.prototype,new n)}}(),ie=function(t){function e(e){return 1/(1+Math.exp(-t*e))-.5}var o=.5/e(1);return function(t){return t<=0?0:t>1?1:o*e(2*t-1)+.5}}(5),se=function(t){function e(e){var o=t.call(this,e)||this;return o.focusTrap=null,o.primaryButton=null,o.uploadFileButton=null,o.handleOnRemoveButtonClicked=function(){o.props.loadedEmptyImage(ot()(o.props.personImageUrl)),o.uploadFileButton&&o.uploadFileButton.focus()},o.handleOnSaveButtonClicked=function(){switch(o.props.status){case"SUCCESS":return o.props.onDone(),o.props.onDismiss();default:o.props.startUpload()}},o.handleUploadAnimation=function(){"IN_PROGRESS"===o.props.status&&o.props.onUploadProgress(tt()())},o.handleOnCancelButtonClicked=function(){o.props.onCancel(),o.props.onDismiss()},o.handleOnCloseButtonClicked=function(){o.props.onClose(),o.props.onDismiss()},o.getFocusTrapRef=o.getFocusTrapRef.bind(o),o.getButtonRef=o.getButtonRef.bind(o),o.getUploadButtonRef=o.getUploadButtonRef.bind(o),o}return re(e,t),e.prototype.getFocusTrapRef=function(){var t=this,e=function(e){return t.focusTrap=e};return e.current=null,e},e.prototype.getButtonRef=function(){var t=this,e=function(e){return t.primaryButton=e};return e.current=null,e},e.prototype.getUploadButtonRef=function(){var t=this,e=function(e){return t.uploadFileButton=e};return e.current=null,e},e.prototype.render=function(){var t,e,o=this,n=this.getWarningText(this.props.warning);return Q.createElement(wt,{onDismiss:this.props.onDismiss,focusTrapRef:this.getFocusTrapRef(),hideTitleText:!!this.props.hideUploadHeader,isComponentInline:!!this.props.isComponentInline,titleText:this.props.strings.uploadHeader,imageEditorDescription:this.props.strings.imageEditorDescription,hideEndActions:this.props.hideButtons,closeIcon:Q.createElement(Pt,{buttonType:"Icon",iconName:"Cancel",onClick:this.handleOnCloseButtonClicked,dataLogName:"PhotoPickerClose",title:this.props.strings.closeIconTitle,ariaLabel:this.props.strings.closeIconAriaLabel}),infoBar:n?Q.createElement(Ct,{warning:this.props.warning,warningText:n,onDismiss:this.props.onDismissInfoBar,dismissButtonAriaLabel:this.props.strings.infoBarDismissButtonAriaLabel}):null,uploadPhoto:this.props.hideUploadPhotoButton&&this.props.renderCustomUploadButton?null:Q.createElement(Ot,{buttonRef:this.getUploadButtonRef(),onFileSelected:this.props.onFileSelected,onUploadNewPhoto:this.props.onUploadNewPhoto,uploadText:this.props.strings.upload,isPhotoListPresent:ot()(this.props.personImageUrl)}),editCanvas:Q.createElement(Xt,{dataUrl:this.props.dataUrl,fileName:this.props.fileName,personDisplayName:this.props.personDisplayName,progress:this.props.progress,warning:n,strings:this.props.strings,onError:this.props.onError,isUploadedPhotoTooSmall:function(t){return o.props.onUploadedPhotoTooSmall(t)},onFileSelected:this.props.onFileSelected,onRefocus:function(){return o.onFocusChange()},onUpdate:this.props.onImageUpdated,imageCropShape:this.props.imageCropShape||"Circle",imageScaling:this.props.imageScaling||"Fill",onCanvasUpdated:this.props.onCanvasUpdated,isComponentInline:!!this.props.isComponentInline,customBackgroundColor:this.props.customBackgroundColor,isPhotoListPresent:ot()(this.props.personImageUrl)}),photoList:ot()(this.props.personImageUrl)?Q.createElement(ae,{photoListImageUrls:this.props.personImageUrl,photoListSelectedIndex:this.props.photoListSelectedIndex,showEmptyPhoto:!!this.props.showPhotoListEmptyPhoto,strings:this.props.strings,onPhotoRemoved:function(){var t;null===(t=o.uploadFileButton)||void 0===t||t.focus()}}):null,applyButton:Q.createElement(Pt,{buttonType:"Primary",buttonLabel:this.getSaveButtonText(this.props.status),dataLogName:"PhotoPickerOkay",onClick:this.handleOnSaveButtonClicked,disabled:this.getIsPrimaryButtonDisabled(),buttonRef:this.getButtonRef()}),cancelButton:this.props.progress>0?null:Q.createElement(Pt,{buttonType:"Default",buttonLabel:this.props.strings.cancel,dataLogName:"PhotoPickerCancel",onClick:this.handleOnCancelButtonClicked}),removeButton:this.props.isImageRemovable?Q.createElement(Pt,{buttonType:"Action",buttonLabel:this.props.strings.remove,iconName:"Delete",dataLogName:"PhotoPickerDelete",disabled:this.getIsRemoveButtonDisabled(),onClick:this.handleOnRemoveButtonClicked}):null,customUploadButton:null===(e=(t=this.props).renderCustomUploadButton)||void 0===e?void 0:e.call(t,{onFileSelected:this.props.onFileSelected,onUploadNewPhoto:this.props.onUploadNewPhoto})})},e.prototype.componentDidMount=function(){var t=this;this.props.loadCurrentImage(),requestAnimationFrame(function(){return t.focusTrap&&t.focusTrap.focus()})},e.prototype.componentWillUnmount=function(){this.props.onImageEditPaneDismissed()},e.prototype.componentDidUpdate=function(t){"IN_PROGRESS"===this.props.status&&requestAnimationFrame(this.handleUploadAnimation),"IN_PROGRESS"===t.status&&"SUCCESS"===this.props.status&&this.primaryButton&&this.primaryButton.focus()},e.prototype.onFocusChange=function(){"SUCCESS"===this.props.status?this.primaryButton&&this.primaryButton.focus():this.focusTrap&&this.focusTrap.focus()},e.prototype.getSaveButtonText=function(t){switch(t){case"IN_PROGRESS":return this.props.strings.inProgress;case"SUCCESS":return this.props.strings.close;case"READY":case"SOMETHING_WENT_WRONG":return this.props.strings.apply;default:return Object(pt.a)(t)}},e.prototype.getWarningText=function(t){switch(t){case"IMAGE_TOO_SMALL_WARNING":return this.props.strings.imageTooSmall;case"IMAGE_TOO_SMALL_ERROR":return this.props.strings.imageTooSmallError;case"NOT_AN_IMAGE":return this.props.strings.notAnImage;case"UNKNOWN":return this.props.strings.somethingWentWrong;case"UNSUPPORTED_BROWSER":return this.props.strings.unsupportedBrowser;default:return""}},e.prototype.getIsPrimaryButtonDisabled=function(){return!this.props.isUpdated||"IN_PROGRESS"===this.props.status||this.props.isUploadedPhotoTooSmall},e.prototype.getIsRemoveButtonDisabled=function(){return!this.props.dataUrl||"IN_PROGRESS"===this.props.status},e}(Q.Component);var le=Object(nt.c)(function(t){var e=M.getSelectors(t).getPhotoPickerState(),o=0;switch(e.status){case"IN_PROGRESS":var n=e.uploadDuration/2e3;o=.999999*ie(n);break;case"SUCCESS":o=1;break;case"READY":case"SOMETHING_WENT_WRONG":o=0;break;default:Object(pt.a)(e.status)}return{dataUrl:e.dataUrl,initialImage:e.currentImageDataUrl,warning:e.warning,status:e.status,isUpdated:e.isUpdated,isUploadedPhotoTooSmall:e.isUploadedPhotoTooSmall,progress:o,fileName:e.fileName}},function(t){return{onUploadedPhotoTooSmall:function(e){return t(u({isUploadedPhotoTooSmall:e}))},onDismissInfoBar:function(){return t(C())},onError:function(e){return t(y({warning:e}))},onUploadNewPhoto:function(){return t(h())},onFileSelected:function(e,o){return function(t,e,o){var n=new FileReader,a=function(){return t(y({warning:"NOT_AN_IMAGE"}))};n.onerror=a,n.onloadend=function(){var r=document.createElement("img");r.onerror=a,r.onload=function(){t(S({dataUrl:r.src,fileName:e.name})),t(R()),o&&t(A({selectedIndex:0,newImageUrl:r.src}))},r.src=String(n.result)},n.readAsDataURL(e)}(t,e,o)},onCancel:function(){return t(p())},onClose:function(){return t(d())},onDone:function(){return t(m())},onImageEditPaneDismissed:function(){return t(g())},onImageUpdated:function(){return t(f())},onUploadProgress:function(e){return t(E({now:e}))}}})(se),ce=function(){var t=function(e,o){return(t=Z.a||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=e}t(e,o),e.prototype=null===o?X()(o):(n.prototype=o.prototype,new n)}}(),ue=function(){return(ue=G.a||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var a in e=arguments[o])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},pe=function(t){function e(e){var o=t.call(this,e)||this;return o.stopEventDefaults=function(t){t.stopPropagation(),t.preventDefault()},o.loadCurrentImage=o.loadCurrentImage.bind(o),o.imageLoaded=o.imageLoaded.bind(o),o.imageLoadFailed=o.imageLoadFailed.bind(o),o.startUpload=o.startUpload.bind(o),o}return ce(e,t),e.prototype.render=function(){return Q.createElement(le,ue({loadCurrentImage:this.loadCurrentImage,startUpload:this.startUpload,loadedEmptyImage:this.props.onLoadedEmptyImage},this.props))},e.prototype.loadCurrentImage=function(){var t=this,e=new Image;e.crossOrigin="Anonymous",e.onload=function(){return t.imageLoaded(e)},e.onerror=function(){return t.imageLoadFailed()},e.src=ot()(this.props.personImageUrl)?this.props.personImageUrl[this.props.photoListSelectedIndex||0]||"":this.props.personImageUrl},e.prototype.imageLoaded=function(t){var e=document.createElement("canvas");e.width=t.naturalWidth,e.height=t.naturalHeight;var o=e.getContext("2d");o?(o.drawImage(t,0,0),this.props.onLoadedCurrentImage(at(e,this.props.isComponentInline),!!this.props.isSuggestedPhoto,ot()(this.props.personImageUrl))):this.props.onError("UNSUPPORTED_BROWSER")},e.prototype.imageLoadFailed=function(){this.props.onLoadedEmptyImage(ot()(this.props.personImageUrl))},e.prototype.startUpload=function(){var t=this.getImageDataUrlFromCanvas();this.props.onStartUpload(tt()(),t,this.props.selectedIndex,this.props.imageUrls,this.props.onUpload,this.props.getPhotoListDataOnUpload)},e.prototype.getImageDataUrlFromCanvas=function(t){var e=this;if(!this.props.image)return"";t||(t=648);var o=document.createElement("canvas"),n=this.props.naturalMin/this.props.absoluteScale;o.width=n,o.height=n;var a=o.getContext("2d");if(!a)return this.props.onError("UNSUPPORTED_BROWSER"),"";a.fillStyle=this.props.customBackgroundColor||"white",a.fillRect(0,0,o.width,o.height),this.props.image&&lt(a,o.width,this.props.orientation,this.props.image,function(t,n){return a.drawImage(n,e.props.xpos*o.width/it,e.props.ypos*o.height/it,e.props.naturalWidth,e.props.naturalHeight)});for(var r=1;o.width*r/4>=t;)r/=2,a.drawImage(o,0,0,o.width*r,o.height*r);var i=document.createElement("canvas"),s=Math.min(this.props.naturalMin/this.props.absoluteScale,t);i.width=s,i.height=s;var l=i.getContext("2d");return l?(l.drawImage(o,0,0,o.width*r,o.width*r,0,0,s,s),at(i,this.props.isComponentInline)):(this.props.onError("UNSUPPORTED_BROWSER"),"")},e}(Q.Component);var de=Object(nt.c)(function(t){return ue(ue({},M.getSelectors(t).getEditCanvasState()),M.getSelectors(t).getPhotoListState())},function(t){return{onError:function(e){return t(y({warning:e}))},onLoadedCurrentImage:function(e,o,n){return t(v({dataUrl:e,isSuggestedPhoto:o,isPhotoListPresent:n}))},onLoadedEmptyImage:function(e){return t(b({isPhotoListPresent:e}))},onStartUpload:function(e,o,n,a,r,i){return function(t,e,o,n,a,r,i){t(P({now:e})),r(o,function(){t(I({dataUrl:o})),null==i||i(n===a.length?-1:n,a)},function(){return t(y({warning:"UNKNOWN"}))})}(t,e,o,n,a,r,i)}}})(pe),me=o(1105);function he(){Object(me.a)(void 0,{disableWarnings:!0})}var ge=function(){var t=function(e,o){return(t=Z.a||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=e}t(e,o),e.prototype=null===o?X()(o):(n.prototype=o.prototype,new n)}}(),fe=function(){return(fe=G.a||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var a in e=arguments[o])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},ve=null,be=!1,Se=0,ye=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ge(e,t),e.prototype.UNSAFE_componentWillMount=function(){if(Se>=1)throw new Error("Can only mount one StandalonePhotoPicker at a time.");if(Se+=1,be||(be=!0,he()),null===ve){var t=Object(i.createStore)(Object(V.a)([M]));ve=new q.a({reduxStore:t})}},e.prototype.componentWillUnmount=function(){Se-=1},e.prototype.render=function(){return ve?Q.createElement(J.a,{context:ve},Q.createElement(de,fe({},this.props))):null},e}(Q.Component)}}]);