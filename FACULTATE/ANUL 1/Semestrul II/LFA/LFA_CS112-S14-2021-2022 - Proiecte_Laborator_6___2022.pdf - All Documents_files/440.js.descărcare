(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[440],{4259:function(e,t,n){"use strict";n.r(t);n.d(t,"officeHeaders",function(){return x});n.d(t,"resourceKey",function(){return T});var r=n(0),i=n(54),s=n(1065),o=n(59),u=n(101),a=n(203),f=n(1196),l=n(397),c=n(187),h=n(1973),p=n(469),d=n(35),v=n(2225),m=n(168),g=n(870),y=n(80),b=n(40),w=n(23),E=n(211),S=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t)||this,i=n.invokeApi,s=n.pageContext;if(i)r._invokeApi=i;else{var o=n.dataRequestorType;r._dataRequestor=new o({qosName:"MruRecentDataSource"})}r._engagement=n.engagement;r._identityDataSource=n.identityDataSource;r._itemParentHelper=n.itemParentHelper;r._itemUrlHelper=n.itemUrlHelper;r._ocsApiBaseUrl="".concat(s.msMruEndpointUrl,"/ocs/v2/recent");r._tenantId=Object(a.normalizeLower)(s.aadTenantId);return r}t.prototype.removeRecentItem=function(e){return o.n.reject("Not implemented")};t.prototype.changePinStatus=function(e){var t=e.mruState.isPinnedToMru,n={category:"Document",type:"ClassicMru",app:Object(v.r)(e),is_pinned:!t,mru_id:e.mruState.mruId,url:e.properties.path};this._engagement.logData({name:"MruRecent"+(t?".UnpinItem":".PinItem"),isIntentional:!0});return this._invokeApi({url:"".concat(this._ocsApiBaseUrl,"/docs"),qosName:t?"SetMRUUnpinned":"SetMRUPinned",body:n})};t.prototype.recordDocumentView=function(e,t){var n=!t.mru_id,s=this._itemParentHelper,o=this._itemUrlHelper,u=this.observables,f=s.getFacetedAncestorOrSelf(e,"list"),l=s.getFacetedAncestorOrSelf(e,"subsite"),c=u.peekUnwrap(f),h=u.peekUnwrap(l),p=e.properties,d=c&&c.list,v=h&&h.subsite,g=o.getItemUrlParts(e.key),y=o.getUrlParts({path:g.fullItemUrl,listUrl:d&&d.listUrlDir,webUrl:v&&v.serverRelativeUrl}).webRelativeItemUrl,b=new m.e(y).segments.slice(0,-1),w=v&&v.webTemplateId,E="number"==typeof w?w===i.t.mySite?"business":"documentLibrary":void 0;t=Object(r.__assign)(Object(r.__assign)({},t),{display_path:b,onedrive_info:Object(r.__assign)({drive_type:E},t.onedrive_info),sharepoint_info:{list_id:Object(a.normalizeLower)(p.listId||d&&d.id),list_item_id:parseInt(p.ID,10),list_item_unique_id:Object(a.normalizeLower)(p.uniqueId),site_id:v&&Object(a.normalizeLower)(v.siteCollectionId),site_url:v&&v.serverRelativeUrl,tenant_id:this._tenantId,web_id:v&&Object(a.normalizeLower)(v.id)}});return this._invokeApi({url:this._ocsApiBaseUrl,qosName:"".concat(n?"Add":"Update","MRUEntry"),body:t})};t.prototype.getTokenForMru=function(){return this._identityDataSource.getOfficeToken().then(function(e){return e.accessToken})};t.prototype._invokeApi=function(e){var t=this;return this.getTokenForMru().then(function(n){if(!w.e.isActivated("A1C0D26A-2ECD-43C5-9686-E57F14E61AB9","10/5/2021","Avoid using SP DataRequestor for Office MRU Recent")){var i=new y.e({name:"MruRecentDataSource.".concat(e.qosName)});return g.e.start({url:e.url,method:"POST",headers:Object(r.__assign)({Authorization:"Bearer ".concat(n)},x),json:JSON.stringify(e.body)}).then(function(e){i.end({resultType:b.e.Success});return JSON.parse(e.responseText)},function(e){i.end(Object(E.e)(e));return o.n.reject(e)})}return t._dataRequestor.getData({url:e.url,method:"POST",qosName:e.qosName,needsRequestDigest:!1,noRedirect:!0,additionalHeaders:Object(r.__assign)({Authorization:"Bearer ".concat(n)},x),additionalPostData:JSON.stringify(e.body)})})};t.dependencies=Object(r.__assign)(Object(r.__assign)({},s.default.dependencies),{dataRequestorType:f.n,engagement:p.e,identityDataSource:l.t,itemParentHelper:h.e,itemUrlHelper:c.a,pageContext:d.h});return t})(s.default);t.default=S;var x={"X-Office-Platform":"Web","X-Office-Application":"110","X-Office-Version":window._spModuleLink?window._spModuleLink.buildNumber:0,"Content-Type":"application/json;charset=UTF-8"},T=Object(u.s)("MruRecentDataSource",S)}}]);